(self.webpackChunkbusinessgate=self.webpackChunkbusinessgate||[]).push([[736],{6355:(Sn,Nt,H)=>{"use strict";H.d(Nt,{ST:()=>rv,yb:()=>Py});var w=H(5e3),ue=H(4986),g=H(8306),nt=H(8996),xe=H(9646),Le=H(5813),Re=H(4482),Ue=H(5403);function fe(){return(0,Re.e)((s,e)=>{let n,c=!1;s.subscribe(new Ue.Q(e,y=>{const S=n;n=y,c&&e.next([S,y]),c=!0}))})}var U,se=H(8675),ae=H(4004),$e=H(5026),St=H(1884),pt=H(9300),bt=H(2011),Ct=H(9808),ut=(H(1488),H(3942)),he=H(5861),je=H(9681),Ae=H(4859),j=H(1877),W=H(2090),ge="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},q={},Y=Y||{},ee=ge||self;function Pe(){}function _e(s){var e=typeof s;return"array"==(e="object"!=e?e:s?Array.isArray(s)?"array":e:"null")||"object"==e&&"number"==typeof s.length}function We(s){var e=typeof s;return"object"==e&&null!=s||"function"==e}var _t="closure_uid_"+(1e9*Math.random()>>>0),ft=0;function Zt(s,e,n){return s.call.apply(s.bind,arguments)}function nn(s,e,n){if(!s)throw Error();if(2<arguments.length){var c=Array.prototype.slice.call(arguments,2);return function(){var y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(y,c),s.apply(e,y)}}return function(){return s.apply(e,arguments)}}function qt(s,e,n){return(qt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Zt:nn).apply(null,arguments)}function An(s,e){var n=Array.prototype.slice.call(arguments,1);return function(){var c=n.slice();return c.push.apply(c,arguments),s.apply(this,c)}}function kn(s,e){function n(){}n.prototype=e.prototype,s.Z=e.prototype,s.prototype=new n,s.prototype.constructor=s,s.Vb=function(c,y,S){for(var L=Array(arguments.length-2),te=2;te<arguments.length;te++)L[te-2]=arguments[te];return e.prototype[y].apply(c,L)}}function jn(){this.s=this.s,this.o=this.o}var lr={};jn.prototype.s=!1,jn.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var s=function rt(s){return Object.prototype.hasOwnProperty.call(s,_t)&&s[_t]||(s[_t]=++ft)}(this);delete lr[s]}},jn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Er=Array.prototype.indexOf?function(s,e){return Array.prototype.indexOf.call(s,e,void 0)}:function(s,e){if("string"==typeof s)return"string"!=typeof e||1!=e.length?-1:s.indexOf(e,0);for(let n=0;n<s.length;n++)if(n in s&&s[n]===e)return n;return-1},Sr=Array.prototype.forEach?function(s,e,n){Array.prototype.forEach.call(s,e,n)}:function(s,e,n){const c=s.length,y="string"==typeof s?s.split(""):s;for(let S=0;S<c;S++)S in y&&e.call(n,y[S],S,s)};function vr(s){return Array.prototype.concat.apply([],arguments)}function qi(s){const e=s.length;if(0<e){const n=Array(e);for(let c=0;c<e;c++)n[c]=s[c];return n}return[]}function ii(s){return/^[\s\xa0]*$/.test(s)}var oi,fi=String.prototype.trim?function(s){return s.trim()}:function(s){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(s)[1]};function bi(s,e){return-1!=s.indexOf(e)}function pi(s,e){return s<e?-1:s>e?1:0}e:{var Xt=ee.navigator;if(Xt){var ln=Xt.userAgent;if(ln){oi=ln;break e}}oi=""}function En(s,e,n){for(const c in s)e.call(n,s[c],c,s)}function bn(s){const e={};for(const n in s)e[n]=s[n];return e}var Wn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function jt(s,e){let n,c;for(let y=1;y<arguments.length;y++){for(n in c=arguments[y],c)s[n]=c[n];for(let S=0;S<Wn.length;S++)n=Wn[S],Object.prototype.hasOwnProperty.call(c,n)&&(s[n]=c[n])}}function ve(s){return ve[" "](s),s}ve[" "]=Pe;var wr,s,re=bi(oi,"Opera"),ht=bi(oi,"Trident")||bi(oi,"MSIE"),zt=bi(oi,"Edge"),sn=zt||ht,Mn=bi(oi,"Gecko")&&!(bi(oi.toLowerCase(),"webkit")&&!bi(oi,"Edge"))&&!(bi(oi,"Trident")||bi(oi,"MSIE"))&&!bi(oi,"Edge"),Jn=bi(oi.toLowerCase(),"webkit")&&!bi(oi,"Edge");function Tr(){var s=ee.document;return s?s.documentMode:void 0}e:{var Ki="",Li=(s=oi,Mn?/rv:([^\);]+)(\)|;)/.exec(s):zt?/Edge\/([\d\.]+)/.exec(s):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(s):Jn?/WebKit\/(\S+)/.exec(s):re?/(?:Version)[ \/]?(\S+)/.exec(s):void 0);if(Li&&(Ki=Li?Li[1]:""),ht){var Ht=Tr();if(null!=Ht&&Ht>parseFloat(Ki)){wr=String(Ht);break e}}wr=Ki}var Te={};var vt=ee.document&&ht&&(Tr()||parseInt(wr,10))||void 0,dn=function(){if(!ee.addEventListener||!Object.defineProperty)return!1;var s=!1,e=Object.defineProperty({},"passive",{get:function(){s=!0}});try{ee.addEventListener("test",Pe,e),ee.removeEventListener("test",Pe,e)}catch(n){}return s}();function Pn(s,e){this.type=s,this.g=this.target=e,this.defaultPrevented=!1}function ce(s,e){if(Pn.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var n=this.type=s.type,c=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=e,e=s.relatedTarget){if(Mn){e:{try{ve(e.nodeName);var y=!0;break e}catch(S){}y=!1}y||(e=null)}}else"mouseover"==n?e=s.fromElement:"mouseout"==n&&(e=s.toElement);this.relatedTarget=e,c?(this.clientX=void 0!==c.clientX?c.clientX:c.pageX,this.clientY=void 0!==c.clientY?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0):(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType="string"==typeof s.pointerType?s.pointerType:be[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&ce.Z.h.call(this)}}Pn.prototype.h=function(){this.defaultPrevented=!0},kn(ce,Pn);var be={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.Z.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function ot(s,e,n,c,y){this.listener=s,this.proxy=null,this.src=e,this.type=n,this.capture=!!c,this.ia=y,this.key=++Qe,this.ca=this.fa=!1}function Dt(s){s.ca=!0,s.listener=null,s.proxy=null,s.src=null,s.ia=null}function Lt(s){this.src=s,this.g={},this.h=0}function Je(s,e){var n=e.type;if(n in s.g){var S,c=s.g[n],y=Er(c,e);(S=0<=y)&&Array.prototype.splice.call(c,y,1),S&&(Dt(e),0==s.g[n].length&&(delete s.g[n],s.h--))}}function Ie(s,e,n,c){for(var y=0;y<s.length;++y){var S=s[y];if(!S.ca&&S.listener==e&&S.capture==!!n&&S.ia==c)return y}return-1}Lt.prototype.add=function(s,e,n,c,y){var S=s.toString();(s=this.g[S])||(s=this.g[S]=[],this.h++);var L=Ie(s,e,c,y);return-1<L?(e=s[L],n||(e.fa=!1)):((e=new ot(e,this.src,S,!!c,y)).fa=n,s.push(e)),e};var ze="closure_lm_"+(1e6*Math.random()|0),Ve={};function mt(s,e,n,c,y){if(c&&c.once)return Dn(s,e,n,c,y);if(Array.isArray(e)){for(var S=0;S<e.length;S++)mt(s,e[S],n,c,y);return null}return n=Xn(n),s&&s[Oe]?s.N(e,n,We(c)?!!c.capture:!!c,y):Tt(s,e,n,!1,c,y)}function Tt(s,e,n,c,y,S){if(!e)throw Error("Invalid event type");var L=We(y)?!!y.capture:!!y,te=Hn(s);if(te||(s[ze]=te=new Lt(s)),(n=te.add(e,n,c,L,S)).proxy)return n;if(c=function en(){var e=Yn;return function s(n){return e.call(s.src,s.listener,n)}}(),n.proxy=c,c.src=s,c.listener=n,s.addEventListener)dn||(y=L),void 0===y&&(y=!1),s.addEventListener(e.toString(),c,y);else if(s.attachEvent)s.attachEvent(Kn(e.toString()),c);else{if(!s.addListener||!s.removeListener)throw Error("addEventListener and attachEvent are unavailable.");s.addListener(c)}return n}function Dn(s,e,n,c,y){if(Array.isArray(e)){for(var S=0;S<e.length;S++)Dn(s,e[S],n,c,y);return null}return n=Xn(n),s&&s[Oe]?s.O(e,n,We(c)?!!c.capture:!!c,y):Tt(s,e,n,!0,c,y)}function zn(s,e,n,c,y){if(Array.isArray(e))for(var S=0;S<e.length;S++)zn(s,e[S],n,c,y);else c=We(c)?!!c.capture:!!c,n=Xn(n),s&&s[Oe]?(s=s.i,(e=String(e).toString())in s.g&&-1<(n=Ie(S=s.g[e],n,c,y))&&(Dt(S[n]),Array.prototype.splice.call(S,n,1),0==S.length&&(delete s.g[e],s.h--))):s&&(s=Hn(s))&&(e=s.g[e.toString()],s=-1,e&&(s=Ie(e,n,c,y)),(n=-1<s?e[s]:null)&&an(n))}function an(s){if("number"!=typeof s&&s&&!s.ca){var e=s.src;if(e&&e[Oe])Je(e.i,s);else{var n=s.type,c=s.proxy;e.removeEventListener?e.removeEventListener(n,c,s.capture):e.detachEvent?e.detachEvent(Kn(n),c):e.addListener&&e.removeListener&&e.removeListener(c),(n=Hn(e))?(Je(n,s),0==n.h&&(n.src=null,e[ze]=null)):Dt(s)}}}function Kn(s){return s in Ve?Ve[s]:Ve[s]="on"+s}function Yn(s,e){if(s.ca)s=!0;else{e=new ce(e,this);var n=s.listener,c=s.ia||s.src;s.fa&&an(s),s=n.call(c,e)}return s}function Hn(s){return(s=s[ze])instanceof Lt?s:null}var Ir="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xn(s){return"function"==typeof s?s:(s[Ir]||(s[Ir]=function(e){return s.handleEvent(e)}),s[Ir])}function br(){jn.call(this),this.i=new Lt(this),this.P=this,this.I=null}function yn(s,e){var n,c=s.I;if(c)for(n=[];c;c=c.I)n.push(c);if(s=s.P,c=e.type||e,"string"==typeof e)e=new Pn(e,s);else if(e instanceof Pn)e.target=e.target||s;else{var y=e;jt(e=new Pn(c,s),y)}if(y=!0,n)for(var S=n.length-1;0<=S;S--){var L=e.g=n[S];y=ur(L,c,!0,e)&&y}if(y=ur(L=e.g=s,c,!0,e)&&y,y=ur(L,c,!1,e)&&y,n)for(S=0;S<n.length;S++)y=ur(L=e.g=n[S],c,!1,e)&&y}function ur(s,e,n,c){if(!(e=s.i.g[String(e)]))return!0;e=e.concat();for(var y=!0,S=0;S<e.length;++S){var L=e[S];if(L&&!L.ca&&L.capture==n){var te=L.listener,Me=L.ia||L.src;L.fa&&Je(s.i,L),y=!1!==te.call(Me,c)&&y}}return y&&!c.defaultPrevented}kn(br,jn),br.prototype[Oe]=!0,br.prototype.removeEventListener=function(s,e,n,c){zn(this,s,e,n,c)},br.prototype.M=function(){if(br.Z.M.call(this),this.i){var e,s=this.i;for(e in s.g){for(var n=s.g[e],c=0;c<n.length;c++)Dt(n[c]);delete s.g[e],s.h--}}this.I=null},br.prototype.N=function(s,e,n,c){return this.i.add(String(s),e,!1,n,c)},br.prototype.O=function(s,e,n,c){return this.i.add(String(s),e,!0,n,c)};var Dr=ee.JSON.stringify;function jr(){var s=Yi;let e=null;return s.g&&(e=s.g,s.g=s.g.next,s.g||(s.h=null),e.next=null),e}var Fr,zr=new class{constructor(s,e){this.i=s,this.j=e,this.h=0,this.g=null}get(){let s;return 0<this.h?(this.h--,s=this.g,this.g=s.next,s.next=null):s=this.i(),s}}(()=>new Ci,s=>s.reset());class Ci{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Mr(s){ee.setTimeout(()=>{throw s},0)}function Gr(s,e){Fr||function Vr(){var s=ee.Promise.resolve(void 0);Fr=function(){s.then(Ao)}}(),hs||(Fr(),hs=!0),Yi.add(s,e)}var hs=!1,Yi=new class oo{constructor(){this.h=this.g=null}add(e,n){const c=zr.get();c.set(e,n),this.h?this.h.next=c:this.g=c,this.h=c}};function Ao(){for(var s;s=jr();){try{s.h.call(s.g)}catch(n){Mr(n)}var e=zr;e.j(s),100>e.h&&(e.h++,s.next=e.g,e.g=s)}hs=!1}function Bo(s,e){br.call(this),this.h=s||1,this.g=e||ee,this.j=qt(this.kb,this),this.l=Date.now()}function Pi(s){s.da=!1,s.S&&(s.g.clearTimeout(s.S),s.S=null)}function Si(s,e,n){if("function"==typeof s)n&&(s=qt(s,n));else{if(!s||"function"!=typeof s.handleEvent)throw Error("Invalid listener argument");s=qt(s.handleEvent,s)}return 2147483647<Number(e)?-1:ee.setTimeout(s,e||0)}function xs(s){s.g=Si(()=>{s.g=null,s.i&&(s.i=!1,xs(s))},s.j);const e=s.h;s.h=null,s.m.apply(null,e)}kn(Bo,br),(U=Bo.prototype).da=!1,U.S=null,U.kb=function(){if(this.da){var s=Date.now()-this.l;0<s&&s<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-s):(this.S&&(this.g.clearTimeout(this.S),this.S=null),yn(this,"tick"),this.da&&(Pi(this),this.start()))}},U.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},U.M=function(){Bo.Z.M.call(this),Pi(this),delete this.g};class zi extends jn{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:xs(this)}M(){super.M(),this.g&&(ee.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Br(s){jn.call(this),this.h=s,this.g={}}kn(Br,jn);var ds=[];function _i(s,e,n,c){Array.isArray(n)||(n&&(ds[0]=n.toString()),n=ds);for(var y=0;y<n.length;y++){var S=mt(e,n[y],c||s.handleEvent,!1,s.h||s);if(!S)break;s.g[S.key]=S}}function fo(s){En(s.g,function(e,n){this.g.hasOwnProperty(n)&&an(e)},s),s.g={}}function Ji(){this.g=!0}function fs(s,e,n,c){s.info(function(){return"XMLHTTP TEXT ("+e+"): "+function jo(s,e){if(!s.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(s=0;s<n.length;s++)if(Array.isArray(n[s])){var c=n[s];if(!(2>c.length)){var y=c[1];if(Array.isArray(y)&&!(1>y.length)){var S=y[0];if("noop"!=S&&"stop"!=S&&"close"!=S)for(var L=1;L<y.length;L++)y[L]=""}}}return Dr(n)}catch(te){return e}}(s,n)+(c?" "+c:"")})}Br.prototype.M=function(){Br.Z.M.call(this),fo(this)},Br.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ji.prototype.Aa=function(){this.g=!1},Ji.prototype.info=function(){};var Mo={},No=null;function mi(){return No=No||new br}function su(s){Pn.call(this,Mo.Ma,s)}function Oa(s){const e=mi();yn(e,new su(e,s))}function rs(s,e){Pn.call(this,Mo.STAT_EVENT,s),this.stat=e}function Yo(s){const e=mi();yn(e,new rs(e,s))}function $a(s,e){Pn.call(this,Mo.Na,s),this.size=e}function au(s,e){if("function"!=typeof s)throw Error("Fn must not be null and must be a function");return ee.setTimeout(function(){s()},e)}Mo.Ma="serverreachability",kn(su,Pn),Mo.STAT_EVENT="statevent",kn(rs,Pn),Mo.Na="timingevent",kn($a,Pn);var fa={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ta={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function pa(){}function Uu(){}pa.prototype.h=null;var $s,ma={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Ss(){Pn.call(this,"d")}function Ls(){Pn.call(this,"c")}function Ho(){}function ga(s,e,n,c){this.l=s,this.j=e,this.m=n,this.X=c||1,this.V=new Br(this),this.P=Es,this.W=new Bo(s=sn?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Cs}function Cs(){this.i=null,this.g="",this.h=!1}kn(Ss,Pn),kn(Ls,Pn),kn(Ho,pa),Ho.prototype.g=function(){return new XMLHttpRequest},Ho.prototype.i=function(){return{}},$s=new Ho;var Es=45e3,is={},po={};function Ni(s,e,n){s.K=1,s.v=vn(qr(e)),s.s=n,s.U=!0,Uo(s,null)}function Uo(s,e){s.F=Date.now(),Ga(s),s.A=qr(s.v);var n=s.A,c=s.X;Array.isArray(c)||(c=[String(c)]),Ns(n.h,"t",c),s.C=0,n=s.l.H,s.h=new Cs,s.g=Yr(s.l,n?e:null,!s.s),0<s.O&&(s.L=new zi(qt(s.Ia,s,s.g),s.O)),_i(s.V,s.g,"readystatechange",s.gb),e=s.H?bn(s.H):{},s.s?(s.u||(s.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.s,e)):(s.u="GET",s.g.ea(s.A,s.u,null,e)),Oa(1),function ou(s,e,n,c,y,S){s.info(function(){if(s.g)if(S)for(var L="",te=S.split("&"),Me=0;Me<te.length;Me++){var dt=te[Me].split("=");if(1<dt.length){var Rt=dt[0];dt=dt[1];var Kt=Rt.split("_");L=2<=Kt.length&&"type"==Kt[1]?L+(Rt+"=")+dt+"&":L+(Rt+"=redacted&")}}else L=null;else L=S;return"XMLHTTP REQ ("+c+") [attempt "+y+"]: "+e+"\n"+n+"\n"+L})}(s.j,s.u,s.A,s.m,s.X,s.s)}function el(s){return!!s.g&&"GET"==s.u&&2!=s.K&&s.l.Ba}function na(s,e,n){let y,c=!0;for(;!s.I&&s.C<n.length;){if(y=uu(s,n),y==po){4==e&&(s.o=4,Yo(14),c=!1),fs(s.j,s.m,null,"[Incomplete Response]");break}if(y==is){s.o=4,Yo(15),fs(s.j,s.m,n,"[Invalid Chunk]"),c=!1;break}fs(s.j,s.m,y,null),ss(s,y)}el(s)&&y!=po&&y!=is&&(s.h.g="",s.C=0),4!=e||0!=n.length||s.h.h||(s.o=1,Yo(16),c=!1),s.i=s.i&&c,c?0<n.length&&!s.aa&&(s.aa=!0,(e=s.l).g==s&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Mt(e),e.L=!0,Yo(11))):(fs(s.j,s.m,n,"[Invalid Chunked Response]"),so(s),qs(s))}function uu(s,e){var n=s.C,c=e.indexOf("\n",n);return-1==c?po:(n=Number(e.substring(n,c)),isNaN(n)?is:(c+=1)+n>e.length?po:(e=e.substr(c,n),s.C=c+n,e))}function Ga(s){s.Y=Date.now()+s.P,Gs(s,s.P)}function Gs(s,e){if(null!=s.B)throw Error("WatchDog timer not null");s.B=au(qt(s.eb,s),e)}function os(s){s.B&&(ee.clearTimeout(s.B),s.B=null)}function qs(s){0==s.l.G||s.I||on(s.l,s)}function so(s){os(s);var e=s.L;e&&"function"==typeof e.na&&e.na(),s.L=null,Pi(s.W),fo(s.V),s.g&&(e=s.g,s.g=null,e.abort(),e.na())}function ss(s,e){try{var n=s.l;if(0!=n.G&&(n.g==s||xo(n.i,s)))if(n.I=s.N,!s.J&&xo(n.i,s)&&3==n.G){try{var c=n.Ca.g.parse(e)}catch(dt){c=null}if(Array.isArray(c)&&3==c.length){var y=c;if(0==y[0])e:if(n.u)n.ta=y[1],0<n.ta-n.U&&37500>y[2]&&n.N&&0==n.A&&!n.v&&(n.v=au(qt(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<s.F))break e;_n(n),Ai(n)}Ze(n),Yo(18)}if(1>=Fa(n.i)&&n.ka){try{n.ka()}catch(dt){}n.ka=void 0}}else Gn(n,11)}else if((s.J||n.g==s)&&_n(n),!ii(e))for(y=n.Ca.g.parse(e),e=0;e<y.length;e++){let dt=y[e];if(n.U=dt[0],dt=dt[1],2==n.G)if("c"==dt[0]){n.J=dt[1],n.la=dt[2];const Rt=dt[3];null!=Rt&&(n.ma=Rt,n.h.info("VER="+n.ma));const Kt=dt[4];null!=Kt&&(n.za=Kt,n.h.info("SVER="+n.za));const Cn=dt[5];null!=Cn&&"number"==typeof Cn&&0<Cn&&(n.K=c=1.5*Cn,n.h.info("backChannelRequestTimeoutMs_="+c)),c=n;const nr=s.g;if(nr){const fr=nr.g?nr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fr){var S=c.i;!S.g&&(bi(fr,"spdy")||bi(fr,"quic")||bi(fr,"h2"))&&(S.j=S.l,S.g=new Set,S.h&&(Ws(S,S.h),S.h=null))}if(c.D){const $r=nr.g?nr.g.getResponseHeader("X-HTTP-Session-Id"):null;$r&&(c.sa=$r,Ot(c.F,c.D,$r))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-s.F,n.h.info("Handshake RTT: "+n.O+"ms"));var L=s;if((c=n).oa=gi(c,c.H?c.la:null,c.W),L.J){Wa(c.i,L);var te=L,Me=c.K;Me&&te.setTimeout(Me),te.B&&(os(te),Ga(te)),c.g=L}else Ge(c);0<n.l.length&&sa(n)}else"stop"!=dt[0]&&"close"!=dt[0]||Gn(n,7);else 3==n.G&&("stop"==dt[0]||"close"==dt[0]?"stop"==dt[0]?Gn(n,7):To(n):"noop"!=dt[0]&&n.j&&n.j.wa(dt),n.A=0)}Oa(4)}catch(dt){}}function wo(s,e){if(s.forEach&&"function"==typeof s.forEach)s.forEach(e,void 0);else if(_e(s)||"string"==typeof s)Sr(s,e,void 0);else{if(s.T&&"function"==typeof s.T)var n=s.T();else if(s.R&&"function"==typeof s.R)n=void 0;else if(_e(s)||"string"==typeof s){n=[];for(var c=s.length,y=0;y<c;y++)n.push(y)}else for(y in n=[],c=0,s)n[c++]=y;c=function Su(s){if(s.R&&"function"==typeof s.R)return s.R();if("string"==typeof s)return s.split("");if(_e(s)){for(var e=[],n=s.length,c=0;c<n;c++)e.push(s[c]);return e}for(c in e=[],n=0,s)e[n++]=s[c];return e}(s),y=c.length;for(var S=0;S<y;S++)e.call(void 0,c[S],n&&n[S],s)}}function Ds(s,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var c=0;c<n;c+=2)this.set(arguments[c],arguments[c+1])}else if(s)if(s instanceof Ds)for(n=s.T(),c=0;c<n.length;c++)this.set(n[c],s.get(n[c]));else for(c in s)this.set(c,s[c])}function qa(s){if(s.i!=s.g.length){for(var e=0,n=0;e<s.g.length;){var c=s.g[e];eo(s.h,c)&&(s.g[n++]=c),e++}s.g.length=n}if(s.i!=s.g.length){var y={};for(n=e=0;e<s.g.length;)eo(y,c=s.g[e])||(s.g[n++]=c,y[c]=1),e++;s.g.length=n}}function eo(s,e){return Object.prototype.hasOwnProperty.call(s,e)}(U=ga.prototype).setTimeout=function(s){this.P=s},U.gb=function(s){s=s.target;const e=this.L;e&&3==us(s)?e.l():this.Ia(s)},U.Ia=function(s){try{if(s==this.g)e:{const Rt=us(this.g);var e=this.g.Da();const Kt=this.g.ba();if(!(3>Rt)&&(3!=Rt||sn||this.g&&(this.h.h||this.g.ga()||rl(this.g)))){this.I||4!=Rt||7==e||Oa(8==e||0>=Kt?3:2),os(this);var n=this.g.ba();this.N=n;t:if(el(this)){var c=rl(this.g);s="";var y=c.length,S=4==us(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){so(this),qs(this);var L="";break t}this.h.i=new ee.TextDecoder}for(e=0;e<y;e++)this.h.h=!0,s+=this.h.i.decode(c[e],{stream:S&&e==y-1});c.splice(0,y),this.h.g+=s,this.C=0,L=this.h.g}else L=this.g.ga();if(this.i=200==n,function ns(s,e,n,c,y,S,L){s.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+y+"]: "+e+"\n"+n+"\n"+S+" "+L})}(this.j,this.u,this.A,this.m,this.X,Rt,n),this.i){if(this.$&&!this.J){t:{if(this.g){var te,Me=this.g;if((te=Me.g?Me.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ii(te)){var dt=te;break t}}dt=null}if(!(n=dt)){this.i=!1,this.o=3,Yo(12),so(this),qs(this);break e}fs(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ss(this,n)}this.U?(na(this,Rt,L),sn&&this.i&&3==Rt&&(_i(this.V,this.W,"tick",this.fb),this.W.start())):(fs(this.j,this.m,L,null),ss(this,L)),4==Rt&&so(this),this.i&&!this.I&&(4==Rt?on(this.l,this):(this.i=!1,Ga(this)))}else 400==n&&0<L.indexOf("Unknown SID")?(this.o=3,Yo(12)):(this.o=0,Yo(13)),so(this),qs(this)}}}catch(Rt){}},U.fb=function(){if(this.g){var s=us(this.g),e=this.g.ga();this.C<e.length&&(os(this),na(this,s,e),this.i&&4!=s&&Ga(this))}},U.cancel=function(){this.I=!0,so(this)},U.eb=function(){this.B=null;const s=Date.now();0<=s-this.Y?(function Io(s,e){s.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Oa(3),Yo(17)),so(this),this.o=2,qs(this)):Gs(this,this.Y-s)},(U=Ds.prototype).R=function(){qa(this);for(var s=[],e=0;e<this.g.length;e++)s.push(this.h[this.g[e]]);return s},U.T=function(){return qa(this),this.g.concat()},U.get=function(s,e){return eo(this.h,s)?this.h[s]:e},U.set=function(s,e){eo(this.h,s)||(this.i++,this.g.push(s)),this.h[s]=e},U.forEach=function(s,e){for(var n=this.T(),c=0;c<n.length;c++){var y=n[c],S=this.get(y);s.call(e,S,y,this)}};var Cu=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Jo(s,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,s instanceof Jo){this.g=void 0!==e?e:s.g,oe(this,s.j),this.s=s.s,qe(this,s.i),ne(this,s.m),this.l=s.l,e=s.h;var n=new go;n.i=e.i,e.g&&(n.g=new Ds(e.g),n.h=e.h),et(this,n),this.o=s.o}else s&&(n=String(s).match(Cu))?(this.g=!!e,oe(this,n[1]||"",!0),this.s=Hr(n[2]||""),qe(this,n[3]||"",!0),ne(this,n[4]),this.l=Hr(n[5]||"",!0),et(this,n[6]||"",!0),this.o=Hr(n[7]||"")):(this.g=!!e,this.h=new go(null,this.g))}function qr(s){return new Jo(s)}function oe(s,e,n){s.j=n?Hr(e,!0):e,s.j&&(s.j=s.j.replace(/:$/,""))}function qe(s,e,n){s.i=n?Hr(e,!0):e}function ne(s,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);s.m=e}else s.m=null}function et(s,e,n){e instanceof go?(s.h=e,function Na(s,e){e&&!s.j&&(Rr(s),s.i=null,s.g.forEach(function(n,c){var y=c.toLowerCase();c!=y&&(ra(this,c),Ns(this,y,n))},s)),s.j=e}(s.h,s.g)):(n||(e=li(e,Di)),s.h=new go(e,s.g))}function Ot(s,e,n){s.h.set(e,n)}function vn(s){return Ot(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function Hr(s,e){return s?e?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function li(s,e,n){return"string"==typeof s?(s=encodeURI(s).replace(e,ni),n&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function ni(s){return"%"+((s=s.charCodeAt(0))>>4&15).toString(16)+(15&s).toString(16)}Jo.prototype.toString=function(){var s=[],e=this.j;e&&s.push(li(e,Qr,!0),":");var n=this.i;return(n||"file"==e)&&(s.push("//"),(e=this.s)&&s.push(li(e,Qr,!0),"@"),s.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&s.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&s.push("/"),s.push(li(n,"/"==n.charAt(0)?Vi:mo,!0))),(n=this.h.toString())&&s.push("?",n),(n=this.o)&&s.push("#",li(n,ms)),s.join("")};var Qr=/[#\/\?@]/g,mo=/[#\?:]/g,Vi=/[#\?]/g,Di=/[#\?@]/g,ms=/#/g;function go(s,e){this.h=this.g=null,this.i=s||null,this.j=!!e}function Rr(s){s.g||(s.g=new Ds,s.h=0,s.i&&function ps(s,e){if(s){s=s.split("&");for(var n=0;n<s.length;n++){var c=s[n].indexOf("="),y=null;if(0<=c){var S=s[n].substring(0,c);y=s[n].substring(c+1)}else S=s[n];e(S,y?decodeURIComponent(y.replace(/\+/g," ")):"")}}}(s.i,function(e,n){s.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function ra(s,e){Rr(s),e=Fs(s,e),eo(s.g.h,e)&&(s.i=null,s.h-=s.g.get(e).length,eo((s=s.g).h,e)&&(delete s.h[e],s.i--,s.g.length>2*s.i&&qa(s)))}function La(s,e){return Rr(s),e=Fs(s,e),eo(s.g.h,e)}function Ns(s,e,n){ra(s,e),0<n.length&&(s.i=null,s.g.set(Fs(s,e),qi(n)),s.h+=n.length)}function Fs(s,e){return e=String(e),s.j&&(e=e.toLowerCase()),e}function vl(s){this.l=s||Nn,s=ee.PerformanceNavigationTiming?0<(s=ee.performance.getEntriesByType("navigation")).length&&("hq"==s[0].nextHopProtocol||"h2"==s[0].nextHopProtocol):!!(ee.g&&ee.g.Ea&&ee.g.Ea()&&ee.g.Ea().Zb),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(U=go.prototype).add=function(s,e){Rr(this),this.i=null,s=Fs(this,s);var n=this.g.get(s);return n||this.g.set(s,n=[]),n.push(e),this.h+=1,this},U.forEach=function(s,e){Rr(this),this.g.forEach(function(n,c){Sr(n,function(y){s.call(e,y,c,this)},this)},this)},U.T=function(){Rr(this);for(var s=this.g.R(),e=this.g.T(),n=[],c=0;c<e.length;c++)for(var y=s[c],S=0;S<y.length;S++)n.push(e[c]);return n},U.R=function(s){Rr(this);var e=[];if("string"==typeof s)La(this,s)&&(e=vr(e,this.g.get(Fs(this,s))));else{s=this.g.R();for(var n=0;n<s.length;n++)e=vr(e,s[n])}return e},U.set=function(s,e){return Rr(this),this.i=null,La(this,s=Fs(this,s))&&(this.h-=this.g.get(s).length),this.g.set(s,[e]),this.h+=1,this},U.get=function(s,e){return s&&0<(s=this.R(s)).length?String(s[0]):e},U.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var s=[],e=this.g.T(),n=0;n<e.length;n++){var c=e[n],y=encodeURIComponent(String(c));c=this.R(c);for(var S=0;S<c.length;S++){var L=y;""!==c[S]&&(L+="="+encodeURIComponent(String(c[S]))),s.push(L)}}return this.i=s.join("&")};var Nn=10;function Cr(s){return!!s.h||!!s.g&&s.g.size>=s.j}function Fa(s){return s.h?1:s.g?s.g.size:0}function xo(s,e){return s.h?s.h==e:!!s.g&&s.g.has(e)}function Ws(s,e){s.g?s.g.add(e):s.h=e}function Wa(s,e){s.h&&s.h==e?s.h=null:s.g&&s.g.has(e)&&s.g.delete(e)}function as(s){if(null!=s.h)return s.i.concat(s.h.D);if(null!=s.g&&0!==s.g.size){let e=s.i;for(const n of s.g.values())e=e.concat(n.D);return e}return qi(s.i)}function zu(){}function Vu(){this.g=new zu}function Du(s,e,n){const c=n||"";try{wo(s,function(y,S){let L=y;We(y)&&(L=Dr(y)),e.push(c+S+"="+encodeURIComponent(L))})}catch(y){throw e.push(c+"type="+encodeURIComponent("_badmap")),y}}function ya(s,e,n,c,y){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,y(c)}catch(S){}}function As(s){this.l=s.$b||null,this.j=s.ib||!1}function yo(s,e){br.call(this),this.D=s,this.u=e,this.m=void 0,this.readyState=Bs,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}vl.prototype.cancel=function(){if(this.i=as(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const s of this.g.values())s.cancel();this.g.clear()}},zu.prototype.stringify=function(s){return ee.JSON.stringify(s,void 0)},zu.prototype.parse=function(s){return ee.JSON.parse(s,void 0)},kn(As,pa),As.prototype.g=function(){return new yo(this.l,this.j)},As.prototype.i=function(s){return function(){return s}}({}),kn(yo,br);var Bs=0;function Za(s){s.j.read().then(s.Sa.bind(s)).catch(s.ha.bind(s))}function Eo(s){s.readyState=4,s.l=null,s.j=null,s.A=null,Us(s)}function Us(s){s.onreadystatechange&&s.onreadystatechange.call(s)}(U=yo.prototype).open=function(s,e){if(this.readyState!=Bs)throw this.abort(),Error("Error reopening a connection");this.C=s,this.B=e,this.readyState=1,Us(this)},U.send=function(s){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};s&&(e.body=s),(this.D||ee).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},U.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Eo(this)),this.readyState=Bs},U.Va=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Us(this)),this.g&&(this.readyState=3,Us(this),this.g)))if("arraybuffer"===this.responseType)s.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==ee.ReadableStream&&"body"in s){if(this.j=s.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Za(this)}else s.text().then(this.Ua.bind(this),this.ha.bind(this))},U.Sa=function(s){if(this.g){if(this.u&&s.value)this.response.push(s.value);else if(!this.u){var e=s.value?s.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!s.done}))&&(this.response=this.responseText+=e)}s.done?Eo(this):Us(this),3==this.readyState&&Za(this)}},U.Ua=function(s){this.g&&(this.response=this.responseText=s,Eo(this))},U.Ta=function(s){this.g&&(this.response=s,Eo(this))},U.ha=function(){this.g&&Eo(this)},U.setRequestHeader=function(s,e){this.v.append(s,e)},U.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},U.getAllResponseHeaders=function(){if(!this.h)return"";const s=[],e=this.h.entries();for(var n=e.next();!n.done;)s.push((n=n.value)[0]+": "+n[1]),n=e.next();return s.join("\r\n")},Object.defineProperty(yo.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(s){this.m=s?"include":"same-origin"}});var Au=ee.JSON.parse;function Fo(s){br.call(this),this.headers=new Ds,this.u=s||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ia,this.K=this.L=!1}kn(Fo,br);var ia="",Hu=/^https?$/i,_a=["POST","PUT"];function va(s){return"content-type"==s.toLowerCase()}function $u(s,e){s.h=!1,s.g&&(s.l=!0,s.g.abort(),s.l=!1),s.j=e,s.m=5,Mu(s),ba(s)}function Mu(s){s.D||(s.D=!0,yn(s,"complete"),yn(s,"error"))}function Ms(s){if(s.h&&void 0!==Y&&(!s.C[1]||4!=us(s)||2!=s.ba()))if(s.v&&4==us(s))Si(s.Fa,0,s);else if(yn(s,"readystatechange"),4==us(s)){s.h=!1;try{const te=s.ba();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var c;if(c=0===te){var y=String(s.H).match(Cu)[1]||null;if(!y&&ee.self&&ee.self.location){var S=ee.self.location.protocol;y=S.substr(0,S.length-1)}c=!Hu.test(y?y.toLowerCase():"")}n=c}if(n)yn(s,"complete"),yn(s,"success");else{s.m=6;try{var L=2<us(s)?s.g.statusText:""}catch(Me){L=""}s.j=L+" ["+s.ba()+"]",Mu(s)}}finally{ba(s)}}}function ba(s,e){if(s.g){nl(s);const n=s.g,c=s.C[0]?Pe:null;s.g=null,s.C=null,e||yn(s,"ready");try{n.onreadystatechange=c}catch(y){}}}function nl(s){s.g&&s.K&&(s.g.ontimeout=null),s.A&&(ee.clearTimeout(s.A),s.A=null)}function us(s){return s.g?s.g.readyState:0}function rl(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.J){case ia:case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch(e){return null}}function lu(s,e,n){e:{for(c in n){var c=!1;break e}c=!0}c||(n=function fl(s){let e="";return En(s,function(n,c){e+=c,e+=":",e+=n,e+="\r\n"}),e}(n),"string"==typeof s?null!=n&&encodeURIComponent(String(n)):Ot(s,e,n))}function oa(s,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[s]||e}function kl(s){this.za=0,this.l=[],this.h=new Ji,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=oa("failFast",!1,s),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=oa("baseRetryDelayMs",5e3,s),this.$a=oa("retryDelaySeedMs",1e4,s),this.Ya=oa("forwardChannelMaxRetries",2,s),this.ra=oa("forwardChannelRequestTimeoutMs",2e4,s),this.qa=s&&s.xmlHttpFactory||void 0,this.Ba=s&&s.Yb||!1,this.K=void 0,this.H=s&&s.supportsCrossDomainXhr||!1,this.J="",this.i=new vl(s&&s.concurrentRequestLimit),this.Ca=new Vu,this.ja=s&&s.fastHandshake||!1,this.Ra=s&&s.Wb||!1,s&&s.Aa&&this.h.Aa(),s&&s.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&s&&s.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!s||!1!==s.Xb}function To(s){if(ao(s),3==s.G){var e=s.V++,n=qr(s.F);Ot(n,"SID",s.J),Ot(n,"RID",e),Ot(n,"TYPE","terminate"),$(s,n),(e=new ga(s,s.h,e,void 0)).K=2,e.v=vn(qr(n)),n=!1,ee.navigator&&ee.navigator.sendBeacon&&(n=ee.navigator.sendBeacon(e.v.toString(),"")),!n&&ee.Image&&((new Image).src=e.v,n=!0),n||(e.g=Yr(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Ga(e)}dr(s)}function Ai(s){s.g&&(Mt(s),s.g.cancel(),s.g=null)}function ao(s){Ai(s),s.u&&(ee.clearTimeout(s.u),s.u=null),_n(s),s.i.cancel(),s.m&&("number"==typeof s.m&&ee.clearTimeout(s.m),s.m=null)}function Ka(s,e){s.l.push(new class{constructor(s,e){this.h=s,this.g=e}}(s.Za++,e)),3==s.G&&sa(s)}function sa(s){Cr(s.i)||s.m||(s.m=!0,Gr(s.Ha,s),s.C=0)}function B(s,e){var n;n=e?e.m:s.V++;const c=qr(s.F);Ot(c,"SID",s.J),Ot(c,"RID",n),Ot(c,"AID",s.U),$(s,c),s.o&&s.s&&lu(c,s.o,s.s),n=new ga(s,s.h,n,s.C+1),null===s.o&&(n.H=s.s),e&&(s.l=e.D.concat(s.l)),e=de(s,n,1e3),n.setTimeout(Math.round(.5*s.ra)+Math.round(.5*s.ra*Math.random())),Ws(s.i,n),Ni(n,c,e)}function $(s,e){s.j&&wo({},function(n,c){Ot(e,c,n)})}function de(s,e,n){n=Math.min(s.l.length,n);var c=s.j?qt(s.j.Oa,s.j,s):null;e:{var y=s.l;let S=-1;for(;;){const L=["count="+n];-1==S?0<n?(S=y[0].h,L.push("ofs="+S)):S=0:L.push("ofs="+S);let te=!0;for(let Me=0;Me<n;Me++){let dt=y[Me].h;const Rt=y[Me].g;if(dt-=S,0>dt)S=Math.max(0,y[Me].h-100),te=!1;else try{Du(Rt,L,"req"+dt+"_")}catch(Kt){c&&c(Rt)}}if(te){c=L.join("&");break e}}}return s=s.l.splice(0,n),e.D=s,c}function Ge(s){s.g||s.u||(s.Y=1,Gr(s.Ga,s),s.A=0)}function Ze(s){return!(s.g||s.u||3<=s.A||(s.Y++,s.u=au(qt(s.Ga,s),or(s,s.A)),s.A++,0))}function Mt(s){null!=s.B&&(ee.clearTimeout(s.B),s.B=null)}function $t(s){s.g=new ga(s,s.h,"rpc",s.Y),null===s.o&&(s.g.H=s.s),s.g.O=0;var e=qr(s.oa);Ot(e,"RID","rpc"),Ot(e,"SID",s.J),Ot(e,"CI",s.N?"0":"1"),Ot(e,"AID",s.U),$(s,e),Ot(e,"TYPE","xmlhttp"),s.o&&s.s&&lu(e,s.o,s.s),s.K&&s.g.setTimeout(s.K);var n=s.g;s=s.la,n.K=1,n.v=vn(qr(e)),n.s=null,n.U=!0,Uo(n,s)}function _n(s){null!=s.v&&(ee.clearTimeout(s.v),s.v=null)}function on(s,e){var n=null;if(s.g==e){_n(s),Mt(s),s.g=null;var c=2}else{if(!xo(s.i,e))return;n=e.D,Wa(s.i,e),c=1}if(s.I=e.N,0!=s.G)if(e.i)if(1==c){n=e.s?e.s.length:0,e=Date.now()-e.F;var y=s.C;yn(c=mi(),new $a(c,n,e,y)),sa(s)}else Ge(s);else if(3==(y=e.o)||0==y&&0<s.I||!(1==c&&function P(s,e){return!(Fa(s.i)>=s.i.j-(s.m?1:0)||(s.m?(s.l=e.D.concat(s.l),0):1==s.G||2==s.G||s.C>=(s.Xa?0:s.Ya)||(s.m=au(qt(s.Ha,s,e),or(s,s.C)),s.C++,0)))}(s,e)||2==c&&Ze(s)))switch(n&&0<n.length&&(e=s.i,e.i=e.i.concat(n)),y){case 1:Gn(s,5);break;case 4:Gn(s,10);break;case 3:Gn(s,6);break;default:Gn(s,2)}}function or(s,e){let n=s.Pa+Math.floor(Math.random()*s.$a);return s.j||(n*=2),n*e}function Gn(s,e){if(s.h.info("Error code "+e),2==e){var n=null;s.j&&(n=null);var c=qt(s.jb,s);n||(n=new Jo("//www.google.com/images/cleardot.gif"),ee.location&&"http"==ee.location.protocol||oe(n,"https"),vn(n)),function ju(s,e){const n=new Ji;if(ee.Image){const c=new Image;c.onload=An(ya,n,c,"TestLoadImage: loaded",!0,e),c.onerror=An(ya,n,c,"TestLoadImage: error",!1,e),c.onabort=An(ya,n,c,"TestLoadImage: abort",!1,e),c.ontimeout=An(ya,n,c,"TestLoadImage: timeout",!1,e),ee.setTimeout(function(){c.ontimeout&&c.ontimeout()},1e4),c.src=s}else e(!1)}(n.toString(),c)}else Yo(2);s.G=0,s.j&&s.j.va(e),dr(s),ao(s)}function dr(s){s.G=0,s.I=-1,s.j&&((0!=as(s.i).length||0!=s.l.length)&&(s.i.i.length=0,qi(s.l),s.l.length=0),s.j.ua())}function gi(s,e,n){let c=function On(s){return s instanceof Jo?qr(s):new Jo(s,void 0)}(n);if(""!=c.i)e&&qe(c,e+"."+c.i),ne(c,c.m);else{const y=ee.location;c=function er(s,e,n,c){var y=new Jo(null,void 0);return s&&oe(y,s),e&&qe(y,e),n&&ne(y,n),c&&(y.l=c),y}(y.protocol,e?e+"."+y.hostname:y.hostname,+y.port,n)}return s.aa&&En(s.aa,function(y,S){Ot(c,S,y)}),n=s.sa,(e=s.D)&&n&&Ot(c,e,n),Ot(c,"VER",s.ma),$(s,c),c}function Yr(s,e,n){if(e&&!s.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Fo(n&&s.Ba&&!s.qa?new As({ib:!0}):s.qa)).L=s.H,e}function tr(){}function Po(){if(ht&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function gs(s,e){br.call(this),this.g=new kl(e),this.l=s,this.h=e&&e.messageUrlParams||null,s=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.s=s,s=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(s?s["X-WebChannel-Content-Type"]=e.messageContentType:s={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(s?s["X-WebChannel-Client-Profile"]=e.ya:s={"X-WebChannel-Client-Profile":e.ya}),this.g.P=s,(s=e&&e.httpHeadersOverwriteParam)&&!ii(s)&&(this.g.o=s),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ii(e)&&(this.g.D=e,null!==(s=this.h)&&e in s&&e in(s=this.h)&&delete s[e]),this.j=new wi(this)}function Ya(s){Ss.call(this);var e=s.__sm__;if(e){e:{for(const n in e){s=n;break e}s=void 0}(this.i=s)&&(s=this.i,e=null!==e&&s in e?e[s]:void 0),this.data=e}else this.data=s}function wa(){Ls.call(this),this.status=1}function wi(s){this.g=s}(U=Fo.prototype).ea=function(s,e,n,c){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+s);e=e?e.toUpperCase():"GET",this.H=s,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():$s.g(),this.C=function Tu(s){return s.h||(s.h=s.i())}(this.u?this.u:$s),this.g.onreadystatechange=qt(this.Fa,this);try{this.F=!0,this.g.open(e,String(s),!0),this.F=!1}catch(S){return void $u(this,S)}s=n||"";const y=new Ds(this.headers);c&&wo(c,function(S,L){y.set(L,S)}),c=function di(s){e:{var e=va;const n=s.length,c="string"==typeof s?s.split(""):s;for(let y=0;y<n;y++)if(y in c&&e.call(void 0,c[y],y,s)){e=y;break e}e=-1}return 0>e?null:"string"==typeof s?s.charAt(e):s[e]}(y.T()),n=ee.FormData&&s instanceof ee.FormData,!(0<=Er(_a,e))||c||n||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),y.forEach(function(S,L){this.g.setRequestHeader(L,S)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{nl(this),0<this.B&&((this.K=function tl(s){return ht&&function ke(){return function me(s){var e=Te;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=s(9)}(function(){let s=0;const e=fi(String(wr)).split("."),n=fi("9").split("."),c=Math.max(e.length,n.length);for(let L=0;0==s&&L<c;L++){var y=e[L]||"",S=n[L]||"";do{if(y=/(\d*)(\D*)(.*)/.exec(y)||["","","",""],S=/(\d*)(\D*)(.*)/.exec(S)||["","","",""],0==y[0].length&&0==S[0].length)break;s=pi(0==y[1].length?0:parseInt(y[1],10),0==S[1].length?0:parseInt(S[1],10))||pi(0==y[2].length,0==S[2].length)||pi(y[2],S[2]),y=y[3],S=S[3]}while(0==s)}return 0<=s})}()&&"number"==typeof s.timeout&&void 0!==s.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=qt(this.pa,this)):this.A=Si(this.pa,this.B,this)),this.v=!0,this.g.send(s),this.v=!1}catch(S){$u(this,S)}},U.pa=function(){void 0!==Y&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,yn(this,"timeout"),this.abort(8))},U.abort=function(s){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=s||7,yn(this,"complete"),yn(this,"abort"),ba(this))},U.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ba(this,!0)),Fo.Z.M.call(this)},U.Fa=function(){this.s||(this.F||this.v||this.l?Ms(this):this.cb())},U.cb=function(){Ms(this)},U.ba=function(){try{return 2<us(this)?this.g.status:-1}catch(s){return-1}},U.ga=function(){try{return this.g?this.g.responseText:""}catch(s){return""}},U.Qa=function(s){if(this.g){var e=this.g.responseText;return s&&0==e.indexOf(s)&&(e=e.substring(s.length)),Au(e)}},U.Da=function(){return this.m},U.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(U=kl.prototype).ma=8,U.G=1,U.hb=function(s){try{this.h.info("Origin Trials invoked: "+s)}catch(e){}},U.Ha=function(s){if(this.m)if(this.m=null,1==this.G){if(!s){this.V=Math.floor(1e5*Math.random()),s=this.V++;const y=new ga(this,this.h,s,void 0);let S=this.s;if(this.P&&(S?(S=bn(S),jt(S,this.P)):S=this.P),null===this.o&&(y.H=S),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){var c=this.l[n];if(void 0===(c="__data__"in c.g&&"string"==typeof(c=c.g.__data__)?c.length:void 0))break;if(4096<(e+=c)){e=n;break e}if(4096===e||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=de(this,y,e),Ot(n=qr(this.F),"RID",s),Ot(n,"CVER",22),this.D&&Ot(n,"X-HTTP-Session-Id",this.D),$(this,n),this.o&&S&&lu(n,this.o,S),Ws(this.i,y),this.Ra&&Ot(n,"TYPE","init"),this.ja?(Ot(n,"$req",e),Ot(n,"SID","null"),y.$=!0,Ni(y,n,null)):Ni(y,n,e),this.G=2}}else 3==this.G&&(s?B(this,s):0==this.l.length||Cr(this.i)||B(this))},U.Ga=function(){if(this.u=null,$t(this),this.$&&!(this.L||null==this.g||0>=this.O)){var s=2*this.O;this.h.info("BP detection timer enabled: "+s),this.B=au(qt(this.bb,this),s)}},U.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Yo(10),Ai(this),$t(this))},U.ab=function(){null!=this.v&&(this.v=null,Ai(this),Ze(this),Yo(19))},U.jb=function(s){s?(this.h.info("Successfully pinged google.com"),Yo(2)):(this.h.info("Failed to ping google.com"),Yo(1))},(U=tr.prototype).xa=function(){},U.wa=function(){},U.va=function(){},U.ua=function(){},U.Oa=function(){},Po.prototype.g=function(s,e){return new gs(s,e)},kn(gs,br),gs.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var s=this.g,e=this.l,n=this.h||void 0;s.Wa&&(s.h.info("Origin Trials enabled."),Gr(qt(s.hb,s,e))),Yo(0),s.W=e,s.aa=n||{},s.N=s.X,s.F=gi(s,null,s.W),sa(s)},gs.prototype.close=function(){To(this.g)},gs.prototype.u=function(s){if("string"==typeof s){var e={};e.__data__=s,Ka(this.g,e)}else this.v?((e={}).__data__=Dr(s),Ka(this.g,e)):Ka(this.g,s)},gs.prototype.M=function(){this.g.j=null,delete this.j,To(this.g),delete this.g,gs.Z.M.call(this)},kn(Ya,Ss),kn(wa,Ls),kn(wi,tr),wi.prototype.xa=function(){yn(this.g,"a")},wi.prototype.wa=function(s){yn(this.g,new Ya(s))},wi.prototype.va=function(s){yn(this.g,new wa(s))},wi.prototype.ua=function(){yn(this.g,"b")},Po.prototype.createWebChannel=Po.prototype.g,gs.prototype.send=gs.prototype.u,gs.prototype.open=gs.prototype.m,gs.prototype.close=gs.prototype.close,fa.NO_ERROR=0,fa.TIMEOUT=8,fa.HTTP_ERROR=6,ta.COMPLETE="complete",Uu.EventType=ma,ma.OPEN="a",ma.CLOSE="b",ma.ERROR="c",ma.MESSAGE="d",br.prototype.listen=br.prototype.N,Fo.prototype.listenOnce=Fo.prototype.O,Fo.prototype.getLastError=Fo.prototype.La,Fo.prototype.getLastErrorCode=Fo.prototype.Da,Fo.prototype.getStatus=Fo.prototype.ba,Fo.prototype.getResponseJson=Fo.prototype.Qa,Fo.prototype.getResponseText=Fo.prototype.ga,Fo.prototype.send=Fo.prototype.ea;var Ba=q.createWebChannelTransport=function(){return new Po},rr=q.getStatEventTarget=function(){return mi()},Gu=q.ErrorCode=fa,cu=q.EventType=ta,Ol=q.Event=Mo,Ri=q.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},zs=q.FetchXmlHttpFactory=As,Zs=q.WebChannel=Uu,qu=q.XhrIo=Fo;const Qo="@firebase/firestore";class So{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}So.UNAUTHENTICATED=new So(null),So.GOOGLE_CREDENTIALS=new So("google-credentials-uid"),So.FIRST_PARTY=new So("first-party-uid"),So.MOCK_USER=new So("mock-user");let hu="9.6.3";const aa=new j.Yd("@firebase/firestore");function bl(){return aa.logLevel}function Zn(s,...e){if(aa.logLevel<=j.in.DEBUG){const n=e.map(F);aa.debug(`Firestore (${hu}): ${s}`,...n)}}function Mi(s,...e){if(aa.logLevel<=j.in.ERROR){const n=e.map(F);aa.error(`Firestore (${hu}): ${s}`,...n)}}function V(s,...e){if(aa.logLevel<=j.in.WARN){const n=e.map(F);aa.warn(`Firestore (${hu}): ${s}`,...n)}}function F(s){if("string"==typeof s)return s;try{return JSON.stringify(s)}catch(n){return s}}function M(s="Unexpected state"){const e=`FIRESTORE (${hu}) INTERNAL ASSERTION FAILED: `+s;throw Mi(e),new Error(e)}function J(s,e){s||M()}function De(s,e){return s}const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends W.ZR{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}class wn{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Fn{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(So.UNAUTHENTICATED))}shutdown(){}}class Pr{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class si{constructor(e){this.t=e,this.currentUser=So.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){var c=this;let y=this.i;const S=dt=>this.i!==y?(y=this.i,n(dt)):Promise.resolve();let L=new pn;this.o=()=>{this.i++,this.currentUser=this.u(),L.resolve(),L=new pn,e.enqueueRetryable(()=>S(this.currentUser))};const te=()=>{const dt=L;e.enqueueRetryable((0,he.Z)(function*(){yield dt.promise,yield S(c.currentUser)}))},Me=dt=>{Zn("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=dt,this.auth.addAuthTokenListener(this.o),te()};this.t.onInit(dt=>Me(dt)),setTimeout(()=>{if(!this.auth){const dt=this.t.getImmediate({optional:!0});dt?Me(dt):(Zn("FirebaseAuthCredentialsProvider","Auth not yet detected"),L.resolve(),L=new pn)}},0),te()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(c=>this.i!==e?(Zn("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):c?(J("string"==typeof c.accessToken),new wn(c.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return J(null===e||"string"==typeof e),new So(e)}}class xi{constructor(e,n,c){this.type="FirstParty",this.user=So.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const y=e.auth.getAuthHeaderValueForFirstParty([]);y&&this.headers.set("Authorization",y),c&&this.headers.set("X-Goog-Iam-Authorization-Token",c)}}class Ro{constructor(e,n,c){this.h=e,this.l=n,this.m=c}getToken(){return Promise.resolve(new xi(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(So.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Co{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xa{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null}start(e,n){this.o=y=>{e.enqueueRetryable(()=>{return null!=(S=y).error&&Zn("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${S.error.message}`),n(S.token);var S})};const c=y=>{Zn("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=y,this.appCheck.addTokenListener(this.o)};this.g.onInit(y=>c(y)),setTimeout(()=>{if(!this.appCheck){const y=this.g.getImmediate({optional:!0});y?c(y):Zn("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(J("string"==typeof n.token),new Co(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class Wr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=c=>this.p(c),this.T=c=>n.writeSequenceNumber(c))}p(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.T&&this.T(e),e}}function Xi(s){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(s);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let c=0;c<s;c++)n[c]=Math.floor(256*Math.random());return n}Wr.I=-1;class Ks{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let c="";for(;c.length<20;){const y=Xi(40);for(let S=0;S<y.length;++S)c.length<20&&y[S]<n&&(c+=e.charAt(y[S]%e.length))}return c}}function Jr(s,e){return s<e?-1:s>e?1:0}function du(s,e,n){return s.length===e.length&&s.every((c,y)=>n(c,e[y]))}function Pu(s){return s+"\0"}class ji{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new at(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new at(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new at(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ji.fromMillis(Date.now())}static fromDate(e){return ji.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),c=Math.floor(1e6*(e-1e3*n));return new ji(n,c)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Jr(this.nanoseconds,e.nanoseconds):Jr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ei{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ei(e)}static min(){return new ei(new ji(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function Ja(s){let e=0;for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e++;return e}function _o(s,e){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&e(n,s[n])}function Ll(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class wl{constructor(e,n,c){void 0===n?n=0:n>e.length&&M(),void 0===c?c=e.length-n:c>e.length-n&&M(),this.segments=e,this.offset=n,this.len=c}get length(){return this.len}isEqual(e){return 0===wl.comparator(this,e)}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof wl?e.forEach(c=>{n.push(c)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,c=this.limit();n<c;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const c=Math.min(e.length,n.length);for(let y=0;y<c;y++){const S=e.get(y),L=n.get(y);if(S<L)return-1;if(S>L)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class uo extends wl{construct(e,n,c){return new uo(e,n,c)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const c of e){if(c.indexOf("//")>=0)throw new at(Ne.INVALID_ARGUMENT,`Invalid segment (${c}). Paths must not contain // in them.`);n.push(...c.split("/").filter(y=>y.length>0))}return new uo(n)}static emptyPath(){return new uo([])}}const Nl=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class es extends wl{construct(e,n,c){return new es(e,n,c)}static isValidIdentifier(e){return Nl.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),es.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new es(["__name__"])}static fromServerFormat(e){const n=[];let c="",y=0;const S=()=>{if(0===c.length)throw new at(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(c),c=""};let L=!1;for(;y<e.length;){const te=e[y];if("\\"===te){if(y+1===e.length)throw new at(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const Me=e[y+1];if("\\"!==Me&&"."!==Me&&"`"!==Me)throw new at(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);c+=Me,y+=2}else"`"===te?(L=!L,y++):"."!==te||L?(c+=te,y++):(S(),y++)}if(S(),L)throw new at(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new es(n)}static emptyPath(){return new es([])}}class pl{constructor(e){this.fields=e,e.sort(es.comparator)}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return du(this.fields,e.fields,(n,c)=>n.isEqual(c))}}class no{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new no(n)}static fromUint8Array(e){const n=function(c){let y="";for(let S=0;S<c.length;++S)y+=String.fromCharCode(c[S]);return y}(e);return new no(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let c=0;c<e.length;c++)n[c]=e.charCodeAt(c);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Jr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}no.EMPTY_BYTE_STRING=new no("");const Lc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wi(s){if(J(!!s),"string"==typeof s){let e=0;const n=Lc.exec(s);if(J(!!n),n[1]){let y=n[1];y=(y+"000000000").substr(0,9),e=Number(y)}const c=new Date(s);return{seconds:Math.floor(c.getTime()/1e3),nanos:e}}return{seconds:to(s.seconds),nanos:to(s.nanos)}}function to(s){return"number"==typeof s?s:"string"==typeof s?Number(s):0}function Ua(s){return"string"==typeof s?no.fromBase64String(s):no.fromUint8Array(s)}function Wl(s){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==s?void 0:s.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Fl(s){const e=s.mapValue.fields.__previous_value__;return Wl(e)?Fl(e):e}function ls(s){const e=Wi(s.mapValue.fields.__local_write_time__.timestampValue);return new ji(e.seconds,e.nanos)}function l(s){return null==s}function d(s){return 0===s&&1/s==-1/0}function h(s){return"number"==typeof s&&Number.isInteger(s)&&!d(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}class m{constructor(e){this.path=e}static fromPath(e){return new m(uo.fromString(e))}static fromName(e){return new m(uo.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===uo.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,n){return uo.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new m(new uo(e.slice()))}}function E(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Wl(s)?4:10:M()}function D(s,e){if(s===e)return!0;const n=E(s);if(n!==E(e))return!1;switch(n){case 0:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return ls(s).isEqual(ls(e));case 3:return function(c,y){if("string"==typeof c.timestampValue&&"string"==typeof y.timestampValue&&c.timestampValue.length===y.timestampValue.length)return c.timestampValue===y.timestampValue;const S=Wi(c.timestampValue),L=Wi(y.timestampValue);return S.seconds===L.seconds&&S.nanos===L.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return y=e,Ua(s.bytesValue).isEqual(Ua(y.bytesValue));case 7:return s.referenceValue===e.referenceValue;case 8:return function(c,y){return to(c.geoPointValue.latitude)===to(y.geoPointValue.latitude)&&to(c.geoPointValue.longitude)===to(y.geoPointValue.longitude)}(s,e);case 2:return function(c,y){if("integerValue"in c&&"integerValue"in y)return to(c.integerValue)===to(y.integerValue);if("doubleValue"in c&&"doubleValue"in y){const S=to(c.doubleValue),L=to(y.doubleValue);return S===L?d(S)===d(L):isNaN(S)&&isNaN(L)}return!1}(s,e);case 9:return du(s.arrayValue.values||[],e.arrayValue.values||[],D);case 10:return function(c,y){const S=c.mapValue.fields||{},L=y.mapValue.fields||{};if(Ja(S)!==Ja(L))return!1;for(const te in S)if(S.hasOwnProperty(te)&&(void 0===L[te]||!D(S[te],L[te])))return!1;return!0}(s,e);default:return M()}var y}function k(s,e){return void 0!==(s.values||[]).find(n=>D(n,e))}function G(s,e){if(s===e)return 0;const n=E(s),c=E(e);if(n!==c)return Jr(n,c);switch(n){case 0:return 0;case 1:return Jr(s.booleanValue,e.booleanValue);case 2:return function(y,S){const L=to(y.integerValue||y.doubleValue),te=to(S.integerValue||S.doubleValue);return L<te?-1:L>te?1:L===te?0:isNaN(L)?isNaN(te)?0:-1:1}(s,e);case 3:return le(s.timestampValue,e.timestampValue);case 4:return le(ls(s),ls(e));case 5:return Jr(s.stringValue,e.stringValue);case 6:return function(y,S){const L=Ua(y),te=Ua(S);return L.compareTo(te)}(s.bytesValue,e.bytesValue);case 7:return function(y,S){const L=y.split("/"),te=S.split("/");for(let Me=0;Me<L.length&&Me<te.length;Me++){const dt=Jr(L[Me],te[Me]);if(0!==dt)return dt}return Jr(L.length,te.length)}(s.referenceValue,e.referenceValue);case 8:return function(y,S){const L=Jr(to(y.latitude),to(S.latitude));return 0!==L?L:Jr(to(y.longitude),to(S.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return function(y,S){const L=y.values||[],te=S.values||[];for(let Me=0;Me<L.length&&Me<te.length;++Me){const dt=G(L[Me],te[Me]);if(dt)return dt}return Jr(L.length,te.length)}(s.arrayValue,e.arrayValue);case 10:return function(y,S){const L=y.fields||{},te=Object.keys(L),Me=S.fields||{},dt=Object.keys(Me);te.sort(),dt.sort();for(let Rt=0;Rt<te.length&&Rt<dt.length;++Rt){const Kt=Jr(te[Rt],dt[Rt]);if(0!==Kt)return Kt;const Cn=G(L[te[Rt]],Me[dt[Rt]]);if(0!==Cn)return Cn}return Jr(te.length,dt.length)}(s.mapValue,e.mapValue);default:throw M()}}function le(s,e){if("string"==typeof s&&"string"==typeof e&&s.length===e.length)return Jr(s,e);const n=Wi(s),c=Wi(e),y=Jr(n.seconds,c.seconds);return 0!==y?y:Jr(n.nanos,c.nanos)}function Se(s){return Ke(s)}function Ke(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(c){const y=Wi(c);return`time(${y.seconds},${y.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?Ua(s.bytesValue).toBase64():"referenceValue"in s?m.fromName(s.referenceValue).toString():"geoPointValue"in s?`geo(${(e=s.geoPointValue).latitude},${e.longitude})`:"arrayValue"in s?function(c){let y="[",S=!0;for(const L of c.values||[])S?S=!1:y+=",",y+=Ke(L);return y+"]"}(s.arrayValue):"mapValue"in s?function(c){const y=Object.keys(c.fields||{}).sort();let S="{",L=!0;for(const te of y)L?L=!1:S+=",",S+=`${te}:${Ke(c.fields[te])}`;return S+"}"}(s.mapValue):M();var e}function Xe(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function it(s){return!!s&&"integerValue"in s}function xt(s){return!!s&&"arrayValue"in s}function wt(s){return!!s&&"nullValue"in s}function Pt(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function gt(s){return!!s&&"mapValue"in s}function kt(s){if(s.geoPointValue)return{geoPointValue:Object.assign({},s.geoPointValue)};if(s.timestampValue&&"object"==typeof s.timestampValue)return{timestampValue:Object.assign({},s.timestampValue)};if(s.mapValue){const e={mapValue:{fields:{}}};return _o(s.mapValue.fields,(n,c)=>e.mapValue.fields[n]=kt(c)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(s.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=kt(s.arrayValue.values[n]);return e}return Object.assign({},s)}class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let c=0;c<e.length-1;++c)if(n=(n.mapValue.fields||{})[e.get(c)],!gt(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=kt(n)}setAll(e){let n=es.emptyPath(),c={},y=[];e.forEach((L,te)=>{if(!n.isImmediateParentOf(te)){const Me=this.getFieldsMap(n);this.applyChanges(Me,c,y),c={},y=[],n=te.popLast()}L?c[te.lastSegment()]=kt(L):y.push(te.lastSegment())});const S=this.getFieldsMap(n);this.applyChanges(S,c,y)}delete(e){const n=this.field(e.popLast());gt(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return D(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let c=0;c<e.length;++c){let y=n.mapValue.fields[e.get(c)];gt(y)&&y.mapValue.fields||(y={mapValue:{fields:{}}},n.mapValue.fields[e.get(c)]=y),n=y}return n.mapValue.fields}applyChanges(e,n,c){_o(n,(y,S)=>e[y]=S);for(const y of c)delete e[y]}clone(){return new Bt(kt(this.value))}}function Jt(s){const e=[];return _o(s.fields,(n,c)=>{const y=new es([n]);if(gt(c)){const S=Jt(c.mapValue).fields;if(0===S.length)e.push(y);else for(const L of S)e.push(y.child(L))}else e.push(y)}),new pl(e)}class tn{constructor(e,n,c,y,S){this.key=e,this.documentType=n,this.version=c,this.data=y,this.documentState=S}static newInvalidDocument(e){return new tn(e,0,ei.min(),Bt.empty(),0)}static newFoundDocument(e,n,c){return new tn(e,1,n,c,0)}static newNoDocument(e,n){return new tn(e,2,n,Bt.empty(),0)}static newUnknownDocument(e,n){return new tn(e,3,n,Bt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tn(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class un{constructor(e,n=null,c=[],y=[],S=null,L=null,te=null){this.path=e,this.collectionGroup=n,this.orderBy=c,this.filters=y,this.limit=S,this.startAt=L,this.endAt=te,this.R=null}}function gn(s,e=null,n=[],c=[],y=null,S=null,L=null){return new un(s,e,n,c,y,S,L)}function Rn(s){const e=De(s);if(null===e.R){let n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(c=>function Z(s){return s.field.canonicalString()+s.op.toString()+Se(s.value)}(c)).join(","),n+="|ob:",n+=e.orderBy.map(c=>{return(y=c).field.canonicalString()+y.dir;var y}).join(","),l(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=hr(e.startAt)),e.endAt&&(n+="|ub:",n+=hr(e.endAt)),e.R=n}return e.R}function Vn(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let y=0;y<s.orderBy.length;y++)if(!ki(s.orderBy[y],e.orderBy[y]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let y=0;y<s.filters.length;y++)if((n=s.filters[y]).op!==(c=e.filters[y]).op||!n.field.isEqual(c.field)||!D(n.value,c.value))return!1;var n,c;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!$o(s.startAt,e.startAt)&&$o(s.endAt,e.endAt)}function cr(s){return m.isDocumentKey(s.path)&&null===s.collectionGroup&&0===s.filters.length}class yr extends class{}{constructor(e,n,c){super(),this.field=e,this.op=n,this.value=c}static create(e,n,c){return e.isKeyField()?"in"===n||"not-in"===n?this.P(e,n,c):new Q(e,n,c):"array-contains"===n?new Qt(e,c):"in"===n?new mn(e,c):"not-in"===n?new xn(e,c):"array-contains-any"===n?new Bn(e,c):new yr(e,n,c)}static P(e,n,c){return"in"===n?new Fe(e,c):new st(e,c)}matches(e){const n=e.data.field(this.field);return"!="===this.op?null!==n&&this.v(G(n,this.value)):null!==n&&E(this.value)===E(n)&&this.v(G(n,this.value))}v(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return M()}}V(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Q extends yr{constructor(e,n,c){super(e,n,c),this.key=m.fromName(c.referenceValue)}matches(e){const n=m.comparator(e.key,this.key);return this.v(n)}}class Fe extends yr{constructor(e,n){super(e,"in",n),this.keys=Ut(0,n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class st extends yr{constructor(e,n){super(e,"not-in",n),this.keys=Ut(0,n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Ut(s,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(c=>m.fromName(c.referenceValue))}class Qt extends yr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return xt(n)&&k(n.arrayValue,this.value)}}class mn extends yr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return null!==n&&k(this.value.arrayValue,n)}}class xn extends yr{constructor(e,n){super(e,"not-in",n)}matches(e){if(k(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return null!==n&&!k(this.value.arrayValue,n)}}class Bn extends yr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!xt(n)||!n.arrayValue.values)&&n.arrayValue.values.some(c=>k(this.value.arrayValue,c))}}class sr{constructor(e,n){this.position=e,this.before=n}}function hr(s){return`${s.before?"b":"a"}:${s.position.map(e=>Se(e)).join(",")}`}class vi{constructor(e,n="asc"){this.field=e,this.dir=n}}function ki(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}function Hi(s,e,n){let c=0;for(let y=0;y<s.position.length;y++){const S=e[y],L=s.position[y];if(c=S.field.isKeyField()?m.comparator(m.fromName(L.referenceValue),n.key):G(L,n.data.field(S.field)),"desc"===S.dir&&(c*=-1),0!==c)break}return s.before?c<=0:c<0}function $o(s,e){if(null===s)return null===e;if(null===e||s.before!==e.before||s.position.length!==e.position.length)return!1;for(let n=0;n<s.position.length;n++)if(!D(s.position[n],e.position[n]))return!1;return!0}class Ei{constructor(e,n=null,c=[],y=[],S=null,L="F",te=null,Me=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=c,this.filters=y,this.limit=S,this.limitType=L,this.startAt=te,this.endAt=Me,this.S=null,this.D=null}}function Qi(s,e,n,c,y,S,L,te){return new Ei(s,e,n,c,y,S,L,te)}function ko(s){return new Ei(s)}function vo(s){return!l(s.limit)&&"F"===s.limitType}function Xa(s){return!l(s.limit)&&"L"===s.limitType}function ua(s){return s.explicitOrderBy.length>0?s.explicitOrderBy[0].field:null}function za(s){for(const e of s.filters)if(e.V())return e.field;return null}function Ys(s){return null!==s.collectionGroup}function ol(s){const e=De(s);if(null===e.S){e.S=[];const n=za(e),c=ua(e);if(null!==n&&null===c)n.isKeyField()||e.S.push(new vi(n)),e.S.push(new vi(es.keyField(),"asc"));else{let y=!1;for(const S of e.explicitOrderBy)e.S.push(S),S.field.isKeyField()&&(y=!0);if(!y){const S=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.S.push(new vi(es.keyField(),S))}}}return e.S}function Ia(s){const e=De(s);if(!e.D)if("F"===e.limitType)e.D=gn(e.path,e.collectionGroup,ol(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const S of ol(e))n.push(new vi(S.field,"desc"===S.dir?"asc":"desc"));const c=e.endAt?new sr(e.endAt.position,!e.endAt.before):null,y=e.startAt?new sr(e.startAt.position,!e.startAt.before):null;e.D=gn(e.path,e.collectionGroup,n,e.filters,e.limit,c,y)}return e.D}function El(s,e,n){return new Ei(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,n,s.startAt,s.endAt)}function Ta(s,e){return Vn(Ia(s),Ia(e))&&s.limitType===e.limitType}function ml(s){return`${Rn(Ia(s))}|lt:${s.limitType}`}function Wu(s){return`Query(target=${function $n(s){let e=s.path.canonicalString();return null!==s.collectionGroup&&(e+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(e+=`, filters: [${s.filters.map(n=>{return`${(c=n).field.canonicalString()} ${c.op} ${Se(c.value)}`;var c}).join(", ")}]`),l(s.limit)||(e+=", limit: "+s.limit),s.orderBy.length>0&&(e+=`, orderBy: [${s.orderBy.map(n=>{return`${(c=n).field.canonicalString()} (${c.dir})`;var c}).join(", ")}]`),s.startAt&&(e+=", startAt: "+hr(s.startAt)),s.endAt&&(e+=", endAt: "+hr(s.endAt)),`Target(${e})`}(Ia(s))}; limitType=${s.limitType})`}function Il(s,e){return e.isFoundDocument()&&function(n,c){const y=c.key.path;return null!==n.collectionGroup?c.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(y):m.isDocumentKey(n.path)?n.path.isEqual(y):n.path.isImmediateParentOf(y)}(s,e)&&function(n,c){for(const y of n.explicitOrderBy)if(!y.field.isKeyField()&&null===c.data.field(y.field))return!1;return!0}(s,e)&&function(n,c){for(const y of n.filters)if(!y.matches(c))return!1;return!0}(s,e)&&(c=e,!((n=s).startAt&&!Hi(n.startAt,ol(n),c)||n.endAt&&Hi(n.endAt,ol(n),c)));var n,c}function Zu(s){return(e,n)=>{let c=!1;for(const y of ol(s)){const S=ys(y,e,n);if(0!==S)return S;c=c||y.field.isKeyField()}return 0}}function ys(s,e,n){const c=s.field.isKeyField()?m.comparator(e.key,n.key):function(y,S,L){const te=S.data.field(y),Me=L.data.field(y);return null!==te&&null!==Me?G(te,Me):M()}(s.field,e,n);switch(s.dir){case"asc":return c;case"desc":return-1*c;default:return M()}}function Tl(s,e){if(s.C){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:d(e)?"-0":e}}function Sl(s){return{integerValue:""+s}}function Bl(s,e){return h(e)?Sl(e):Tl(s,e)}class Fi{constructor(){this._=void 0}}function Va(s,e,n){return s instanceof dc?function(c,y){const S={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:c.seconds,nanos:c.nanoseconds}}}};return y&&(S.fields.__previous_value__=y),{mapValue:S}}(n,e):s instanceof Ku?Qd(s,e):s instanceof fu?Nc(s,e):function(c,y){const S=Ru(c,y),L=fc(S)+fc(c.N);return it(S)&&it(c.N)?Sl(L):Tl(c.k,L)}(s,e)}function Sa(s,e,n){return s instanceof Ku?Qd(s,e):s instanceof fu?Nc(s,e):n}function Ru(s,e){return s instanceof Yu?it(n=e)||(c=n)&&"doubleValue"in c?e:{integerValue:0}:null;var c,n}class dc extends Fi{}class Ku extends Fi{constructor(e){super(),this.elements=e}}function Qd(s,e){const n=uh(e);for(const c of s.elements)n.some(y=>D(y,c))||n.push(c);return{arrayValue:{values:n}}}class fu extends Fi{constructor(e){super(),this.elements=e}}function Nc(s,e){let n=uh(e);for(const c of s.elements)n=n.filter(y=>!D(y,c));return{arrayValue:{values:n}}}class Yu extends Fi{constructor(e,n){super(),this.k=e,this.N=n}}function fc(s){return to(s.integerValue||s.doubleValue)}function uh(s){return xt(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class Qa{constructor(e,n){this.field=e,this.transform=n}}class Kp{constructor(e,n){this.version=e,this.transformResults=n}}class Js{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Js}static exists(e){return new Js(void 0,e)}static updateTime(e){return new Js(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lh(s,e){return void 0!==s.updateTime?e.isFoundDocument()&&e.version.isEqual(s.updateTime):void 0===s.exists||s.exists===e.isFoundDocument()}class fd{}function Cl(s,e,n){s instanceof ch?function(c,y,S){const L=c.value.clone(),te=ef(c.fieldTransforms,y,S.transformResults);L.setAll(te),y.convertToFoundDocument(S.version,L).setHasCommittedMutations()}(s,e,n):s instanceof mu?function(c,y,S){if(!lh(c.precondition,y))return void y.convertToUnknownDocument(S.version);const L=ef(c.fieldTransforms,y,S.transformResults),te=y.data;te.setAll(Bc(c)),te.setAll(L),y.convertToFoundDocument(S.version,te).setHasCommittedMutations()}(s,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function pc(s,e,n){var y;s instanceof ch?function(c,y,S){if(!lh(c.precondition,y))return;const L=c.value.clone(),te=qf(c.fieldTransforms,S,y);L.setAll(te),y.convertToFoundDocument(Fc(y),L).setHasLocalMutations()}(s,e,n):s instanceof mu?function(c,y,S){if(!lh(c.precondition,y))return;const L=qf(c.fieldTransforms,S,y),te=y.data;te.setAll(Bc(c)),te.setAll(L),y.convertToFoundDocument(Fc(y),te).setHasLocalMutations()}(s,e,n):lh(s.precondition,y=e)&&y.convertToNoDocument(ei.min())}function Fh(s,e){let n=null;for(const c of s.fieldTransforms){const y=e.data.field(c.field),S=Ru(c.transform,y||null);null!=S&&(null==n&&(n=Bt.empty()),n.set(c.field,S))}return n||null}function Gf(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&(c=e.fieldTransforms,!!(void 0===(n=s.fieldTransforms)&&void 0===c||n&&c&&du(n,c,(y,S)=>function pu(s,e){return s.field.isEqual(e.field)&&(c=e.transform,(n=s.transform)instanceof Ku&&c instanceof Ku||n instanceof fu&&c instanceof fu?du(n.elements,c.elements,D):n instanceof Yu&&c instanceof Yu?D(n.N,c.N):n instanceof dc&&c instanceof dc);var n,c}(y,S))))&&(0===s.type?s.value.isEqual(e.value):1!==s.type||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask));var n,c}function Fc(s){return s.isFoundDocument()?s.version:ei.min()}class ch extends fd{constructor(e,n,c,y=[]){super(),this.key=e,this.value=n,this.precondition=c,this.fieldTransforms=y,this.type=0}}class mu extends fd{constructor(e,n,c,y,S=[]){super(),this.key=e,this.data=n,this.fieldMask=c,this.precondition=y,this.fieldTransforms=S,this.type=1}}function Bc(s){const e=new Map;return s.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const c=s.data.field(n);e.set(n,c)}}),e}function ef(s,e,n){const c=new Map;J(s.length===n.length);for(let y=0;y<n.length;y++){const S=s[y],L=S.transform,te=e.data.field(S.field);c.set(S.field,Sa(L,te,n[y]))}return c}function qf(s,e,n){const c=new Map;for(const y of s){const S=y.transform,L=n.data.field(y.field);c.set(y.field,Va(S,L,e))}return c}class Bh extends fd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}}class Wf extends fd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}}class Uc{constructor(e){this.count=e}}var Ca,bo;function Ul(s){switch(s){default:return M();case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0}}function tf(s){if(void 0===s)return Mi("GRPC error has no .code"),Ne.UNKNOWN;switch(s){case Ca.OK:return Ne.OK;case Ca.CANCELLED:return Ne.CANCELLED;case Ca.UNKNOWN:return Ne.UNKNOWN;case Ca.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case Ca.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case Ca.INTERNAL:return Ne.INTERNAL;case Ca.UNAVAILABLE:return Ne.UNAVAILABLE;case Ca.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case Ca.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case Ca.NOT_FOUND:return Ne.NOT_FOUND;case Ca.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case Ca.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case Ca.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case Ca.ABORTED:return Ne.ABORTED;case Ca.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case Ca.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case Ca.DATA_LOSS:return Ne.DATA_LOSS;default:return M()}}(bo=Ca||(Ca={}))[bo.OK=0]="OK",bo[bo.CANCELLED=1]="CANCELLED",bo[bo.UNKNOWN=2]="UNKNOWN",bo[bo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bo[bo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bo[bo.NOT_FOUND=5]="NOT_FOUND",bo[bo.ALREADY_EXISTS=6]="ALREADY_EXISTS",bo[bo.PERMISSION_DENIED=7]="PERMISSION_DENIED",bo[bo.UNAUTHENTICATED=16]="UNAUTHENTICATED",bo[bo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bo[bo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bo[bo.ABORTED=10]="ABORTED",bo[bo.OUT_OF_RANGE=11]="OUT_OF_RANGE",bo[bo.UNIMPLEMENTED=12]="UNIMPLEMENTED",bo[bo.INTERNAL=13]="INTERNAL",bo[bo.UNAVAILABLE=14]="UNAVAILABLE",bo[bo.DATA_LOSS=15]="DATA_LOSS";class lo{constructor(e,n){this.comparator=e,this.root=n||$i.EMPTY}insert(e,n){return new lo(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,$i.BLACK,null,null))}remove(e){return new lo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$i.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const c=this.comparator(e,n.key);if(0===c)return n.value;c<0?n=n.left:c>0&&(n=n.right)}return null}indexOf(e){let n=0,c=this.root;for(;!c.isEmpty();){const y=this.comparator(e,c.key);if(0===y)return n+c.left.size;y<0?c=c.left:(n+=c.left.size+1,c=c.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,c)=>(e(n,c),!1))}toString(){const e=[];return this.inorderTraversal((n,c)=>(e.push(`${n}:${c}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mc(this.root,e,this.comparator,!1)}getReverseIterator(){return new mc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mc(this.root,e,this.comparator,!0)}}class mc{constructor(e,n,c,y){this.isReverse=y,this.nodeStack=[];let S=1;for(;!e.isEmpty();)if(S=n?c(e.key,n):1,y&&(S*=-1),S<0)e=this.isReverse?e.left:e.right;else{if(0===S){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $i{constructor(e,n,c,y,S){this.key=e,this.value=n,this.color=null!=c?c:$i.RED,this.left=null!=y?y:$i.EMPTY,this.right=null!=S?S:$i.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,c,y,S){return new $i(null!=e?e:this.key,null!=n?n:this.value,null!=c?c:this.color,null!=y?y:this.left,null!=S?S:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,c){let y=this;const S=c(e,y.key);return y=S<0?y.copy(null,null,null,y.left.insert(e,n,c),null):0===S?y.copy(null,n,null,null,null):y.copy(null,null,null,null,y.right.insert(e,n,c)),y.fixUp()}removeMin(){if(this.left.isEmpty())return $i.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let c,y=this;if(n(e,y.key)<0)y.left.isEmpty()||y.left.isRed()||y.left.left.isRed()||(y=y.moveRedLeft()),y=y.copy(null,null,null,y.left.remove(e,n),null);else{if(y.left.isRed()&&(y=y.rotateRight()),y.right.isEmpty()||y.right.isRed()||y.right.left.isRed()||(y=y.moveRedRight()),0===n(e,y.key)){if(y.right.isEmpty())return $i.EMPTY;c=y.right.min(),y=y.copy(c.key,c.value,null,null,y.right.removeMin())}y=y.copy(null,null,null,null,y.right.remove(e,n))}return y.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$i.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw M();const e=this.left.check();if(e!==this.right.check())throw M();return e+(this.isRed()?0:1)}}$i.EMPTY=null,$i.RED=!0,$i.BLACK=!1,$i.EMPTY=new class{constructor(){this.size=0}get key(){throw M()}get value(){throw M()}get color(){throw M()}get left(){throw M()}get right(){throw M()}copy(s,e,n,c,y){return this}insert(s,e,n){return new $i(s,e)}remove(s,e){return this}isEmpty(){return!0}inorderTraversal(s){return!1}reverseTraversal(s){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Go{constructor(e){this.comparator=e,this.data=new lo(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,c)=>(e(n),!1))}forEachInRange(e,n){const c=this.data.getIteratorFrom(e[0]);for(;c.hasNext();){const y=c.getNext();if(this.comparator(y.key,e[1])>=0)return;n(y.key)}}forEachWhile(e,n){let c;for(c=void 0!==n?this.data.getIteratorFrom(n):this.data.getIterator();c.hasNext();)if(!e(c.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new pd(this.data.getIterator())}getIteratorFrom(e){return new pd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(c=>{n=n.add(c)}),n}isEqual(e){if(!(e instanceof Go)||this.size!==e.size)return!1;const n=this.data.getIterator(),c=e.data.getIterator();for(;n.hasNext();){const y=n.getNext().key,S=c.getNext().key;if(0!==this.comparator(y,S))return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Go(this.comparator);return n.data=e,n}}class pd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const nf=new lo(m.comparator);function gu(){return nf}const md=new lo(m.comparator);function hh(){return md}const gd=new lo(m.comparator);function gc(){return gd}const Zf=new Go(m.comparator);function Oo(...s){let e=Zf;for(const n of s)e=e.add(n);return e}const yd=new Go(Jr);function yc(){return yd}class Uh{constructor(e,n,c,y,S){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=c,this.documentUpdates=y,this.resolvedLimboDocuments=S}static createSynthesizedRemoteEventForCurrentChange(e,n){const c=new Map;return c.set(e,Zl.createSynthesizedTargetChangeForCurrentChange(e,n)),new Uh(ei.min(),c,yc(),gu(),Oo())}}class Zl{constructor(e,n,c,y,S){this.resumeToken=e,this.current=n,this.addedDocuments=c,this.modifiedDocuments=y,this.removedDocuments=S}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Zl(no.EMPTY_BYTE_STRING,n,Oo(),Oo(),Oo())}}class dh{constructor(e,n,c,y){this.$=e,this.removedTargetIds=n,this.key=c,this.O=y}}class zh{constructor(e,n){this.targetId=e,this.M=n}}class zc{constructor(e,n,c=no.EMPTY_BYTE_STRING,y=null){this.state=e,this.targetIds=n,this.resumeToken=c,this.cause=y}}class yu{constructor(){this.F=0,this.L=Vs(),this.B=no.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}get current(){return this.U}get resumeToken(){return this.B}get K(){return 0!==this.F}get j(){return this.q}W(e){e.approximateByteSize()>0&&(this.q=!0,this.B=e)}G(){let e=Oo(),n=Oo(),c=Oo();return this.L.forEach((y,S)=>{switch(S){case 0:e=e.add(y);break;case 2:n=n.add(y);break;case 1:c=c.add(y);break;default:M()}}),new Zl(this.B,this.U,e,n,c)}H(){this.q=!1,this.L=Vs()}J(e,n){this.q=!0,this.L=this.L.insert(e,n)}Y(e){this.q=!0,this.L=this.L.remove(e)}X(){this.F+=1}Z(){this.F-=1}tt(){this.q=!0,this.U=!0}}class rf{constructor(e){this.et=e,this.nt=new Map,this.st=gu(),this.it=Kf(),this.rt=new Go(Jr)}ot(e){for(const n of e.$)e.O&&e.O.isFoundDocument()?this.ct(n,e.O):this.at(n,e.key,e.O);for(const n of e.removedTargetIds)this.at(n,e.key,e.O)}ut(e){this.forEachTarget(e,n=>{const c=this.ht(n);switch(e.state){case 0:this.lt(n)&&c.W(e.resumeToken);break;case 1:c.Z(),c.K||c.H(),c.W(e.resumeToken);break;case 2:c.Z(),c.K||this.removeTarget(n);break;case 3:this.lt(n)&&(c.tt(),c.W(e.resumeToken));break;case 4:this.lt(n)&&(this.ft(n),c.W(e.resumeToken));break;default:M()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.nt.forEach((c,y)=>{this.lt(y)&&n(y)})}dt(e){const n=e.targetId,c=e.M.count,y=this.wt(n);if(y){const S=y.target;if(cr(S))if(0===c){const L=new m(S.path);this.at(n,L,tn.newNoDocument(L,ei.min()))}else J(1===c);else this._t(n)!==c&&(this.ft(n),this.rt=this.rt.add(n))}}gt(e){const n=new Map;this.nt.forEach((S,L)=>{const te=this.wt(L);if(te){if(S.current&&cr(te.target)){const Me=new m(te.target.path);null!==this.st.get(Me)||this.yt(L,Me)||this.at(L,Me,tn.newNoDocument(Me,e))}S.j&&(n.set(L,S.G()),S.H())}});let c=Oo();this.it.forEach((S,L)=>{let te=!0;L.forEachWhile(Me=>{const dt=this.wt(Me);return!dt||2===dt.purpose||(te=!1,!1)}),te&&(c=c.add(S))});const y=new Uh(e,n,this.rt,this.st,c);return this.st=gu(),this.it=Kf(),this.rt=new Go(Jr),y}ct(e,n){if(!this.lt(e))return;const c=this.yt(e,n.key)?2:0;this.ht(e).J(n.key,c),this.st=this.st.insert(n.key,n),this.it=this.it.insert(n.key,this.Tt(n.key).add(e))}at(e,n,c){if(!this.lt(e))return;const y=this.ht(e);this.yt(e,n)?y.J(n,1):y.Y(n),this.it=this.it.insert(n,this.Tt(n).delete(e)),c&&(this.st=this.st.insert(n,c))}removeTarget(e){this.nt.delete(e)}_t(e){const n=this.ht(e).G();return this.et.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}X(e){this.ht(e).X()}ht(e){let n=this.nt.get(e);return n||(n=new yu,this.nt.set(e,n)),n}Tt(e){let n=this.it.get(e);return n||(n=new Go(Jr),this.it=this.it.insert(e,n)),n}lt(e){const n=null!==this.wt(e);return n||Zn("WatchChangeAggregator","Detected inactive target",e),n}wt(e){const n=this.nt.get(e);return n&&n.K?null:this.et.Et(e)}ft(e){this.nt.set(e,new yu),this.et.getRemoteKeysForTarget(e).forEach(n=>{this.at(e,n,null)})}yt(e,n){return this.et.getRemoteKeysForTarget(e).has(n)}}function Kf(){return new lo(m.comparator)}function Vs(){return new lo(m.comparator)}const of={asc:"ASCENDING",desc:"DESCENDING"},Yf={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class _c{constructor(e,n){this.databaseId=e,this.C=n}}function fh(s,e){return s.C?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Jf(s,e){return s.C?e.toBase64():e.toUint8Array()}function Vh(s,e){return fh(s,e.toTimestamp())}function Da(s){return J(!!s),ei.fromTimestamp(function(e){const n=Wi(e);return new ji(n.seconds,n.nanos)}(s))}function _d(s,e){return(n=s,new uo(["projects",n.projectId,"databases",n.database])).child("documents").child(e).canonicalString();var n}function Xf(s){const e=uo.fromString(s);return J(mh(e)),e}function Kl(s,e){return _d(s.databaseId,e.path)}function Yl(s,e){const n=Xf(e);if(n.get(1)!==s.databaseId.projectId)throw new at(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+s.databaseId.projectId);if(n.get(3)!==s.databaseId.database)throw new at(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+s.databaseId.database);return new m(jh(n))}function Jl(s,e){return _d(s.databaseId,e)}function Xs(s){const e=Xf(s);return 4===e.length?uo.emptyPath():jh(e)}function Aa(s){return new uo(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function jh(s){return J(s.length>4&&"documents"===s.get(4)),s.popFirst(5)}function vd(s,e,n){return{name:Kl(s,e),fields:n.value.mapValue.fields}}function eu(s,e,n){const c=Yl(s,e.name),y=Da(e.updateTime),S=new Bt({mapValue:{fields:e.fields}}),L=tn.newFoundDocument(c,y,S);return n&&L.setHasCommittedMutations(),n?L.setHasCommittedMutations():L}function vc(s,e){let n;if(e instanceof ch)n={update:vd(s,e.key,e.value)};else if(e instanceof Bh)n={delete:Kl(s,e.key)};else if(e instanceof mu)n={update:vd(s,e.key,e.data),updateMask:lf(e.fieldMask)};else{if(!(e instanceof Wf))return M();n={verify:Kl(s,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(c=>function(y,S){const L=S.transform;if(L instanceof dc)return{fieldPath:S.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(L instanceof Ku)return{fieldPath:S.field.canonicalString(),appendMissingElements:{values:L.elements}};if(L instanceof fu)return{fieldPath:S.field.canonicalString(),removeAllFromArray:{values:L.elements}};if(L instanceof Yu)return{fieldPath:S.field.canonicalString(),increment:L.N};throw M()}(0,c))),e.precondition.isNone||(n.currentDocument=void 0!==(y=e.precondition).updateTime?{updateTime:Vh(s,y.updateTime)}:void 0!==y.exists?{exists:y.exists}:M()),n;var y}function sf(s,e){const n=e.currentDocument?void 0!==(y=e.currentDocument).updateTime?Js.updateTime(Da(y.updateTime)):void 0!==y.exists?Js.exists(y.exists):Js.none():Js.none(),c=e.updateTransforms?e.updateTransforms.map(y=>function(S,L){let te=null;"setToServerValue"in L?(J("REQUEST_TIME"===L.setToServerValue),te=new dc):"appendMissingElements"in L?te=new Ku(L.appendMissingElements.values||[]):"removeAllFromArray"in L?te=new fu(L.removeAllFromArray.values||[]):"increment"in L?te=new Yu(S,L.increment):M();const Me=es.fromServerFormat(L.fieldPath);return new Qa(Me,te)}(s,y)):[];var y;if(e.update){const y=Yl(s,e.update.name),S=new Bt({mapValue:{fields:e.update.fields}});if(e.updateMask){const L=new pl((e.updateMask.fieldPaths||[]).map(dt=>es.fromServerFormat(dt)));return new mu(y,S,L,n,c)}return new ch(y,S,n,c)}if(e.delete){const y=Yl(s,e.delete);return new Bh(y,n)}if(e.verify){const y=Yl(s,e.verify);return new Wf(y,n)}return M()}function bd(s,e){return{documents:[Jl(s,e.path)]}}function ph(s,e){const n={structuredQuery:{}},c=e.path;null!==e.collectionGroup?(n.parent=Jl(s,c),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Jl(s,c.popLast()),n.structuredQuery.from=[{collectionId:c.lastSegment()}]);const y=function(te){if(0===te.length)return;const Me=te.map(dt=>function(Rt){if("=="===Rt.op){if(Pt(Rt.value))return{unaryFilter:{field:bc(Rt.field),op:"IS_NAN"}};if(wt(Rt.value))return{unaryFilter:{field:bc(Rt.field),op:"IS_NULL"}}}else if("!="===Rt.op){if(Pt(Rt.value))return{unaryFilter:{field:bc(Rt.field),op:"IS_NOT_NAN"}};if(wt(Rt.value))return{unaryFilter:{field:bc(Rt.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bc(Rt.field),op:Yp(Rt.op),value:Rt.value}}}(dt));return 1===Me.length?Me[0]:{compositeFilter:{op:"AND",filters:Me}}}(e.filters);y&&(n.structuredQuery.where=y);const S=function(te){if(0!==te.length)return te.map(Me=>{return{field:bc((dt=Me).field),direction:ep(dt.dir)};var dt})}(e.orderBy);S&&(n.structuredQuery.orderBy=S);const L=(Me=e.limit,s.C||l(Me)?Me:{value:Me});var Me;return null!==L&&(n.structuredQuery.limit=L),e.startAt&&(n.structuredQuery.startAt=zl(e.startAt)),e.endAt&&(n.structuredQuery.endAt=zl(e.endAt)),n}function ja(s){let e=Xs(s.parent);const n=s.structuredQuery,c=n.from?n.from.length:0;let y=null;if(c>0){J(1===c);const Rt=n.from[0];Rt.allDescendants?y=Rt.collectionId:e=e.child(Rt.collectionId)}let S=[];n.where&&(S=uf(n.where));let L=[];n.orderBy&&(L=n.orderBy.map(Rt=>{return new vi(Vc((Kt=Rt).field),function(Cn){switch(Cn){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(Kt.direction));var Kt}));let te=null;n.limit&&(te=function(Rt){let Kt;return Kt="object"==typeof Rt?Rt.value:Rt,l(Kt)?null:Kt}(n.limit));let Me=null;n.startAt&&(Me=Hh(n.startAt));let dt=null;return n.endAt&&(dt=Hh(n.endAt)),Qi(e,y,L,S,te,"F",Me,dt)}function uf(s){return s?void 0!==s.unaryFilter?[jc(s)]:void 0!==s.fieldFilter?[ku(s)]:void 0!==s.compositeFilter?s.compositeFilter.filters.map(e=>uf(e)).reduce((e,n)=>e.concat(n)):M():[]}function zl(s){return{before:s.before,values:s.position}}function Hh(s){return new sr(s.values||[],!!s.before)}function ep(s){return of[s]}function Yp(s){return Yf[s]}function bc(s){return{fieldPath:s.canonicalString()}}function Vc(s){return es.fromServerFormat(s.fieldPath)}function ku(s){return yr.create(Vc(s.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return M()}}(s.fieldFilter.op),s.fieldFilter.value)}function jc(s){switch(s.unaryFilter.op){case"IS_NAN":const e=Vc(s.unaryFilter.field);return yr.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Vc(s.unaryFilter.field);return yr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Vc(s.unaryFilter.field);return yr.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const y=Vc(s.unaryFilter.field);return yr.create(y,"!=",{nullValue:"NULL_VALUE"});default:return M()}}function lf(s){const e=[];return s.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function mh(s){return s.length>=4&&"projects"===s.get(0)&&"databases"===s.get(2)}function la(s){let e="";for(let n=0;n<s.length;n++)e.length>0&&(e=yh(e)),e=gh(s.get(n),e);return yh(e)}function gh(s,e){let n=e;const c=s.length;for(let y=0;y<c;y++){const S=s.charAt(y);switch(S){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=S}}return n}function yh(s){return s+"\x01\x01"}function Bi(s){const e=s.length;if(J(e>=2),2===e)return J("\x01"===s.charAt(0)&&"\x01"===s.charAt(1)),uo.emptyPath();const n=e-2,c=[];let y="";for(let S=0;S<e;){const L=s.indexOf("\x01",S);switch((L<0||L>n)&&M(),s.charAt(L+1)){case"\x01":const te=s.substring(S,L);let Me;0===y.length?Me=te:(y+=te,Me=y,y=""),c.push(Me);break;case"\x10":y+=s.substring(S,L),y+="\0";break;case"\x11":y+=s.substring(S,L+1);break;default:M()}S=L+2}return new uo(c)}class tp{constructor(e,n){this.seconds=e,this.nanoseconds=n}}class Ps{constructor(e,n,c){this.ownerId=e,this.allowTabSynchronization=n,this.leaseTimestampMs=c}}Ps.store="owner",Ps.key="owner";class sl{constructor(e,n,c){this.userId=e,this.lastAcknowledgedBatchId=n,this.lastStreamToken=c}}sl.store="mutationQueues",sl.keyPath="userId";class cs{constructor(e,n,c,y,S){this.userId=e,this.batchId=n,this.localWriteTimeMs=c,this.baseMutations=y,this.mutations=S}}cs.store="mutations",cs.keyPath="batchId",cs.userMutationsIndex="userMutationsIndex",cs.userMutationsKeyPath=["userId","batchId"];class tu{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,n){return[e,la(n)]}static key(e,n,c){return[e,la(n),c]}}tu.store="documentMutations",tu.PLACEHOLDER=new tu;class np{constructor(e,n){this.path=e,this.readTime=n}}class A{constructor(e,n){this.path=e,this.version=n}}class b{constructor(e,n,c,y,S,L){this.unknownDocument=e,this.noDocument=n,this.document=c,this.hasCommittedMutations=y,this.readTime=S,this.parentPath=L}}b.store="remoteDocuments",b.readTimeIndex="readTimeIndex",b.readTimeIndexPath="readTime",b.collectionReadTimeIndex="collectionReadTimeIndex",b.collectionReadTimeIndexPath=["parentPath","readTime"];class I{constructor(e){this.byteSize=e}}I.store="remoteDocumentGlobal",I.key="remoteDocumentGlobalKey";class N{constructor(e,n,c,y,S,L,te){this.targetId=e,this.canonicalId=n,this.readTime=c,this.resumeToken=y,this.lastListenSequenceNumber=S,this.lastLimboFreeSnapshotVersion=L,this.query=te}}N.store="targets",N.keyPath="targetId",N.queryTargetsIndexName="queryTargetsIndex",N.queryTargetsKeyPath=["canonicalId","targetId"];class we{constructor(e,n,c){this.targetId=e,this.path=n,this.sequenceNumber=c}}we.store="targetDocuments",we.keyPath=["targetId","path"],we.documentTargetsIndex="documentTargetsIndex",we.documentTargetsKeyPath=["path","targetId"];class lt{constructor(e,n,c,y){this.highestTargetId=e,this.highestListenSequenceNumber=n,this.lastRemoteSnapshotVersion=c,this.targetCount=y}}lt.key="targetGlobalKey",lt.store="targetGlobal";class Yt{constructor(e,n){this.collectionId=e,this.parent=n}}Yt.store="collectionParents",Yt.keyPath=["collectionId","parent"];class In{constructor(e,n,c,y){this.clientId=e,this.updateTimeMs=n,this.networkEnabled=c,this.inForeground=y}}In.store="clientMetadata",In.keyPath="clientId";class ar{constructor(e,n,c){this.bundleId=e,this.createTime=n,this.version=c}}ar.store="bundles",ar.keyPath="bundleId";class Lr{constructor(e,n,c){this.name=e,this.readTime=n,this.bundledQuery=c}}Lr.store="namedQueries",Lr.keyPath="name";const ai=[sl.store,cs.store,tu.store,b.store,N.store,Ps.store,lt.store,we.store,In.store,I.store,Yt.store,ar.store,Lr.store],Xr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Qs{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class Un{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&M(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Un((c,y)=>{this.nextCallback=S=>{this.wrapSuccess(e,S).next(c,y)},this.catchCallback=S=>{this.wrapFailure(n,S).next(c,y)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Un?n:Un.resolve(n)}catch(n){return Un.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Un.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Un.reject(n)}static resolve(e){return new Un((n,c)=>{n(e)})}static reject(e){return new Un((n,c)=>{c(e)})}static waitFor(e){return new Un((n,c)=>{let y=0,S=0,L=!1;e.forEach(te=>{++y,te.next(()=>{++S,L&&S===y&&n()},Me=>c(Me))}),L=!0,S===y&&n()})}static or(e){let n=Un.resolve(!1);for(const c of e)n=n.next(y=>y?Un.resolve(y):c());return n}static forEach(e,n){const c=[];return e.forEach((y,S)=>{c.push(n.call(this,y,S))}),this.waitFor(c)}}class Al{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.It=new pn,this.transaction.oncomplete=()=>{this.It.resolve()},this.transaction.onabort=()=>{n.error?this.It.reject(new ea(e,n.error)):this.It.resolve()},this.transaction.onerror=c=>{const y=ca(c.target.error);this.It.reject(new ea(e,y))}}static open(e,n,c,y){try{return new Al(n,e.transaction(y,c))}catch(S){throw new ea(n,S)}}get At(){return this.It.promise}abort(e){e&&this.It.reject(e),this.aborted||(Zn("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const n=this.transaction.objectStore(e);return new Ma(n)}}class nu{constructor(e,n,c){this.name=e,this.version=n,this.Rt=c,12.2===nu.bt((0,W.z$)())&&Mi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Zn("SimpleDb","Removing database:",e),vu(window.indexedDB.deleteDatabase(e)).toPromise()}static Pt(){if(!(0,W.hl)())return!1;if(nu.vt())return!0;const e=(0,W.z$)(),n=nu.bt(e),c=0<n&&n<10,y=nu.Vt(e),S=0<y&&y<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||c||S)}static vt(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.St)}static Dt(e,n){return e.store(n)}static bt(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),c=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(c)}static Vt(e){const n=e.match(/Android ([\d.]+)/i),c=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(c)}Ct(e){var n=this;return(0,he.Z)(function*(){return n.db||(Zn("SimpleDb","Opening database:",n.name),n.db=yield new Promise((c,y)=>{const S=indexedDB.open(n.name,n.version);S.onsuccess=L=>{c(L.target.result)},S.onblocked=()=>{y(new ea(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},S.onerror=L=>{const te=L.target.error;y("VersionError"===te.name?new at(Ne.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===te.name?new at(Ne.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+te):new ea(e,te))},S.onupgradeneeded=L=>{Zn("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',L.oldVersion),n.Rt.Nt(L.target.result,S.transaction,L.oldVersion,n.version).next(()=>{Zn("SimpleDb","Database upgrade to version "+n.version+" complete")})}})),n.kt&&(n.db.onversionchange=c=>n.kt(c)),n.db})()}xt(e){this.kt=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,c,y){var S=this;return(0,he.Z)(function*(){const L="readonly"===n;let te=0;for(;;){++te;try{S.db=yield S.Ct(e);const Me=Al.open(S.db,e,L?"readonly":"readwrite",c),dt=y(Me).catch(Rt=>(Me.abort(Rt),Un.reject(Rt))).toPromise();return dt.catch(()=>{}),yield Me.At,dt}catch(Me){const dt="FirebaseError"!==Me.name&&te<3;if(Zn("SimpleDb","Transaction failed with error:",Me.message,"Retrying:",dt),S.close(),!dt)return Promise.reject(Me)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Xl{constructor(e){this.$t=e,this.Ot=!1,this.Mt=null}get isDone(){return this.Ot}get Ft(){return this.Mt}set cursor(e){this.$t=e}done(){this.Ot=!0}Lt(e){this.Mt=e}delete(){return vu(this.$t.delete())}}class ea extends at{constructor(e,n){super(Ne.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ju(s){return"IndexedDbTransactionError"===s.name}class Ma{constructor(e){this.store=e}put(e,n){let c;return void 0!==n?(Zn("SimpleDb","PUT",this.store.name,e,n),c=this.store.put(n,e)):(Zn("SimpleDb","PUT",this.store.name,"<auto-key>",e),c=this.store.put(e)),vu(c)}add(e){return Zn("SimpleDb","ADD",this.store.name,e,e),vu(this.store.add(e))}get(e){return vu(this.store.get(e)).next(n=>(void 0===n&&(n=null),Zn("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return Zn("SimpleDb","DELETE",this.store.name,e),vu(this.store.delete(e))}count(){return Zn("SimpleDb","COUNT",this.store.name),vu(this.store.count())}Bt(e,n){const c=this.cursor(this.options(e,n)),y=[];return this.Ut(c,(S,L)=>{y.push(L)}).next(()=>y)}qt(e,n){Zn("SimpleDb","DELETE ALL",this.store.name);const c=this.options(e,n);c.Kt=!1;const y=this.cursor(c);return this.Ut(y,(S,L,te)=>te.delete())}jt(e,n){let c;n?c=e:(c={},n=e);const y=this.cursor(c);return this.Ut(y,n)}Qt(e){const n=this.cursor({});return new Un((c,y)=>{n.onerror=S=>{const L=ca(S.target.error);y(L)},n.onsuccess=S=>{const L=S.target.result;L?e(L.primaryKey,L.value).next(te=>{te?L.continue():c()}):c()}})}Ut(e,n){const c=[];return new Un((y,S)=>{e.onerror=L=>{S(L.target.error)},e.onsuccess=L=>{const te=L.target.result;if(!te)return void y();const Me=new Xl(te),dt=n(te.primaryKey,te.value,Me);if(dt instanceof Un){const Rt=dt.catch(Kt=>(Me.done(),Un.reject(Kt)));c.push(Rt)}Me.isDone?y():null===Me.Ft?te.continue():te.continue(Me.Ft)}}).next(()=>Un.waitFor(c))}options(e,n){let c;return void 0!==e&&("string"==typeof e?c=e:n=e),{index:c,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const c=this.store.index(e.index);return e.Kt?c.openKeyCursor(e.range,n):c.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function vu(s){return new Un((e,n)=>{s.onsuccess=c=>{e(c.target.result)},s.onerror=c=>{const y=ca(c.target.error);n(y)}})}let wc=!1;function ca(s){const e=nu.bt((0,W.z$)());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(n)>=0){const c=new at("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return wc||(wc=!0,setTimeout(()=>{throw c},0)),c}}return s}class wd extends Qs{constructor(e,n){super(),this.Wt=e,this.currentSequenceNumber=n}}function ru(s,e){const n=De(s);return nu.Dt(n.Wt,e)}class $h{constructor(e,n,c,y){this.batchId=e,this.localWriteTime=n,this.baseMutations=c,this.mutations=y}applyToRemoteDocument(e,n){const c=n.mutationResults;for(let y=0;y<this.mutations.length;y++){const S=this.mutations[y];S.key.isEqual(e.key)&&Cl(S,e,c[y])}}applyToLocalView(e){for(const n of this.baseMutations)n.key.isEqual(e.key)&&pc(n,e,this.localWriteTime);for(const n of this.mutations)n.key.isEqual(e.key)&&pc(n,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(n=>{const c=e.get(n.key),y=c;this.applyToLocalView(y),c.isValidDocument()||y.convertToNoDocument(ei.min())})}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Oo())}isEqual(e){return this.batchId===e.batchId&&du(this.mutations,e.mutations,(n,c)=>Gf(n,c))&&du(this.baseMutations,e.baseMutations,(n,c)=>Gf(n,c))}}class xd{constructor(e,n,c,y){this.batch=e,this.commitVersion=n,this.mutationResults=c,this.docVersions=y}static from(e,n,c){J(e.mutations.length===c.length);let y=gc();const S=e.mutations;for(let L=0;L<S.length;L++)y=y.insert(S[L].key,c[L].version);return new xd(e,n,c,y)}}class xc{constructor(e,n,c,y,S=ei.min(),L=ei.min(),te=no.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=c,this.sequenceNumber=y,this.snapshotVersion=S,this.lastLimboFreeSnapshotVersion=L,this.resumeToken=te}withSequenceNumber(e){return new xc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new xc(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class rp{constructor(e){this.Gt=e}}function Jp(s,e){if(e.document)return eu(s.Gt,e.document,!!e.hasCommittedMutations);if(e.noDocument){const n=m.fromSegments(e.noDocument.path),c=$c(e.noDocument.readTime),y=tn.newNoDocument(n,c);return e.hasCommittedMutations?y.setHasCommittedMutations():y}if(e.unknownDocument){const n=m.fromSegments(e.unknownDocument.path),c=$c(e.unknownDocument.version);return tn.newUnknownDocument(n,c)}return M()}function Xp(s,e,n){const c=Hc(n),y=e.key.path.popLast().toArray();if(e.isFoundDocument()){const S={name:Kl(te=s.Gt,(Me=e).key),fields:Me.data.value.mapValue.fields,updateTime:fh(te,Me.version.toTimestamp())};return new b(null,null,S,e.hasCommittedMutations,c,y)}var te,Me;if(e.isNoDocument()){const S=e.key.path.toArray(),L=_h(e.version),te=e.hasCommittedMutations;return new b(null,new np(S,L),null,te,c,y)}if(e.isUnknownDocument()){const S=e.key.path.toArray(),L=_h(e.version);return new b(new A(S,L),null,null,!0,c,y)}return M()}function Hc(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function Ed(s){const e=new ji(s[0],s[1]);return ei.fromTimestamp(e)}function _h(s){const e=s.toTimestamp();return new tp(e.seconds,e.nanoseconds)}function $c(s){const e=new ji(s.seconds,s.nanoseconds);return ei.fromTimestamp(e)}function Id(s,e){const n=(e.baseMutations||[]).map(S=>sf(s.Gt,S));for(let S=0;S<e.mutations.length-1;++S){const L=e.mutations[S];S+1<e.mutations.length&&void 0!==e.mutations[S+1].transform&&(L.updateTransforms=e.mutations[S+1].transform.fieldTransforms,e.mutations.splice(S+1,1),++S)}const c=e.mutations.map(S=>sf(s.Gt,S)),y=ji.fromMillis(e.localWriteTimeMs);return new $h(e.batchId,y,n,c)}function Td(s){const e=$c(s.readTime),n=void 0!==s.lastLimboFreeSnapshotVersion?$c(s.lastLimboFreeSnapshotVersion):ei.min();let c;var y;return void 0!==s.query.documents?(J(1===(y=s.query).documents.length),c=Ia(ko(Xs(y.documents[0])))):c=Ia(ja(s.query)),new xc(c,s.targetId,0,s.lastListenSequenceNumber,e,n,no.fromBase64String(s.resumeToken))}function ip(s,e){const n=_h(e.snapshotVersion),c=_h(e.lastLimboFreeSnapshotVersion);let y;y=cr(e.target)?bd(s.Gt,e.target):ph(s.Gt,e.target);const S=e.resumeToken.toBase64();return new N(e.targetId,Rn(e.target),n,S,e.sequenceNumber,c,y)}function cf(s){const e=ja({parent:s.parent,structuredQuery:s.structuredQuery});return"LAST"===s.limitType?El(e,e.limit,"L"):e}class vh{getBundleMetadata(e,n){return Qp(e).get(n).next(c=>{if(c)return{id:(y=c).bundleId,createTime:$c(y.createTime),version:y.version};var y})}saveBundleMetadata(e,n){return Qp(e).put({bundleId:(c=n).id,createTime:_h(Da(c.createTime)),version:c.version});var c}getNamedQuery(e,n){return em(e).get(n).next(c=>{if(c)return{name:(y=c).name,query:cf(y.bundledQuery),readTime:$c(y.readTime)};var y})}saveNamedQuery(e,n){return em(e).put({name:(c=n).name,readTime:_h(Da(c.readTime)),bundledQuery:c.bundledQuery});var c}}function Qp(s){return ru(s,ar.store)}function em(s){return ru(s,Lr.store)}class Om{constructor(){this.zt=new Gh}addToCollectionParentIndex(e,n){return this.zt.add(n),Un.resolve()}getCollectionParents(e,n){return Un.resolve(this.zt.getEntries(n))}}class Gh{constructor(){this.index={}}add(e){const n=e.lastSegment(),c=e.popLast(),y=this.index[n]||new Go(uo.comparator),S=!y.has(c);return this.index[n]=y.add(c),S}has(e){const n=e.lastSegment(),c=e.popLast(),y=this.index[n];return y&&y.has(c)}getEntries(e){return(this.index[e]||new Go(uo.comparator)).toArray()}}class op{constructor(){this.Ht=new Gh}addToCollectionParentIndex(e,n){if(!this.Ht.has(n)){const c=n.lastSegment(),y=n.popLast();e.addOnCommittedListener(()=>{this.Ht.add(n)});const S={collectionId:c,parent:la(y)};return sp(e).put(S)}return Un.resolve()}getCollectionParents(e,n){const c=[],y=IDBKeyRange.bound([n,""],[Pu(n),""],!1,!0);return sp(e).Bt(y).next(S=>{for(const L of S){if(L.collectionId!==n)break;c.push(Bi(L.parent))}return c})}}function sp(s){return ru(s,Yt.store)}const Sd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class bu{constructor(e,n,c){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=c}static withCacheSize(e){return new bu(e,bu.DEFAULT_COLLECTION_PERCENTILE,bu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function qh(s,e,n){const c=s.store(cs.store),y=s.store(tu.store),S=[],L=IDBKeyRange.only(n.batchId);let te=0;const Me=c.jt({range:L},(Rt,Kt,Cn)=>(te++,Cn.delete()));S.push(Me.next(()=>{J(1===te)}));const dt=[];for(const Rt of n.mutations){const Kt=tu.key(e,Rt.key.path,n.batchId);S.push(y.delete(Kt)),dt.push(Rt.key)}return Un.waitFor(S).next(()=>dt)}function Ec(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw M();e=s.noDocument}return JSON.stringify(e).length}bu.DEFAULT_COLLECTION_PERCENTILE=10,bu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bu.DEFAULT=new bu(41943040,bu.DEFAULT_COLLECTION_PERCENTILE,bu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bu.DISABLED=new bu(-1,0,0);class Cd{constructor(e,n,c,y){this.userId=e,this.k=n,this.Jt=c,this.referenceDelegate=y,this.Yt={}}static Xt(e,n,c,y){J(""!==e.uid);const S=e.isAuthenticated()?e.uid:"";return new Cd(S,n,c,y)}checkEmpty(e){let n=!0;const c=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gc(e).jt({index:cs.userMutationsIndex,range:c},(y,S,L)=>{n=!1,L.done()}).next(()=>n)}addMutationBatch(e,n,c,y){const S=Ml(e),L=Gc(e);return L.add({}).next(te=>{J("number"==typeof te);const Me=new $h(te,n,c,y),dt=function(Cn,nr,fr){const $r=fr.baseMutations.map(da=>vc(Cn.Gt,da)),Oi=fr.mutations.map(da=>vc(Cn.Gt,da));return new cs(nr,fr.batchId,fr.localWriteTime.toMillis(),$r,Oi)}(this.k,this.userId,Me),Rt=[];let Kt=new Go((Cn,nr)=>Jr(Cn.canonicalString(),nr.canonicalString()));for(const Cn of y){const nr=tu.key(this.userId,Cn.key.path,te);Kt=Kt.add(Cn.key.path.popLast()),Rt.push(L.put(dt)),Rt.push(S.put(nr,tu.PLACEHOLDER))}return Kt.forEach(Cn=>{Rt.push(this.Jt.addToCollectionParentIndex(e,Cn))}),e.addOnCommittedListener(()=>{this.Yt[te]=Me.keys()}),Un.waitFor(Rt).next(()=>Me)})}lookupMutationBatch(e,n){return Gc(e).get(n).next(c=>c?(J(c.userId===this.userId),Id(this.k,c)):null)}Zt(e,n){return this.Yt[n]?Un.resolve(this.Yt[n]):this.lookupMutationBatch(e,n).next(c=>{if(c){const y=c.keys();return this.Yt[n]=y,y}return null})}getNextMutationBatchAfterBatchId(e,n){const c=n+1,y=IDBKeyRange.lowerBound([this.userId,c]);let S=null;return Gc(e).jt({index:cs.userMutationsIndex,range:y},(L,te,Me)=>{te.userId===this.userId&&(J(te.batchId>=c),S=Id(this.k,te)),Me.done()}).next(()=>S)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let c=-1;return Gc(e).jt({index:cs.userMutationsIndex,range:n,reverse:!0},(y,S,L)=>{c=S.batchId,L.done()}).next(()=>c)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gc(e).Bt(cs.userMutationsIndex,n).next(c=>c.map(y=>Id(this.k,y)))}getAllMutationBatchesAffectingDocumentKey(e,n){const c=tu.prefixForPath(this.userId,n.path),y=IDBKeyRange.lowerBound(c),S=[];return Ml(e).jt({range:y},(L,te,Me)=>{const[dt,Rt,Kt]=L,Cn=Bi(Rt);if(dt===this.userId&&n.path.isEqual(Cn))return Gc(e).get(Kt).next(nr=>{if(!nr)throw M();J(nr.userId===this.userId),S.push(Id(this.k,nr))});Me.done()}).next(()=>S)}getAllMutationBatchesAffectingDocumentKeys(e,n){let c=new Go(Jr);const y=[];return n.forEach(S=>{const L=tu.prefixForPath(this.userId,S.path),te=IDBKeyRange.lowerBound(L),Me=Ml(e).jt({range:te},(dt,Rt,Kt)=>{const[Cn,nr,fr]=dt,$r=Bi(nr);Cn===this.userId&&S.path.isEqual($r)?c=c.add(fr):Kt.done()});y.push(Me)}),Un.waitFor(y).next(()=>this.te(e,c))}getAllMutationBatchesAffectingQuery(e,n){const c=n.path,y=c.length+1,S=tu.prefixForPath(this.userId,c),L=IDBKeyRange.lowerBound(S);let te=new Go(Jr);return Ml(e).jt({range:L},(Me,dt,Rt)=>{const[Kt,Cn,nr]=Me,fr=Bi(Cn);Kt===this.userId&&c.isPrefixOf(fr)?fr.length===y&&(te=te.add(nr)):Rt.done()}).next(()=>this.te(e,te))}te(e,n){const c=[],y=[];return n.forEach(S=>{y.push(Gc(e).get(S).next(L=>{if(null===L)throw M();J(L.userId===this.userId),c.push(Id(this.k,L))}))}),Un.waitFor(y).next(()=>c)}removeMutationBatch(e,n){return qh(e.Wt,this.userId,n).next(c=>(e.addOnCommittedListener(()=>{this.ee(n.batchId)}),Un.forEach(c,y=>this.referenceDelegate.markPotentiallyOrphaned(e,y))))}ee(e){delete this.Yt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return Un.resolve();const c=IDBKeyRange.lowerBound(tu.prefixForUser(this.userId)),y=[];return Ml(e).jt({range:c},(S,L,te)=>{if(S[0]===this.userId){const Me=Bi(S[1]);y.push(Me)}else te.done()}).next(()=>{J(0===y.length)})})}containsKey(e,n){return hf(e,this.userId,n)}ne(e){return df(e).get(this.userId).next(n=>n||new sl(this.userId,-1,""))}}function hf(s,e,n){const c=tu.prefixForPath(e,n.path),y=c[1],S=IDBKeyRange.lowerBound(c);let L=!1;return Ml(s).jt({range:S,Kt:!0},(te,Me,dt)=>{const[Rt,Kt,Cn]=te;Rt===e&&Kt===y&&(L=!0),dt.done()}).next(()=>L)}function Gc(s){return ru(s,cs.store)}function Ml(s){return ru(s,tu.store)}function df(s){return ru(s,sl.store)}class Ic{constructor(e){this.se=e}next(){return this.se+=2,this.se}static ie(){return new Ic(0)}static re(){return new Ic(-1)}}class Wh{constructor(e,n){this.referenceDelegate=e,this.k=n}allocateTargetId(e){return this.oe(e).next(n=>{const c=new Ic(n.highestTargetId);return n.highestTargetId=c.next(),this.ce(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.oe(e).next(n=>ei.fromTimestamp(new ji(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.oe(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,c){return this.oe(e).next(y=>(y.highestListenSequenceNumber=n,c&&(y.lastRemoteSnapshotVersion=c.toTimestamp()),n>y.highestListenSequenceNumber&&(y.highestListenSequenceNumber=n),this.ce(e,y)))}addTargetData(e,n){return this.ae(e,n).next(()=>this.oe(e).next(c=>(c.targetCount+=1,this.ue(n,c),this.ce(e,c))))}updateTargetData(e,n){return this.ae(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Zh(e).delete(n.targetId)).next(()=>this.oe(e)).next(c=>(J(c.targetCount>0),c.targetCount-=1,this.ce(e,c)))}removeTargets(e,n,c){let y=0;const S=[];return Zh(e).jt((L,te)=>{const Me=Td(te);Me.sequenceNumber<=n&&null===c.get(Me.targetId)&&(y++,S.push(this.removeTargetData(e,Me)))}).next(()=>Un.waitFor(S)).next(()=>y)}forEachTarget(e,n){return Zh(e).jt((c,y)=>{const S=Td(y);n(S)})}oe(e){return ap(e).get(lt.key).next(n=>(J(null!==n),n))}ce(e,n){return ap(e).put(lt.key,n)}ae(e,n){return Zh(e).put(ip(this.k,n))}ue(e,n){let c=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,c=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,c=!0),c}getTargetCount(e){return this.oe(e).next(n=>n.targetCount)}getTargetData(e,n){const c=Rn(n),y=IDBKeyRange.bound([c,Number.NEGATIVE_INFINITY],[c,Number.POSITIVE_INFINITY]);let S=null;return Zh(e).jt({range:y,index:N.queryTargetsIndexName},(L,te,Me)=>{const dt=Td(te);Vn(n,dt.target)&&(S=dt,Me.done())}).next(()=>S)}addMatchingKeys(e,n,c){const y=[],S=bh(e);return n.forEach(L=>{const te=la(L.path);y.push(S.put(new we(c,te))),y.push(this.referenceDelegate.addReference(e,c,L))}),Un.waitFor(y)}removeMatchingKeys(e,n,c){const y=bh(e);return Un.forEach(n,S=>{const L=la(S.path);return Un.waitFor([y.delete([c,L]),this.referenceDelegate.removeReference(e,c,S)])})}removeMatchingKeysForTargetId(e,n){const c=bh(e),y=IDBKeyRange.bound([n],[n+1],!1,!0);return c.delete(y)}getMatchingKeysForTargetId(e,n){const c=IDBKeyRange.bound([n],[n+1],!1,!0),y=bh(e);let S=Oo();return y.jt({range:c,Kt:!0},(L,te,Me)=>{const dt=Bi(L[1]),Rt=new m(dt);S=S.add(Rt)}).next(()=>S)}containsKey(e,n){const c=la(n.path),y=IDBKeyRange.bound([c],[Pu(c)],!1,!0);let S=0;return bh(e).jt({index:we.documentTargetsIndex,Kt:!0,range:y},([L,te],Me,dt)=>{0!==L&&(S++,dt.done())}).next(()=>S>0)}Et(e,n){return Zh(e).get(n).next(c=>c?Td(c):null)}}function Zh(s){return ru(s,N.store)}function ap(s){return ru(s,lt.store)}function bh(s){return ru(s,we.store)}function Kh(s){return up.apply(this,arguments)}function up(){return up=(0,he.Z)(function*(s){if(s.code!==Ne.FAILED_PRECONDITION||s.message!==Xr)throw s;Zn("LocalStore","Unexpectedly lost primary lease")}),up.apply(this,arguments)}function Yh([s,e],[n,c]){const y=Jr(s,n);return 0===y?Jr(e,c):y}class lp{constructor(e){this.he=e,this.buffer=new Go(Yh),this.le=0}fe(){return++this.le}de(e){const n=[e,this.fe()];if(this.buffer.size<this.he)this.buffer=this.buffer.add(n);else{const c=this.buffer.last();Yh(n,c)<0&&(this.buffer=this.buffer.delete(c).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Fy{constructor(e,n){this.garbageCollector=e,this.asyncQueue=n,this.we=!1,this._e=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.me(e)}stop(){this._e&&(this._e.cancel(),this._e=null)}get started(){return null!==this._e}me(e){var n=this;const c=this.we?3e5:6e4;Zn("LruGarbageCollector",`Garbage collection scheduled in ${c}ms`),this._e=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",c,(0,he.Z)(function*(){n._e=null,n.we=!0;try{yield e.collectGarbage(n.garbageCollector)}catch(y){Ju(y)?Zn("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",y):yield Kh(y)}yield n.me(e)}))}}class Jh{constructor(e,n){this.ge=e,this.params=n}calculateTargetCount(e,n){return this.ge.ye(e).next(c=>Math.floor(n/100*c))}nthSequenceNumber(e,n){if(0===n)return Un.resolve(Wr.I);const c=new lp(n);return this.ge.forEachTarget(e,y=>c.de(y.sequenceNumber)).next(()=>this.ge.pe(e,y=>c.de(y))).next(()=>c.maxValue)}removeTargets(e,n,c){return this.ge.removeTargets(e,n,c)}removeOrphanedDocuments(e,n){return this.ge.removeOrphanedDocuments(e,n)}collect(e,n){return-1===this.params.cacheSizeCollectionThreshold?(Zn("LruGarbageCollector","Garbage collection skipped; disabled"),Un.resolve(Sd)):this.getCacheSize(e).next(c=>c<this.params.cacheSizeCollectionThreshold?(Zn("LruGarbageCollector",`Garbage collection skipped; Cache size ${c} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Sd):this.Te(e,n))}getCacheSize(e){return this.ge.getCacheSize(e)}Te(e,n){let c,y,S,L,te,Me,dt;const Rt=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(Kt=>(Kt>this.params.maximumSequenceNumbersToCollect?(Zn("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${Kt}`),y=this.params.maximumSequenceNumbersToCollect):y=Kt,L=Date.now(),this.nthSequenceNumber(e,y))).next(Kt=>(c=Kt,te=Date.now(),this.removeTargets(e,c,n))).next(Kt=>(S=Kt,Me=Date.now(),this.removeOrphanedDocuments(e,c))).next(Kt=>(dt=Date.now(),bl()<=j.in.DEBUG&&Zn("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${L-Rt}ms\n\tDetermined least recently used ${y} in `+(te-L)+`ms\n\tRemoved ${S} targets in `+(Me-te)+`ms\n\tRemoved ${Kt} documents in `+(dt-Me)+`ms\nTotal Duration: ${dt-Rt}ms`),Un.resolve({didRun:!0,sequenceNumbersCollected:y,targetsRemoved:S,documentsRemoved:Kt})))}}class ff{constructor(e,n){this.db=e,this.garbageCollector=new Jh(this,n)}ye(e){const n=this.Ee(e);return this.db.getTargetCache().getTargetCount(e).next(c=>n.next(y=>c+y))}Ee(e){let n=0;return this.pe(e,c=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pe(e,n){return this.Ie(e,(c,y)=>n(y))}addReference(e,n,c){return ro(e,c)}removeReference(e,n,c){return ro(e,c)}removeTargets(e,n,c){return this.db.getTargetCache().removeTargets(e,n,c)}markPotentiallyOrphaned(e,n){return ro(e,n)}Ae(e,n){return function(c,y){let S=!1;return df(c).Qt(L=>hf(c,L,y).next(te=>(te&&(S=!0),Un.resolve(!te)))).next(()=>S)}(e,n)}removeOrphanedDocuments(e,n){const c=this.db.getRemoteDocumentCache().newChangeBuffer(),y=[];let S=0;return this.Ie(e,(L,te)=>{if(te<=n){const Me=this.Ae(e,L).next(dt=>{if(!dt)return S++,c.getEntry(e,L).next(()=>(c.removeEntry(L),bh(e).delete([0,la(L.path)])))});y.push(Me)}}).next(()=>Un.waitFor(y)).next(()=>c.apply(e)).next(()=>S)}removeTarget(e,n){const c=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,c)}updateLimboDocument(e,n){return ro(e,n)}Ie(e,n){const c=bh(e);let y,S=Wr.I;return c.jt({index:we.documentTargetsIndex},([L,te],{path:Me,sequenceNumber:dt})=>{0===L?(S!==Wr.I&&n(new m(Bi(y)),S),S=dt,y=Me):S=Wr.I}).next(()=>{S!==Wr.I&&n(new m(Bi(y)),S)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ro(s,e){return bh(s).put((c=s.currentSequenceNumber,new we(0,la(e.path),c)));var c}class Dd{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={}}get(e){const n=this.mapKeyFn(e),c=this.inner[n];if(void 0!==c)for(const[y,S]of c)if(this.equalsFn(y,e))return S}has(e){return void 0!==this.get(e)}set(e,n){const c=this.mapKeyFn(e),y=this.inner[c];if(void 0!==y){for(let S=0;S<y.length;S++)if(this.equalsFn(y[S][0],e))return void(y[S]=[e,n]);y.push([e,n])}else this.inner[c]=[[e,n]]}delete(e){const n=this.mapKeyFn(e),c=this.inner[n];if(void 0===c)return!1;for(let y=0;y<c.length;y++)if(this.equalsFn(c[y][0],e))return 1===c.length?delete this.inner[n]:c.splice(y,1),!0;return!1}forEach(e){_o(this.inner,(n,c)=>{for(const[y,S]of c)e(y,S)})}isEmpty(){return Ll(this.inner)}}class cp{constructor(){this.changes=new Dd(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}getReadTime(e){const n=this.changes.get(e);return n?n.readTime:ei.min()}addEntry(e,n){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:n})}removeEntry(e,n=null){this.assertNotApplied(),this.changes.set(e,{document:tn.newInvalidDocument(e),readTime:n})}getEntry(e,n){this.assertNotApplied();const c=this.changes.get(n);return void 0!==c?Un.resolve(c.document):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Xu{constructor(e,n){this.k=e,this.Jt=n}addEntry(e,n,c){return wh(e).put(hp(n),c)}removeEntry(e,n){const c=wh(e),y=hp(n);return c.delete(y)}updateMetadata(e,n){return this.getMetadata(e).next(c=>(c.byteSize+=n,this.Re(e,c)))}getEntry(e,n){return wh(e).get(hp(n)).next(c=>this.be(n,c))}Pe(e,n){return wh(e).get(hp(n)).next(c=>({document:this.be(n,c),size:Ec(c)}))}getEntries(e,n){let c=gu();return this.ve(e,n,(y,S)=>{const L=this.be(y,S);c=c.insert(y,L)}).next(()=>c)}Ve(e,n){let c=gu(),y=new lo(m.comparator);return this.ve(e,n,(S,L)=>{const te=this.be(S,L);c=c.insert(S,te),y=y.insert(S,Ec(L))}).next(()=>({documents:c,Se:y}))}ve(e,n,c){if(n.isEmpty())return Un.resolve();const y=IDBKeyRange.bound(n.first().path.toArray(),n.last().path.toArray()),S=n.getIterator();let L=S.getNext();return wh(e).jt({range:y},(te,Me,dt)=>{const Rt=m.fromSegments(te);for(;L&&m.comparator(L,Rt)<0;)c(L,null),L=S.getNext();L&&L.isEqual(Rt)&&(c(L,Me),L=S.hasNext()?S.getNext():null),L?dt.Lt(L.path.toArray()):dt.done()}).next(()=>{for(;L;)c(L,null),L=S.hasNext()?S.getNext():null})}getDocumentsMatchingQuery(e,n,c){let y=gu();const S=n.path.length+1,L={};if(c.isEqual(ei.min())){const te=n.path.toArray();L.range=IDBKeyRange.lowerBound(te)}else{const te=n.path.toArray(),Me=Hc(c);L.range=IDBKeyRange.lowerBound([te,Me],!0),L.index=b.collectionReadTimeIndex}return wh(e).jt(L,(te,Me,dt)=>{if(te.length!==S)return;const Rt=Jp(this.k,Me);n.path.isPrefixOf(Rt.key.path)?Il(n,Rt)&&(y=y.insert(Rt.key,Rt)):dt.done()}).next(()=>y)}newChangeBuffer(e){return new wg(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return tm(e).get(I.key).next(n=>(J(!!n),n))}Re(e,n){return tm(e).put(I.key,n)}be(e,n){if(n){const c=Jp(this.k,n);if(!c.isNoDocument()||!c.version.isEqual(ei.min()))return c}return tn.newInvalidDocument(e)}}class wg extends cp{constructor(e,n){super(),this.De=e,this.trackRemovals=n,this.Ce=new Dd(c=>c.toString(),(c,y)=>c.isEqual(y))}applyChanges(e){const n=[];let c=0,y=new Go((S,L)=>Jr(S.canonicalString(),L.canonicalString()));return this.changes.forEach((S,L)=>{const te=this.Ce.get(S);if(L.document.isValidDocument()){const Me=Xp(this.De.k,L.document,this.getReadTime(S));y=y.add(S.path.popLast()),c+=Ec(Me)-te,n.push(this.De.addEntry(e,S,Me))}else if(c-=te,this.trackRemovals){const Me=Xp(this.De.k,tn.newNoDocument(S,ei.min()),this.getReadTime(S));n.push(this.De.addEntry(e,S,Me))}else n.push(this.De.removeEntry(e,S))}),y.forEach(S=>{n.push(this.De.Jt.addToCollectionParentIndex(e,S))}),n.push(this.De.updateMetadata(e,c)),Un.waitFor(n)}getFromCache(e,n){return this.De.Pe(e,n).next(c=>(this.Ce.set(n,c.size),c.document))}getAllFromCache(e,n){return this.De.Ve(e,n).next(({documents:c,Se:y})=>(y.forEach((S,L)=>{this.Ce.set(S,L)}),c))}}function tm(s){return ru(s,I.store)}function wh(s){return ru(s,b.store)}function hp(s){return s.path.toArray()}class xg{constructor(e){this.k=e}Nt(e,n,c,y){J(c<y&&c>=0&&y<=11);const S=new Al("createOrUpgrade",n);var te;c<1&&y>=1&&(e.createObjectStore(Ps.store),(te=e).createObjectStore(sl.store,{keyPath:sl.keyPath}),te.createObjectStore(cs.store,{keyPath:cs.keyPath,autoIncrement:!0}).createIndex(cs.userMutationsIndex,cs.userMutationsKeyPath,{unique:!0}),te.createObjectStore(tu.store),Lm(e),function(te){te.createObjectStore(b.store)}(e));let L=Un.resolve();return c<3&&y>=3&&(0!==c&&(function(te){te.deleteObjectStore(we.store),te.deleteObjectStore(N.store),te.deleteObjectStore(lt.store)}(e),Lm(e)),L=L.next(()=>function(te){const Me=te.store(lt.store),dt=new lt(0,0,ei.min().toTimestamp(),0);return Me.put(lt.key,dt)}(S))),c<4&&y>=4&&(0!==c&&(L=L.next(()=>function(te,Me){return Me.store(cs.store).Bt().next(dt=>{te.deleteObjectStore(cs.store),te.createObjectStore(cs.store,{keyPath:cs.keyPath,autoIncrement:!0}).createIndex(cs.userMutationsIndex,cs.userMutationsKeyPath,{unique:!0});const Rt=Me.store(cs.store),Kt=dt.map(Cn=>Rt.put(Cn));return Un.waitFor(Kt)})}(e,S))),L=L.next(()=>{!function(te){te.createObjectStore(In.store,{keyPath:In.keyPath})}(e)})),c<5&&y>=5&&(L=L.next(()=>this.Ne(S))),c<6&&y>=6&&(L=L.next(()=>(function(te){te.createObjectStore(I.store)}(e),this.ke(S)))),c<7&&y>=7&&(L=L.next(()=>this.xe(S))),c<8&&y>=8&&(L=L.next(()=>this.$e(e,S))),c<9&&y>=9&&(L=L.next(()=>{(function(te){te.objectStoreNames.contains("remoteDocumentChanges")&&te.deleteObjectStore("remoteDocumentChanges")})(e),function(te){const Me=te.objectStore(b.store);Me.createIndex(b.readTimeIndex,b.readTimeIndexPath,{unique:!1}),Me.createIndex(b.collectionReadTimeIndex,b.collectionReadTimeIndexPath,{unique:!1})}(n)})),c<10&&y>=10&&(L=L.next(()=>this.Oe(S))),c<11&&y>=11&&(L=L.next(()=>{(function(te){te.createObjectStore(ar.store,{keyPath:ar.keyPath})})(e),function(te){te.createObjectStore(Lr.store,{keyPath:Lr.keyPath})}(e)})),L}ke(e){let n=0;return e.store(b.store).jt((c,y)=>{n+=Ec(y)}).next(()=>{const c=new I(n);return e.store(I.store).put(I.key,c)})}Ne(e){const n=e.store(sl.store),c=e.store(cs.store);return n.Bt().next(y=>Un.forEach(y,S=>{const L=IDBKeyRange.bound([S.userId,-1],[S.userId,S.lastAcknowledgedBatchId]);return c.Bt(cs.userMutationsIndex,L).next(te=>Un.forEach(te,Me=>{J(Me.userId===S.userId);const dt=Id(this.k,Me);return qh(e,S.userId,dt).next(()=>{})}))}))}xe(e){const n=e.store(we.store),c=e.store(b.store);return e.store(lt.store).get(lt.key).next(y=>{const S=[];return c.jt((L,te)=>{const Me=new uo(L),dt=[0,la(Me)];S.push(n.get(dt).next(Rt=>Rt?Un.resolve():n.put(new we(0,la(Me),y.highestListenSequenceNumber))))}).next(()=>Un.waitFor(S))})}$e(e,n){e.createObjectStore(Yt.store,{keyPath:Yt.keyPath});const c=n.store(Yt.store),y=new Gh,S=L=>{if(y.add(L)){const te=L.lastSegment(),Me=L.popLast();return c.put({collectionId:te,parent:la(Me)})}};return n.store(b.store).jt({Kt:!0},(L,te)=>{const Me=new uo(L);return S(Me.popLast())}).next(()=>n.store(tu.store).jt({Kt:!0},([L,te,Me],dt)=>{const Rt=Bi(te);return S(Rt.popLast())}))}Oe(e){const n=e.store(N.store);return n.jt((c,y)=>{const S=Td(y),L=ip(this.k,S);return n.put(L)})}}function Lm(s){s.createObjectStore(we.store,{keyPath:we.keyPath}).createIndex(we.documentTargetsIndex,we.documentTargetsKeyPath,{unique:!0}),s.createObjectStore(N.store,{keyPath:N.keyPath}).createIndex(N.queryTargetsIndexName,N.queryTargetsKeyPath,{unique:!0}),s.createObjectStore(lt.store)}const dp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class fp{constructor(e,n,c,y,S,L,te,Me,dt,Rt){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=c,this.Me=S,this.window=L,this.document=te,this.Fe=dt,this.Le=Rt,this.Be=null,this.Ue=!1,this.isPrimary=!1,this.networkEnabled=!0,this.qe=null,this.inForeground=!1,this.Ke=null,this.je=null,this.Qe=Number.NEGATIVE_INFINITY,this.We=Kt=>Promise.resolve(),!fp.Pt())throw new at(Ne.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ff(this,y),this.Ge=n+"main",this.k=new rp(Me),this.ze=new nu(this.Ge,11,new xg(this.k)),this.He=new Wh(this.referenceDelegate,this.k),this.Jt=new op,this.Je=new Xu(this.k,this.Jt),this.Ye=new vh,this.window&&this.window.localStorage?this.Xe=this.window.localStorage:(this.Xe=null,!1===Rt&&Mi("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ze().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new at(Ne.FAILED_PRECONDITION,dp);return this.tn(),this.en(),this.nn(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.He.getHighestSequenceNumber(e))}).then(e=>{this.Be=new Wr(e,this.Fe)}).then(()=>{this.Ue=!0}).catch(e=>(this.ze&&this.ze.close(),Promise.reject(e)))}sn(e){var n=this;return this.We=function(){var c=(0,he.Z)(function*(y){if(n.started)return e(y)});return function(y){return c.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ze.xt(function(){var n=(0,he.Z)(function*(c){null===c.newVersion&&(yield e())});return function(c){return n.apply(this,arguments)}}())}setNetworkEnabled(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Me.enqueueAndForget((0,he.Z)(function*(){n.started&&(yield n.Ze())})))}Ze(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>pf(e).put(new In(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.rn(e).next(n=>{n||(this.isPrimary=!1,this.Me.enqueueRetryable(()=>this.We(!1)))})}).next(()=>this.on(e)).next(n=>this.isPrimary&&!n?this.cn(e).next(()=>!1):!!n&&this.an(e).next(()=>!0))).catch(e=>{if(Ju(e))return Zn("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Zn("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Me.enqueueRetryable(()=>this.We(e)),this.isPrimary=e})}rn(e){return Ad(e).get(Ps.key).next(n=>Un.resolve(this.un(n)))}hn(e){return pf(e).delete(this.clientId)}ln(){var e=this;return(0,he.Z)(function*(){if(e.isPrimary&&!e.fn(e.Qe,18e5)){e.Qe=Date.now();const n=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",c=>{const y=ru(c,In.store);return y.Bt().next(S=>{const L=e.dn(S,18e5),te=S.filter(Me=>-1===L.indexOf(Me));return Un.forEach(te,Me=>y.delete(Me.clientId)).next(()=>te)})}).catch(()=>[]);if(e.Xe)for(const c of n)e.Xe.removeItem(e.wn(c.clientId))}})()}nn(){this.je=this.Me.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ze().then(()=>this.ln()).then(()=>this.nn()))}un(e){return!!e&&e.ownerId===this.clientId}on(e){return this.Le?Un.resolve(!0):Ad(e).get(Ps.key).next(n=>{if(null!==n&&this.fn(n.leaseTimestampMs,5e3)&&!this._n(n.ownerId)){if(this.un(n)&&this.networkEnabled)return!0;if(!this.un(n)){if(!n.allowTabSynchronization)throw new at(Ne.FAILED_PRECONDITION,dp);return!1}}return!(!this.networkEnabled||!this.inForeground)||pf(e).Bt().next(c=>void 0===this.dn(c,5e3).find(y=>{if(this.clientId!==y.clientId){const L=!this.inForeground&&y.inForeground,te=this.networkEnabled===y.networkEnabled;if(!this.networkEnabled&&y.networkEnabled||L&&te)return!0}return!1}))}).next(n=>(this.isPrimary!==n&&Zn("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){var e=this;return(0,he.Z)(function*(){e.Ue=!1,e.mn(),e.je&&(e.je.cancel(),e.je=null),e.gn(),e.yn(),yield e.ze.runTransaction("shutdown","readwrite",[Ps.store,In.store],n=>{const c=new wd(n,Wr.I);return e.cn(c).next(()=>e.hn(c))}),e.ze.close(),e.pn()})()}dn(e,n){return e.filter(c=>this.fn(c.updateTimeMs,n)&&!this._n(c.clientId))}Tn(){return this.runTransaction("getActiveClients","readonly",e=>pf(e).Bt().next(n=>this.dn(n,18e5).map(c=>c.clientId)))}get started(){return this.Ue}getMutationQueue(e){return Cd.Xt(e,this.k,this.Jt,this.referenceDelegate)}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getIndexManager(){return this.Jt}getBundleCache(){return this.Ye}runTransaction(e,n,c){let S;return Zn("IndexedDbPersistence","Starting transaction:",e),this.ze.runTransaction(e,"readonly"===n?"readonly":"readwrite",ai,L=>(S=new wd(L,this.Be?this.Be.next():Wr.I),"readwrite-primary"===n?this.rn(S).next(te=>!!te||this.on(S)).next(te=>{if(!te)throw Mi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Me.enqueueRetryable(()=>this.We(!1)),new at(Ne.FAILED_PRECONDITION,Xr);return c(S)}).next(te=>this.an(S).next(()=>te)):this.En(S).next(()=>c(S)))).then(L=>(S.raiseOnCommittedEvent(),L))}En(e){return Ad(e).get(Ps.key).next(n=>{if(null!==n&&this.fn(n.leaseTimestampMs,5e3)&&!this._n(n.ownerId)&&!this.un(n)&&!(this.Le||this.allowTabSynchronization&&n.allowTabSynchronization))throw new at(Ne.FAILED_PRECONDITION,dp)})}an(e){const n=new Ps(this.clientId,this.allowTabSynchronization,Date.now());return Ad(e).put(Ps.key,n)}static Pt(){return nu.Pt()}cn(e){const n=Ad(e);return n.get(Ps.key).next(c=>this.un(c)?(Zn("IndexedDbPersistence","Releasing primary lease."),n.delete(Ps.key)):Un.resolve())}fn(e,n){const c=Date.now();return!(e<c-n||e>c&&(Mi(`Detected an update time that is in the future: ${e} > ${c}`),1))}tn(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ke=()=>{this.Me.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ze()))},this.document.addEventListener("visibilitychange",this.Ke),this.inForeground="visible"===this.document.visibilityState)}gn(){this.Ke&&(this.document.removeEventListener("visibilitychange",this.Ke),this.Ke=null)}en(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.qe=()=>{this.mn(),(0,W.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Me.enterRestrictedMode(!0),this.Me.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.qe))}yn(){this.qe&&(this.window.removeEventListener("pagehide",this.qe),this.qe=null)}_n(e){var n;try{const c=null!==(null===(n=this.Xe)||void 0===n?void 0:n.getItem(this.wn(e)));return Zn("IndexedDbPersistence",`Client '${e}' ${c?"is":"is not"} zombied in LocalStorage`),c}catch(c){return Mi("IndexedDbPersistence","Failed to get zombied client id.",c),!1}}mn(){if(this.Xe)try{this.Xe.setItem(this.wn(this.clientId),String(Date.now()))}catch(e){Mi("Failed to set zombie client id.",e)}}pn(){if(this.Xe)try{this.Xe.removeItem(this.wn(this.clientId))}catch(e){}}wn(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ad(s){return ru(s,Ps.store)}function pf(s){return ru(s,In.store)}function Ii(s,e){let n=s.projectId;return s.isDefaultDatabase||(n+="."+s.database),"firestore/"+e+"/"+n+"/"}class mf{constructor(e,n){this.progress=e,this.In=n}}class qc{constructor(e,n,c){this.Je=e,this.An=n,this.Jt=c}Rn(e,n){return this.An.getAllMutationBatchesAffectingDocumentKey(e,n).next(c=>this.bn(e,n,c))}bn(e,n,c){return this.Je.getEntry(e,n).next(y=>{for(const S of c)S.applyToLocalView(y);return y})}Pn(e,n){e.forEach((c,y)=>{for(const S of n)S.applyToLocalView(y)})}vn(e,n){return this.Je.getEntries(e,n).next(c=>this.Vn(e,c).next(()=>c))}Vn(e,n){return this.An.getAllMutationBatchesAffectingDocumentKeys(e,n).next(c=>this.Pn(n,c))}getDocumentsMatchingQuery(e,n,c){return m.isDocumentKey((y=n).path)&&null===y.collectionGroup&&0===y.filters.length?this.Sn(e,n.path):Ys(n)?this.Dn(e,n,c):this.Cn(e,n,c);var y}Sn(e,n){return this.Rn(e,new m(n)).next(c=>{let y=hh();return c.isFoundDocument()&&(y=y.insert(c.key,c)),y})}Dn(e,n,c){const y=n.collectionGroup;let S=hh();return this.Jt.getCollectionParents(e,y).next(L=>Un.forEach(L,te=>{const Me=(dt=n,Rt=te.child(y),new Ei(Rt,null,dt.explicitOrderBy.slice(),dt.filters.slice(),dt.limit,dt.limitType,dt.startAt,dt.endAt));var dt,Rt;return this.Cn(e,Me,c).next(dt=>{dt.forEach((Rt,Kt)=>{S=S.insert(Rt,Kt)})})}).next(()=>S))}Cn(e,n,c){let y,S;return this.Je.getDocumentsMatchingQuery(e,n,c).next(L=>(y=L,this.An.getAllMutationBatchesAffectingQuery(e,n))).next(L=>(S=L,this.Nn(e,S,y).next(te=>{y=te;for(const Me of S)for(const dt of Me.mutations){const Rt=dt.key;let Kt=y.get(Rt);null==Kt&&(Kt=tn.newInvalidDocument(Rt),y=y.insert(Rt,Kt)),pc(dt,Kt,Me.localWriteTime),Kt.isFoundDocument()||(y=y.remove(Rt))}}))).next(()=>(y.forEach((L,te)=>{Il(n,te)||(y=y.remove(L))}),y))}Nn(e,n,c){let y=Oo();for(const L of n)for(const te of L.mutations)te instanceof mu&&null===c.get(te.key)&&(y=y.add(te.key));let S=c;return this.Je.getEntries(e,y).next(L=>(L.forEach((te,Me)=>{Me.isFoundDocument()&&(S=S.insert(te,Me))}),S))}}class Md{constructor(e,n,c,y){this.targetId=e,this.fromCache=n,this.kn=c,this.xn=y}static $n(e,n){let c=Oo(),y=Oo();for(const S of n.docChanges)switch(S.type){case 0:c=c.add(S.doc.key);break;case 1:y=y.add(S.doc.key)}return new Md(e,n.fromCache,c,y)}}class Tc{On(e){this.Mn=e}getDocumentsMatchingQuery(e,n,c,y){return 0===(S=n).filters.length&&null===S.limit&&null==S.startAt&&null==S.endAt&&(0===S.explicitOrderBy.length||1===S.explicitOrderBy.length&&S.explicitOrderBy[0].field.isKeyField())||c.isEqual(ei.min())?this.Fn(e,n):this.Mn.vn(e,y).next(S=>{const L=this.Ln(n,S);return(vo(n)||Xa(n))&&this.Bn(n.limitType,L,y,c)?this.Fn(e,n):(bl()<=j.in.DEBUG&&Zn("QueryEngine","Re-using previous result from %s to execute query: %s",c.toString(),Wu(n)),this.Mn.getDocumentsMatchingQuery(e,n,c).next(te=>(L.forEach(Me=>{te=te.insert(Me.key,Me)}),te)))});var S}Ln(e,n){let c=new Go(Zu(e));return n.forEach((y,S)=>{Il(e,S)&&(c=c.add(S))}),c}Bn(e,n,c,y){if(c.size!==n.size)return!0;const S="F"===e?n.last():n.first();return!!S&&(S.hasPendingWrites||S.version.compareTo(y)>0)}Fn(e,n){return bl()<=j.in.DEBUG&&Zn("QueryEngine","Using full collection scan to execute query:",Wu(n)),this.Mn.getDocumentsMatchingQuery(e,n,ei.min())}}class Vl{constructor(e,n,c,y){this.persistence=e,this.Un=n,this.k=y,this.qn=new lo(Jr),this.Kn=new Dd(S=>Rn(S),Vn),this.jn=ei.min(),this.An=e.getMutationQueue(c),this.Qn=e.getRemoteDocumentCache(),this.He=e.getTargetCache(),this.Wn=new qc(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=e.getBundleCache(),this.Un.On(this.Wn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.qn))}}function Rs(s,e,n,c){return new Vl(s,e,n,c)}function qo(s,e){return Pd.apply(this,arguments)}function Pd(){return Pd=(0,he.Z)(function*(s,e){const n=De(s);let c=n.An,y=n.Wn;const S=yield n.persistence.runTransaction("Handle user change","readonly",L=>{let te;return n.An.getAllMutationBatches(L).next(Me=>(te=Me,c=n.persistence.getMutationQueue(e),y=new qc(n.Qn,c,n.persistence.getIndexManager()),c.getAllMutationBatches(L))).next(Me=>{const dt=[],Rt=[];let Kt=Oo();for(const Cn of te){dt.push(Cn.batchId);for(const nr of Cn.mutations)Kt=Kt.add(nr.key)}for(const Cn of Me){Rt.push(Cn.batchId);for(const nr of Cn.mutations)Kt=Kt.add(nr.key)}return y.vn(L,Kt).next(Cn=>({Gn:Cn,removedBatchIds:dt,addedBatchIds:Rt}))})});return n.An=c,n.Wn=y,n.Un.On(n.Wn),S}),Pd.apply(this,arguments)}function Sc(s,e){const n=De(s);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",c=>{const y=e.batch.keys(),S=n.Qn.newChangeBuffer({trackRemovals:!0});return function(L,te,Me,dt){const Rt=Me.batch,Kt=Rt.keys();let Cn=Un.resolve();return Kt.forEach(nr=>{Cn=Cn.next(()=>dt.getEntry(te,nr)).next(fr=>{const $r=Me.docVersions.get(nr);J(null!==$r),fr.version.compareTo($r)<0&&(Rt.applyToRemoteDocument(fr,Me),fr.isValidDocument()&&dt.addEntry(fr,Me.commitVersion))})}),Cn.next(()=>L.An.removeMutationBatch(te,Rt))}(n,c,e,S).next(()=>S.apply(c)).next(()=>n.An.performConsistencyCheck(c)).next(()=>n.Wn.vn(c,y))})}function gf(s){const e=De(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.He.getLastRemoteSnapshotVersion(n))}function nm(s,e){const n=De(s),c=e.snapshotVersion;let y=n.qn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",S=>{const L=n.Qn.newChangeBuffer({trackRemovals:!0});y=n.qn;const te=[];e.targetChanges.forEach((dt,Rt)=>{const Kt=y.get(Rt);if(!Kt)return;te.push(n.He.removeMatchingKeys(S,dt.removedDocuments,Rt).next(()=>n.He.addMatchingKeys(S,dt.addedDocuments,Rt)));let Cn=Kt.withSequenceNumber(S.currentSequenceNumber);var nr,fr,$r;e.targetMismatches.has(Rt)?Cn=Cn.withResumeToken(no.EMPTY_BYTE_STRING,ei.min()).withLastLimboFreeSnapshotVersion(ei.min()):dt.resumeToken.approximateByteSize()>0&&(Cn=Cn.withResumeToken(dt.resumeToken,c)),y=y.insert(Rt,Cn),fr=Cn,$r=dt,(0===(nr=Kt).resumeToken.approximateByteSize()||fr.snapshotVersion.toMicroseconds()-nr.snapshotVersion.toMicroseconds()>=3e8||$r.addedDocuments.size+$r.modifiedDocuments.size+$r.removedDocuments.size>0)&&te.push(n.He.updateTargetData(S,Cn))});let Me=gu();if(e.documentUpdates.forEach((dt,Rt)=>{e.resolvedLimboDocuments.has(dt)&&te.push(n.persistence.referenceDelegate.updateLimboDocument(S,dt))}),te.push(yf(S,L,e.documentUpdates,c,void 0).next(dt=>{Me=dt})),!c.isEqual(ei.min())){const dt=n.He.getLastRemoteSnapshotVersion(S).next(Rt=>n.He.setTargetsMetadata(S,S.currentSequenceNumber,c));te.push(dt)}return Un.waitFor(te).next(()=>L.apply(S)).next(()=>n.Wn.Vn(S,Me)).next(()=>Me)}).then(S=>(n.qn=y,S))}function yf(s,e,n,c,y){let S=Oo();return n.forEach(L=>S=S.add(L)),e.getEntries(s,S).next(L=>{let te=gu();return n.forEach((Me,dt)=>{const Rt=L.get(Me),Kt=(null==y?void 0:y.get(Me))||c;dt.isNoDocument()&&dt.version.isEqual(ei.min())?(e.removeEntry(Me,Kt),te=te.insert(Me,dt)):!Rt.isValidDocument()||dt.version.compareTo(Rt.version)>0||0===dt.version.compareTo(Rt.version)&&Rt.hasPendingWrites?(e.addEntry(dt,Kt),te=te.insert(Me,dt)):Zn("LocalStore","Ignoring outdated watch update for ",Me,". Current version:",Rt.version," Watch version:",dt.version)}),te})}function Nm(s,e){const n=De(s);return n.persistence.runTransaction("Get next mutation batch","readonly",c=>(void 0===e&&(e=-1),n.An.getNextMutationBatchAfterBatchId(c,e)))}function Pl(s,e){const n=De(s);return n.persistence.runTransaction("Allocate target","readwrite",c=>{let y;return n.He.getTargetData(c,e).next(S=>S?(y=S,Un.resolve(y)):n.He.allocateTargetId(c).next(L=>(y=new xc(e,L,0,c.currentSequenceNumber),n.He.addTargetData(c,y).next(()=>y))))}).then(c=>{const y=n.qn.get(c.targetId);return(null===y||c.snapshotVersion.compareTo(y.snapshotVersion)>0)&&(n.qn=n.qn.insert(c.targetId,c),n.Kn.set(e,c.targetId)),c})}function Ql(s,e,n){return Xh.apply(this,arguments)}function Xh(){return Xh=(0,he.Z)(function*(s,e,n){const c=De(s),y=c.qn.get(e),S=n?"readwrite":"readwrite-primary";try{n||(yield c.persistence.runTransaction("Release target",S,L=>c.persistence.referenceDelegate.removeTarget(L,y)))}catch(L){if(!Ju(L))throw L;Zn("LocalStore",`Failed to update sequence numbers for target ${e}: ${L}`)}c.qn=c.qn.remove(e),c.Kn.delete(y.target)}),Xh.apply(this,arguments)}function ts(s,e,n){const c=De(s);let y=ei.min(),S=Oo();return c.persistence.runTransaction("Execute query","readonly",L=>function(te,Me,dt){const Rt=De(te),Kt=Rt.Kn.get(dt);return void 0!==Kt?Un.resolve(Rt.qn.get(Kt)):Rt.He.getTargetData(Me,dt)}(c,L,Ia(e)).next(te=>{if(te)return y=te.lastLimboFreeSnapshotVersion,c.He.getMatchingKeysForTargetId(L,te.targetId).next(Me=>{S=Me})}).next(()=>c.Un.getDocumentsMatchingQuery(L,e,n?y:ei.min(),n?S:Oo())).next(te=>({documents:te,zn:S})))}function xh(s,e){const n=De(s),c=De(n.He),y=n.qn.get(e);return y?Promise.resolve(y.target):n.persistence.runTransaction("Get target data","readonly",S=>c.Et(S,e).next(L=>L?L.target:null))}function jl(s){const e=De(s);return e.persistence.runTransaction("Get new document changes","readonly",n=>function(c,y,S){const L=De(c);let te=gu(),Me=Hc(S);const dt=wh(y),Rt=IDBKeyRange.lowerBound(Me,!0);return dt.jt({index:b.readTimeIndex,range:Rt},(Kt,Cn)=>{const nr=Jp(L.k,Cn);te=te.insert(nr.key,nr),Me=Cn.readTime}).next(()=>({In:te,readTime:Ed(Me)}))}(e.Qn,n,e.jn)).then(({In:n,readTime:c})=>(e.jn=c,n))}function _f(){return _f=(0,he.Z)(function*(s){const e=De(s);return e.persistence.runTransaction("Synchronize last document change read time","readonly",n=>function(c){const y=wh(c);let S=ei.min();return y.jt({index:b.readTimeIndex,reverse:!0},(L,te,Me)=>{te.readTime&&(S=Ed(te.readTime)),Me.done()}).next(()=>S)}(n)).then(n=>{e.jn=n})}),_f.apply(this,arguments)}function Eh(){return Eh=(0,he.Z)(function*(s,e,n,c){const y=De(s);let S=Oo(),L=gu(),te=gc();for(const Rt of n){const Kt=e.Hn(Rt.metadata.name);Rt.document&&(S=S.add(Kt)),L=L.insert(Kt,e.Jn(Rt)),te=te.insert(Kt,e.Yn(Rt.metadata.readTime))}const Me=y.Qn.newChangeBuffer({trackRemovals:!0}),dt=yield Pl(y,(Rt=c,Ia(ko(uo.fromString(`__bundle__/docs/${Rt}`)))));var Rt;return y.persistence.runTransaction("Apply bundle documents","readwrite",Rt=>yf(Rt,Me,L,ei.min(),te).next(Kt=>(Me.apply(Rt),Kt)).next(Kt=>y.He.removeMatchingKeysForTargetId(Rt,dt.targetId).next(()=>y.He.addMatchingKeys(Rt,S,dt.targetId)).next(()=>y.Wn.Vn(Rt,Kt)).next(()=>Kt)))}),Eh.apply(this,arguments)}function Wc(s,e){return pp.apply(this,arguments)}function pp(){return pp=(0,he.Z)(function*(s,e,n=Oo()){const c=yield Pl(s,Ia(cf(e.bundledQuery))),y=De(s);return y.persistence.runTransaction("Save named query","readwrite",S=>{const L=Da(e.readTime);if(c.snapshotVersion.compareTo(L)>=0)return y.Ye.saveNamedQuery(S,e);const te=c.withResumeToken(no.EMPTY_BYTE_STRING,L);return y.qn=y.qn.insert(te.targetId,te),y.He.updateTargetData(S,te).next(()=>y.He.removeMatchingKeysForTargetId(S,c.targetId)).next(()=>y.He.addMatchingKeys(S,n,c.targetId)).next(()=>y.Ye.saveNamedQuery(S,e))})}),pp.apply(this,arguments)}class im{constructor(e){this.k=e,this.Xn=new Map,this.Zn=new Map}getBundleMetadata(e,n){return Un.resolve(this.Xn.get(n))}saveBundleMetadata(e,n){var c;return this.Xn.set(n.id,{id:(c=n).id,version:c.version,createTime:Da(c.createTime)}),Un.resolve()}getNamedQuery(e,n){return Un.resolve(this.Zn.get(n))}saveNamedQuery(e,n){return this.Zn.set(n.name,{name:(c=n).name,query:cf(c.bundledQuery),readTime:Da(c.readTime)}),Un.resolve();var c}}class Fm{constructor(){this.ts=new Go(io.es),this.ns=new Go(io.ss)}isEmpty(){return this.ts.isEmpty()}addReference(e,n){const c=new io(e,n);this.ts=this.ts.add(c),this.ns=this.ns.add(c)}rs(e,n){e.forEach(c=>this.addReference(c,n))}removeReference(e,n){this.os(new io(e,n))}cs(e,n){e.forEach(c=>this.removeReference(c,n))}us(e){const n=new m(new uo([])),c=new io(n,e),y=new io(n,e+1),S=[];return this.ns.forEachInRange([c,y],L=>{this.os(L),S.push(L.key)}),S}hs(){this.ts.forEach(e=>this.os(e))}os(e){this.ts=this.ts.delete(e),this.ns=this.ns.delete(e)}ls(e){const n=new m(new uo([])),c=new io(n,e),y=new io(n,e+1);let S=Oo();return this.ns.forEachInRange([c,y],L=>{S=S.add(L.key)}),S}containsKey(e){const n=new io(e,0),c=this.ts.firstAfterOrEqual(n);return null!==c&&e.isEqual(c.key)}}class io{constructor(e,n){this.key=e,this.fs=n}static es(e,n){return m.comparator(e.key,n.key)||Jr(e.fs,n.fs)}static ss(e,n){return Jr(e.fs,n.fs)||m.comparator(e.key,n.key)}}class Qh{constructor(e,n){this.Jt=e,this.referenceDelegate=n,this.An=[],this.ds=1,this.ws=new Go(io.es)}checkEmpty(e){return Un.resolve(0===this.An.length)}addMutationBatch(e,n,c,y){const S=this.ds;this.ds++;const L=new $h(S,n,c,y);this.An.push(L);for(const te of y)this.ws=this.ws.add(new io(te.key,S)),this.Jt.addToCollectionParentIndex(e,te.key.path.popLast());return Un.resolve(L)}lookupMutationBatch(e,n){return Un.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const y=this.gs(n+1),S=y<0?0:y;return Un.resolve(this.An.length>S?this.An[S]:null)}getHighestUnacknowledgedBatchId(){return Un.resolve(0===this.An.length?-1:this.ds-1)}getAllMutationBatches(e){return Un.resolve(this.An.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const c=new io(n,0),y=new io(n,Number.POSITIVE_INFINITY),S=[];return this.ws.forEachInRange([c,y],L=>{const te=this._s(L.fs);S.push(te)}),Un.resolve(S)}getAllMutationBatchesAffectingDocumentKeys(e,n){let c=new Go(Jr);return n.forEach(y=>{const S=new io(y,0),L=new io(y,Number.POSITIVE_INFINITY);this.ws.forEachInRange([S,L],te=>{c=c.add(te.fs)})}),Un.resolve(this.ys(c))}getAllMutationBatchesAffectingQuery(e,n){const c=n.path,y=c.length+1;let S=c;m.isDocumentKey(S)||(S=S.child(""));const L=new io(new m(S),0);let te=new Go(Jr);return this.ws.forEachWhile(Me=>{const dt=Me.key.path;return!!c.isPrefixOf(dt)&&(dt.length===y&&(te=te.add(Me.fs)),!0)},L),Un.resolve(this.ys(te))}ys(e){const n=[];return e.forEach(c=>{const y=this._s(c);null!==y&&n.push(y)}),n}removeMutationBatch(e,n){J(0===this.ps(n.batchId,"removed")),this.An.shift();let c=this.ws;return Un.forEach(n.mutations,y=>{const S=new io(y.key,n.batchId);return c=c.delete(S),this.referenceDelegate.markPotentiallyOrphaned(e,y.key)}).next(()=>{this.ws=c})}ee(e){}containsKey(e,n){const c=new io(n,0),y=this.ws.firstAfterOrEqual(c);return Un.resolve(n.isEqual(y&&y.key))}performConsistencyCheck(e){return Un.resolve()}ps(e,n){return this.gs(e)}gs(e){return 0===this.An.length?0:e-this.An[0].batchId}_s(e){const n=this.gs(e);return n<0||n>=this.An.length?null:this.An[n]}}class om{constructor(e,n){this.Jt=e,this.Ts=n,this.docs=new lo(m.comparator),this.size=0}addEntry(e,n,c){const y=n.key,S=this.docs.get(y),L=S?S.size:0,te=this.Ts(n);return this.docs=this.docs.insert(y,{document:n.mutableCopy(),size:te,readTime:c}),this.size+=te-L,this.Jt.addToCollectionParentIndex(e,y.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const c=this.docs.get(n);return Un.resolve(c?c.document.mutableCopy():tn.newInvalidDocument(n))}getEntries(e,n){let c=gu();return n.forEach(y=>{const S=this.docs.get(y);c=c.insert(y,S?S.document.mutableCopy():tn.newInvalidDocument(y))}),Un.resolve(c)}getDocumentsMatchingQuery(e,n,c){let y=gu();const S=new m(n.path.child("")),L=this.docs.getIteratorFrom(S);for(;L.hasNext();){const{key:te,value:{document:Me,readTime:dt}}=L.getNext();if(!n.path.isPrefixOf(te.path))break;dt.compareTo(c)<=0||Il(n,Me)&&(y=y.insert(Me.key,Me.mutableCopy()))}return Un.resolve(y)}Es(e,n){return Un.forEach(this.docs,c=>n(c))}newChangeBuffer(e){return new t(this)}getSize(e){return Un.resolve(this.size)}}class t extends cp{constructor(e){super(),this.De=e}applyChanges(e){const n=[];return this.changes.forEach((c,y)=>{y.document.isValidDocument()?n.push(this.De.addEntry(e,y.document,this.getReadTime(c))):this.De.removeEntry(c)}),Un.waitFor(n)}getFromCache(e,n){return this.De.getEntry(e,n)}getAllFromCache(e,n){return this.De.getEntries(e,n)}}class i{constructor(e){this.persistence=e,this.Is=new Dd(n=>Rn(n),Vn),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this.As=0,this.Rs=new Fm,this.targetCount=0,this.bs=Ic.ie()}forEachTarget(e,n){return this.Is.forEach((c,y)=>n(y)),Un.resolve()}getLastRemoteSnapshotVersion(e){return Un.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Un.resolve(this.As)}allocateTargetId(e){return this.highestTargetId=this.bs.next(),Un.resolve(this.highestTargetId)}setTargetsMetadata(e,n,c){return c&&(this.lastRemoteSnapshotVersion=c),n>this.As&&(this.As=n),Un.resolve()}ae(e){this.Is.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.bs=new Ic(n),this.highestTargetId=n),e.sequenceNumber>this.As&&(this.As=e.sequenceNumber)}addTargetData(e,n){return this.ae(n),this.targetCount+=1,Un.resolve()}updateTargetData(e,n){return this.ae(n),Un.resolve()}removeTargetData(e,n){return this.Is.delete(n.target),this.Rs.us(n.targetId),this.targetCount-=1,Un.resolve()}removeTargets(e,n,c){let y=0;const S=[];return this.Is.forEach((L,te)=>{te.sequenceNumber<=n&&null===c.get(te.targetId)&&(this.Is.delete(L),S.push(this.removeMatchingKeysForTargetId(e,te.targetId)),y++)}),Un.waitFor(S).next(()=>y)}getTargetCount(e){return Un.resolve(this.targetCount)}getTargetData(e,n){const c=this.Is.get(n)||null;return Un.resolve(c)}addMatchingKeys(e,n,c){return this.Rs.rs(n,c),Un.resolve()}removeMatchingKeys(e,n,c){this.Rs.cs(n,c);const y=this.persistence.referenceDelegate,S=[];return y&&n.forEach(L=>{S.push(y.markPotentiallyOrphaned(e,L))}),Un.waitFor(S)}removeMatchingKeysForTargetId(e,n){return this.Rs.us(n),Un.resolve()}getMatchingKeysForTargetId(e,n){const c=this.Rs.ls(n);return Un.resolve(c)}containsKey(e,n){return Un.resolve(this.Rs.containsKey(n))}}class u{constructor(e,n){this.Ps={},this.Be=new Wr(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=e(this),this.He=new i(this),this.Jt=new Om,this.Je=new om(this.Jt,c=>this.referenceDelegate.vs(c)),this.k=new rp(n),this.Ye=new im(this.k)}start(){return Promise.resolve()}shutdown(){return this.Ue=!1,Promise.resolve()}get started(){return this.Ue}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Jt}getMutationQueue(e){let n=this.Ps[e.toKey()];return n||(n=new Qh(this.Jt,this.referenceDelegate),this.Ps[e.toKey()]=n),n}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getBundleCache(){return this.Ye}runTransaction(e,n,c){Zn("MemoryPersistence","Starting transaction:",e);const y=new p(this.Be.next());return this.referenceDelegate.Vs(),c(y).next(S=>this.referenceDelegate.Ss(y).next(()=>S)).toPromise().then(S=>(y.raiseOnCommittedEvent(),S))}Ds(e,n){return Un.or(Object.values(this.Ps).map(c=>()=>c.containsKey(e,n)))}}class p extends Qs{constructor(e){super(),this.currentSequenceNumber=e}}class v{constructor(e){this.persistence=e,this.Cs=new Fm,this.Ns=null}static ks(e){return new v(e)}get xs(){if(this.Ns)return this.Ns;throw M()}addReference(e,n,c){return this.Cs.addReference(c,n),this.xs.delete(c.toString()),Un.resolve()}removeReference(e,n,c){return this.Cs.removeReference(c,n),this.xs.add(c.toString()),Un.resolve()}markPotentiallyOrphaned(e,n){return this.xs.add(n.toString()),Un.resolve()}removeTarget(e,n){this.Cs.us(n.targetId).forEach(y=>this.xs.add(y.toString()));const c=this.persistence.getTargetCache();return c.getMatchingKeysForTargetId(e,n.targetId).next(y=>{y.forEach(S=>this.xs.add(S.toString()))}).next(()=>c.removeTargetData(e,n))}Vs(){this.Ns=new Set}Ss(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Un.forEach(this.xs,c=>{const y=m.fromPath(c);return this.$s(e,y).next(S=>{S||n.removeEntry(y)})}).next(()=>(this.Ns=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(c=>{c?this.xs.delete(n.toString()):this.xs.add(n.toString())})}vs(e){return 0}$s(e,n){return Un.or([()=>Un.resolve(this.Cs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ds(e,n)])}}function x(s,e){return`firestore_clients_${s}_${e}`}function C(s,e,n){let c=`firestore_mutations_${s}_${n}`;return e.isAuthenticated()&&(c+=`_${e.uid}`),c}function O(s,e){return`firestore_targets_${s}_${e}`}class K{constructor(e,n,c,y){this.user=e,this.batchId=n,this.state=c,this.error=y}static Os(e,n,c){const y=JSON.parse(c);let S,L="object"==typeof y&&-1!==["pending","acknowledged","rejected"].indexOf(y.state)&&(void 0===y.error||"object"==typeof y.error);return L&&y.error&&(L="string"==typeof y.error.message&&"string"==typeof y.error.code,L&&(S=new at(y.error.code,y.error.message))),L?new K(e,n,y.state,S):(Mi("SharedClientState",`Failed to parse mutation state for ID '${n}': ${c}`),null)}Ms(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ie{constructor(e,n,c){this.targetId=e,this.state=n,this.error=c}static Os(e,n){const c=JSON.parse(n);let y,S="object"==typeof c&&-1!==["not-current","current","rejected"].indexOf(c.state)&&(void 0===c.error||"object"==typeof c.error);return S&&c.error&&(S="string"==typeof c.error.message&&"string"==typeof c.error.code,S&&(y=new at(c.error.code,c.error.message))),S?new ie(e,c.state,y):(Mi("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Ms(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pe{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Os(e,n){const c=JSON.parse(n);let y="object"==typeof c&&c.activeTargetIds instanceof Array,S=yc();for(let L=0;y&&L<c.activeTargetIds.length;++L)y=h(c.activeTargetIds[L]),S=S.add(c.activeTargetIds[L]);return y?new pe(e,S):(Mi("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Ee{constructor(e,n){this.clientId=e,this.onlineState=n}static Os(e){const n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new Ee(n.clientId,n.onlineState):(Mi("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Be{constructor(){this.activeTargetIds=yc()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ls(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ms(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ye{constructor(e,n,c,y,S){this.window=e,this.Me=n,this.persistenceKey=c,this.Bs=y,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Us=this.qs.bind(this),this.Ks=new lo(Jr),this.started=!1,this.js=[];const L=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=S,this.Qs=x(this.persistenceKey,this.Bs),this.Ws=`firestore_sequence_number_${this.persistenceKey}`,this.Ks=this.Ks.insert(this.Bs,new Be),this.Gs=new RegExp(`^firestore_clients_${L}_([^_]*)$`),this.zs=new RegExp(`^firestore_mutations_${L}_(\\d+)(?:_(.*))?$`),this.Hs=new RegExp(`^firestore_targets_${L}_(\\d+)$`),this.Js=`firestore_online_state_${this.persistenceKey}`,this.Ys=function(te){return`firestore_bundle_loaded_${te}`}(this.persistenceKey),this.window.addEventListener("storage",this.Us)}static Pt(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,he.Z)(function*(){const n=yield e.syncEngine.Tn();for(const y of n){if(y===e.Bs)continue;const S=e.getItem(x(e.persistenceKey,y));if(S){const L=pe.Os(y,S);L&&(e.Ks=e.Ks.insert(L.clientId,L))}}e.Xs();const c=e.storage.getItem(e.Js);if(c){const y=e.Zs(c);y&&e.ti(y)}for(const y of e.js)e.qs(y);e.js=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ei(this.Ks)}isActiveQueryTarget(e){let n=!1;return this.Ks.forEach((c,y)=>{y.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.ni(e,"pending")}updateMutationState(e,n,c){this.ni(e,n,c),this.si(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const c=this.storage.getItem(O(this.persistenceKey,e));if(c){const y=ie.Os(e,c);y&&(n=y.state)}}return this.ii.Fs(e),this.Xs(),n}removeLocalQueryTarget(e){this.ii.Ls(e),this.Xs()}isLocalQueryTarget(e){return this.ii.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(O(this.persistenceKey,e))}updateQueryState(e,n,c){this.ri(e,n,c)}handleUserChange(e,n,c){n.forEach(y=>{this.si(y)}),this.currentUser=e,c.forEach(y=>{this.addPendingMutation(y)})}setOnlineState(e){this.oi(e)}notifyBundleLoaded(){this.ci()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Us),this.removeItem(this.Qs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return Zn("SharedClientState","READ",e,n),n}setItem(e,n){Zn("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){Zn("SharedClientState","REMOVE",e),this.storage.removeItem(e)}qs(e){var n=this;const c=e;if(c.storageArea===this.storage){if(Zn("SharedClientState","EVENT",c.key,c.newValue),c.key===this.Qs)return void Mi("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Me.enqueueRetryable((0,he.Z)(function*(){if(n.started){if(null!==c.key)if(n.Gs.test(c.key)){if(null==c.newValue){const y=n.ai(c.key);return n.ui(y,null)}{const y=n.hi(c.key,c.newValue);if(y)return n.ui(y.clientId,y)}}else if(n.zs.test(c.key)){if(null!==c.newValue){const y=n.li(c.key,c.newValue);if(y)return n.fi(y)}}else if(n.Hs.test(c.key)){if(null!==c.newValue){const y=n.di(c.key,c.newValue);if(y)return n.wi(y)}}else if(c.key===n.Js){if(null!==c.newValue){const y=n.Zs(c.newValue);if(y)return n.ti(y)}}else if(c.key===n.Ws){const y=function(S){let L=Wr.I;if(null!=S)try{const te=JSON.parse(S);J("number"==typeof te),L=te}catch(te){Mi("SharedClientState","Failed to read sequence number from WebStorage",te)}return L}(c.newValue);y!==Wr.I&&n.sequenceNumberHandler(y)}else if(c.key===n.Ys)return n.syncEngine._i()}else n.js.push(c)}))}}get ii(){return this.Ks.get(this.Bs)}Xs(){this.setItem(this.Qs,this.ii.Ms())}ni(e,n,c){const y=new K(this.currentUser,e,n,c),S=C(this.persistenceKey,this.currentUser,e);this.setItem(S,y.Ms())}si(e){const n=C(this.persistenceKey,this.currentUser,e);this.removeItem(n)}oi(e){this.storage.setItem(this.Js,JSON.stringify({clientId:this.Bs,onlineState:e}))}ri(e,n,c){const y=O(this.persistenceKey,e),S=new ie(e,n,c);this.setItem(y,S.Ms())}ci(){this.setItem(this.Ys,"value-not-used")}ai(e){const n=this.Gs.exec(e);return n?n[1]:null}hi(e,n){const c=this.ai(e);return pe.Os(c,n)}li(e,n){const c=this.zs.exec(e),y=Number(c[1]);return K.Os(new So(void 0!==c[2]?c[2]:null),y,n)}di(e,n){const c=this.Hs.exec(e),y=Number(c[1]);return ie.Os(y,n)}Zs(e){return Ee.Os(e)}fi(e){var n=this;return(0,he.Z)(function*(){if(e.user.uid===n.currentUser.uid)return n.syncEngine.mi(e.batchId,e.state,e.error);Zn("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}wi(e){return this.syncEngine.gi(e.targetId,e.state,e.error)}ui(e,n){const c=n?this.Ks.insert(e,n):this.Ks.remove(e),y=this.ei(this.Ks),S=this.ei(c),L=[],te=[];return S.forEach(Me=>{y.has(Me)||L.push(Me)}),y.forEach(Me=>{S.has(Me)||te.push(Me)}),this.syncEngine.yi(L,te).then(()=>{this.Ks=c})}ti(e){this.Ks.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ei(e){let n=yc();return e.forEach((c,y)=>{n=n.unionWith(y.activeTargetIds)}),n}}class yt{constructor(){this.pi=new Be,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,c){}addLocalQueryTarget(e){return this.pi.Fs(e),this.Ti[e]||"not-current"}updateQueryState(e,n,c){this.Ti[e]=n}removeLocalQueryTarget(e){this.pi.Ls(e)}isLocalQueryTarget(e){return this.pi.activeTargetIds.has(e)}clearQueryState(e){delete this.Ti[e]}getAllActiveQueryTargets(){return this.pi.activeTargetIds}isActiveQueryTarget(e){return this.pi.activeTargetIds.has(e)}start(){return this.pi=new Be,Promise.resolve()}handleUserChange(e,n,c){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class Et{Ei(e){}shutdown(){}}class Vt{constructor(){this.Ii=()=>this.Ai(),this.Ri=()=>this.bi(),this.Pi=[],this.vi()}Ei(e){this.Pi.push(e)}shutdown(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}vi(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}Ai(){Zn("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Pi)e(0)}bi(){Zn("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Pi)e(1)}static Pt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const At={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Wt{constructor(e){this.Vi=e.Vi,this.Si=e.Si}Di(e){this.Ci=e}Ni(e){this.ki=e}onMessage(e){this.xi=e}close(){this.Si()}send(e){this.Vi(e)}$i(){this.Ci()}Oi(e){this.ki(e)}Mi(e){this.xi(e)}}class rn extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.Fi=(e.ssl?"https":"http")+"://"+e.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Bi(e,n,c,y,S){const L=this.Ui(e,n);Zn("RestConnection","Sending: ",L,c);const te={};return this.qi(te,y,S),this.Ki(e,L,te,c).then(Me=>(Zn("RestConnection","Received: ",Me),Me),Me=>{throw V("RestConnection",`${e} failed with error: `,Me,"url: ",L,"request:",c),Me})}ji(e,n,c,y,S){return this.Bi(e,n,c,y,S)}qi(e,n,c){e["X-Goog-Api-Client"]="gl-js/ fire/"+hu,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((y,S)=>e[S]=y),c&&c.headers.forEach((y,S)=>e[S]=y)}Ui(e,n){return`${this.Fi}/v1/${n}:${At[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}Ki(e,n,c,y){return new Promise((S,L)=>{const te=new qu;te.listenOnce(cu.COMPLETE,()=>{try{switch(te.getLastErrorCode()){case Gu.NO_ERROR:const dt=te.getResponseJson();Zn("Connection","XHR received:",JSON.stringify(dt)),S(dt);break;case Gu.TIMEOUT:Zn("Connection",'RPC "'+e+'" timed out'),L(new at(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case Gu.HTTP_ERROR:const Rt=te.getStatus();if(Zn("Connection",'RPC "'+e+'" failed with status:',Rt,"response text:",te.getResponseText()),Rt>0){const Kt=te.getResponseJson().error;if(Kt&&Kt.status&&Kt.message){const Cn=function(nr){const fr=nr.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(fr)>=0?fr:Ne.UNKNOWN}(Kt.status);L(new at(Cn,Kt.message))}else L(new at(Ne.UNKNOWN,"Server responded with status "+te.getStatus()))}else L(new at(Ne.UNAVAILABLE,"Connection failed."));break;default:M()}}finally{Zn("Connection",'RPC "'+e+'" completed.')}});const Me=JSON.stringify(y);te.send(n,"POST",Me,c,15)})}Qi(e,n,c){const y=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],S=Ba(),L=rr(),te={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(te.xmlHttpFactory=new zs({})),this.qi(te.initMessageHeaders,n,c),(0,W.uI)()||(0,W.b$)()||(0,W.d)()||(0,W.w1)()||(0,W.Mn)()||(0,W.ru)()||(te.httpHeadersOverwriteParam="$httpHeaders");const Me=y.join("");Zn("Connection","Creating WebChannel: "+Me,te);const dt=S.createWebChannel(Me,te);let Rt=!1,Kt=!1;const Cn=new Wt({Vi:fr=>{Kt?Zn("Connection","Not sending because WebChannel is closed:",fr):(Rt||(Zn("Connection","Opening WebChannel transport."),dt.open(),Rt=!0),Zn("Connection","WebChannel sending:",fr),dt.send(fr))},Si:()=>dt.close()}),nr=(fr,$r,Oi)=>{fr.listen($r,da=>{try{Oi(da)}catch(Eu){setTimeout(()=>{throw Eu},0)}})};return nr(dt,Zs.EventType.OPEN,()=>{Kt||Zn("Connection","WebChannel transport opened.")}),nr(dt,Zs.EventType.CLOSE,()=>{Kt||(Kt=!0,Zn("Connection","WebChannel transport closed"),Cn.Oi())}),nr(dt,Zs.EventType.ERROR,fr=>{Kt||(Kt=!0,V("Connection","WebChannel transport errored:",fr),Cn.Oi(new at(Ne.UNAVAILABLE,"The operation could not be completed")))}),nr(dt,Zs.EventType.MESSAGE,fr=>{var $r;if(!Kt){const Oi=fr.data[0];J(!!Oi);const da=Oi,Eu=da.error||(null===($r=da[0])||void 0===$r?void 0:$r.error);if(Eu){Zn("Connection","WebChannel received error:",Eu);const cc=Eu.status;let ws=function(oh){const _g=Ca[oh];if(void 0!==_g)return tf(_g)}(cc),Iu=Eu.message;void 0===ws&&(ws=Ne.INTERNAL,Iu="Unknown error status: "+cc+" with message "+Eu.message),Kt=!0,Cn.Oi(new at(ws,Iu)),dt.close()}else Zn("Connection","WebChannel received:",Oi),Cn.Mi(Oi)}}),nr(L,Ol.STAT_EVENT,fr=>{fr.stat===Ri.PROXY?Zn("Connection","Detected buffering proxy"):fr.stat===Ri.NOPROXY&&Zn("Connection","Detected no buffering proxy")}),setTimeout(()=>{Cn.$i()},0),Cn}}function fn(){return"undefined"!=typeof window?window:null}function cn(){return"undefined"!=typeof document?document:null}function Tn(s){return new _c(s,!0)}class qn{constructor(e,n,c=1e3,y=1.5,S=6e4){this.Me=e,this.timerId=n,this.Wi=c,this.Gi=y,this.zi=S,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}reset(){this.Hi=0}Xi(){this.Hi=this.zi}Zi(e){this.cancel();const n=Math.floor(this.Hi+this.tr()),c=Math.max(0,Date.now()-this.Yi),y=Math.max(0,n-c);y>0&&Zn("ExponentialBackoff",`Backing off for ${y} ms (base delay: ${this.Hi} ms, delay with jitter: ${n} ms, last attempt: ${c} ms ago)`),this.Ji=this.Me.enqueueAfterDelay(this.timerId,y,()=>(this.Yi=Date.now(),e())),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}er(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}cancel(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}tr(){return(Math.random()-.5)*this.Hi}}class ir{constructor(e,n,c,y,S,L,te,Me){this.Me=e,this.nr=c,this.sr=y,this.ir=S,this.authCredentialsProvider=L,this.appCheckCredentialsProvider=te,this.listener=Me,this.state=0,this.rr=0,this.cr=null,this.ar=null,this.stream=null,this.ur=new qn(e,n)}hr(){return 1===this.state||5===this.state||this.lr()}lr(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.dr()}stop(){var e=this;return(0,he.Z)(function*(){e.hr()&&(yield e.close(0))})()}wr(){this.state=0,this.ur.reset()}_r(){this.lr()&&null===this.cr&&(this.cr=this.Me.enqueueAfterDelay(this.nr,6e4,()=>this.mr()))}gr(e){this.yr(),this.stream.send(e)}mr(){var e=this;return(0,he.Z)(function*(){if(e.lr())return e.close(0)})()}yr(){this.cr&&(this.cr.cancel(),this.cr=null)}pr(){this.ar&&(this.ar.cancel(),this.ar=null)}close(e,n){var c=this;return(0,he.Z)(function*(){c.yr(),c.pr(),c.ur.cancel(),c.rr++,4!==e?c.ur.reset():n&&n.code===Ne.RESOURCE_EXHAUSTED?(Mi(n.toString()),Mi("Using maximum backoff delay to prevent overloading the backend."),c.ur.Xi()):n&&n.code===Ne.UNAUTHENTICATED&&3!==c.state&&(c.authCredentialsProvider.invalidateToken(),c.appCheckCredentialsProvider.invalidateToken()),null!==c.stream&&(c.Tr(),c.stream.close(),c.stream=null),c.state=e,yield c.listener.Ni(n)})()}Tr(){}auth(){this.state=1;const e=this.Er(this.rr),n=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([c,y])=>{this.rr===n&&this.Ir(c,y)},c=>{e(()=>{const y=new at(Ne.UNKNOWN,"Fetching auth token failed: "+c.message);return this.Ar(y)})})}Ir(e,n){const c=this.Er(this.rr);this.stream=this.Rr(e,n),this.stream.Di(()=>{c(()=>(this.state=2,this.ar=this.Me.enqueueAfterDelay(this.sr,1e4,()=>(this.lr()&&(this.state=3),Promise.resolve())),this.listener.Di()))}),this.stream.Ni(y=>{c(()=>this.Ar(y))}),this.stream.onMessage(y=>{c(()=>this.onMessage(y))})}dr(){var e=this;this.state=5,this.ur.Zi((0,he.Z)(function*(){e.state=0,e.start()}))}Ar(e){return Zn("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Er(e){return n=>{this.Me.enqueueAndForget(()=>this.rr===e?n():(Zn("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kr extends ir{constructor(e,n,c,y,S,L){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,c,y,L),this.k=S}Rr(e,n){return this.ir.Qi("Listen",e,n)}onMessage(e){this.ur.reset();const n=function _u(s,e){let n;if("targetChange"in e){const c="NO_CHANGE"===(Me=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===Me?1:"REMOVE"===Me?2:"CURRENT"===Me?3:"RESET"===Me?4:M(),y=e.targetChange.targetIds||[],S=function(Me,dt){return Me.C?(J(void 0===dt||"string"==typeof dt),no.fromBase64String(dt||"")):(J(void 0===dt||dt instanceof Uint8Array),no.fromUint8Array(dt||new Uint8Array))}(s,e.targetChange.resumeToken),L=e.targetChange.cause,te=L&&function(Me){const dt=void 0===Me.code?Ne.UNKNOWN:tf(Me.code);return new at(dt,Me.message||"")}(L);n=new zc(c,y,S,te||null)}else if("documentChange"in e){const c=e.documentChange,y=Yl(s,c.document.name),S=Da(c.document.updateTime),L=new Bt({mapValue:{fields:c.document.fields}}),te=tn.newFoundDocument(y,S,L);n=new dh(c.targetIds||[],c.removedTargetIds||[],te.key,te)}else if("documentDelete"in e){const c=e.documentDelete,y=Yl(s,c.document),S=c.readTime?Da(c.readTime):ei.min(),L=tn.newNoDocument(y,S);n=new dh([],c.removedTargetIds||[],L.key,L)}else if("documentRemove"in e){const c=e.documentRemove,y=Yl(s,c.document);n=new dh([],c.removedTargetIds||[],y,null)}else{if(!("filter"in e))return M();{const c=e.filter,S=new Uc(c.count||0);n=new zh(c.targetId,S)}}var Me;return n}(this.k,e),c=function(y){if(!("targetChange"in y))return ei.min();const S=y.targetChange;return S.targetIds&&S.targetIds.length?ei.min():S.readTime?Da(S.readTime):ei.min()}(e);return this.listener.br(n,c)}Pr(e){const n={};n.database=Aa(this.k),n.addTarget=function(y,S){let L;const te=S.target;return L=cr(te)?{documents:bd(y,te)}:{query:ph(y,te)},L.targetId=S.targetId,S.resumeToken.approximateByteSize()>0?L.resumeToken=Jf(y,S.resumeToken):S.snapshotVersion.compareTo(ei.min())>0&&(L.readTime=fh(y,S.snapshotVersion.toTimestamp())),L}(this.k,e);const c=function af(s,e){const n=function(c,y){switch(y){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return M()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);c&&(n.labels=c),this.gr(n)}vr(e){const n={};n.database=Aa(this.k),n.removeTarget=e,this.gr(n)}}class pr extends ir{constructor(e,n,c,y,S,L){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,c,y,L),this.k=S,this.Vr=!1}get Sr(){return this.Vr}start(){this.Vr=!1,this.lastStreamToken=void 0,super.start()}Tr(){this.Vr&&this.Dr([])}Rr(e,n){return this.ir.Qi("Write",e,n)}onMessage(e){if(J(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Vr){this.ur.reset();const n=function Qf(s,e){return s&&s.length>0?(J(void 0!==e),s.map(n=>function(c,y){let S=Da(c.updateTime?c.updateTime:y);return S.isEqual(ei.min())&&(S=Da(y)),new Kp(S,c.transformResults||[])}(n,e))):[]}(e.writeResults,e.commitTime),c=Da(e.commitTime);return this.listener.Cr(c,n)}return J(!e.writeResults||0===e.writeResults.length),this.Vr=!0,this.listener.Nr()}kr(){const e={};e.database=Aa(this.k),this.gr(e)}Dr(e){const n={streamToken:this.lastStreamToken,writes:e.map(c=>vc(this.k,c))};this.gr(n)}}class Ur extends class{}{constructor(e,n,c,y){super(),this.authCredentials=e,this.appCheckCredentials=n,this.ir=c,this.k=y,this.$r=!1}Or(){if(this.$r)throw new at(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}Bi(e,n,c){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([y,S])=>this.ir.Bi(e,n,c,y,S)).catch(y=>{throw"FirebaseError"===y.name?(y.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),y):new at(Ne.UNKNOWN,y.toString())})}ji(e,n,c){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([y,S])=>this.ir.ji(e,n,c,y,S)).catch(y=>{throw"FirebaseError"===y.name?(y.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),y):new at(Ne.UNKNOWN,y.toString())})}terminate(){this.$r=!0}}class mr{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.Mr=0,this.Fr=null,this.Lr=!0}Br(){0===this.Mr&&(this.Ur("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.Fr=null,this.qr("Backend didn't respond within 10 seconds."),this.Ur("Offline"),Promise.resolve())))}Kr(e){"Online"===this.state?this.Ur("Unknown"):(this.Mr++,this.Mr>=1&&(this.jr(),this.qr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Ur("Offline")))}set(e){this.jr(),this.Mr=0,"Online"===e&&(this.Lr=!1),this.Ur(e)}Ur(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}qr(e){const n=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Lr?(Mi(n),this.Lr=!1):Zn("OnlineStateTracker",n)}jr(){null!==this.Fr&&(this.Fr.cancel(),this.Fr=null)}}class ri{constructor(e,n,c,y,S){var L=this;this.localStore=e,this.datastore=n,this.asyncQueue=c,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=S,this.Hr.Ei(te=>{c.enqueueAndForget((0,he.Z)(function*(){var Me;co(L)&&(Zn("RemoteStore","Restarting streams for network reachability change."),yield(Me=(0,he.Z)(function*(dt){const Rt=De(dt);Rt.Gr.add(4),yield ti(Rt),Rt.Jr.set("Unknown"),Rt.Gr.delete(4),yield Nr(Rt)}),function(dt){return Me.apply(this,arguments)})(L))}))}),this.Jr=new mr(c,y)}}function Nr(s){return xr.apply(this,arguments)}function xr(){return xr=(0,he.Z)(function*(s){if(co(s))for(const e of s.zr)yield e(!0)}),xr.apply(this,arguments)}function ti(s){return Kr.apply(this,arguments)}function Kr(){return Kr=(0,he.Z)(function*(s){for(const e of s.zr)yield e(!1)}),Kr.apply(this,arguments)}function yi(s,e){const n=De(s);n.Wr.has(e.targetId)||(n.Wr.set(e.targetId,e),Vo(n)?Wo(n):ec(n).lr()&&Gi(n,e))}function Or(s,e){const n=De(s),c=ec(n);n.Wr.delete(e),c.lr()&&zo(n,e),0===n.Wr.size&&(c.lr()?c._r():co(n)&&n.Jr.set("Unknown"))}function Gi(s,e){s.Yr.X(e.targetId),ec(s).Pr(e)}function zo(s,e){s.Yr.X(e),ec(s).vr(e)}function Wo(s){s.Yr=new rf({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>s.Wr.get(e)||null}),ec(s).start(),s.Jr.Br()}function Vo(s){return co(s)&&!ec(s).hr()&&s.Wr.size>0}function co(s){return 0===De(s).Gr.size}function Zo(s){s.Yr=void 0}function ha(s){return ks.apply(this,arguments)}function ks(){return ks=(0,he.Z)(function*(s){s.Wr.forEach((e,n)=>{Gi(s,e)})}),ks.apply(this,arguments)}function Ou(s,e){return js.apply(this,arguments)}function js(){return js=(0,he.Z)(function*(s,e){Zo(s),Vo(s)?(s.Jr.Kr(e),Wo(s)):s.Jr.set("Unknown")}),js.apply(this,arguments)}function iu(s,e,n){return _s.apply(this,arguments)}function _s(){return _s=(0,he.Z)(function*(s,e,n){if(s.Jr.set("Online"),e instanceof zc&&2===e.state&&e.cause)try{yield(c=(0,he.Z)(function*(y,S){const L=S.cause;for(const te of S.targetIds)y.Wr.has(te)&&(yield y.remoteSyncer.rejectListen(te,L),y.Wr.delete(te),y.Yr.removeTarget(te))}),function(y,S){return c.apply(this,arguments)})(s,e)}catch(c){Zn("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),c),yield Os(s,c)}else if(e instanceof dh?s.Yr.ot(e):e instanceof zh?s.Yr.dt(e):s.Yr.ut(e),!n.isEqual(ei.min()))try{const c=yield gf(s.localStore);n.compareTo(c)>=0&&(yield function(y,S){const L=y.Yr.gt(S);return L.targetChanges.forEach((te,Me)=>{if(te.resumeToken.approximateByteSize()>0){const dt=y.Wr.get(Me);dt&&y.Wr.set(Me,dt.withResumeToken(te.resumeToken,S))}}),L.targetMismatches.forEach(te=>{const Me=y.Wr.get(te);if(!Me)return;y.Wr.set(te,Me.withResumeToken(no.EMPTY_BYTE_STRING,Me.snapshotVersion)),zo(y,te);const dt=new xc(Me.target,te,1,Me.sequenceNumber);Gi(y,dt)}),y.remoteSyncer.applyRemoteEvent(L)}(s,n))}catch(c){Zn("RemoteStore","Failed to raise snapshot:",c),yield Os(s,c)}var c}),_s.apply(this,arguments)}function Os(s,e,n){return Ti.apply(this,arguments)}function Ti(){return Ti=(0,he.Z)(function*(s,e,n){if(!Ju(e))throw e;s.Gr.add(1),yield ti(s),s.Jr.set("Offline"),n||(n=()=>gf(s.localStore)),s.asyncQueue.enqueueRetryable((0,he.Z)(function*(){Zn("RemoteStore","Retrying IndexedDB access"),yield n(),s.Gr.delete(1),yield Nr(s)}))}),Ti.apply(this,arguments)}function Do(s,e){return e().catch(n=>Os(s,n,e))}function ui(s){return Ui.apply(this,arguments)}function Ui(){return Ui=(0,he.Z)(function*(s){const e=De(s),n=Qu(e);let c=e.Qr.length>0?e.Qr[e.Qr.length-1].batchId:-1;for(;Lu(e);)try{const y=yield Nm(e.localStore,c);if(null===y){0===e.Qr.length&&n._r();break}c=y.batchId,wu(e,y)}catch(y){yield Os(e,y)}Ko(e)&&Is(e)}),Ui.apply(this,arguments)}function Lu(s){return co(s)&&s.Qr.length<10}function wu(s,e){s.Qr.push(e);const n=Qu(s);n.lr()&&n.Sr&&n.Dr(e.mutations)}function Ko(s){return co(s)&&!Qu(s).hr()&&s.Qr.length>0}function Is(s){Qu(s).start()}function xu(s){return Zi.apply(this,arguments)}function Zi(){return Zi=(0,he.Z)(function*(s){Qu(s).kr()}),Zi.apply(this,arguments)}function Hl(s){return Nu.apply(this,arguments)}function Nu(){return Nu=(0,he.Z)(function*(s){const e=Qu(s);for(const n of s.Qr)e.Dr(n.mutations)}),Nu.apply(this,arguments)}function Cc(s,e,n){return vs.apply(this,arguments)}function vs(){return vs=(0,he.Z)(function*(s,e,n){const c=s.Qr.shift(),y=xd.from(c,e,n);yield Do(s,()=>s.remoteSyncer.applySuccessfulWrite(y)),yield ui(s)}),vs.apply(this,arguments)}function Dc(s,e){return al.apply(this,arguments)}function al(){return al=(0,he.Z)(function*(s,e){var n;e&&Qu(s).Sr&&(yield(n=(0,he.Z)(function*(c,y){if(Ul(S=y.code)&&S!==Ne.ABORTED){const L=c.Qr.shift();Qu(c).wr(),yield Do(c,()=>c.remoteSyncer.rejectFailedWrite(L.batchId,y)),yield ui(c)}var S}),function(c,y){return n.apply(this,arguments)})(s,e)),Ko(s)&&Is(s)}),al.apply(this,arguments)}function Ih(s,e){return Ac.apply(this,arguments)}function Ac(){return Ac=(0,he.Z)(function*(s,e){const n=De(s);e?(n.Gr.delete(2),yield Nr(n)):e||(n.Gr.add(2),yield ti(n),n.Jr.set("Unknown"))}),Ac.apply(this,arguments)}function ec(s){return s.Xr||(s.Xr=function(e,n,c){const y=De(e);return y.Or(),new kr(n,y.ir,y.authCredentials,y.appCheckCredentials,y.k,c)}(s.datastore,s.asyncQueue,{Di:ha.bind(null,s),Ni:Ou.bind(null,s),br:iu.bind(null,s)}),s.zr.push(function(){var e=(0,he.Z)(function*(n){n?(s.Xr.wr(),Vo(s)?Wo(s):s.Jr.set("Unknown")):(yield s.Xr.stop(),Zo(s))});return function(n){return e.apply(this,arguments)}}())),s.Xr}function Qu(s){return s.Zr||(s.Zr=function(e,n,c){const y=De(e);return y.Or(),new pr(n,y.ir,y.authCredentials,y.appCheckCredentials,y.k,c)}(s.datastore,s.asyncQueue,{Di:xu.bind(null,s),Ni:Dc.bind(null,s),Nr:Hl.bind(null,s),Cr:Cc.bind(null,s)}),s.zr.push(function(){var e=(0,he.Z)(function*(n){n?(s.Zr.wr(),yield ui(s)):(yield s.Zr.stop(),s.Qr.length>0&&(Zn("RemoteStore",`Stopping write stream with ${s.Qr.length} pending writes`),s.Qr=[]))});return function(n){return e.apply(this,arguments)}}())),s.Zr}class Zc{constructor(e,n,c,y,S){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=c,this.op=y,this.removalCallback=S,this.deferred=new pn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(L=>{})}static createAndSchedule(e,n,c,y,S){const L=Date.now()+c,te=new Zc(e,n,L,y,S);return te.start(c),te}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new at(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mc(s,e){if(Mi("AsyncQueue",`${e}: ${s}`),Ju(s))return new at(Ne.UNAVAILABLE,`${e}: ${s}`);throw s}class tc{constructor(e){this.comparator=e?(n,c)=>e(n,c)||m.comparator(n.key,c.key):(n,c)=>m.comparator(n.key,c.key),this.keyedMap=hh(),this.sortedSet=new lo(this.comparator)}static emptySet(e){return new tc(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,c)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof tc)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),c=e.sortedSet.getIterator();for(;n.hasNext();){const y=n.getNext().key,S=c.getNext().key;if(!y.isEqual(S))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,n){const c=new tc;return c.comparator=this.comparator,c.keyedMap=e,c.sortedSet=n,c}}class ul{constructor(){this.eo=new lo(m.comparator)}track(e){const n=e.doc.key,c=this.eo.get(n);c?0!==e.type&&3===c.type?this.eo=this.eo.insert(n,e):3===e.type&&1!==c.type?this.eo=this.eo.insert(n,{type:c.type,doc:e.doc}):2===e.type&&2===c.type?this.eo=this.eo.insert(n,{type:2,doc:e.doc}):2===e.type&&0===c.type?this.eo=this.eo.insert(n,{type:0,doc:e.doc}):1===e.type&&0===c.type?this.eo=this.eo.remove(n):1===e.type&&2===c.type?this.eo=this.eo.insert(n,{type:1,doc:c.doc}):0===e.type&&1===c.type?this.eo=this.eo.insert(n,{type:2,doc:e.doc}):M():this.eo=this.eo.insert(n,e)}no(){const e=[];return this.eo.inorderTraversal((n,c)=>{e.push(c)}),e}}class nc{constructor(e,n,c,y,S,L,te,Me){this.query=e,this.docs=n,this.oldDocs=c,this.docChanges=y,this.mutatedKeys=S,this.fromCache=L,this.syncStateChanged=te,this.excludesMetadataChanges=Me}static fromInitialDocuments(e,n,c,y){const S=[];return n.forEach(L=>{S.push({type:0,doc:L})}),new nc(e,n,tc.emptySet(n),S,c,y,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ta(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,c=e.docChanges;if(n.length!==c.length)return!1;for(let y=0;y<n.length;y++)if(n[y].type!==c[y].type||!n[y].doc.isEqual(c[y].doc))return!1;return!0}}class mp{constructor(){this.so=void 0,this.listeners=[]}}class Kc{constructor(){this.queries=new Dd(e=>ml(e),Ta),this.onlineState="Unknown",this.io=new Set}}function kd(s,e){return Yc.apply(this,arguments)}function Yc(){return Yc=(0,he.Z)(function*(s,e){const n=De(s),c=e.query;let y=!1,S=n.queries.get(c);if(S||(y=!0,S=new mp),y)try{S.so=yield n.onListen(c)}catch(L){const te=Mc(L,`Initialization of query '${Wu(e.query)}' failed`);return void e.onError(te)}n.queries.set(c,S),S.listeners.push(e),e.ro(n.onlineState),S.so&&e.oo(S.so)&&ed(n)}),Yc.apply(this,arguments)}function Pc(s,e){return Th.apply(this,arguments)}function Th(){return Th=(0,he.Z)(function*(s,e){const n=De(s),c=e.query;let y=!1;const S=n.queries.get(c);if(S){const L=S.listeners.indexOf(e);L>=0&&(S.listeners.splice(L,1),y=0===S.listeners.length)}if(y)return n.queries.delete(c),n.onUnlisten(c)}),Th.apply(this,arguments)}function gp(s,e){const n=De(s);let c=!1;for(const y of e){const L=n.queries.get(y.query);if(L){for(const te of L.listeners)te.oo(y)&&(c=!0);L.so=y}}c&&ed(n)}function Od(s,e,n){const c=De(s),y=c.queries.get(e);if(y)for(const S of y.listeners)S.onError(n);c.queries.delete(e)}function ed(s){s.io.forEach(e=>{e.next()})}class td{constructor(e,n,c){this.query=e,this.co=n,this.ao=!1,this.uo=null,this.onlineState="Unknown",this.options=c||{}}oo(e){if(!this.options.includeMetadataChanges){const c=[];for(const y of e.docChanges)3!==y.type&&c.push(y);e=new nc(e.query,e.docs,e.oldDocs,c,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.ao?this.ho(e)&&(this.co.next(e),n=!0):this.lo(e,this.onlineState)&&(this.fo(e),n=!0),this.uo=e,n}onError(e){this.co.error(e)}ro(e){this.onlineState=e;let n=!1;return this.uo&&!this.ao&&this.lo(this.uo,e)&&(this.fo(this.uo),n=!0),n}lo(e,n){return!e.fromCache||!(this.options.wo&&"Offline"!==n||e.docs.isEmpty()&&"Offline"!==n)}ho(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.uo&&this.uo.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}fo(e){e=nc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.ao=!0,this.co.next(e)}}class nd{constructor(e,n){this.payload=e,this.byteLength=n}_o(){return"metadata"in this.payload}}class Sh{constructor(e){this.k=e}Hn(e){return Yl(this.k,e)}Jn(e){return e.metadata.exists?eu(this.k,e.document,!1):tn.newNoDocument(this.Hn(e.metadata.name),this.Yn(e.metadata.readTime))}Yn(e){return Da(e)}}class vf{constructor(e,n,c){this.mo=e,this.localStore=n,this.k=c,this.queries=[],this.documents=[],this.progress=Ch(e)}yo(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n),n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}po(e){const n=new Map,c=new Sh(this.k);for(const y of e)if(y.metadata.queries){const S=c.Hn(y.metadata.name);for(const L of y.metadata.queries){const te=(n.get(L)||Oo()).add(S);n.set(L,te)}}return n}complete(){var e=this;return(0,he.Z)(function*(){const n=yield function rm(s,e,n,c){return Eh.apply(this,arguments)}(e.localStore,new Sh(e.k),e.documents,e.mo.id),c=e.po(e.documents);for(const y of e.queries)yield Wc(e.localStore,y,c.get(y.name));return e.progress.taskState="Success",new mf(Object.assign({},e.progress),n)})()}}function Ch(s){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:s.totalDocuments,totalBytes:s.totalBytes}}class rd{constructor(e){this.key=e}}class Dh{constructor(e){this.key=e}}class bf{constructor(e,n){this.query=e,this.To=n,this.Eo=null,this.current=!1,this.Io=Oo(),this.mutatedKeys=Oo(),this.Ao=Zu(e),this.Ro=new tc(this.Ao)}get bo(){return this.To}Po(e,n){const c=n?n.vo:new ul,y=n?n.Ro:this.Ro;let S=n?n.mutatedKeys:this.mutatedKeys,L=y,te=!1;const Me=vo(this.query)&&y.size===this.query.limit?y.last():null,dt=Xa(this.query)&&y.size===this.query.limit?y.first():null;if(e.inorderTraversal((Rt,Kt)=>{const Cn=y.get(Rt),nr=Il(this.query,Kt)?Kt:null,fr=!!Cn&&this.mutatedKeys.has(Cn.key),$r=!!nr&&(nr.hasLocalMutations||this.mutatedKeys.has(nr.key)&&nr.hasCommittedMutations);let Oi=!1;Cn&&nr?Cn.data.isEqual(nr.data)?fr!==$r&&(c.track({type:3,doc:nr}),Oi=!0):this.Vo(Cn,nr)||(c.track({type:2,doc:nr}),Oi=!0,(Me&&this.Ao(nr,Me)>0||dt&&this.Ao(nr,dt)<0)&&(te=!0)):!Cn&&nr?(c.track({type:0,doc:nr}),Oi=!0):Cn&&!nr&&(c.track({type:1,doc:Cn}),Oi=!0,(Me||dt)&&(te=!0)),Oi&&(nr?(L=L.add(nr),S=$r?S.add(Rt):S.delete(Rt)):(L=L.delete(Rt),S=S.delete(Rt)))}),vo(this.query)||Xa(this.query))for(;L.size>this.query.limit;){const Rt=vo(this.query)?L.last():L.first();L=L.delete(Rt.key),S=S.delete(Rt.key),c.track({type:1,doc:Rt})}return{Ro:L,vo:c,Bn:te,mutatedKeys:S}}Vo(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,c){const y=this.Ro;this.Ro=e.Ro,this.mutatedKeys=e.mutatedKeys;const S=e.vo.no();S.sort((dt,Rt)=>function(Kt,Cn){const nr=fr=>{switch(fr){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return M()}};return nr(Kt)-nr(Cn)}(dt.type,Rt.type)||this.Ao(dt.doc,Rt.doc)),this.So(c);const L=n?this.Do():[],te=0===this.Io.size&&this.current?1:0,Me=te!==this.Eo;return this.Eo=te,0!==S.length||Me?{snapshot:new nc(this.query,e.Ro,y,S,e.mutatedKeys,0===te,Me,!1),Co:L}:{Co:L}}ro(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new ul,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}No(e){return!this.To.has(e)&&!!this.Ro.has(e)&&!this.Ro.get(e).hasLocalMutations}So(e){e&&(e.addedDocuments.forEach(n=>this.To=this.To.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.To=this.To.delete(n)),this.current=e.current)}Do(){if(!this.current)return[];const e=this.Io;this.Io=Oo(),this.Ro.forEach(c=>{this.No(c.key)&&(this.Io=this.Io.add(c.key))});const n=[];return e.forEach(c=>{this.Io.has(c)||n.push(new Dh(c))}),this.Io.forEach(c=>{e.has(c)||n.push(new rd(c))}),n}ko(e){this.To=e.zn,this.Io=Oo();const n=this.Po(e.documents);return this.applyChanges(n,!0)}xo(){return nc.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}class Ld{constructor(e,n,c){this.query=e,this.targetId=n,this.view=c}}class id{constructor(e){this.key=e,this.$o=!1}}class Nd{constructor(e,n,c,y,S,L){this.localStore=e,this.remoteStore=n,this.eventManager=c,this.sharedClientState=y,this.currentUser=S,this.maxConcurrentLimboResolutions=L,this.Oo={},this.Mo=new Dd(te=>ml(te),Ta),this.Fo=new Map,this.Lo=new Set,this.Bo=new lo(m.comparator),this.Uo=new Map,this.qo=new Fm,this.Ko={},this.jo=new Map,this.Qo=Ic.re(),this.onlineState="Unknown",this.Wo=void 0}get isPrimaryClient(){return!0===this.Wo}}function wf(s,e){return Jc.apply(this,arguments)}function Jc(){return Jc=(0,he.Z)(function*(s,e){const n=xp(s);let c,y;const S=n.Mo.get(e);if(S)c=S.targetId,n.sharedClientState.addLocalQueryTarget(c),y=S.view.xo();else{const L=yield Pl(n.localStore,Ia(e)),te=n.sharedClientState.addLocalQueryTarget(L.targetId);c=L.targetId,y=yield Fd(n,e,c,"current"===te),n.isPrimaryClient&&yi(n.remoteStore,L)}return y}),Jc.apply(this,arguments)}function Fd(s,e,n,c){return xf.apply(this,arguments)}function xf(){return xf=(0,he.Z)(function*(s,e,n,c){s.Go=(Rt,Kt,Cn)=>{return(nr=(0,he.Z)(function*(fr,$r,Oi,da){let Eu=$r.view.Po(Oi);Eu.Bn&&(Eu=yield ts(fr.localStore,$r.query,!1).then(({documents:Iu})=>$r.view.Po(Iu,Eu)));const cc=da&&da.targetChanges.get($r.targetId),ws=$r.view.applyChanges(Eu,fr.isPrimaryClient,cc);return sd(fr,$r.targetId,ws.Co),ws.snapshot}),function(fr,$r,Oi,da){return nr.apply(this,arguments)})(s,Rt,Kt,Cn);var nr};const y=yield ts(s.localStore,e,!0),S=new bf(e,y.zn),L=S.Po(y.documents),te=Zl.createSynthesizedTargetChangeForCurrentChange(n,c&&"Offline"!==s.onlineState),Me=S.applyChanges(L,s.isPrimaryClient,te);sd(s,n,Me.Co);const dt=new Ld(e,n,S);return s.Mo.set(e,dt),s.Fo.has(n)?s.Fo.get(n).push(e):s.Fo.set(n,[e]),Me.snapshot}),xf.apply(this,arguments)}function yp(s,e){return Ef.apply(this,arguments)}function Ef(){return Ef=(0,he.Z)(function*(s,e){const n=De(s),c=n.Mo.get(e),y=n.Fo.get(c.targetId);if(y.length>1)return n.Fo.set(c.targetId,y.filter(S=>!Ta(S,e))),void n.Mo.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(c.targetId),n.sharedClientState.isActiveQueryTarget(c.targetId)||(yield Ql(n.localStore,c.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(c.targetId),Or(n.remoteStore,c.targetId),Rc(n,c.targetId)}).catch(Kh))):(Rc(n,c.targetId),yield Ql(n.localStore,c.targetId,!0))}),Ef.apply(this,arguments)}function Bd(){return Bd=(0,he.Z)(function*(s,e,n){const c=Sf(s);try{const y=yield function(S,L){const te=De(S),Me=ji.now(),dt=L.reduce((Kt,Cn)=>Kt.add(Cn.key),Oo());let Rt;return te.persistence.runTransaction("Locally write mutations","readwrite",Kt=>te.Wn.vn(Kt,dt).next(Cn=>{Rt=Cn;const nr=[];for(const fr of L){const $r=Fh(fr,Rt.get(fr.key));null!=$r&&nr.push(new mu(fr.key,$r,Jt($r.value.mapValue),Js.exists(!0)))}return te.An.addMutationBatch(Kt,Me,nr,L)})).then(Kt=>(Kt.applyToLocalDocumentSet(Rt),{batchId:Kt.batchId,changes:Rt}))}(c.localStore,e);c.sharedClientState.addPendingMutation(y.batchId),function(S,L,te){let Me=S.Ko[S.currentUser.toKey()];Me||(Me=new lo(Jr)),Me=Me.insert(L,te),S.Ko[S.currentUser.toKey()]=Me}(c,y.batchId,n),yield sc(c,y.changes),yield ui(c.remoteStore)}catch(y){const S=Mc(y,"Failed to persist write");n.reject(S)}}),Bd.apply(this,arguments)}function Ud(s,e){return bs.apply(this,arguments)}function bs(){return bs=(0,he.Z)(function*(s,e){const n=De(s);try{const c=yield nm(n.localStore,e);e.targetChanges.forEach((y,S)=>{const L=n.Uo.get(S);L&&(J(y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size<=1),y.addedDocuments.size>0?L.$o=!0:y.modifiedDocuments.size>0?J(L.$o):y.removedDocuments.size>0&&(J(L.$o),L.$o=!1))}),yield sc(n,c,e)}catch(c){yield Kh(c)}}),bs.apply(this,arguments)}function ic(s,e,n){const c=De(s);if(c.isPrimaryClient&&0===n||!c.isPrimaryClient&&1===n){const y=[];c.Mo.forEach((S,L)=>{const te=L.view.ro(e);te.snapshot&&y.push(te.snapshot)}),function(S,L){const te=De(S);te.onlineState=L;let Me=!1;te.queries.forEach((dt,Rt)=>{for(const Kt of Rt.listeners)Kt.ro(L)&&(Me=!0)}),Me&&ed(te)}(c.eventManager,e),y.length&&c.Oo.br(y),c.onlineState=e,c.isPrimaryClient&&c.sharedClientState.setOnlineState(e)}}function sm(s,e,n){return oc.apply(this,arguments)}function oc(){return oc=(0,he.Z)(function*(s,e,n){const c=De(s);c.sharedClientState.updateQueryState(e,"rejected",n);const y=c.Uo.get(e),S=y&&y.key;if(S){let L=new lo(m.comparator);L=L.insert(S,tn.newNoDocument(S,ei.min()));const te=Oo().add(S),Me=new Uh(ei.min(),new Map,new Go(Jr),L,te);yield Ud(c,Me),c.Bo=c.Bo.remove(S),c.Uo.delete(e),Xc(c)}else yield Ql(c.localStore,e,!1).then(()=>Rc(c,e,n)).catch(Kh)}),oc.apply(this,arguments)}function If(s,e){return Ah.apply(this,arguments)}function Ah(){return Ah=(0,he.Z)(function*(s,e){const n=De(s),c=e.batch.batchId;try{const y=yield Sc(n.localStore,e);zd(n,c,null),od(n,c),n.sharedClientState.updateMutationState(c,"acknowledged"),yield sc(n,y)}catch(y){yield Kh(y)}}),Ah.apply(this,arguments)}function _p(s,e,n){return gl.apply(this,arguments)}function gl(){return gl=(0,he.Z)(function*(s,e,n){const c=De(s);try{const y=yield function(S,L){const te=De(S);return te.persistence.runTransaction("Reject batch","readwrite-primary",Me=>{let dt;return te.An.lookupMutationBatch(Me,L).next(Rt=>(J(null!==Rt),dt=Rt.keys(),te.An.removeMutationBatch(Me,Rt))).next(()=>te.An.performConsistencyCheck(Me)).next(()=>te.Wn.vn(Me,dt))})}(c.localStore,e);zd(c,e,n),od(c,e),c.sharedClientState.updateMutationState(e,"rejected",n),yield sc(c,y)}catch(y){yield Kh(y)}}),gl.apply(this,arguments)}function Mh(){return Mh=(0,he.Z)(function*(s,e){const n=De(s);co(n.remoteStore)||Zn("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const c=yield function(S){const L=De(S);return L.persistence.runTransaction("Get highest unacknowledged batch id","readonly",te=>L.An.getHighestUnacknowledgedBatchId(te))}(n.localStore);if(-1===c)return void e.resolve();const y=n.jo.get(c)||[];y.push(e),n.jo.set(c,y)}catch(c){const y=Mc(c,"Initialization of waitForPendingWrites() operation failed");e.reject(y)}}),Mh.apply(this,arguments)}function od(s,e){(s.jo.get(e)||[]).forEach(n=>{n.resolve()}),s.jo.delete(e)}function zd(s,e,n){const c=De(s);let y=c.Ko[c.currentUser.toKey()];if(y){const S=y.get(e);S&&(n?S.reject(n):S.resolve(),y=y.remove(e)),c.Ko[c.currentUser.toKey()]=y}}function Rc(s,e,n=null){s.sharedClientState.removeLocalQueryTarget(e);for(const c of s.Fo.get(e))s.Mo.delete(c),n&&s.Oo.zo(c,n);s.Fo.delete(e),s.isPrimaryClient&&s.qo.us(e).forEach(c=>{s.qo.containsKey(c)||am(s,c)})}function am(s,e){s.Lo.delete(e.path.canonicalString());const n=s.Bo.get(e);null!==n&&(Or(s.remoteStore,n),s.Bo=s.Bo.remove(e),s.Uo.delete(n),Xc(s))}function sd(s,e,n){for(const c of n)c instanceof rd?(s.qo.addReference(c.key,e),um(s,c)):c instanceof Dh?(Zn("SyncEngine","Document no longer in limbo: "+c.key),s.qo.removeReference(c.key,e),s.qo.containsKey(c.key)||am(s,c.key)):M()}function um(s,e){const n=e.key,c=n.path.canonicalString();s.Bo.get(n)||s.Lo.has(c)||(Zn("SyncEngine","New document in limbo: "+n),s.Lo.add(c),Xc(s))}function Xc(s){for(;s.Lo.size>0&&s.Bo.size<s.maxConcurrentLimboResolutions;){const e=s.Lo.values().next().value;s.Lo.delete(e);const n=new m(uo.fromString(e)),c=s.Qo.next();s.Uo.set(c,new id(n)),s.Bo=s.Bo.insert(n,c),yi(s.remoteStore,new xc(Ia(ko(n.path)),c,2,Wr.I))}}function sc(s,e,n){return vp.apply(this,arguments)}function vp(){return vp=(0,he.Z)(function*(s,e,n){const c=De(s),y=[],S=[],L=[];var te;c.Mo.isEmpty()||(c.Mo.forEach((te,Me)=>{L.push(c.Go(Me,e,n).then(dt=>{if(dt){c.isPrimaryClient&&c.sharedClientState.updateQueryState(Me.targetId,dt.fromCache?"not-current":"current"),y.push(dt);const Rt=Md.$n(Me.targetId,dt);S.push(Rt)}}))}),yield Promise.all(L),c.Oo.br(y),yield(te=(0,he.Z)(function*(Me,dt){const Rt=De(Me);try{yield Rt.persistence.runTransaction("notifyLocalViewChanges","readwrite",Kt=>Un.forEach(dt,Cn=>Un.forEach(Cn.kn,nr=>Rt.persistence.referenceDelegate.addReference(Kt,Cn.targetId,nr)).next(()=>Un.forEach(Cn.xn,nr=>Rt.persistence.referenceDelegate.removeReference(Kt,Cn.targetId,nr)))))}catch(Kt){if(!Ju(Kt))throw Kt;Zn("LocalStore","Failed to update sequence numbers: "+Kt)}for(const Kt of dt){const Cn=Kt.targetId;if(!Kt.fromCache){const nr=Rt.qn.get(Cn),$r=nr.withLastLimboFreeSnapshotVersion(nr.snapshotVersion);Rt.qn=Rt.qn.insert(Cn,$r)}}}),function(Me,dt){return te.apply(this,arguments)})(c.localStore,S))}),vp.apply(this,arguments)}function Bm(s,e){return Pa.apply(this,arguments)}function Pa(){return Pa=(0,he.Z)(function*(s,e){const n=De(s);if(!n.currentUser.isEqual(e)){Zn("SyncEngine","User change. New user:",e.toKey());const c=yield qo(n.localStore,e);n.currentUser=e,(y=n).jo.forEach(L=>{L.forEach(te=>{te.reject(new at(Ne.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),y.jo.clear(),n.sharedClientState.handleUserChange(e,c.removedBatchIds,c.addedBatchIds),yield sc(n,c.Gn)}var y}),Pa.apply(this,arguments)}function bp(s,e){const n=De(s),c=n.Uo.get(e);if(c&&c.$o)return Oo().add(c.key);{let y=Oo();const S=n.Fo.get(e);if(!S)return y;for(const L of S){const te=n.Mo.get(L);y=y.unionWith(te.view.bo)}return y}}function Um(s,e){return $l.apply(this,arguments)}function $l(){return $l=(0,he.Z)(function*(s,e){const n=De(s),c=yield ts(n.localStore,e.query,!0),y=e.view.ko(c);return n.isPrimaryClient&&sd(n,e.targetId,y.Co),y}),$l.apply(this,arguments)}function Eg(s){return ll.apply(this,arguments)}function ll(){return ll=(0,he.Z)(function*(s){const e=De(s);return jl(e.localStore).then(n=>sc(e,n))}),ll.apply(this,arguments)}function Qc(s,e,n,c){return eh.apply(this,arguments)}function eh(){return eh=(0,he.Z)(function*(s,e,n,c){const y=De(s),S=yield function(L,te){const Me=De(L),dt=De(Me.An);return Me.persistence.runTransaction("Lookup mutation documents","readonly",Rt=>dt.Zt(Rt,te).next(Kt=>Kt?Me.Wn.vn(Rt,Kt):Un.resolve(null)))}(y.localStore,e);var te;null!==S?("pending"===n?yield ui(y.remoteStore):"acknowledged"===n||"rejected"===n?(zd(y,e,c||null),od(y,e),te=e,De(De(y.localStore).An).ee(te)):M(),yield sc(y,S)):Zn("SyncEngine","Cannot apply mutation batch with id: "+e)}),eh.apply(this,arguments)}function th(){return th=(0,he.Z)(function*(s,e){const n=De(s);if(xp(n),Sf(n),!0===e&&!0!==n.Wo){const c=n.sharedClientState.getAllActiveQueryTargets(),y=yield Ph(n,c.toArray());n.Wo=!0,yield Ih(n.remoteStore,!0);for(const S of y)yi(n.remoteStore,S)}else if(!1===e&&!1!==n.Wo){const c=[];let y=Promise.resolve();n.Fo.forEach((S,L)=>{n.sharedClientState.isLocalQueryTarget(L)?c.push(L):y=y.then(()=>(Rc(n,L),Ql(n.localStore,L,!0))),Or(n.remoteStore,L)}),yield y,yield Ph(n,c),function(S){const L=De(S);L.Uo.forEach((te,Me)=>{Or(L.remoteStore,Me)}),L.qo.hs(),L.Uo=new Map,L.Bo=new lo(m.comparator)}(n),n.Wo=!1,yield Ih(n.remoteStore,!1)}}),th.apply(this,arguments)}function Ph(s,e,n){return wp.apply(this,arguments)}function wp(){return wp=(0,he.Z)(function*(s,e,n){const c=De(s),y=[],S=[];for(const L of e){let te;const Me=c.Fo.get(L);if(Me&&0!==Me.length){te=yield Pl(c.localStore,Ia(Me[0]));for(const dt of Me){const Rt=c.Mo.get(dt),Kt=yield Um(c,Rt);Kt.snapshot&&S.push(Kt.snapshot)}}else{const dt=yield xh(c.localStore,L);te=yield Pl(c.localStore,dt),yield Fd(c,lm(dt),L,!1)}y.push(te)}return c.Oo.br(S),y}),wp.apply(this,arguments)}function lm(s){return Qi(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function zm(s){const e=De(s);return De(De(e.localStore).persistence).Tn()}function Vm(s,e,n,c){return Vd.apply(this,arguments)}function Vd(){return Vd=(0,he.Z)(function*(s,e,n,c){const y=De(s);if(y.Wo)Zn("SyncEngine","Ignoring unexpected query state notification.");else if(y.Fo.has(e))switch(n){case"current":case"not-current":{const S=yield jl(y.localStore),L=Uh.createSynthesizedRemoteEventForCurrentChange(e,"current"===n);yield sc(y,S,L);break}case"rejected":yield Ql(y.localStore,e,!0),Rc(y,e,c);break;default:M()}}),Vd.apply(this,arguments)}function jm(s,e,n){return Gl.apply(this,arguments)}function Gl(){return Gl=(0,he.Z)(function*(s,e,n){const c=xp(s);if(c.Wo){for(const y of e){if(c.Fo.has(y)){Zn("SyncEngine","Adding an already active target "+y);continue}const S=yield xh(c.localStore,y),L=yield Pl(c.localStore,S);yield Fd(c,lm(S),L.targetId,!1),yi(c.remoteStore,L)}for(const y of n)c.Fo.has(y)&&(yield Ql(c.localStore,y,!1).then(()=>{Or(c.remoteStore,y),Rc(c,y)}).catch(Kh))}}),Gl.apply(this,arguments)}function xp(s){const e=De(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ud.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bp.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sm.bind(null,e),e.Oo.br=gp.bind(null,e.eventManager),e.Oo.zo=Od.bind(null,e.eventManager),e}function Sf(s){const e=De(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=If.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_p.bind(null,e),e}class $m{constructor(){this.synchronizeTabs=!1}initialize(e){var n=this;return(0,he.Z)(function*(){n.k=Tn(e.databaseInfo.databaseId),n.sharedClientState=n.Jo(e),n.persistence=n.Yo(e),yield n.persistence.start(),n.gcScheduler=n.Xo(e),n.localStore=n.Zo(e)})()}Xo(e){return null}Zo(e){return Rs(this.persistence,new Tc,e.initialUser,this.k)}Yo(e){return new u(v.ks,this.k)}Jo(e){return new yt}terminate(){var e=this;return(0,he.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class jd extends $m{constructor(e,n,c){super(),this.tc=e,this.cacheSizeBytes=n,this.forceOwnership=c,this.synchronizeTabs=!1}initialize(e){var n=()=>super.initialize,c=this;return(0,he.Z)(function*(){yield n().call(c,e),yield function Rd(s){return _f.apply(this,arguments)}(c.localStore),yield c.tc.initialize(c,e),yield Sf(c.tc.syncEngine),yield ui(c.tc.remoteStore),yield c.persistence.sn(()=>(c.gcScheduler&&!c.gcScheduler.started&&c.gcScheduler.start(c.localStore),Promise.resolve()))})()}Zo(e){return Rs(this.persistence,new Tc,e.initialUser,this.k)}Xo(e){return new Fy(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue)}Yo(e){const n=Ii(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),c=void 0!==this.cacheSizeBytes?bu.withCacheSize(this.cacheSizeBytes):bu.DEFAULT;return new fp(this.synchronizeTabs,n,e.clientId,c,e.asyncQueue,fn(),cn(),this.k,this.sharedClientState,!!this.forceOwnership)}Jo(e){return new yt}}class Gm extends jd{constructor(e,n){super(e,n,!1),this.tc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){var n=()=>super.initialize,c=this;return(0,he.Z)(function*(){yield n().call(c,e);const y=c.tc.syncEngine;c.sharedClientState instanceof Ye&&(c.sharedClientState.syncEngine={mi:Qc.bind(null,y),gi:Vm.bind(null,y),yi:jm.bind(null,y),Tn:zm.bind(null,y),_i:Eg.bind(null,y)},yield c.sharedClientState.start()),yield c.persistence.sn(function(){var S=(0,he.Z)(function*(L){yield function ad(s,e){return th.apply(this,arguments)}(c.tc.syncEngine,L),c.gcScheduler&&(L&&!c.gcScheduler.started?c.gcScheduler.start(c.localStore):L||c.gcScheduler.stop())});return function(L){return S.apply(this,arguments)}}())})()}Jo(e){const n=fn();if(!Ye.Pt(n))throw new at(Ne.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const c=Ii(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ye(n,e.asyncQueue,c,e.clientId,e.initialUser)}}class Cf{initialize(e,n){var c=this;return(0,he.Z)(function*(){c.localStore||(c.localStore=e.localStore,c.sharedClientState=e.sharedClientState,c.datastore=c.createDatastore(n),c.remoteStore=c.createRemoteStore(n),c.eventManager=c.createEventManager(n),c.syncEngine=c.createSyncEngine(n,!e.synchronizeTabs),c.sharedClientState.onlineStateHandler=y=>ic(c.syncEngine,y,1),c.remoteStore.remoteSyncer.handleCredentialChange=Bm.bind(null,c.syncEngine),yield Ih(c.remoteStore,c.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Kc}createDatastore(e){const n=Tn(e.databaseInfo.databaseId),c=new rn(e.databaseInfo);return new Ur(e.authCredentials,e.appCheckCredentials,c,n)}createRemoteStore(e){return n=this.localStore,c=this.datastore,y=e.asyncQueue,S=te=>ic(this.syncEngine,te,0),L=Vt.Pt()?new Vt:new Et,new ri(n,c,y,S,L);var n,c,y,S,L}createSyncEngine(e,n){return function(c,y,S,L,te,Me,dt){const Rt=new Nd(c,y,S,L,te,Me);return dt&&(Rt.Wo=!0),Rt}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return(e=(0,he.Z)(function*(n){const c=De(n);Zn("RemoteStore","RemoteStore shutting down."),c.Gr.add(5),yield ti(c),c.Hr.shutdown(),c.Jr.set("Unknown")}),function(n){return e.apply(this,arguments)})(this.remoteStore);var e}}function Df(s,e=10240){let n=0;return{read:()=>(0,he.Z)(function*(){if(n<s.byteLength){const c={value:s.slice(n,n+e),done:!1};return n+=e,c}return{done:!0}})(),cancel:()=>(0,he.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class Ep{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.ec(this.observer.next,e)}error(e){this.observer.error?this.ec(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}nc(){this.muted=!0}ec(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class cl{constructor(e,n){this.sc=e,this.k=n,this.metadata=new pn,this.buffer=new Uint8Array,this.ic=new TextDecoder("utf-8"),this.rc().then(c=>{c&&c._o()?this.metadata.resolve(c.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==c?void 0:c.payload)}`))},c=>this.metadata.reject(c))}close(){return this.sc.cancel()}getMetadata(){var e=this;return(0,he.Z)(function*(){return e.metadata.promise})()}Ho(){var e=this;return(0,he.Z)(function*(){return yield e.getMetadata(),e.rc()})()}rc(){var e=this;return(0,he.Z)(function*(){const n=yield e.oc();if(null===n)return null;const c=e.ic.decode(n),y=Number(c);isNaN(y)&&e.cc(`length string (${c}) is not valid number`);const S=yield e.ac(y);return new nd(JSON.parse(S),n.length+y)})()}uc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}oc(){var e=this;return(0,he.Z)(function*(){for(;e.uc()<0&&!(yield e.hc()););if(0===e.buffer.length)return null;const n=e.uc();n<0&&e.cc("Reached the end of bundle when a length string is expected.");const c=e.buffer.slice(0,n);return e.buffer=e.buffer.slice(n),c})()}ac(e){var n=this;return(0,he.Z)(function*(){for(;n.buffer.length<e;)(yield n.hc())&&n.cc("Reached the end of bundle when more is expected.");const c=n.ic.decode(n.buffer.slice(0,e));return n.buffer=n.buffer.slice(e),c})()}cc(e){throw this.sc.cancel(),new Error(`Invalid bundle format: ${e}`)}hc(){var e=this;return(0,he.Z)(function*(){const n=yield e.sc.read();if(!n.done){const c=new Uint8Array(e.buffer.length+n.value.length);c.set(e.buffer),c.set(n.value,e.buffer.length),e.buffer=c}return n.done})()}}class Ig{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var n=this;return(0,he.Z)(function*(){if(n.ensureCommitNotCalled(),n.mutations.length>0)throw new at(Ne.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const c=yield(y=(0,he.Z)(function*(S,L){const te=De(S),Me=Aa(te.k)+"/documents",dt={documents:L.map(nr=>Kl(te.k,nr))},Rt=yield te.ji("BatchGetDocuments",Me,dt),Kt=new Map;Rt.forEach(nr=>{const fr=function Dl(s,e){return"found"in e?function(n,c){J(!!c.found);const y=Yl(n,c.found.name),S=Da(c.found.updateTime),L=new Bt({mapValue:{fields:c.found.fields}});return tn.newFoundDocument(y,S,L)}(s,e):"missing"in e?function(n,c){J(!!c.missing),J(!!c.readTime);const y=Yl(n,c.missing),S=Da(c.readTime);return tn.newNoDocument(y,S)}(s,e):M()}(te.k,nr);Kt.set(fr.key.toString(),fr)});const Cn=[];return L.forEach(nr=>{const fr=Kt.get(nr.toString());J(!!fr),Cn.push(fr)}),Cn}),function(S,L){return y.apply(this,arguments)})(n.datastore,e);var y;return c.forEach(y=>n.recordVersion(y)),c})()}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(c){this.lastWriteError=c}this.writtenDocs.add(e.toString())}delete(e){this.write(new Bh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,he.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const n=e.readVersions;var c;e.mutations.forEach(c=>{n.delete(c.key.toString())}),n.forEach((c,y)=>{const S=m.fromPath(y);e.mutations.push(new Wf(S,e.precondition(S)))}),yield(c=(0,he.Z)(function*(y,S){const L=De(y),te=Aa(L.k)+"/documents",Me={writes:S.map(dt=>vc(L.k,dt))};yield L.Bi("Commit",te,Me)}),function(y,S){return c.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw M();n=ei.min()}const c=this.readVersions.get(e.key.toString());if(c){if(!n.isEqual(c))throw new at(Ne.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?Js.updateTime(n):Js.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ei.min()))throw new at(Ne.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Js.updateTime(n)}return Js.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class cm{constructor(e,n,c,y){this.asyncQueue=e,this.datastore=n,this.updateFunction=c,this.deferred=y,this.lc=5,this.ur=new qn(this.asyncQueue,"transaction_retry")}run(){this.lc-=1,this.fc()}fc(){var e=this;this.ur.Zi((0,he.Z)(function*(){const n=new Ig(e.datastore),c=e.dc(n);c&&c.then(y=>{e.asyncQueue.enqueueAndForget(()=>n.commit().then(()=>{e.deferred.resolve(y)}).catch(S=>{e.wc(S)}))}).catch(y=>{e.wc(y)})}))}dc(e){try{const n=this.updateFunction(e);return!l(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}wc(e){this.lc>0&&this._c(e)?(this.lc-=1,this.asyncQueue.enqueueAndForget(()=>(this.fc(),Promise.resolve()))):this.deferred.reject(e)}_c(e){if("FirebaseError"===e.name){const n=e.code;return"aborted"===n||"failed-precondition"===n||!Ul(n)}return!1}}class qm{constructor(e,n,c,y){var S=this;this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=c,this.databaseInfo=y,this.user=So.UNAUTHENTICATED,this.clientId=Ks.A(),this.authCredentialListener=()=>Promise.resolve(),this.authCredentials.start(c,function(){var L=(0,he.Z)(function*(te){Zn("FirestoreClient","Received user=",te.uid),yield S.authCredentialListener(te),S.user=te});return function(te){return L.apply(this,arguments)}}()),this.appCheckCredentials.start(c,()=>Promise.resolve())}getConfiguration(){var e=this;return(0,he.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new at(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const n=new pn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,he.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),n.resolve()}catch(c){const y=Mc(c,"Failed to shutdown persistence");n.reject(y)}})),n.promise}}function Ip(s,e){return Tp.apply(this,arguments)}function Tp(){return Tp=(0,he.Z)(function*(s,e){s.asyncQueue.verifyOperationInProgress(),Zn("FirestoreClient","Initializing OfflineComponentProvider");const n=yield s.getConfiguration();yield e.initialize(n);let c=n.initialUser;s.setCredentialChangeListener(function(){var y=(0,he.Z)(function*(S){c.isEqual(S)||(yield qo(e.localStore,S),c=S)});return function(S){return y.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s.offlineComponents=e}),Tp.apply(this,arguments)}function Wm(s,e){return Zm.apply(this,arguments)}function Zm(){return Zm=(0,he.Z)(function*(s,e){s.asyncQueue.verifyOperationInProgress();const n=yield Sp(s);Zn("FirestoreClient","Initializing OnlineComponentProvider");const c=yield s.getConfiguration();yield e.initialize(n,c),s.setCredentialChangeListener(y=>{return(S=(0,he.Z)(function*(L,te){const Me=De(L);Me.asyncQueue.verifyOperationInProgress(),Zn("RemoteStore","RemoteStore received new credentials");const dt=co(Me);Me.Gr.add(3),yield ti(Me),dt&&Me.Jr.set("Unknown"),yield Me.remoteSyncer.handleCredentialChange(te),Me.Gr.delete(3),yield Nr(Me)}),function(L,te){return S.apply(this,arguments)})(e.remoteStore,y);var S}),s.onlineComponents=e}),Zm.apply(this,arguments)}function Sp(s){return Cp.apply(this,arguments)}function Cp(){return Cp=(0,he.Z)(function*(s){return s.offlineComponents||(Zn("FirestoreClient","Using default OfflineComponentProvider"),yield Ip(s,new $m)),s.offlineComponents}),Cp.apply(this,arguments)}function Dp(s){return Af.apply(this,arguments)}function Af(){return Af=(0,he.Z)(function*(s){return s.onlineComponents||(Zn("FirestoreClient","Using default OnlineComponentProvider"),yield Wm(s,new Cf)),s.onlineComponents}),Af.apply(this,arguments)}function Km(s){return Sp(s).then(e=>e.persistence)}function ql(s){return Sp(s).then(e=>e.localStore)}function Mf(s){return Dp(s).then(e=>e.remoteStore)}function Ap(s){return Dp(s).then(e=>e.syncEngine)}function kc(s){return Mp.apply(this,arguments)}function Mp(){return Mp=(0,he.Z)(function*(s){const e=yield Dp(s),n=e.eventManager;return n.onListen=wf.bind(null,e.syncEngine),n.onUnlisten=yp.bind(null,e.syncEngine),n}),Mp.apply(this,arguments)}function Rp(s,e,n={}){const c=new pn;return s.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return function(y,S,L,te,Me){const dt=new Ep({next:Kt=>{S.enqueueAndForget(()=>Pc(y,Rt));const Cn=Kt.docs.has(L);!Cn&&Kt.fromCache?Me.reject(new at(Ne.UNAVAILABLE,"Failed to get document because the client is offline.")):Cn&&Kt.fromCache&&te&&"server"===te.source?Me.reject(new at(Ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):Me.resolve(Kt)},error:Kt=>Me.reject(Kt)}),Rt=new td(ko(L.path),dt,{includeMetadataChanges:!0,wo:!0});return kd(y,Rt)}(yield kc(s),s.asyncQueue,e,n,c)})),c.promise}function By(s,e,n={}){const c=new pn;return s.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return function(y,S,L,te,Me){const dt=new Ep({next:Kt=>{S.enqueueAndForget(()=>Pc(y,Rt)),Kt.fromCache&&"server"===te.source?Me.reject(new at(Ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):Me.resolve(Kt)},error:Kt=>Me.reject(Kt)}),Rt=new td(L,dt,{includeMetadataChanges:!0,wo:!0});return kd(y,Rt)}(yield kc(s),s.asyncQueue,e,n,c)})),c.promise}class Pf{constructor(e,n,c,y,S,L,te,Me){this.databaseId=e,this.appId=n,this.persistenceKey=c,this.host=y,this.ssl=S,this.forceLongPolling=L,this.autoDetectLongPolling=te,this.useFetchStreams=Me}}class ud{constructor(e,n){this.projectId=e,this.database=n||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ud&&e.projectId===this.projectId&&e.database===this.database}}const ac=new Map;function dm(s,e,n){if(!n)throw new at(Ne.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function Rf(s,e,n,c){if(!0===e&&!0===c)throw new at(Ne.INVALID_ARGUMENT,`${s} and ${n} cannot be used together.`)}function kf(s){if(!m.isDocumentKey(s))throw new at(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function Of(s){if(m.isDocumentKey(s))throw new at(Ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function ld(s){if(void 0===s)return"undefined";if(null===s)return"null";if("string"==typeof s)return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if("number"==typeof s||"boolean"==typeof s)return""+s;if("object"==typeof s){if(s instanceof Array)return"an array";{const e=(n=s).constructor?n.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var n;return"function"==typeof s?"a function":M()}function ho(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new at(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ld(s);throw new at(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return s}function Lf(s,e){if(e<=0)throw new at(Ne.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}class Nf{constructor(e){var n;if(void 0===e.host){if(void 0!==e.ssl)throw new at(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new at(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Rf("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kh{constructor(e,n,c){this._authCredentials=n,this._appCheckCredentials=c,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nf({}),this._settingsFrozen=!1,e instanceof ud?this._databaseId=e:(this._app=e,this._databaseId=function(y){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new at(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ud(y.options.projectId)}(e))}get app(){if(!this._app)throw new at(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new at(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nf(e),void 0!==e.credentials&&(this._authCredentials=function(n){if(!n)return new Fn;switch(n.type){case"gapi":const c=n.client;return J(!("object"!=typeof c||null===c||!c.auth||!c.auth.getAuthHeaderValueForFirstParty)),new Ro(c,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new at(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=ac.get(e);n&&(Zn("ComponentProvider","Removing Datastore"),ac.delete(e),n.terminate())}(this),Promise.resolve()}}class Hs{constructor(e,n,c){this.converter=n,this._key=c,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hs(this.firestore,e,this._key)}}class hl{constructor(e,n,c){this.converter=n,this._query=c,this.type="query",this.firestore=e}withConverter(e){return new hl(this.firestore,e,this._query)}}class nh extends hl{constructor(e,n,c){super(e,n,ko(c)),this._path=c,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hs(this.firestore,null,new m(e))}withConverter(e){return new nh(this.firestore,e,this._path)}}function Sg(s,e,...n){if(s=(0,W.m9)(s),dm("collection","path",e),s instanceof kh){const c=uo.fromString(e,...n);return Of(c),new nh(s,null,c)}{if(!(s instanceof Hs||s instanceof nh))throw new at(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const c=s._path.child(uo.fromString(e,...n));return Of(c),new nh(s.firestore,null,c)}}function fm(s,e,...n){if(s=(0,W.m9)(s),1===arguments.length&&(e=Ks.A()),dm("doc","path",e),s instanceof kh){const c=uo.fromString(e,...n);return kf(c),new Hs(s,null,new m(c))}{if(!(s instanceof Hs||s instanceof nh))throw new at(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const c=s._path.child(uo.fromString(e,...n));return kf(c),new Hs(s.firestore,s instanceof nh?s.converter:null,new m(c))}}function Cg(s,e){return s=(0,W.m9)(s),e=(0,W.m9)(e),(s instanceof Hs||s instanceof nh)&&(e instanceof Hs||e instanceof nh)&&s.firestore===e.firestore&&s.path===e.path&&s.converter===e.converter}function Dg(s,e){return s=(0,W.m9)(s),e=(0,W.m9)(e),s instanceof hl&&e instanceof hl&&s.firestore===e.firestore&&Ta(s._query,e._query)&&s.converter===e.converter}class zy{constructor(){this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new qn(this,"async_queue_retry"),this.bc=()=>{const n=cn();n&&Zn("AsyncQueue","Visibility state changed to "+n.visibilityState),this.ur.er()};const e=cn();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.bc)}get isShuttingDown(){return this.yc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pc(),this.vc(e)}enterRestrictedMode(e){if(!this.yc){this.yc=!0,this.Ac=e||!1;const n=cn();n&&"function"==typeof n.removeEventListener&&n.removeEventListener("visibilitychange",this.bc)}}enqueue(e){if(this.Pc(),this.yc)return new Promise(()=>{});const n=new pn;return this.vc(()=>this.yc&&this.Ac?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.gc.push(e),this.Vc()))}Vc(){var e=this;return(0,he.Z)(function*(){if(0!==e.gc.length){try{yield e.gc[0](),e.gc.shift(),e.ur.reset()}catch(n){if(!Ju(n))throw n;Zn("AsyncQueue","Operation failed with retryable error: "+n)}e.gc.length>0&&e.ur.Zi(()=>e.Vc())}})()}vc(e){const n=this.mc.then(()=>(this.Ic=!0,e().catch(c=>{throw this.Ec=c,this.Ic=!1,Mi("INTERNAL UNHANDLED ERROR: ",function(S){let L=S.message||"";return S.stack&&(L=S.stack.includes(S.message)?S.stack:S.message+"\n"+S.stack),L}(c)),c}).then(c=>(this.Ic=!1,c))));return this.mc=n,n}enqueueAfterDelay(e,n,c){this.Pc(),this.Rc.indexOf(e)>-1&&(n=0);const y=Zc.createAndSchedule(this,e,n,c,S=>this.Sc(S));return this.Tc.push(y),y}Pc(){this.Ec&&M()}verifyOperationInProgress(){}Dc(){var e=this;return(0,he.Z)(function*(){let n;do{n=e.mc,yield n}while(n!==e.mc)})()}Cc(e){for(const n of this.Tc)if(n.timerId===e)return!0;return!1}Nc(e){return this.Dc().then(()=>{this.Tc.sort((n,c)=>n.targetTimeMs-c.targetTimeMs);for(const n of this.Tc)if(n.skipDelay(),"all"!==e&&n.timerId===e)break;return this.Dc()})}kc(e){this.Rc.push(e)}Sc(e){const n=this.Tc.indexOf(e);this.Tc.splice(n,1)}}function Ag(s){return function(e,n){if("object"!=typeof e||null===e)return!1;const c=e;for(const y of["next","error","complete"])if(y in c&&"function"==typeof c[y])return!0;return!1}(s)}class Vy{constructor(){this._progressObserver={},this._taskCompletionResolver=new pn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,c){this._progressObserver={next:e,error:n,complete:c}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Ra extends kh{constructor(e,n,c){super(e,n,c),this.type="firestore",this._queue=new zy,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Mg(this),this._firestoreClient.terminate()}}function Fu(s){return s._firestoreClient||Mg(s),s._firestoreClient.verifyNotTerminated(),s._firestoreClient}function Mg(s){var e;const n=s._freezeSettings(),c=(S=(null===(e=s._app)||void 0===e?void 0:e.options.appId)||"",new Pf(s._databaseId,S,s._persistenceKey,(te=n).host,te.ssl,te.experimentalForceLongPolling,te.experimentalAutoDetectLongPolling,te.useFetchStreams));var S,te;s._firestoreClient=new qm(s._authCredentials,s._appCheckCredentials,s._queue,c)}function Hy(s,e,n){const c=new pn;return s.asyncQueue.enqueue((0,he.Z)(function*(){try{yield Ip(s,n),yield Wm(s,e),c.resolve()}catch(y){if(!("FirebaseError"===(S=y).name?S.code===Ne.FAILED_PRECONDITION||S.code===Ne.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&S instanceof DOMException)||22===S.code||20===S.code||11===S.code))throw y;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+y),c.reject(y)}var S})).then(()=>c.promise)}function xv(s){if(s._initialized||s._terminated)throw new at(Ne.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Hd{constructor(...e){for(let n=0;n<e.length;++n)if(0===e[n].length)throw new at(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new es(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class rh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rh(no.fromBase64String(e))}catch(n){throw new at(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new rh(no.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Op{constructor(e){this._methodName=e}}class Jm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new at(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new at(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Jr(this._lat,e._lat)||Jr(this._long,e._long)}}const Lp=/^__.*__$/;class Ev{constructor(e,n,c){this.data=e,this.fieldMask=n,this.fieldTransforms=c}toMutation(e,n){return null!==this.fieldMask?new mu(e,this.data,this.fieldMask,n,this.fieldTransforms):new ch(e,this.data,n,this.fieldTransforms)}}class Rg{constructor(e,n,c){this.data=e,this.fieldMask=n,this.fieldTransforms=c}toMutation(e,n){return new mu(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Gy(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw M()}}class pm{constructor(e,n,c,y,S,L){this.settings=e,this.databaseId=n,this.k=c,this.ignoreUndefinedProperties=y,void 0===S&&this.xc(),this.fieldTransforms=S||[],this.fieldMask=L||[]}get path(){return this.settings.path}get $c(){return this.settings.$c}Oc(e){return new pm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mc(e){var n;const c=null===(n=this.path)||void 0===n?void 0:n.child(e),y=this.Oc({path:c,Fc:!1});return y.Lc(e),y}Bc(e){var n;const c=null===(n=this.path)||void 0===n?void 0:n.child(e),y=this.Oc({path:c,Fc:!1});return y.xc(),y}Uc(e){return this.Oc({path:void 0,Fc:!0})}qc(e){return Np(e,this.settings.methodName,this.settings.Kc||!1,this.path,this.settings.jc)}contains(e){return void 0!==this.fieldMask.find(n=>e.isPrefixOf(n))||void 0!==this.fieldTransforms.find(n=>e.isPrefixOf(n.field))}xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lc(this.path.get(e))}Lc(e){if(0===e.length)throw this.qc("Document fields must not be empty");if(Gy(this.$c)&&Lp.test(e))throw this.qc('Document fields cannot begin and end with "__"')}}class Xm{constructor(e,n,c){this.databaseId=e,this.ignoreUndefinedProperties=n,this.k=c||Tn(e)}Qc(e,n,c,y=!1){return new pm({$c:e,methodName:n,jc:c,path:es.emptyPath(),Fc:!1,Kc:y},this.databaseId,this.k,this.ignoreUndefinedProperties)}}function Ff(s){const e=s._freezeSettings(),n=Tn(s._databaseId);return new Xm(s._databaseId,!!e.ignoreUndefinedProperties,n)}function mm(s,e,n,c,y,S={}){const L=s.Qc(S.merge||S.mergeFields?2:0,e,n,y);Ng("Data must be an object, but it was:",L,c);const te=Sv(c,L);let Me,dt;if(S.merge)Me=new pl(L.fieldMask),dt=L.fieldTransforms;else if(S.mergeFields){const Rt=[];for(const Kt of S.mergeFields){const Cn=Zy(e,Kt,n);if(!L.contains(Cn))throw new at(Ne.INVALID_ARGUMENT,`Field '${Cn}' is specified in your field mask but missing from your input data.`);ng(Rt,Cn)||Rt.push(Cn)}Me=new pl(Rt),dt=L.fieldTransforms.filter(Kt=>Me.covers(Kt.field))}else Me=null,dt=L.fieldTransforms;return new Ev(new Bt(te),Me,dt)}class gm extends Op{_toFieldTransform(e){if(2!==e.$c)throw e.qc(1===e.$c?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gm}}function qy(s,e,n){return new pm({$c:3,jc:e.settings.jc,methodName:s._methodName,Fc:n},e.databaseId,e.k,e.ignoreUndefinedProperties)}class kg extends Op{_toFieldTransform(e){return new Qa(e.path,new dc)}isEqual(e){return e instanceof kg}}class Iv extends Op{constructor(e,n){super(e),this.Wc=n}_toFieldTransform(e){const n=qy(this,e,!0),c=this.Wc.map(S=>cd(S,n)),y=new Ku(c);return new Qa(e.path,y)}isEqual(e){return this===e}}class Tv extends Op{constructor(e,n){super(e),this.Wc=n}_toFieldTransform(e){const n=qy(this,e,!0),c=this.Wc.map(S=>cd(S,n)),y=new fu(c);return new Qa(e.path,y)}isEqual(e){return this===e}}class Wy extends Op{constructor(e,n){super(e),this.Gc=n}_toFieldTransform(e){const n=new Yu(e.k,Bl(e.k,this.Gc));return new Qa(e.path,n)}isEqual(e){return this===e}}function Og(s,e,n,c){const y=s.Qc(1,e,n);Ng("Data must be an object, but it was:",y,c);const S=[],L=Bt.empty();_o(c,(Me,dt)=>{const Rt=tg(e,Me,n);dt=(0,W.m9)(dt);const Kt=y.Bc(Rt);if(dt instanceof gm)S.push(Rt);else{const Cn=cd(dt,Kt);null!=Cn&&(S.push(Rt),L.set(Rt,Cn))}});const te=new pl(S);return new Rg(L,te,y.fieldTransforms)}function Qm(s,e,n,c,y,S){const L=s.Qc(1,e,n),te=[Zy(e,c,n)],Me=[y];if(S.length%2!=0)throw new at(Ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let Cn=0;Cn<S.length;Cn+=2)te.push(Zy(e,S[Cn])),Me.push(S[Cn+1]);const dt=[],Rt=Bt.empty();for(let Cn=te.length-1;Cn>=0;--Cn)if(!ng(dt,te[Cn])){const nr=te[Cn];let fr=Me[Cn];fr=(0,W.m9)(fr);const $r=L.Bc(nr);if(fr instanceof gm)dt.push(nr);else{const Oi=cd(fr,$r);null!=Oi&&(dt.push(nr),Rt.set(nr,Oi))}}const Kt=new pl(dt);return new Rg(Rt,Kt,L.fieldTransforms)}function Lg(s,e,n,c=!1){return cd(n,s.Qc(c?4:3,e))}function cd(s,e){if(eg(s=(0,W.m9)(s)))return Ng("Unsupported field value:",e,s),Sv(s,e);if(s instanceof Op)return function(n,c){if(!Gy(c.$c))throw c.qc(`${n._methodName}() can only be used with update() and set()`);if(!c.path)throw c.qc(`${n._methodName}() is not currently supported inside arrays`);const y=n._toFieldTransform(c);y&&c.fieldTransforms.push(y)}(s,e),null;if(void 0===s&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.Fc&&4!==e.$c)throw e.qc("Nested arrays are not supported");return function(n,c){const y=[];let S=0;for(const L of n){let te=cd(L,c.Uc(S));null==te&&(te={nullValue:"NULL_VALUE"}),y.push(te),S++}return{arrayValue:{values:y}}}(s,e)}return function(n,c){if(null===(n=(0,W.m9)(n)))return{nullValue:"NULL_VALUE"};if("number"==typeof n)return Bl(c.k,n);if("boolean"==typeof n)return{booleanValue:n};if("string"==typeof n)return{stringValue:n};if(n instanceof Date){const y=ji.fromDate(n);return{timestampValue:fh(c.k,y)}}if(n instanceof ji){const y=new ji(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:fh(c.k,y)}}if(n instanceof Jm)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof rh)return{bytesValue:Jf(c.k,n._byteString)};if(n instanceof Hs){const y=c.databaseId,S=n.firestore._databaseId;if(!S.isEqual(y))throw c.qc(`Document reference is for database ${S.projectId}/${S.database} but should be for database ${y.projectId}/${y.database}`);return{referenceValue:_d(n.firestore._databaseId||c.databaseId,n._key.path)}}throw c.qc(`Unsupported field value: ${ld(n)}`)}(s,e)}function Sv(s,e){const n={};return Ll(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_o(s,(c,y)=>{const S=cd(y,e.Mc(c));null!=S&&(n[c]=S)}),{mapValue:{fields:n}}}function eg(s){return!("object"!=typeof s||null===s||s instanceof Array||s instanceof Date||s instanceof ji||s instanceof Jm||s instanceof rh||s instanceof Hs||s instanceof Op)}function Ng(s,e,n){if(!eg(n)||"object"!=typeof(c=n)||null===c||Object.getPrototypeOf(c)!==Object.prototype&&null!==Object.getPrototypeOf(c)){const c=ld(n);throw e.qc("an object"===c?s+" a custom object":s+" "+c)}var c}function Zy(s,e,n){if((e=(0,W.m9)(e))instanceof Hd)return e._internalPath;if("string"==typeof e)return tg(s,e);throw Np("Field path arguments must be of type string or ",s,!1,void 0,n)}const ym=new RegExp("[~\\*/\\[\\]]");function tg(s,e,n){if(e.search(ym)>=0)throw Np(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,n);try{return new Hd(...e.split("."))._internalPath}catch(c){throw Np(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,n)}}function Np(s,e,n,c,y){const S=c&&!c.isEmpty(),L=void 0!==y;let te=`Function ${e}() called with invalid data`;n&&(te+=" (via `toFirestore()`)"),te+=". ";let Me="";return(S||L)&&(Me+=" (found",S&&(Me+=` in field ${c}`),L&&(Me+=` in document ${y}`),Me+=")"),new at(Ne.INVALID_ARGUMENT,te+s+Me)}function ng(s,e){return s.some(n=>n.isEqual(e))}class _m{constructor(e,n,c,y,S){this._firestore=e,this._userDataWriter=n,this._key=c,this._document=y,this._converter=S}get id(){return this._key.path.lastSegment()}get ref(){return new Hs(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Fg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Fp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n)}}}class Fg extends _m{data(){return super.data()}}function Fp(s,e){return"string"==typeof e?tg(s,e):e instanceof Hd?e._internalPath:e._delegate._internalPath}class $d{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gd extends _m{constructor(e,n,c,y,S,L){super(e,n,c,y,L),this._firestore=e,this._firestoreImpl=e,this.metadata=S}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new vm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const c=this._document.data.field(Fp("DocumentSnapshot.get",e));if(null!==c)return this._userDataWriter.convertValue(c,n.serverTimestamps)}}}class vm extends Gd{data(e={}){return super.data(e)}}class Oh{constructor(e,n,c,y){this._firestore=e,this._userDataWriter=n,this._snapshot=y,this.metadata=new $d(y.hasPendingWrites,y.fromCache),this.query=c}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,n){this._snapshot.docs.forEach(c=>{e.call(n,new vm(this._firestore,this._userDataWriter,c.key,c,new $d(this._snapshot.mutatedKeys.has(c.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new at(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(c,y){if(c._snapshot.oldDocs.isEmpty()){let S=0;return c._snapshot.docChanges.map(L=>({type:"added",doc:new vm(c._firestore,c._userDataWriter,L.doc.key,L.doc,new $d(c._snapshot.mutatedKeys.has(L.doc.key),c._snapshot.fromCache),c.query.converter),oldIndex:-1,newIndex:S++}))}{let S=c._snapshot.oldDocs;return c._snapshot.docChanges.filter(L=>y||3!==L.type).map(L=>{const te=new vm(c._firestore,c._userDataWriter,L.doc.key,L.doc,new $d(c._snapshot.mutatedKeys.has(L.doc.key),c._snapshot.fromCache),c.query.converter);let Me=-1,dt=-1;return 0!==L.type&&(Me=S.indexOf(L.doc.key),S=S.delete(L.doc.key)),1!==L.type&&(S=S.add(L.doc),dt=S.indexOf(L.doc.key)),{type:Bg(L.type),doc:te,oldIndex:Me,newIndex:dt}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Bg(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return M()}}function Ky(s,e){return s instanceof Gd&&e instanceof Gd?s._firestore===e._firestore&&s._key.isEqual(e._key)&&(null===s._document?null===e._document:s._document.isEqual(e._document))&&s._converter===e._converter:s instanceof Oh&&e instanceof Oh&&s._firestore===e._firestore&&Dg(s.query,e.query)&&s.metadata.isEqual(e.metadata)&&s._snapshot.isEqual(e._snapshot)}function Ug(s){if(Xa(s)&&0===s.explicitOrderBy.length)throw new at(Ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Bf{}function hd(s,...e){for(const n of e)s=n._apply(s);return s}class Yy extends Bf{constructor(e,n,c){super(),this.zc=e,this.Hc=n,this.Jc=c,this.type="where"}_apply(e){const n=Ff(e.firestore),c=function(y,S,L,te,Me,dt,Rt){let Kt;if(Me.isKeyField()){if("array-contains"===dt||"array-contains-any"===dt)throw new at(Ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${dt}' queries on documentId().`);if("in"===dt||"not-in"===dt){Zg(Rt,dt);const nr=[];for(const fr of Rt)nr.push(Wg(te,y,fr));Kt={arrayValue:{values:nr}}}else Kt=Wg(te,y,Rt)}else"in"!==dt&&"not-in"!==dt&&"array-contains-any"!==dt||Zg(Rt,dt),Kt=Lg(L,"where",Rt,"in"===dt||"not-in"===dt);const Cn=yr.create(Me,dt,Kt);return function(nr,fr){if(fr.V()){const Oi=za(nr);if(null!==Oi&&!Oi.isEqual(fr.field))throw new at(Ne.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Oi.toString()}' and '${fr.field.toString()}'`);const da=ua(nr);null!==da&&Kg(0,fr.field,da)}const $r=function(Oi,da){for(const Eu of Oi.filters)if(da.indexOf(Eu.op)>=0)return Eu.op;return null}(nr,function(Oi){switch(Oi){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(fr.op));if(null!==$r)throw new at(Ne.INVALID_ARGUMENT,$r===fr.op?`Invalid query. You cannot use more than one '${fr.op.toString()}' filter.`:`Invalid query. You cannot use '${fr.op.toString()}' filters with '${$r.toString()}' filters.`)}(y,Cn),Cn}(e._query,0,n,e.firestore._databaseId,this.zc,this.Hc,this.Jc);return new hl(e.firestore,e.converter,function(y,S){const L=y.filters.concat([S]);return new Ei(y.path,y.collectionGroup,y.explicitOrderBy.slice(),L,y.limit,y.limitType,y.startAt,y.endAt)}(e._query,c))}}class Jy extends Bf{constructor(e,n){super(),this.zc=e,this.Yc=n,this.type="orderBy"}_apply(e){const n=function(c,y,S){if(null!==c.startAt)throw new at(Ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==c.endAt)throw new at(Ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const L=new vi(y,S);return function(te,Me){if(null===ua(te)){const dt=za(te);null!==dt&&Kg(0,dt,Me.field)}}(c,L),L}(e._query,this.zc,this.Yc);return new hl(e.firestore,e.converter,function(c,y){const S=c.explicitOrderBy.concat([y]);return new Ei(c.path,c.collectionGroup,S,c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(e._query,n))}}class Vg extends Bf{constructor(e,n,c){super(),this.type=e,this.Xc=n,this.Zc=c}_apply(e){return new hl(e.firestore,e.converter,El(e._query,this.Xc,this.Zc))}}class Hg extends Bf{constructor(e,n,c){super(),this.type=e,this.ta=n,this.ea=c}_apply(e){const n=qg(e,this.type,this.ta,this.ea);return new hl(e.firestore,e.converter,(y=n,new Ei((c=e._query).path,c.collectionGroup,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,y,c.endAt)));var c,y}}class $g extends Bf{constructor(e,n,c){super(),this.type=e,this.ta=n,this.ea=c}_apply(e){const n=qg(e,this.type,this.ta,this.ea);return new hl(e.firestore,e.converter,(y=n,new Ei((c=e._query).path,c.collectionGroup,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,y)));var c,y}}function qg(s,e,n,c){if(n[0]=(0,W.m9)(n[0]),n[0]instanceof _m)return function(y,S,L,te,Me){if(!te)throw new at(Ne.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${L}().`);const dt=[];for(const Rt of ol(y))if(Rt.field.isKeyField())dt.push(Xe(S,te.key));else{const Kt=te.data.field(Rt.field);if(Wl(Kt))throw new at(Ne.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+Rt.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===Kt){const Cn=Rt.field.canonicalString();throw new at(Ne.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${Cn}' (used as the orderBy) does not exist.`)}dt.push(Kt)}return new sr(dt,Me)}(s._query,s.firestore._databaseId,e,n[0]._document,c);{const y=Ff(s.firestore);return function(S,L,te,Me,dt,Rt){const Kt=S.explicitOrderBy;if(dt.length>Kt.length)throw new at(Ne.INVALID_ARGUMENT,`Too many arguments provided to ${Me}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const Cn=[];for(let nr=0;nr<dt.length;nr++){const fr=dt[nr];if(Kt[nr].field.isKeyField()){if("string"!=typeof fr)throw new at(Ne.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${Me}(), but got a ${typeof fr}`);if(!Ys(S)&&-1!==fr.indexOf("/"))throw new at(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${Me}() must be a plain document ID, but '${fr}' contains a slash.`);const $r=S.path.child(uo.fromString(fr));if(!m.isDocumentKey($r))throw new at(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${Me}() must result in a valid document path, but '${$r}' is not because it contains an odd number of segments.`);const Oi=new m($r);Cn.push(Xe(L,Oi))}else{const $r=Lg(te,Me,fr);Cn.push($r)}}return new sr(Cn,Rt)}(s._query,s.firestore._databaseId,y,e,n,c)}}function Wg(s,e,n){if("string"==typeof(n=(0,W.m9)(n))){if(""===n)throw new at(Ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ys(e)&&-1!==n.indexOf("/"))throw new at(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const c=e.path.child(uo.fromString(n));if(!m.isDocumentKey(c))throw new at(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${c}' is not because it has an odd number of segments (${c.length}).`);return Xe(s,new m(c))}if(n instanceof Hs)return Xe(s,n._key);throw new at(Ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ld(n)}.`)}function Zg(s,e){if(!Array.isArray(s)||0===s.length)throw new at(Ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(s.length>10)throw new at(Ne.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Kg(s,e,n){if(!n.isEqual(e))throw new at(Ne.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class rg{convertValue(e,n="none"){switch(E(e)){case 0:return null;case 1:return e.booleanValue;case 2:return to(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ua(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw M()}}convertObject(e,n){const c={};return _o(e.fields,(y,S)=>{c[y]=this.convertValue(S,n)}),c}convertGeoPoint(e){return new Jm(to(e.latitude),to(e.longitude))}convertArray(e,n){return(e.values||[]).map(c=>this.convertValue(c,n))}convertServerTimestamp(e,n){switch(n){case"previous":const c=Fl(e);return null==c?null:this.convertValue(c,n);case"estimate":return this.convertTimestamp(ls(e));default:return null}}convertTimestamp(e){const n=Wi(e);return new ji(n.seconds,n.nanos)}convertDocumentKey(e,n){const c=uo.fromString(e);J(mh(c));const y=new ud(c.get(1),c.get(3)),S=new m(c.popFirst(5));return y.isEqual(n)||Mi(`Document ${S} contains a document reference within a different database (${y.projectId}/${y.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),S}}function bm(s,e,n){let c;return c=s?n&&(n.merge||n.mergeFields)?s.toFirestore(e,n):s.toFirestore(e):e,c}class t_ extends rg{constructor(e){super(),this.firestore=e}convertBytes(e){return new rh(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Hs(this.firestore,null,n)}}class Yg{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ff(e)}set(e,n,c){this._verifyNotCommitted();const y=Uf(e,this._firestore),S=bm(y.converter,n,c),L=mm(this._dataReader,"WriteBatch.set",y._key,S,null!==y.converter,c);return this._mutations.push(L.toMutation(y._key,Js.none())),this}update(e,n,c,...y){this._verifyNotCommitted();const S=Uf(e,this._firestore);let L;return L="string"==typeof(n=(0,W.m9)(n))||n instanceof Hd?Qm(this._dataReader,"WriteBatch.update",S._key,n,c,y):Og(this._dataReader,"WriteBatch.update",S._key,n),this._mutations.push(L.toMutation(S._key,Js.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Uf(e,this._firestore);return this._mutations=this._mutations.concat(new Bh(n._key,Js.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new at(Ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Uf(s,e){if((s=(0,W.m9)(s)).firestore!==e)throw new at(Ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}class zf extends rg{constructor(e){super(),this.firestore=e}convertBytes(e){return new rh(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Hs(this.firestore,null,n)}}function i_(s,e,n){s=ho(s,Hs);const c=ho(s.firestore,Ra),y=bm(s.converter,e,n);return Up(c,[mm(Ff(c),"setDoc",s._key,y,null!==s.converter,n).toMutation(s._key,Js.none())])}function Jg(s,e,n,...c){s=ho(s,Hs);const y=ho(s.firestore,Ra),S=Ff(y);let L;return L="string"==typeof(e=(0,W.m9)(e))||e instanceof Hd?Qm(S,"updateDoc",s._key,e,n,c):Og(S,"updateDoc",s._key,e),Up(y,[L.toMutation(s._key,Js.exists(!0))])}function Xg(s,...e){var n,c,y;s=(0,W.m9)(s);let S={includeMetadataChanges:!1},L=0;"object"!=typeof e[L]||Ag(e[L])||(S=e[L],L++);const te={includeMetadataChanges:S.includeMetadataChanges};if(Ag(e[L])){const Kt=e[L];e[L]=null===(n=Kt.next)||void 0===n?void 0:n.bind(Kt),e[L+1]=null===(c=Kt.error)||void 0===c?void 0:c.bind(Kt),e[L+2]=null===(y=Kt.complete)||void 0===y?void 0:y.bind(Kt)}let Me,dt,Rt;if(s instanceof Hs)dt=ho(s.firestore,Ra),Rt=ko(s._key.path),Me={next:Kt=>{e[L]&&e[L](Qg(dt,s,Kt))},error:e[L+1],complete:e[L+2]};else{const Kt=ho(s,hl);dt=ho(Kt.firestore,Ra),Rt=Kt._query;const Cn=new zf(dt);Me={next:nr=>{e[L]&&e[L](new Oh(dt,Cn,Kt,nr))},error:e[L+1],complete:e[L+2]},Ug(s._query)}return function(Kt,Cn,nr,fr){const $r=new Ep(fr),Oi=new td(Cn,$r,nr);return Kt.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return kd(yield kc(Kt),Oi)})),()=>{$r.nc(),Kt.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return Pc(yield kc(Kt),Oi)}))}}(Fu(dt),Rt,te,Me)}function Up(s,e){return function(n,c){const y=new pn;return n.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return function rc(s,e,n){return Bd.apply(this,arguments)}(yield Ap(n),c,y)})),y.promise}(Fu(s),e)}function Qg(s,e,n){const c=n.docs.get(e._key),y=new zf(s);return new Gd(s,y,e._key,c,new $d(n.hasPendingWrites,n.fromCache),e.converter)}class s_ extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Ff(e)}get(e){const n=Uf(e,this._firestore),c=new t_(this._firestore);return this._transaction.lookup([n._key]).then(y=>{if(!y||1!==y.length)return M();const S=y[0];if(S.isFoundDocument())return new _m(this._firestore,c,S.key,S,n.converter);if(S.isNoDocument())return new _m(this._firestore,c,n._key,null,n.converter);throw M()})}set(e,n,c){const y=Uf(e,this._firestore),S=bm(y.converter,n,c),L=mm(this._dataReader,"Transaction.set",y._key,S,null!==y.converter,c);return this._transaction.set(y._key,L),this}update(e,n,c,...y){const S=Uf(e,this._firestore);let L;return L="string"==typeof(n=(0,W.m9)(n))||n instanceof Hd?Qm(this._dataReader,"Transaction.update",S._key,n,c,y):Og(this._dataReader,"Transaction.update",S._key,n),this._transaction.update(S._key,L),this}delete(e){const n=Uf(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Uf(e,this._firestore),c=new zf(this._firestore);return super.get(e).then(y=>new Gd(this._firestore,c,n._key,y._document,new $d(!1,!1),n.converter))}}function uc(s,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new at("invalid-argument",`Invalid options passed to function ${s}(): You cannot specify both "merge" and "mergeFields".`);return e}function Oc(){if("undefined"==typeof Uint8Array)throw new at("unimplemented","Uint8Arrays are not available in this environment.")}function ny(){if(!function xl(){return"undefined"!=typeof atob}())throw new at("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(s,e=!0){hu=je.SDK_VERSION,(0,je._registerComponent)(new Ae.wA("firestore",(n,{options:c})=>{const y=n.getProvider("app").getImmediate(),S=new Ra(y,new si(n.getProvider("auth-internal")),new xa(n.getProvider("app-check-internal")));return c=Object.assign({useFetchStreams:e},c),S._setSettings(c),S},"PUBLIC")),(0,je.registerVersion)(Qo,"3.4.3",s),(0,je.registerVersion)(Qo,"3.4.3","esm2017")}();class zp{constructor(e){this._delegate=e}static fromBase64String(e){return ny(),new zp(rh.fromBase64String(e))}static fromUint8Array(e){return Oc(),new zp(rh.fromUint8Array(e))}toBase64(){return ny(),this._delegate.toBase64()}toUint8Array(){return Oc(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function ry(s){return function Ov(s,e){if("object"!=typeof s||null===s)return!1;const n=s;for(const c of e)if(c in n&&"function"==typeof n[c])return!0;return!1}(s,["next","error","complete"])}class Lv{enableIndexedDbPersistence(e,n){return function yv(s,e){xv(s=ho(s,Ra));const n=Fu(s),c=s._freezeSettings(),y=new Cf;return Hy(n,y,new jd(y,c.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return function jy(s){xv(s=ho(s,Ra));const e=Fu(s),n=s._freezeSettings(),c=new Cf;return Hy(e,c,new Gm(c,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function _v(s){if(s._initialized&&!s._terminated)throw new at(Ne.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new pn;return s._queue.enqueueAndForgetEvenWhileRestricted((0,he.Z)(function*(){try{yield(n=(0,he.Z)(function*(c){if(!nu.Pt())return Promise.resolve();const y=c+"main";yield nu.delete(y)}),function(c){return n.apply(this,arguments)})(Ii(s._databaseId,s._persistenceKey)),e.resolve()}catch(n){e.reject(n)}var n})),e.promise}(e._delegate)}}class l_{constructor(e,n,c){this._delegate=n,this._persistenceProvider=c,this.INTERNAL={delete:()=>this.terminate()},e instanceof ud||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&V("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},n),e)).merge,this._delegate._setSettings(e)}useEmulator(e,n,c={}){!function kp(s,e,n,c={}){var y;const S=(s=ho(s,kh))._getSettings();if("firestore.googleapis.com"!==S.host&&S.host!==e&&V("Host has been set in both settings() and useEmulator(), emulator host will be used"),s._setSettings(Object.assign(Object.assign({},S),{host:`${e}:${n}`,ssl:!1})),c.mockUserToken){let L,te;if("string"==typeof c.mockUserToken)L=c.mockUserToken,te=So.MOCK_USER;else{L=(0,W.Sg)(c.mockUserToken,null===(y=s._app)||void 0===y?void 0:y.options.projectId);const Me=c.mockUserToken.sub||c.mockUserToken.user_id;if(!Me)throw new at(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");te=new So(Me)}s._authCredentials=new Pr(new wn(L,te))}}(this._delegate,e,n,c)}enableNetwork(){return function bv(s){return function Ym(s){return s.asyncQueue.enqueue((0,he.Z)(function*(){const e=yield Km(s),n=yield Mf(s);return e.setNetworkEnabled(!0),function(c){const y=De(c);return y.Gr.delete(0),Nr(y)}(n)}))}(Fu(s=ho(s,Ra)))}(this._delegate)}disableNetwork(){return function Pg(s){return function Pp(s){return s.asyncQueue.enqueue((0,he.Z)(function*(){const e=yield Km(s),n=yield Mf(s);return e.setNetworkEnabled(!1),(c=(0,he.Z)(function*(y){const S=De(y);S.Gr.add(0),yield ti(S),S.Jr.set("Offline")}),function(y){return c.apply(this,arguments)})(n);var c}))}(Fu(s=ho(s,Ra)))}(this._delegate)}enablePersistence(e){let n=!1,c=!1;return e&&(n=!!e.synchronizeTabs,c=!!e.experimentalForceOwningTab,Rf("synchronizeTabs",n,"experimentalForceOwningTab",c)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,c)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function vv(s){return function(e){const n=new pn;return e.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return function Tf(s,e){return Mh.apply(this,arguments)}(yield Ap(e),n)})),n.promise}(Fu(s=ho(s,Ra)))}(this._delegate)}onSnapshotsInSync(e){return function Bp(s,e){return function Tg(s,e){const n=new Ep(e);return s.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return c=yield kc(s),y=n,De(c).io.add(y),void y.next();var c,y})),()=>{n.nc(),s.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return c=yield kc(s),y=n,void De(c).io.delete(y);var c,y}))}}(Fu(s=ho(s,Ra)),Ag(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new at("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new jf(this,Sg(this._delegate,e))}catch(n){throw _l(n,"collection()","Firestore.collection()")}}doc(e){try{return new lc(this,fm(this._delegate,e))}catch(n){throw _l(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new dl(this,function Uy(s,e){if(s=ho(s,kh),dm("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new at(Ne.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new hl(s,null,(n=e,new Ei(uo.emptyPath(),n)));var n}(this._delegate,e))}catch(n){throw _l(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function kv(s,e){return function Rh(s,e){const n=new pn;return s.asyncQueue.enqueueAndForget((0,he.Z)(function*(){const c=yield(y=s,Dp(y).then(S=>S.datastore));var y;new cm(s.asyncQueue,c,e,n).run()})),n.promise}(Fu(s=ho(s,Ra)),n=>e(new s_(s,n)))}(this._delegate,n=>e(new c_(this,n)))}batch(){return Fu(this._delegate),new iy(new Yg(this._delegate,e=>Up(this._delegate,e)))}loadBundle(e){return function wv(s,e){const n=Fu(s=ho(s,Ra)),c=new Vy;return function hm(s,e,n,c){const y=function(S,L){let te;return te="string"==typeof S?(new TextEncoder).encode(S):S,Me=function(Me,dt){if(Me instanceof Uint8Array)return Df(Me,void 0);if(Me instanceof ArrayBuffer)return Df(new Uint8Array(Me),void 0);if(Me instanceof ReadableStream)return Me.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(te),new cl(Me,L);var Me}(n,Tn(e));s.asyncQueue.enqueueAndForget((0,he.Z)(function*(){!function Hm(s,e,n){const c=De(s);var y;(y=(0,he.Z)(function*(S,L,te){try{const Me=yield L.getMetadata();if(yield function(Cn,nr){const fr=De(Cn),$r=Da(nr.createTime);return fr.persistence.runTransaction("hasNewerBundle","readonly",Oi=>fr.Ye.getBundleMetadata(Oi,nr.id)).then(Oi=>!!Oi&&Oi.createTime.compareTo($r)>=0)}(S.localStore,Me))return yield L.close(),void te._completeWith((Cn=Me,{taskState:"Success",documentsLoaded:Cn.totalDocuments,bytesLoaded:Cn.totalBytes,totalDocuments:Cn.totalDocuments,totalBytes:Cn.totalBytes}));te._updateProgress(Ch(Me));const dt=new vf(Me,S.localStore,L.k);let Rt=yield L.Ho();for(;Rt;){const Cn=yield dt.yo(Rt);Cn&&te._updateProgress(Cn),Rt=yield L.Ho()}const Kt=yield dt.complete();yield sc(S,Kt.In,void 0),yield function(Cn,nr){const fr=De(Cn);return fr.persistence.runTransaction("Save bundle","readwrite",$r=>fr.Ye.saveBundleMetadata($r,nr))}(S.localStore,Me),te._completeWith(Kt.progress)}catch(Me){V("SyncEngine",`Loading bundle failed with ${Me}`),te._failWith(Me)}var Cn}),function(S,L,te){return y.apply(this,arguments)})(c,e,n).then(()=>{c.sharedClientState.notifyBundleLoaded()})}(yield Ap(s),y,c)}))}(n,s._databaseId,e,c),c}(this._delegate,e)}namedQuery(e){return function mb(s,e){return function yl(s,e){return s.asyncQueue.enqueue((0,he.Z)(function*(){return function(n,c){const y=De(n);return y.persistence.runTransaction("Get named query","readonly",S=>y.Ye.getNamedQuery(S,c))}(yield ql(s),e)}))}(Fu(s=ho(s,Ra)),e).then(n=>n?new hl(s,null,n.query):null)}(this._delegate,e).then(n=>n?new dl(this,n):null)}}class Vp extends rg{constructor(e){super(),this.firestore=e}convertBytes(e){return new zp(new rh(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return lc.forKey(n,this.firestore,null)}}class c_{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Vp(e)}get(e){const n=qd(e);return this._delegate.get(n).then(c=>new jp(this._firestore,new Gd(this._firestore._delegate,this._userDataWriter,c._key,c._document,c.metadata,n.converter)))}set(e,n,c){const y=qd(e);return c?(uc("Transaction.set",c),this._delegate.set(y,n,c)):this._delegate.set(y,n),this}update(e,n,c,...y){const S=qd(e);return 2===arguments.length?this._delegate.update(S,n):this._delegate.update(S,n,c,...y),this}delete(e){const n=qd(e);return this._delegate.delete(n),this}}class iy{constructor(e){this._delegate=e}set(e,n,c){const y=qd(e);return c?(uc("WriteBatch.set",c),this._delegate.set(y,n,c)):this._delegate.set(y,n),this}update(e,n,c,...y){const S=qd(e);return 2===arguments.length?this._delegate.update(S,n):this._delegate.update(S,n,c,...y),this}delete(e){const n=qd(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Vf{constructor(e,n,c){this._firestore=e,this._userDataWriter=n,this._delegate=c}fromFirestore(e,n){const c=new vm(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Hp(this._firestore,c),null!=n?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const c=Vf.INSTANCES;let y=c.get(e);y||(y=new WeakMap,c.set(e,y));let S=y.get(n);return S||(S=new Vf(e,new Vp(e),n),y.set(n,S)),S}}Vf.INSTANCES=new WeakMap;class lc{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Vp(e)}static forPath(e,n,c){if(e.length%2!=0)throw new at("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new lc(n,new Hs(n._delegate,c,new m(e)))}static forKey(e,n,c){return new lc(n,new Hs(n._delegate,c,e))}get id(){return this._delegate.id}get parent(){return new jf(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new jf(this.firestore,Sg(this._delegate,e))}catch(n){throw _l(n,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,W.m9)(e))instanceof Hs&&Cg(this._delegate,e)}set(e,n){n=uc("DocumentReference.set",n);try{return n?i_(this._delegate,e,n):i_(this._delegate,e)}catch(c){throw _l(c,"setDoc()","DocumentReference.set()")}}update(e,n,...c){try{return 1===arguments.length?Jg(this._delegate,e):Jg(this._delegate,e,n,...c)}catch(y){throw _l(y,"updateDoc()","DocumentReference.update()")}}delete(){return function Rv(s){return Up(ho(s.firestore,Ra),[new Bh(s._key,Js.none())])}(this._delegate)}onSnapshot(...e){const n=xm(e),c=h_(e,y=>new jp(this.firestore,new Gd(this.firestore._delegate,this._userDataWriter,y._key,y._document,y.metadata,this._delegate.converter)));return Xg(this._delegate,n,c)}get(e){let n;return n="cache"===(null==e?void 0:e.source)?function n_(s){s=ho(s,Hs);const e=ho(s.firestore,Ra),n=Fu(e),c=new zf(e);return function fv(s,e){const n=new pn;return s.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return(c=(0,he.Z)(function*(y,S,L){try{const te=yield function(Me,dt){const Rt=De(Me);return Rt.persistence.runTransaction("read document","readonly",Kt=>Rt.Wn.Rn(Kt,dt))}(y,S);te.isFoundDocument()?L.resolve(te):te.isNoDocument()?L.resolve(null):L.reject(new at(Ne.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(te){const Me=Mc(te,`Failed to get document '${S} from cache`);L.reject(Me)}}),function(y,S,L){return c.apply(this,arguments)})(yield ql(s),e,n);var c})),n.promise}(n,s._key).then(y=>new Gd(e,c,s._key,y,new $d(null!==y&&y.hasLocalMutations,!0),s.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function Mv(s){s=ho(s,Hs);const e=ho(s.firestore,Ra);return Rp(Fu(e),s._key,{source:"server"}).then(n=>Qg(e,s,n))}(this._delegate):function Av(s){s=ho(s,Hs);const e=ho(s.firestore,Ra);return Rp(Fu(e),s._key).then(n=>Qg(e,s,n))}(this._delegate),n.then(c=>new jp(this.firestore,new Gd(this.firestore._delegate,this._userDataWriter,c._key,c._document,c.metadata,this._delegate.converter)))}withConverter(e){return new lc(this.firestore,this._delegate.withConverter(e?Vf.getInstance(this.firestore,e):null))}}function _l(s,e,n){return s.message=s.message.replace(e,n),s}function xm(s){for(const e of s)if("object"==typeof e&&!ry(e))return e;return{}}function h_(s,e){var n,c;let y;return y=ry(s[0])?s[0]:ry(s[1])?s[1]:"function"==typeof s[0]?{next:s[0],error:s[1],complete:s[2]}:{next:s[1],error:s[2],complete:s[3]},{next:S=>{y.next&&y.next(e(S))},error:null===(n=y.error)||void 0===n?void 0:n.bind(y),complete:null===(c=y.complete)||void 0===c?void 0:c.bind(y)}}class jp{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new lc(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Ky(this._delegate,e._delegate)}}class Hp extends jp{data(e){const n=this._delegate.data(e);return function ye(s,e){s||M()}(void 0!==n),n}}class dl{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Vp(e)}where(e,n,c){try{return new dl(this.firestore,hd(this._delegate,function zg(s,e,n){const c=e,y=Fp("where",s);return new Yy(y,c,n)}(e,n,c)))}catch(y){throw _l(y,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new dl(this.firestore,hd(this._delegate,function Cv(s,e="asc"){const n=e,c=Fp("orderBy",s);return new Jy(c,n)}(e,n)))}catch(c){throw _l(c,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new dl(this.firestore,hd(this._delegate,function Xy(s){return Lf("limit",s),new Vg("limit",s,"F")}(e)))}catch(n){throw _l(n,"limit()","Query.limit()")}}limitToLast(e){try{return new dl(this.firestore,hd(this._delegate,function jg(s){return Lf("limitToLast",s),new Vg("limitToLast",s,"L")}(e)))}catch(n){throw _l(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new dl(this.firestore,hd(this._delegate,function Dv(...s){return new Hg("startAt",s,!0)}(...e)))}catch(n){throw _l(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new dl(this.firestore,hd(this._delegate,function Qy(...s){return new Hg("startAfter",s,!1)}(...e)))}catch(n){throw _l(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new dl(this.firestore,hd(this._delegate,function e_(...s){return new $g("endBefore",s,!0)}(...e)))}catch(n){throw _l(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new dl(this.firestore,hd(this._delegate,function Gg(...s){return new $g("endAt",s,!1)}(...e)))}catch(n){throw _l(n,"endAt()","Query.endAt()")}}isEqual(e){return Dg(this._delegate,e._delegate)}get(e){let n;return n="cache"===(null==e?void 0:e.source)?function r_(s){s=ho(s,hl);const e=ho(s.firestore,Ra),n=Fu(e),c=new zf(e);return function pv(s,e){const n=new pn;return s.asyncQueue.enqueueAndForget((0,he.Z)(function*(){return(c=(0,he.Z)(function*(y,S,L){try{const te=yield ts(y,S,!0),Me=new bf(S,te.zn),dt=Me.Po(te.documents),Rt=Me.applyChanges(dt,!1);L.resolve(Rt.snapshot)}catch(te){const Me=Mc(te,`Failed to execute query '${S} against cache`);L.reject(Me)}}),function(y,S,L){return c.apply(this,arguments)})(yield ql(s),e,n);var c})),n.promise}(n,s._query).then(y=>new Oh(e,c,s,y))}(this._delegate):"server"===(null==e?void 0:e.source)?function Pv(s){s=ho(s,hl);const e=ho(s.firestore,Ra),n=Fu(e),c=new zf(e);return By(n,s._query,{source:"server"}).then(y=>new Oh(e,c,s,y))}(this._delegate):function Bu(s){s=ho(s,hl);const e=ho(s.firestore,Ra),n=Fu(e),c=new zf(e);return Ug(s._query),By(n,s._query).then(y=>new Oh(e,c,s,y))}(this._delegate),n.then(c=>new og(this.firestore,new Oh(this.firestore._delegate,this._userDataWriter,this._delegate,c._snapshot)))}onSnapshot(...e){const n=xm(e),c=h_(e,y=>new og(this.firestore,new Oh(this.firestore._delegate,this._userDataWriter,this._delegate,y._snapshot)));return Xg(this._delegate,n,c)}withConverter(e){return new dl(this.firestore,this._delegate.withConverter(e?Vf.getInstance(this.firestore,e):null))}}class ig{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Hp(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class og{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new dl(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Hp(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new ig(this._firestore,n))}forEach(e,n){this._delegate.forEach(c=>{e.call(n,new Hp(this._firestore,c))})}isEqual(e){return Ky(this._delegate,e._delegate)}}class jf extends dl{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new lc(this.firestore,e):null}doc(e){try{return new lc(this.firestore,void 0===e?fm(this._delegate):fm(this._delegate,e))}catch(n){throw _l(n,"doc()","CollectionReference.doc()")}}add(e){return function o_(s,e){const n=ho(s.firestore,Ra),c=fm(s),y=bm(s.converter,e);return Up(n,[mm(Ff(s.firestore),"addDoc",c._key,y,null!==s.converter,{}).toMutation(c._key,Js.exists(!1))]).then(()=>c)}(this._delegate,e).then(n=>new lc(this.firestore,n))}isEqual(e){return Cg(this._delegate,e._delegate)}withConverter(e){return new jf(this.firestore,this._delegate.withConverter(e?Vf.getInstance(this.firestore,e):null))}}function qd(s){return ho(s,Hs)}class sg{constructor(...e){this._delegate=new Hd(...e)}static documentId(){return new sg(es.keyField().canonicalString())}isEqual(e){return(e=(0,W.m9)(e))instanceof Hd&&this._delegate._internalPath.isEqual(e._internalPath)}}class Wd{constructor(e){this._delegate=e}static serverTimestamp(){const e=function yb(){return new kg("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Wd(e)}static delete(){const e=function a_(){return new gm("deleteField")}();return e._methodName="FieldValue.delete",new Wd(e)}static arrayUnion(...e){const n=function ey(...s){return new Iv("arrayUnion",s)}(...e);return n._methodName="FieldValue.arrayUnion",new Wd(n)}static arrayRemove(...e){const n=function ty(...s){return new Tv("arrayRemove",s)}(...e);return n._methodName="FieldValue.arrayRemove",new Wd(n)}static increment(e){const n=function ih(s){return new Wy("increment",s)}(e);return n._methodName="FieldValue.increment",new Wd(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const d_={Firestore:l_,GeoPoint:Jm,Timestamp:ji,Blob:zp,Transaction:c_,WriteBatch:iy,DocumentReference:lc,DocumentSnapshot:jp,Query:dl,QueryDocumentSnapshot:Hp,QuerySnapshot:og,CollectionReference:jf,FieldPath:sg,FieldValue:Wd,setLogLevel:function wm(s){!function il(s){aa.setLogLevel(s)}(s)},CACHE_SIZE_UNLIMITED:-1};!function p_(s){(function f_(s,e){s.INTERNAL.registerComponent(new Ae.wA("firestore-compat",n=>{const c=n.getProvider("app-compat").getImmediate(),y=n.getProvider("firestore").getImmediate();return e(c,y)},"PUBLIC").setServiceProps(Object.assign({},d_)))})(s,(e,n)=>new l_(e,n,new Lv)),s.registerVersion("@firebase/firestore-compat","0.1.12")}(ut.Z);var Nv=H(7579),Fv=H(6451),ag=H(5363),Zd=H(3900),Bv=H(4707),Uv=H(3099);function m_(s,e,n){var c,y;let S,L=!1;return s&&"object"==typeof s?(S=null!==(c=s.bufferSize)&&void 0!==c?c:1/0,e=null!==(y=s.windowTime)&&void 0!==y?y:1/0,L=!!s.refCount,n=s.scheduler):S=null!=s?s:1/0,(0,Uv.B)({connector:()=>new Bv.t(S,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:L})}var zv=H(590),Vv=H(576);function g_(s,e){return(0,Vv.m)(e)?(0,Zd.w)(()=>s,e):(0,Zd.w)(()=>s)}var oy=H(9468);H(5867);const Kd=new Map,Qv={activated:!1,tokenObservers:[]},e0={initialized:!1,enabled:!1};function ka(s){return Kd.get(s)||Qv}function Nh(s,e){Kd.set(s,e)}function $p(){return e0}class n0{constructor(e,n,c,y,S){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=c,this.lowerBound=y,this.upperBound=S,this.pending=null,this.nextErrorWaitInterval=y,y>S)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var n=this;return(0,he.Z)(function*(){n.stop();try{n.pending=new W.BH,yield function r0(s){return new Promise(e=>{setTimeout(e,s)})}(n.getNextRun(e)),n.pending.resolve(),yield n.pending.promise,n.pending=new W.BH,yield n.operation(),n.pending.resolve(),yield n.pending.promise,n.process(!0).catch(()=>{})}catch(c){n.retryPolicy(c)?n.process(!1).catch(()=>{}):n.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}const Rl=new W.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Em(s){if(!ka(s).activated)throw Rl.create("use-before-activation",{appName:s.name})}function ay(s,e){return uy.apply(this,arguments)}function uy(){return uy=(0,he.Z)(function*({url:s,body:e},n){const c={"Content-Type":"application/json"},y=n.getImmediate({optional:!0});y&&(c["X-Firebase-Client"]=y.getPlatformInfoString());const S={method:"POST",body:JSON.stringify(e),headers:c};let L,te;try{L=yield fetch(s,S)}catch(Kt){throw Rl.create("fetch-network-error",{originalErrorMessage:Kt.message})}if(200!==L.status)throw Rl.create("fetch-status-error",{httpStatus:L.status});try{te=yield L.json()}catch(Kt){throw Rl.create("fetch-parse-error",{originalErrorMessage:Kt.message})}const Me=te.ttl.match(/^([\d.]+)(s)$/);if(!Me||!Me[2]||isNaN(Number(Me[1])))throw Rl.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${te.ttl}`});const dt=1e3*Number(Me[1]),Rt=Date.now();return{token:te.attestationToken,expireTimeMillis:Rt+dt,issuedAtTimeMillis:Rt}}),uy.apply(this,arguments)}function S_(s,e){const{projectId:n,appId:c,apiKey:y}=s.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1beta/projects/${n}/apps/${c}:exchangeDebugToken?key=${y}`,body:{debug_token:e}}}const Tm="firebase-app-check-store";let Yd=null;function A_(){return Yd||(Yd=new Promise((s,e)=>{try{const n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=c=>{s(c.target.result)},n.onerror=c=>{var y;e(Rl.create("storage-open",{originalErrorMessage:null===(y=c.target.error)||void 0===y?void 0:y.message}))},n.onupgradeneeded=c=>{0===c.oldVersion&&c.target.result.createObjectStore(Tm,{keyPath:"compositeKey"})}}catch(n){e(Rl.create("storage-open",{originalErrorMessage:n.message}))}}),Yd)}function hg(){return hg=(0,he.Z)(function*(s,e){const c=(yield A_()).transaction(Tm,"readwrite"),S=c.objectStore(Tm).put({compositeKey:s,value:e});return new Promise((L,te)=>{S.onsuccess=Me=>{L()},c.onerror=Me=>{var dt;te(Rl.create("storage-set",{originalErrorMessage:null===(dt=Me.target.error)||void 0===dt?void 0:dt.message}))}})}),hg.apply(this,arguments)}const Sm=new j.Yd("@firebase/app-check");function hy(s,e){return(0,W.hl)()?function a0(s,e){return function ly(s,e){return hg.apply(this,arguments)}(function Gp(s){return`${s.options.appId}-${s.name}`}(s),e)}(s,e).catch(n=>{Sm.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function k_(){return $p().enabled}function dy(){return fy.apply(this,arguments)}function fy(){return fy=(0,he.Z)(function*(){const s=$p();if(s.enabled&&s.token)return s.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),fy.apply(this,arguments)}const xb={error:"UNKNOWN_ERROR"};function Eb(s){return W.US.encodeString(JSON.stringify(s),!1)}function py(s){return O_.apply(this,arguments)}function O_(){return O_=(0,he.Z)(function*(s,e=!1){const n=s.app;Em(n);const c=ka(n);let S,y=c.token;if(!y){const Me=yield c.cachedTokenPromise;Me&&Jd(Me)&&(y=Me)}if(!e&&y&&Jd(y))return{token:y.token};let te,L=!1;if(k_()){c.exchangeTokenPromise||(c.exchangeTokenPromise=ay(S_(n,yield dy()),s.platformLoggerProvider).then(dt=>(c.exchangeTokenPromise=void 0,dt)),L=!0);const Me=yield c.exchangeTokenPromise;return yield hy(n,Me),Nh(n,Object.assign(Object.assign({},c),{token:Me})),{token:Me.token}}try{c.exchangeTokenPromise||(c.exchangeTokenPromise=c.provider.getToken().then(Me=>(c.exchangeTokenPromise=void 0,Me)),L=!0),y=yield c.exchangeTokenPromise}catch(Me){"appCheck/throttled"===Me.code?Sm.warn(Me.message):Sm.error(Me),S=Me}return y?(te={token:y.token},Nh(n,Object.assign(Object.assign({},c),{token:y})),yield hy(n,y)):te=h0(S),L&&my(n,te),te}),O_.apply(this,arguments)}function qp(s,e){const n=ka(s),c=n.tokenObservers.filter(y=>y.next!==e);0===c.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),Nh(s,Object.assign(Object.assign({},n),{tokenObservers:c}))}function L_(s){const{app:e}=s,n=ka(e);let c=n.tokenRefresher;c||(c=function c0(s){const{app:e}=s;return new n0((0,he.Z)(function*(){let c;if(c=ka(e).token?yield py(s,!0):yield py(s),c.error)throw c.error}),()=>!0,()=>{const n=ka(e);if(n.token){let c=n.token.issuedAtTimeMillis+.5*(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)+3e5;return c=Math.min(c,n.token.expireTimeMillis-3e5),Math.max(0,c-Date.now())}return 0},3e4,96e4)}(s),Nh(e,Object.assign(Object.assign({},n),{tokenRefresher:c}))),!c.isRunning()&&n.isTokenAutoRefreshEnabled&&c.start()}function my(s,e){const n=ka(s).tokenObservers;for(const c of n)try{"EXTERNAL"===c.type&&null!=e.error?c.error(e.error):c.next(e)}catch(y){}}function Jd(s){return s.expireTimeMillis-Date.now()>0}function h0(s){return{token:Eb(xb),error:s}}class d0{constructor(e,n){this.app=e,this.platformLoggerProvider=n}_delete(){const{tokenObservers:e}=ka(this.app);for(const n of e)qp(this.app,n.next);return Promise.resolve()}}const j_="app-check-internal";!function x0(){(0,je._registerComponent)(new Ae.wA("app-check",s=>function f0(s,e){return new d0(s,e)}(s.getProvider("app").getImmediate(),s.getProvider("platform-logger")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((s,e,n)=>{s.getProvider(j_).initialize()})),(0,je._registerComponent)(new Ae.wA(j_,s=>function p0(s){return{getToken:e=>py(s,e),addTokenListener:e=>function fg(s,e,n,c){const{app:y}=s,S=ka(y),L={next:n,error:c,type:e};if(Nh(y,Object.assign(Object.assign({},S),{tokenObservers:[...S.tokenObservers,L]})),S.token&&Jd(S.token)){const te=S.token;Promise.resolve().then(()=>{n({token:te.token}),L_(s)}).catch(()=>{})}S.cachedTokenPromise.then(()=>L_(s))}(s,"INTERNAL",e),removeTokenListener:e=>qp(s.app,e)}}(s.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,je.registerVersion)("@firebase/app-check","0.5.3")}();class Iy{constructor(){return(0,Le.vb)("app-check")}}"undefined"!=typeof window&&window;var A0=H(127);const W_=new w.OlP("angularfire2.auth.use-emulator"),Sy=new w.OlP("angularfire2.auth.settings"),Z_=new w.OlP("angularfire2.auth.tenant-id"),Cy=new w.OlP("angularfire2.auth.langugage-code"),P0=new w.OlP("angularfire2.auth.use-device-language"),K_=new w.OlP("angularfire.auth.persistence"),Zp=(s,e,n,c,y,S,L,te)=>(0,bt.cc)(`${s.name}.auth`,"AngularFireAuth",s.name,()=>{const Me=e.runOutsideAngular(()=>s.auth());if(n&&Me.useEmulator(...n),c&&(Me.tenantId=c),Me.languageCode=y,S&&Me.useDeviceLanguage(),L)for(const[dt,Rt]of Object.entries(L))Me.settings[dt]=Rt;return te&&Me.setPersistence(te),Me},[n,c,y,S,L,te]);let Y_=(()=>{class s{constructor(n,c,y,S,L,te,Me,dt,Rt,Kt,Cn,nr){const fr=new Nv.x,$r=(0,xe.of)(void 0).pipe((0,ag.Q)(L.outsideAngular),(0,Zd.w)(()=>S.runOutsideAngular(()=>Promise.resolve().then(H.bind(H,1488)))),(0,ae.U)(()=>(0,bt.on)(n,S,c)),(0,ae.U)(Oi=>Zp(Oi,S,te,dt,Rt,Kt,Me,Cn)),m_({bufferSize:1,refCount:!1}));if((0,Ct.PM)(y))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,xe.of)(null);else{$r.pipe((0,zv.P)()).subscribe();const da=$r.pipe((0,Zd.w)(ws=>ws.getRedirectResult().then(Iu=>Iu,()=>null)),Le.iC,m_({bufferSize:1,refCount:!1})),Eu=$r.pipe((0,Zd.w)(ws=>new g.y(Iu=>({unsubscribe:S.runOutsideAngular(()=>ws.onAuthStateChanged(oh=>Iu.next(oh),oh=>Iu.error(oh),()=>Iu.complete()))})))),cc=$r.pipe((0,Zd.w)(ws=>new g.y(Iu=>({unsubscribe:S.runOutsideAngular(()=>ws.onIdTokenChanged(oh=>Iu.next(oh),oh=>Iu.error(oh),()=>Iu.complete()))}))));this.authState=da.pipe(g_(Eu),(0,oy.R)(L.outsideAngular),(0,ag.Q)(L.insideAngular)),this.user=da.pipe(g_(cc),(0,oy.R)(L.outsideAngular),(0,ag.Q)(L.insideAngular)),this.idToken=this.user.pipe((0,Zd.w)(ws=>ws?(0,nt.D)(ws.getIdToken()):(0,xe.of)(null))),this.idTokenResult=this.user.pipe((0,Zd.w)(ws=>ws?(0,nt.D)(ws.getIdTokenResult()):(0,xe.of)(null))),this.credential=(0,Fv.T)(da,fr,this.authState.pipe((0,pt.h)(ws=>!ws))).pipe((0,ae.U)(ws=>(null==ws?void 0:ws.user)?ws:null),(0,oy.R)(L.outsideAngular),(0,ag.Q)(L.insideAngular))}return(0,bt.pX)(this,$r,S,{spy:{apply:(Oi,da,Eu)=>{(Oi.startsWith("signIn")||Oi.startsWith("createUser"))&&Eu.then(cc=>fr.next(cc))}}})}}return s.\u0275fac=function(n){return new(n||s)(w.LFG(bt.Dh),w.LFG(bt.xv,8),w.LFG(w.Lbi),w.LFG(w.R0b),w.LFG(Le.HU),w.LFG(W_,8),w.LFG(Sy,8),w.LFG(Z_,8),w.LFG(Cy,8),w.LFG(P0,8),w.LFG(K_,8),w.LFG(Iy,8))},s.\u0275prov=w.Yz7({token:s,factory:s.\u0275fac,providedIn:"any"}),s})();function J_(s,e){return function Am(s,e=ue.z){return new g.y(n=>{let c;return null!=e?e.schedule(()=>{c=s.onSnapshot({includeMetadataChanges:!0},n)}):c=s.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=c&&c()}})}(s,e)}function mg(s,e){return J_(s,e).pipe((0,ae.U)(n=>({payload:n,type:"query"})))}function gg(s,e){return mg(s,e).pipe((0,se.O)(void 0),fe(),(0,ae.U)(([n,c])=>{const y=c.payload.docChanges(),S=y.map(L=>({type:L.type,payload:L}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(c.payload.metadata)&&c.payload.docs.forEach((L,te)=>{const Me=y.find(Rt=>Rt.doc.ref.isEqual(L.ref)),dt=null==n?void 0:n.payload.docs.find(Rt=>Rt.ref.isEqual(L.ref));Me&&JSON.stringify(Me.doc.metadata)===JSON.stringify(L.metadata)||!Me&&dt&&JSON.stringify(dt.metadata)===JSON.stringify(L.metadata)||S.push({type:"modified",payload:{oldIndex:te,newIndex:te,type:"modified",doc:L}})}),S}))}function X_(s,e,n){return gg(s,n).pipe((0,$e.R)((c,y)=>function R0(s,e,n){return e.forEach(c=>{n.indexOf(c.type)>-1&&(s=function Q_(s,e){switch(e.type){case"added":if(!s[e.newIndex]||!s[e.newIndex].doc.ref.isEqual(e.doc.ref))return Dy(s,e.newIndex,0,e);break;case"modified":if(null==s[e.oldIndex]||s[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=s.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return Dy(s,e.newIndex,1,e)}break;case"removed":if(s[e.oldIndex]&&s[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Dy(s,e.oldIndex,1)}return s}(s,c))}),s}(c,y.map(S=>S.payload),e),[]),(0,St.x)(),(0,ae.U)(c=>c.map(y=>({type:y.type,payload:y}))))}function Dy(s,e,n,...c){const y=s.slice();return y.splice(e,n,...c),y}function Ay(s){return(!s||0===s.length)&&(s=["added","removed","modified"]),s}class yg{constructor(e,n,c){this.ref=e,this.query=n,this.afs=c}stateChanges(e){let n=gg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe((0,ae.U)(c=>c.filter(y=>e.indexOf(y.type)>-1)))),n.pipe((0,se.O)(void 0),fe(),(0,pt.h)(([c,y])=>y.length>0||!c),(0,ae.U)(([c,y])=>y),Le.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,$e.R)((n,c)=>[...n,...c],[]))}snapshotChanges(e){const n=Ay(e);return X_(this.query,n,this.afs.schedulers.outsideAngular).pipe(Le.iC)}valueChanges(e={}){return mg(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(n=>n.payload.docs.map(c=>e.idField?Object.assign(Object.assign({},c.data()),{[e.idField]:c.id}):c.data())),Le.iC)}get(e){return(0,nt.D)(this.query.get(e)).pipe(Le.iC)}add(e){return this.ref.add(e)}doc(e){return new Mm(this.ref.doc(e),this.afs)}}class Mm{constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){const c=this.ref.collection(e),{ref:y,query:S}=nv(c,n);return new yg(y,S,this.afs)}snapshotChanges(){return function Pb(s,e){return J_(s,e).pipe((0,se.O)(void 0),fe(),(0,ae.U)(([n,c])=>c.exists?(null==n?void 0:n.exists)?{payload:c,type:"modified"}:{payload:c,type:"added"}:{payload:c,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Le.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,ae.U)(({payload:n})=>e.idField?Object.assign(Object.assign({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return(0,nt.D)(this.ref.get(e)).pipe(Le.iC)}}class Pm{constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return e&&0!==e.length?gg(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(n=>n.filter(c=>e.indexOf(c.type)>-1)),(0,pt.h)(n=>n.length>0),Le.iC):gg(this.query,this.afs.schedulers.outsideAngular).pipe(Le.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,$e.R)((n,c)=>[...n,...c],[]))}snapshotChanges(e){const n=Ay(e);return X_(this.query,n,this.afs.schedulers.outsideAngular).pipe(Le.iC)}valueChanges(e={}){return mg(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(c=>c.payload.docs.map(y=>e.idField?Object.assign({[e.idField]:y.id},y.data()):y.data())),Le.iC)}get(e){return(0,nt.D)(this.query.get(e)).pipe(Le.iC)}}const ev=new w.OlP("angularfire2.enableFirestorePersistence"),My=new w.OlP("angularfire2.firestore.persistenceSettings"),tv=new w.OlP("angularfire2.firestore.settings"),k0=new w.OlP("angularfire2.firestore.use-emulator");function nv(s,e=(n=>n)){return{query:e(s),ref:s}}let rv=(()=>{class s{constructor(n,c,y,S,L,te,Me,dt,Rt,Kt,Cn,nr,fr,$r,Oi,da,Eu){this.schedulers=Me;const cc=(0,bt.on)(n,te,c),ws=Rt;Kt&&Zp(cc,te,Cn,fr,$r,Oi,nr,da),[this.firestore,this.persistenceEnabled$]=(0,bt.cc)(`${cc.name}.firestore`,"AngularFirestore",cc.name,()=>{const Iu=te.runOutsideAngular(()=>cc.firestore());if(S&&Iu.settings(S),ws&&Iu.useEmulator(...ws),y&&!(0,Ct.PM)(L)){const oh=()=>{try{return(0,nt.D)(Iu.enablePersistence(dt||void 0).then(()=>!0,()=>!1))}catch(_g){return"undefined"!=typeof console&&console.warn(_g),(0,xe.of)(!1)}};return[Iu,te.runOutsideAngular(oh)]}return[Iu,(0,xe.of)(!1)]},[S,ws,y])}collection(n,c){let y;y="string"==typeof n?this.firestore.collection(n):n;const{ref:S,query:L}=nv(y,c),te=this.schedulers.ngZone.run(()=>S);return new yg(te,L,this)}collectionGroup(n,c){const y=c||(L=>L),S=this.firestore.collectionGroup(n);return new Pm(y(S),this)}doc(n){let c;c="string"==typeof n?this.firestore.doc(n):n;const y=this.schedulers.ngZone.run(()=>c);return new Mm(y,this)}createId(){return this.firestore.collection("_").doc().id}}return s.\u0275fac=function(n){return new(n||s)(w.LFG(bt.Dh),w.LFG(bt.xv,8),w.LFG(ev,8),w.LFG(tv,8),w.LFG(w.Lbi),w.LFG(w.R0b),w.LFG(Le.HU),w.LFG(My,8),w.LFG(k0,8),w.LFG(Y_,8),w.LFG(W_,8),w.LFG(Sy,8),w.LFG(Z_,8),w.LFG(Cy,8),w.LFG(P0,8),w.LFG(K_,8),w.LFG(Iy,8))},s.\u0275prov=w.Yz7({token:s,factory:s.\u0275fac,providedIn:"any"}),s})(),Py=(()=>{class s{constructor(){A0.Z.registerVersion("angularfire",Le.q4.full,"fst-compat")}static enablePersistence(n){return{ngModule:s,providers:[{provide:ev,useValue:!0},{provide:My,useValue:n}]}}}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=w.oAB({type:s}),s.\u0275inj=w.cJS({providers:[rv]}),s})()},2011:(Sn,Nt,H)=>{"use strict";H.d(Nt,{hO:()=>St,xv:()=>fe,Dh:()=>Ue,GT:()=>Le,cc:()=>pt,on:()=>se,pX:()=>xe});var w=H(5e3),ue=H(127),g=H(5813);Sn=H.hmd(Sn);const nt=["ngOnDestroy"],xe=(ut,he,je,Ae={})=>new Proxy(ut,{get:(j,W)=>je.runOutsideAngular(()=>{var ge;if(ut[W])return(null===(ge=null==Ae?void 0:Ae.spy)||void 0===ge?void 0:ge.get)&&Ae.spy.get(W,ut[W]),ut[W];if(nt.indexOf(W)>-1)return()=>{};const q=he.toPromise().then(U=>{const Y=U&&U[W];return"function"==typeof Y?Y.bind(U):Y&&Y.then?Y.then(ee=>je.run(()=>ee)):je.run(()=>Y)});return new Proxy(()=>{},{get:(U,Y)=>q[Y],apply:(U,Y,ee)=>q.then(Pe=>{var _e;const We=Pe&&Pe(...ee);return(null===(_e=null==Ae?void 0:Ae.spy)||void 0===_e?void 0:_e.apply)&&Ae.spy.apply(W,ee,We),We})})})}),Le=(ut,he)=>{he.forEach(je=>{Object.getOwnPropertyNames(je.prototype||je).forEach(Ae=>{Object.defineProperty(ut.prototype,Ae,Object.getOwnPropertyDescriptor(je.prototype||je,Ae))})})};class Re{constructor(he){return he}}const Ue=new w.OlP("angularfire2.app.options"),fe=new w.OlP("angularfire2.app.name");function se(ut,he,je){const j="object"==typeof je&&je||{};j.name=j.name||"string"==typeof je&&je||"[DEFAULT]";const ge=ue.Z.apps.filter(q=>q&&q.name===j.name)[0]||he.runOutsideAngular(()=>ue.Z.initializeApp(ut,j));try{JSON.stringify(ut)!==JSON.stringify(ge.options)&&ae("error",`${ge.name} Firebase App already initialized with different options${Sn.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(q){}return new Re(ge)}const ae=(ut,...he)=>{(0,w.X6Q)()&&"undefined"!=typeof console&&console[ut](...he)},$e={provide:Re,useFactory:se,deps:[Ue,w.R0b,[new w.FiY,fe]]};let St=(()=>{class ut{constructor(je){ue.Z.registerVersion("angularfire",g.q4.full,"core"),ue.Z.registerVersion("angularfire",g.q4.full,"app-compat"),ue.Z.registerVersion("angular",w.q4F.full,je.toString())}static initializeApp(je,Ae){return{ngModule:ut,providers:[{provide:Ue,useValue:je},{provide:fe,useValue:Ae}]}}}return ut.\u0275fac=function(je){return new(je||ut)(w.LFG(w.Lbi))},ut.\u0275mod=w.oAB({type:ut}),ut.\u0275inj=w.cJS({providers:[$e]}),ut})();function pt(ut,he,je,Ae,j){const[,W,ge]=globalThis.\u0275AngularfireInstanceCache.find(q=>q[0]===ut)||[];if(W)return function bt(ut,he){try{return ut.toString()===he.toString()}catch(je){return ut===he}}(j,ge)||(ct("error",`${he} was already initialized on the ${je} Firebase App with different settings.${Ct?" You may need to reload as Firebase is not HMR aware.":""}`),ct("warn",{is:j,was:ge})),W;{const q=Ae();return globalThis.\u0275AngularfireInstanceCache.push([ut,q,j]),q}}const Ct=!!Sn.hot,ct=(ut,...he)=>{(0,w.X6Q)()&&"undefined"!=typeof console&&console[ut](...he)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(Sn,Nt,H)=>{"use strict";H.d(Nt,{q4:()=>h,iC:()=>$n,HU:()=>Bt,vb:()=>wt,JM:()=>xt});var w=H(5e3),ue=H(5867),g=H(5861),nt=H(9681),xe=H(2090),Le=H(4859),Re=H(1877),Ue=H(2940);const fe="@firebase/installations",$e="w:0.5.5",St="FIS_v2",he=new xe.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function je(Z){return Z instanceof xe.ZR&&Z.code.includes("request-failed")}function Ae({projectId:Z}){return`https://firebaseinstallations.googleapis.com/v1/projects/${Z}/installations`}function j(Z){return{token:Z.token,requestStatus:2,expiresIn:Pe(Z.expiresIn),creationTime:Date.now()}}function W(Z,Q){return ge.apply(this,arguments)}function ge(){return(ge=(0,g.Z)(function*(Z,Q){const st=(yield Q.json()).error;return he.create("request-failed",{requestName:Z,serverCode:st.code,serverMessage:st.message,serverStatus:st.status})})).apply(this,arguments)}function q({apiKey:Z}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":Z})}function U(Z,{refreshToken:Q}){const Fe=q(Z);return Fe.append("Authorization",function _e(Z){return`${St} ${Z}`}(Q)),Fe}function Y(Z){return ee.apply(this,arguments)}function ee(){return(ee=(0,g.Z)(function*(Z){const Q=yield Z();return Q.status>=500&&Q.status<600?Z():Q})).apply(this,arguments)}function Pe(Z){return Number(Z.replace("s","000"))}function We(Z,Q){return rt.apply(this,arguments)}function rt(){return(rt=(0,g.Z)(function*(Z,{fid:Q}){const Fe=Ae(Z),Qt={method:"POST",headers:q(Z),body:JSON.stringify({fid:Q,authVersion:St,appId:Z.appId,sdkVersion:$e})},mn=yield Y(()=>fetch(Fe,Qt));if(mn.ok){const xn=yield mn.json();return{fid:xn.fid||Q,registrationStatus:2,refreshToken:xn.refreshToken,authToken:j(xn.authToken)}}throw yield W("Create Installation",mn)})).apply(this,arguments)}function _t(Z){return new Promise(Q=>{setTimeout(Q,Z)})}const Zt=/^[cdef][\w-]{21}$/;function qt(){try{const Z=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(Z),Z[0]=112+Z[0]%16;const Fe=function An(Z){return function ft(Z){return btoa(String.fromCharCode(...Z)).replace(/\+/g,"-").replace(/\//g,"_")}(Z).substr(0,22)}(Z);return Zt.test(Fe)?Fe:""}catch(Z){return""}}function kn(Z){return`${Z.appName}!${Z.appId}`}const jn=new Map;function gr(Z,Q){const Fe=kn(Z);Sr(Fe,Q),function di(Z,Q){const Fe=function qi(){return!vr&&"BroadcastChannel"in self&&(vr=new BroadcastChannel("[Firebase] FID Change"),vr.onmessage=Z=>{Sr(Z.data.key,Z.data.fid)}),vr}();Fe&&Fe.postMessage({key:Z,fid:Q}),function ii(){0===jn.size&&vr&&(vr.close(),vr=null)}()}(Fe,Q)}function Sr(Z,Q){const Fe=jn.get(Z);if(Fe)for(const st of Fe)st(Q)}let vr=null;const pi="firebase-installations-store";let oi=null;function Xt(){return oi||(oi=(0,Ue.openDb)("firebase-installations-database",1,Z=>{0===Z.oldVersion&&Z.createObjectStore(pi)})),oi}function ln(Z,Q){return En.apply(this,arguments)}function En(){return(En=(0,g.Z)(function*(Z,Q){const Fe=kn(Z),Ut=(yield Xt()).transaction(pi,"readwrite"),Qt=Ut.objectStore(pi),mn=yield Qt.get(Fe);return yield Qt.put(Q,Fe),yield Ut.complete,(!mn||mn.fid!==Q.fid)&&gr(Z,Q.fid),Q})).apply(this,arguments)}function bn(Z){return Wn.apply(this,arguments)}function Wn(){return(Wn=(0,g.Z)(function*(Z){const Q=kn(Z),st=(yield Xt()).transaction(pi,"readwrite");yield st.objectStore(pi).delete(Q),yield st.complete})).apply(this,arguments)}function jt(Z,Q){return ve.apply(this,arguments)}function ve(){return(ve=(0,g.Z)(function*(Z,Q){const Fe=kn(Z),Ut=(yield Xt()).transaction(pi,"readwrite"),Qt=Ut.objectStore(pi),mn=yield Qt.get(Fe),xn=Q(mn);return void 0===xn?yield Qt.delete(Fe):yield Qt.put(xn,Fe),yield Ut.complete,xn&&(!mn||mn.fid!==xn.fid)&&gr(Z,xn.fid),xn})).apply(this,arguments)}function me(Z){return re.apply(this,arguments)}function re(){return(re=(0,g.Z)(function*(Z){let Q;const Fe=yield jt(Z,st=>{const Ut=ht(st),Qt=zt(Z,Ut);return Q=Qt.registrationPromise,Qt.installationEntry});return""===Fe.fid?{installationEntry:yield Q}:{installationEntry:Fe,registrationPromise:Q}})).apply(this,arguments)}function ht(Z){return Ki(Z||{fid:qt(),registrationStatus:0})}function zt(Z,Q){if(0===Q.registrationStatus){if(!navigator.onLine)return{installationEntry:Q,registrationPromise:Promise.reject(he.create("app-offline"))};const Fe={fid:Q.fid,registrationStatus:1,registrationTime:Date.now()},st=function sn(Z,Q){return Mn.apply(this,arguments)}(Z,Fe);return{installationEntry:Fe,registrationPromise:st}}return 1===Q.registrationStatus?{installationEntry:Q,registrationPromise:Jn(Z)}:{installationEntry:Q}}function Mn(){return(Mn=(0,g.Z)(function*(Z,Q){try{return ln(Z,yield We(Z,Q))}catch(Fe){throw je(Fe)&&409===Fe.customData.serverCode?yield bn(Z):yield ln(Z,{fid:Q.fid,registrationStatus:0}),Fe}})).apply(this,arguments)}function Jn(Z){return Tr.apply(this,arguments)}function Tr(){return(Tr=(0,g.Z)(function*(Z){let Q=yield wr(Z);for(;1===Q.registrationStatus;)yield _t(100),Q=yield wr(Z);if(0===Q.registrationStatus){const{installationEntry:Fe,registrationPromise:st}=yield me(Z);return st||Fe}return Q})).apply(this,arguments)}function wr(Z){return jt(Z,Q=>{if(!Q)throw he.create("installation-not-found");return Ki(Q)})}function Ki(Z){return function Li(Z){return 1===Z.registrationStatus&&Z.registrationTime+1e4<Date.now()}(Z)?{fid:Z.fid,registrationStatus:0}:Z}function Ht(Z,Q){return Te.apply(this,arguments)}function Te(){return(Te=(0,g.Z)(function*({appConfig:Z,platformLoggerProvider:Q},Fe){const st=ke(Z,Fe),Ut=U(Z,Fe),Qt=Q.getImmediate({optional:!0});Qt&&Ut.append("x-firebase-client",Qt.getPlatformInfoString());const xn={method:"POST",headers:Ut,body:JSON.stringify({installation:{sdkVersion:$e}})},Bn=yield Y(()=>fetch(st,xn));if(Bn.ok)return j(yield Bn.json());throw yield W("Generate Auth Token",Bn)})).apply(this,arguments)}function ke(Z,{fid:Q}){return`${Ae(Z)}/${Q}/authTokens:generate`}function tt(Z){return Ft.apply(this,arguments)}function Ft(){return(Ft=(0,g.Z)(function*(Z,Q=!1){let Fe;const st=yield jt(Z.appConfig,Qt=>{if(!Oe(Qt))throw he.create("not-registered");const mn=Qt.authToken;if(!Q&&Qe(mn))return Qt;if(1===mn.requestStatus)return Fe=vt(Z,Q),Qt;{if(!navigator.onLine)throw he.create("app-offline");const xn=Dt(Qt);return Fe=ce(Z,xn),xn}});return Fe?yield Fe:st.authToken})).apply(this,arguments)}function vt(Z,Q){return dn.apply(this,arguments)}function dn(){return(dn=(0,g.Z)(function*(Z,Q){let Fe=yield Pn(Z.appConfig);for(;1===Fe.authToken.requestStatus;)yield _t(100),Fe=yield Pn(Z.appConfig);const st=Fe.authToken;return 0===st.requestStatus?tt(Z,Q):st})).apply(this,arguments)}function Pn(Z){return jt(Z,Q=>{if(!Oe(Q))throw he.create("not-registered");return function Lt(Z){return 1===Z.requestStatus&&Z.requestTime+1e4<Date.now()}(Q.authToken)?Object.assign(Object.assign({},Q),{authToken:{requestStatus:0}}):Q})}function ce(Z,Q){return be.apply(this,arguments)}function be(){return(be=(0,g.Z)(function*(Z,Q){try{const Fe=yield Ht(Z,Q),st=Object.assign(Object.assign({},Q),{authToken:Fe});return yield ln(Z.appConfig,st),Fe}catch(Fe){if(!je(Fe)||401!==Fe.customData.serverCode&&404!==Fe.customData.serverCode){const st=Object.assign(Object.assign({},Q),{authToken:{requestStatus:0}});yield ln(Z.appConfig,st)}else yield bn(Z.appConfig);throw Fe}})).apply(this,arguments)}function Oe(Z){return void 0!==Z&&2===Z.registrationStatus}function Qe(Z){return 2===Z.requestStatus&&!function ot(Z){const Q=Date.now();return Q<Z.creationTime||Z.creationTime+Z.expiresIn<Q+36e5}(Z)}function Dt(Z){const Q={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},Z),{authToken:Q})}function Ie(){return(Ie=(0,g.Z)(function*(Z){const Q=Z,{installationEntry:Fe,registrationPromise:st}=yield me(Q.appConfig);return st?st.catch(console.error):tt(Q).catch(console.error),Fe.fid})).apply(this,arguments)}function Ve(){return(Ve=(0,g.Z)(function*(Z,Q=!1){const Fe=Z;return yield mt(Fe.appConfig),(yield tt(Fe,Q)).token})).apply(this,arguments)}function mt(Z){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,g.Z)(function*(Z){const{registrationPromise:Q}=yield me(Z);Q&&(yield Q)})).apply(this,arguments)}function Xn(Z){return he.create("missing-app-config-values",{valueName:Z})}const br="installations",ur=Z=>{const Q=Z.getProvider("app").getImmediate(),Fe=function Ir(Z){if(!Z||!Z.options)throw Xn("App Configuration");if(!Z.name)throw Xn("App Name");const Q=["projectId","apiKey","appId"];for(const Fe of Q)if(!Z.options[Fe])throw Xn(Fe);return{appName:Z.name,projectId:Z.options.projectId,apiKey:Z.options.apiKey,appId:Z.options.appId}}(Q);return{app:Q,appConfig:Fe,platformLoggerProvider:(0,nt._getProvider)(Q,"platform-logger"),_delete:()=>Promise.resolve()}},Dr=Z=>{const Q=Z.getProvider("app").getImmediate(),Fe=(0,nt._getProvider)(Q,br).getImmediate();return{getId:()=>function Je(Z){return Ie.apply(this,arguments)}(Fe),getToken:Ut=>function ze(Z){return Ve.apply(this,arguments)}(Fe,Ut)}};(function jr(){(0,nt._registerComponent)(new Le.wA(br,ur,"PUBLIC")),(0,nt._registerComponent)(new Le.wA("installations-internal",Dr,"PRIVATE"))})(),(0,nt.registerVersion)(fe,"0.5.5"),(0,nt.registerVersion)(fe,"0.5.5","esm2017");const oo="@firebase/remote-config",Fr=new xe.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Mo{constructor(Q,Fe,st,Ut){this.client=Q,this.storage=Fe,this.storageCache=st,this.logger=Ut}isCachedDataFresh(Q,Fe){if(!Fe)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const st=Date.now()-Fe,Ut=st<=Q;return this.logger.debug(`Config fetch cache check. Cache age millis: ${st}. Cache max age millis (minimumFetchIntervalMillis setting): ${Q}. Is cache hit: ${Ut}.`),Ut}fetch(Q){var Fe=this;return(0,g.Z)(function*(){const[st,Ut]=yield Promise.all([Fe.storage.getLastSuccessfulFetchTimestampMillis(),Fe.storage.getLastSuccessfulFetchResponse()]);if(Ut&&Fe.isCachedDataFresh(Q.cacheMaxAgeMillis,st))return Ut;Q.eTag=Ut&&Ut.eTag;const Qt=yield Fe.client.fetch(Q),mn=[Fe.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Qt.status&&mn.push(Fe.storage.setLastSuccessfulFetchResponse(Qt)),yield Promise.all(mn),Qt})()}}function No(Z=navigator){return Z.languages&&Z.languages[0]||Z.language}class mi{constructor(Q,Fe,st,Ut,Qt,mn){this.firebaseInstallations=Q,this.sdkVersion=Fe,this.namespace=st,this.projectId=Ut,this.apiKey=Qt,this.appId=mn}fetch(Q){var Fe=this;return(0,g.Z)(function*(){const[st,Ut]=yield Promise.all([Fe.firebaseInstallations.getId(),Fe.firebaseInstallations.getToken()]),mn=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${Fe.projectId}/namespaces/${Fe.namespace}:fetch?key=${Fe.apiKey}`,xn={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":Q.eTag||"*"},Bn={sdk_version:Fe.sdkVersion,app_instance_id:st,app_instance_id_token:Ut,app_id:Fe.appId,language_code:No()},sr={method:"POST",headers:xn,body:JSON.stringify(Bn)},hr=fetch(mn,sr),vi=new Promise((ko,vo)=>{Q.signal.addEventListener(()=>{const Xa=new Error("The operation was aborted.");Xa.name="AbortError",vo(Xa)})});let ki;try{yield Promise.race([hr,vi]),ki=yield hr}catch(ko){let vo="fetch-client-network";throw"AbortError"===ko.name&&(vo="fetch-timeout"),Fr.create(vo,{originalErrorMessage:ko.message})}let Hi=ki.status;const $o=ki.headers.get("ETag")||void 0;let Ei,Qi;if(200===ki.status){let ko;try{ko=yield ki.json()}catch(vo){throw Fr.create("fetch-client-parse",{originalErrorMessage:vo.message})}Ei=ko.entries,Qi=ko.state}if("INSTANCE_STATE_UNSPECIFIED"===Qi?Hi=500:"NO_CHANGE"===Qi?Hi=304:("NO_TEMPLATE"===Qi||"EMPTY_CONFIG"===Qi)&&(Ei={}),304!==Hi&&200!==Hi)throw Fr.create("fetch-status",{httpStatus:Hi});return{status:Hi,eTag:$o,config:Ei}})()}}class rs{constructor(Q,Fe){this.client=Q,this.storage=Fe}fetch(Q){var Fe=this;return(0,g.Z)(function*(){const st=(yield Fe.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return Fe.attemptFetch(Q,st)})()}attemptFetch(Q,{throttleEndTimeMillis:Fe,backoffCount:st}){var Ut=this;return(0,g.Z)(function*(){yield function su(Z,Q){return new Promise((Fe,st)=>{const Ut=Math.max(Q-Date.now(),0),Qt=setTimeout(Fe,Ut);Z.addEventListener(()=>{clearTimeout(Qt),st(Fr.create("fetch-throttle",{throttleEndTimeMillis:Q}))})})}(Q.signal,Fe);try{const Qt=yield Ut.client.fetch(Q);return yield Ut.storage.deleteThrottleMetadata(),Qt}catch(Qt){if(!function Oa(Z){if(!(Z instanceof xe.ZR&&Z.customData))return!1;const Q=Number(Z.customData.httpStatus);return 429===Q||500===Q||503===Q||504===Q}(Qt))throw Qt;const mn={throttleEndTimeMillis:Date.now()+(0,xe.$s)(st),backoffCount:st+1};return yield Ut.storage.setThrottleMetadata(mn),Ut.attemptFetch(Q,mn)}})()}}class au{constructor(Q,Fe,st,Ut,Qt){this.app=Q,this._client=Fe,this._storageCache=st,this._storage=Ut,this._logger=Qt,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function fa(Z,Q){const Fe=Z.target.error||void 0;return Fr.create(Q,{originalErrorMessage:Fe&&Fe.message})}const ta="app_namespace_store";class ma{constructor(Q,Fe,st,Ut=function Uu(){return new Promise((Z,Q)=>{try{const Fe=indexedDB.open("firebase_remote_config",1);Fe.onerror=st=>{Q(fa(st,"storage-open"))},Fe.onsuccess=st=>{Z(st.target.result)},Fe.onupgradeneeded=st=>{0===st.oldVersion&&st.target.result.createObjectStore(ta,{keyPath:"compositeKey"})}}catch(Fe){Q(Fr.create("storage-open",{originalErrorMessage:Fe}))}})}()){this.appId=Q,this.appName=Fe,this.namespace=st,this.openDbPromise=Ut}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(Q){return this.set("last_fetch_status",Q)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(Q){return this.set("last_successful_fetch_timestamp_millis",Q)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(Q){return this.set("last_successful_fetch_response",Q)}getActiveConfig(){return this.get("active_config")}setActiveConfig(Q){return this.set("active_config",Q)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(Q){return this.set("active_config_etag",Q)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(Q){return this.set("throttle_metadata",Q)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(Q){var Fe=this;return(0,g.Z)(function*(){const st=yield Fe.openDbPromise;return new Promise((Ut,Qt)=>{const xn=st.transaction([ta],"readonly").objectStore(ta),Bn=Fe.createCompositeKey(Q);try{const sr=xn.get(Bn);sr.onerror=hr=>{Qt(fa(hr,"storage-get"))},sr.onsuccess=hr=>{const vi=hr.target.result;Ut(vi?vi.value:void 0)}}catch(sr){Qt(Fr.create("storage-get",{originalErrorMessage:sr&&sr.message}))}})})()}set(Q,Fe){var st=this;return(0,g.Z)(function*(){const Ut=yield st.openDbPromise;return new Promise((Qt,mn)=>{const Bn=Ut.transaction([ta],"readwrite").objectStore(ta),sr=st.createCompositeKey(Q);try{const hr=Bn.put({compositeKey:sr,value:Fe});hr.onerror=vi=>{mn(fa(vi,"storage-set"))},hr.onsuccess=()=>{Qt()}}catch(hr){mn(Fr.create("storage-set",{originalErrorMessage:hr&&hr.message}))}})})()}delete(Q){var Fe=this;return(0,g.Z)(function*(){const st=yield Fe.openDbPromise;return new Promise((Ut,Qt)=>{const xn=st.transaction([ta],"readwrite").objectStore(ta),Bn=Fe.createCompositeKey(Q);try{const sr=xn.delete(Bn);sr.onerror=hr=>{Qt(fa(hr,"storage-delete"))},sr.onsuccess=()=>{Ut()}}catch(sr){Qt(Fr.create("storage-delete",{originalErrorMessage:sr&&sr.message}))}})})()}createCompositeKey(Q){return[this.appId,this.appName,this.namespace,Q].join()}}class Ss{constructor(Q){this.storage=Q}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var Q=this;return(0,g.Z)(function*(){const Fe=Q.storage.getLastFetchStatus(),st=Q.storage.getLastSuccessfulFetchTimestampMillis(),Ut=Q.storage.getActiveConfig(),Qt=yield Fe;Qt&&(Q.lastFetchStatus=Qt);const mn=yield st;mn&&(Q.lastSuccessfulFetchTimestampMillis=mn);const xn=yield Ut;xn&&(Q.activeConfig=xn)})()}setLastFetchStatus(Q){return this.lastFetchStatus=Q,this.storage.setLastFetchStatus(Q)}setLastSuccessfulFetchTimestampMillis(Q){return this.lastSuccessfulFetchTimestampMillis=Q,this.storage.setLastSuccessfulFetchTimestampMillis(Q)}setActiveConfig(Q){return this.activeConfig=Q,this.storage.setActiveConfig(Q)}}function ga(){return Cs.apply(this,arguments)}function Cs(){return(Cs=(0,g.Z)(function*(){if(!(0,xe.hl)())return!1;try{return yield(0,xe.eu)()}catch(Z){return!1}})).apply(this,arguments)}!function Ls(){(0,nt._registerComponent)(new Le.wA("remote-config",function Z(Q,{instanceIdentifier:Fe}){const st=Q.getProvider("app").getImmediate(),Ut=Q.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw Fr.create("registration-window");if(!(0,xe.hl)())throw Fr.create("indexed-db-unavailable");const{projectId:Qt,apiKey:mn,appId:xn}=st.options;if(!Qt)throw Fr.create("registration-project-id");if(!mn)throw Fr.create("registration-api-key");if(!xn)throw Fr.create("registration-app-id");const Bn=new ma(xn,st.name,Fe=Fe||"firebase"),sr=new Ss(Bn),hr=new Re.Yd(oo);hr.logLevel=Re.in.ERROR;const vi=new mi(Ut,nt.SDK_VERSION,Fe,Qt,mn,xn),ki=new rs(vi,Bn),Hi=new Mo(ki,Bn,sr,hr),$o=new au(st,Hi,sr,Bn,hr);return function Br(Z){const Q=(0,xe.m9)(Z);Q._initializePromise||(Q._initializePromise=Q._storageCache.loadFromStorage().then(()=>{Q._isInitializationComplete=!0}))}($o),$o},"PUBLIC").setMultipleInstances(!0)),(0,nt.registerVersion)(oo,"0.3.4"),(0,nt.registerVersion)(oo,"0.3.4","esm2017")}();const Es="/firebase-messaging-sw.js",is="/firebase-cloud-messaging-push-scope",po="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Uo="google.c.a.c_id",el="google.c.a.c_l",na="google.c.a.ts",uu="google.c.a.e";var Gs=(()=>{return(Z=Gs||(Gs={})).PUSH_RECEIVED="push-received",Z.NOTIFICATION_CLICKED="notification-clicked",Gs;var Z})();function os(Z){const Q=new Uint8Array(Z);return btoa(String.fromCharCode(...Q)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function qs(Z){const Fe=(Z+"=".repeat((4-Z.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),st=atob(Fe),Ut=new Uint8Array(st.length);for(let Qt=0;Qt<st.length;++Qt)Ut[Qt]=st.charCodeAt(Qt);return Ut}const so="fcm_token_details_db",Su="fcm_token_object_Store";function wo(Z){return Ds.apply(this,arguments)}function Ds(){return Ds=(0,g.Z)(function*(Z){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Qt=>Qt.name).includes(so))return null;let Q=null;return(yield(0,Ue.openDb)(so,5,function(){var st=(0,g.Z)(function*(Ut){var Qt;if(Ut.oldVersion<2||!Ut.objectStoreNames.contains(Su))return;const mn=Ut.transaction.objectStore(Su),xn=yield mn.index("fcmSenderId").get(Z);if(yield mn.clear(),xn)if(2===Ut.oldVersion){const Bn=xn;if(!Bn.auth||!Bn.p256dh||!Bn.endpoint)return;Q={token:Bn.fcmToken,createTime:null!==(Qt=Bn.createTime)&&void 0!==Qt?Qt:Date.now(),subscriptionOptions:{auth:Bn.auth,p256dh:Bn.p256dh,endpoint:Bn.endpoint,swScope:Bn.swScope,vapidKey:"string"==typeof Bn.vapidKey?Bn.vapidKey:os(Bn.vapidKey)}}}else if(3===Ut.oldVersion){const Bn=xn;Q={token:Bn.fcmToken,createTime:Bn.createTime,subscriptionOptions:{auth:os(Bn.auth),p256dh:os(Bn.p256dh),endpoint:Bn.endpoint,swScope:Bn.swScope,vapidKey:os(Bn.vapidKey)}}}else if(4===Ut.oldVersion){const Bn=xn;Q={token:Bn.fcmToken,createTime:Bn.createTime,subscriptionOptions:{auth:os(Bn.auth),p256dh:os(Bn.p256dh),endpoint:Bn.endpoint,swScope:Bn.swScope,vapidKey:os(Bn.vapidKey)}}}});return function(Ut){return st.apply(this,arguments)}}())).close(),yield(0,Ue.deleteDb)(so),yield(0,Ue.deleteDb)("fcm_vapid_details_db"),yield(0,Ue.deleteDb)("undefined"),qa(Q)?Q:null}),Ds.apply(this,arguments)}function qa(Z){if(!Z||!Z.subscriptionOptions)return!1;const{subscriptionOptions:Q}=Z;return"number"==typeof Z.createTime&&Z.createTime>0&&"string"==typeof Z.token&&Z.token.length>0&&"string"==typeof Q.auth&&Q.auth.length>0&&"string"==typeof Q.p256dh&&Q.p256dh.length>0&&"string"==typeof Q.endpoint&&Q.endpoint.length>0&&"string"==typeof Q.swScope&&Q.swScope.length>0&&"string"==typeof Q.vapidKey&&Q.vapidKey.length>0}const ps="firebase-messaging-store";let Jo=null;function qr(){return Jo||(Jo=(0,Ue.openDb)("firebase-messaging-database",1,Z=>{0===Z.oldVersion&&Z.createObjectStore(ps)})),Jo}function oe(Z){return qe.apply(this,arguments)}function qe(){return(qe=(0,g.Z)(function*(Z){const Q=On(Z),st=yield(yield qr()).transaction(ps).objectStore(ps).get(Q);if(st)return st;{const Ut=yield wo(Z.appConfig.senderId);if(Ut)return yield ne(Z,Ut),Ut}})).apply(this,arguments)}function ne(Z,Q){return et.apply(this,arguments)}function et(){return(et=(0,g.Z)(function*(Z,Q){const Fe=On(Z),Ut=(yield qr()).transaction(ps,"readwrite");return yield Ut.objectStore(ps).put(Q,Fe),yield Ut.complete,Q})).apply(this,arguments)}function Ot(Z){return vn.apply(this,arguments)}function vn(){return(vn=(0,g.Z)(function*(Z){const Q=On(Z),st=(yield qr()).transaction(ps,"readwrite");yield st.objectStore(ps).delete(Q),yield st.complete})).apply(this,arguments)}function On({appConfig:Z}){return Z.appId}const Hr=new xe.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function li(Z,Q){return ni.apply(this,arguments)}function ni(){return(ni=(0,g.Z)(function*(Z,Q){const Fe=yield go(Z),st=ra(Q),Ut={method:"POST",headers:Fe,body:JSON.stringify(st)};let Qt;try{Qt=yield(yield fetch(ms(Z.appConfig),Ut)).json()}catch(mn){throw Hr.create("token-subscribe-failed",{errorInfo:mn})}if(Qt.error)throw Hr.create("token-subscribe-failed",{errorInfo:Qt.error.message});if(!Qt.token)throw Hr.create("token-subscribe-no-token");return Qt.token})).apply(this,arguments)}function Qr(Z,Q){return mo.apply(this,arguments)}function mo(){return(mo=(0,g.Z)(function*(Z,Q){const Fe=yield go(Z),st=ra(Q.subscriptionOptions),Ut={method:"PATCH",headers:Fe,body:JSON.stringify(st)};let Qt;try{Qt=yield(yield fetch(`${ms(Z.appConfig)}/${Q.token}`,Ut)).json()}catch(mn){throw Hr.create("token-update-failed",{errorInfo:mn})}if(Qt.error)throw Hr.create("token-update-failed",{errorInfo:Qt.error.message});if(!Qt.token)throw Hr.create("token-update-no-token");return Qt.token})).apply(this,arguments)}function Vi(Z,Q){return Di.apply(this,arguments)}function Di(){return(Di=(0,g.Z)(function*(Z,Q){const st={method:"DELETE",headers:yield go(Z)};try{const Qt=yield(yield fetch(`${ms(Z.appConfig)}/${Q}`,st)).json();if(Qt.error)throw Hr.create("token-unsubscribe-failed",{errorInfo:Qt.error.message})}catch(Ut){throw Hr.create("token-unsubscribe-failed",{errorInfo:Ut})}})).apply(this,arguments)}function ms({projectId:Z}){return`https://fcmregistrations.googleapis.com/v1/projects/${Z}/registrations`}function go(Z){return Rr.apply(this,arguments)}function Rr(){return(Rr=(0,g.Z)(function*({appConfig:Z,installations:Q}){const Fe=yield Q.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":Z.apiKey,"x-goog-firebase-installations-auth":`FIS ${Fe}`})})).apply(this,arguments)}function ra({p256dh:Z,auth:Q,endpoint:Fe,vapidKey:st}){const Ut={web:{endpoint:Fe,auth:Q,p256dh:Z}};return st!==po&&(Ut.web.applicationPubKey=st),Ut}const La=6048e5;function Ns(Z){return Fs.apply(this,arguments)}function Fs(){return(Fs=(0,g.Z)(function*(Z){const Q=yield xo(Z.swRegistration,Z.vapidKey),Fe={vapidKey:Z.vapidKey,swScope:Z.swRegistration.scope,endpoint:Q.endpoint,auth:os(Q.getKey("auth")),p256dh:os(Q.getKey("p256dh"))},st=yield oe(Z.firebaseDependencies);if(st){if(Wa(st.subscriptionOptions,Fe))return Date.now()>=st.createTime+La?vl(Z,{token:st.token,createTime:Date.now(),subscriptionOptions:Fe}):st.token;try{yield Vi(Z.firebaseDependencies,st.token)}catch(Ut){console.warn(Ut)}return Cr(Z.firebaseDependencies,Fe)}return Cr(Z.firebaseDependencies,Fe)})).apply(this,arguments)}function Na(Z){return Xo.apply(this,arguments)}function Xo(){return(Xo=(0,g.Z)(function*(Z){const Q=yield oe(Z.firebaseDependencies);Q&&(yield Vi(Z.firebaseDependencies,Q.token),yield Ot(Z.firebaseDependencies));const Fe=yield Z.swRegistration.pushManager.getSubscription();return!Fe||Fe.unsubscribe()})).apply(this,arguments)}function vl(Z,Q){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,g.Z)(function*(Z,Q){try{const Fe=yield Qr(Z.firebaseDependencies,Q),st=Object.assign(Object.assign({},Q),{token:Fe,createTime:Date.now()});return yield ne(Z.firebaseDependencies,st),Fe}catch(Fe){throw yield Na(Z),Fe}})).apply(this,arguments)}function Cr(Z,Q){return Fa.apply(this,arguments)}function Fa(){return(Fa=(0,g.Z)(function*(Z,Q){const st={token:yield li(Z,Q),createTime:Date.now(),subscriptionOptions:Q};return yield ne(Z,st),st.token})).apply(this,arguments)}function xo(Z,Q){return Ws.apply(this,arguments)}function Ws(){return(Ws=(0,g.Z)(function*(Z,Q){return(yield Z.pushManager.getSubscription())||Z.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:qs(Q)})})).apply(this,arguments)}function Wa(Z,Q){return Q.vapidKey===Z.vapidKey&&Q.endpoint===Z.endpoint&&Q.auth===Z.auth&&Q.p256dh===Z.p256dh}function as(Z){const Q={from:Z.from,collapseKey:Z.collapse_key,messageId:Z.fcmMessageId};return function zu(Z,Q){if(!Q.notification)return;Z.notification={};const Fe=Q.notification.title;Fe&&(Z.notification.title=Fe);const st=Q.notification.body;st&&(Z.notification.body=st);const Ut=Q.notification.image;Ut&&(Z.notification.image=Ut)}(Q,Z),function Vu(Z,Q){!Q.data||(Z.data=Q.data)}(Q,Z),function Du(Z,Q){if(!Q.fcmOptions)return;Z.fcmOptions={};const Fe=Q.fcmOptions.link;Fe&&(Z.fcmOptions.link=Fe);const st=Q.fcmOptions.analytics_label;st&&(Z.fcmOptions.analyticsLabel=st)}(Q,Z),Q}function ju(Z){return"object"==typeof Z&&!!Z&&Uo in Z}function ya(Z,Q){const Fe=[];for(let st=0;st<Z.length;st++)Fe.push(Z.charAt(st)),st<Q.length&&Fe.push(Q.charAt(st));return Fe.join("")}function yo(Z){return Hr.create("missing-app-config-values",{valueName:Z})}ya("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),ya("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Bs{constructor(Q,Fe,st){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Ut=function As(Z){if(!Z||!Z.options)throw yo("App Configuration Object");if(!Z.name)throw yo("App Name");const Q=["projectId","apiKey","appId","messagingSenderId"],{options:Fe}=Z;for(const st of Q)if(!Fe[st])throw yo(st);return{appName:Z.name,projectId:Fe.projectId,apiKey:Fe.apiKey,appId:Fe.appId,senderId:Fe.messagingSenderId}}(Q);this.firebaseDependencies={app:Q,appConfig:Ut,installations:Fe,analyticsProvider:st}}_delete(){return Promise.resolve()}}function Za(Z){return Eo.apply(this,arguments)}function Eo(){return(Eo=(0,g.Z)(function*(Z){try{Z.swRegistration=yield navigator.serviceWorker.register(Es,{scope:is}),Z.swRegistration.update().catch(()=>{})}catch(Q){throw Hr.create("failed-service-worker-registration",{browserErrorMessage:Q.message})}})).apply(this,arguments)}function Us(Z,Q){return Au.apply(this,arguments)}function Au(){return(Au=(0,g.Z)(function*(Z,Q){if(!Q&&!Z.swRegistration&&(yield Za(Z)),Q||!Z.swRegistration){if(!(Q instanceof ServiceWorkerRegistration))throw Hr.create("invalid-sw-registration");Z.swRegistration=Q}})).apply(this,arguments)}function Fo(Z,Q){return ia.apply(this,arguments)}function ia(){return(ia=(0,g.Z)(function*(Z,Q){Q?Z.vapidKey=Q:Z.vapidKey||(Z.vapidKey=po)})).apply(this,arguments)}function _a(){return(_a=(0,g.Z)(function*(Z,Q){if(!navigator)throw Hr.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Hr.create("permission-blocked");return yield Fo(Z,null==Q?void 0:Q.vapidKey),yield Us(Z,null==Q?void 0:Q.serviceWorkerRegistration),Ns(Z)})).apply(this,arguments)}function tl(Z,Q,Fe){return va.apply(this,arguments)}function va(){return(va=(0,g.Z)(function*(Z,Q,Fe){const st=$u(Q);(yield Z.firebaseDependencies.analyticsProvider.get()).logEvent(st,{message_id:Fe[Uo],message_name:Fe[el],message_time:Fe[na],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function $u(Z){switch(Z){case Gs.NOTIFICATION_CLICKED:return"notification_open";case Gs.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Ms(){return(Ms=(0,g.Z)(function*(Z,Q){const Fe=Q.data;if(!Fe.isFirebaseMessaging)return;Z.onMessageHandler&&Fe.messageType===Gs.PUSH_RECEIVED&&("function"==typeof Z.onMessageHandler?Z.onMessageHandler(as(Fe)):Z.onMessageHandler.next(as(Fe)));const st=Fe.data;ju(st)&&"1"===st[uu]&&(yield tl(Z,Fe.messageType,st))})).apply(this,arguments)}const ba="@firebase/messaging",us=Z=>{const Q=new Bs(Z.getProvider("app").getImmediate(),Z.getProvider("installations-internal").getImmediate(),Z.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",Fe=>function Mu(Z,Q){return Ms.apply(this,arguments)}(Q,Fe)),Q},rl=Z=>{const Q=Z.getProvider("messaging").getImmediate();return{getToken:st=>function Hu(Z,Q){return _a.apply(this,arguments)}(Q,st)}};function lu(){return oa.apply(this,arguments)}function oa(){return(oa=(0,g.Z)(function*(){return"undefined"!=typeof window&&(0,xe.hl)()&&(yield(0,xe.eu)())&&(0,xe.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function fl(){(0,nt._registerComponent)(new Le.wA("messaging",us,"PUBLIC")),(0,nt._registerComponent)(new Le.wA("messaging-internal",rl,"PRIVATE")),(0,nt.registerVersion)(ba,"0.9.7"),(0,nt.registerVersion)(ba,"0.9.7","esm2017")}();const $="analytics",de="firebase_id",Mt="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",$t="https://www.googletagmanager.com/gtag/js",_n=new Re.Yd("@firebase/analytics");function on(Z){return Promise.all(Z.map(Q=>Q.catch(Fe=>Fe)))}function or(Z,Q){const Fe=document.createElement("script");Fe.src=`${$t}?l=${Z}&id=${Q}`,Fe.async=!0,document.head.appendChild(Fe)}function dr(Z,Q,Fe,st,Ut,Qt){return gi.apply(this,arguments)}function gi(){return(gi=(0,g.Z)(function*(Z,Q,Fe,st,Ut,Qt){const mn=st[Ut];try{if(mn)yield Q[mn];else{const Bn=(yield on(Fe)).find(sr=>sr.measurementId===Ut);Bn&&(yield Q[Bn.appId])}}catch(xn){_n.error(xn)}Z("config",Ut,Qt)})).apply(this,arguments)}function Yr(Z,Q,Fe,st,Ut){return tr.apply(this,arguments)}function tr(){return(tr=(0,g.Z)(function*(Z,Q,Fe,st,Ut){try{let Qt=[];if(Ut&&Ut.send_to){let mn=Ut.send_to;Array.isArray(mn)||(mn=[mn]);const xn=yield on(Fe);for(const Bn of mn){const sr=xn.find(vi=>vi.measurementId===Bn),hr=sr&&Q[sr.appId];if(!hr){Qt=[];break}Qt.push(hr)}}0===Qt.length&&(Qt=Object.values(Q)),yield Promise.all(Qt),Z("event",st,Ut||{})}catch(Qt){_n.error(Qt)}})).apply(this,arguments)}function Ya(){const Z=window.document.getElementsByTagName("script");for(const Q of Object.values(Z))if(Q.src&&Q.src.includes($t))return Q;return null}const wi=new xe.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),cu=new class Gu{constructor(Q={},Fe=1e3){this.throttleMetadata=Q,this.intervalMillis=Fe}getThrottleMetadata(Q){return this.throttleMetadata[Q]}setThrottleMetadata(Q,Fe){this.throttleMetadata[Q]=Fe}deleteThrottleMetadata(Q){delete this.throttleMetadata[Q]}};function Ol(Z){return new Headers({Accept:"application/json","x-goog-api-key":Z})}function Ri(Z){return zs.apply(this,arguments)}function zs(){return(zs=(0,g.Z)(function*(Z){var Q;const{appId:Fe,apiKey:st}=Z,Ut={method:"GET",headers:Ol(st)},Qt=Mt.replace("{app-id}",Fe),mn=yield fetch(Qt,Ut);if(200!==mn.status&&304!==mn.status){let xn="";try{const Bn=yield mn.json();(null===(Q=Bn.error)||void 0===Q?void 0:Q.message)&&(xn=Bn.error.message)}catch(Bn){}throw wi.create("config-fetch-failed",{httpStatus:mn.status,responseMessage:xn})}return mn.json()})).apply(this,arguments)}function Zs(Z){return qu.apply(this,arguments)}function qu(){return(qu=(0,g.Z)(function*(Z,Q=cu,Fe){const{appId:st,apiKey:Ut,measurementId:Qt}=Z.options;if(!st)throw wi.create("no-app-id");if(!Ut){if(Qt)return{measurementId:Qt,appId:st};throw wi.create("no-api-key")}const mn=Q.getThrottleMetadata(st)||{backoffCount:0,throttleEndTimeMillis:Date.now()},xn=new bl;return setTimeout((0,g.Z)(function*(){xn.abort()}),void 0!==Fe?Fe:6e4),Qo({appId:st,apiKey:Ut,measurementId:Qt},mn,xn,Q)})).apply(this,arguments)}function Qo(Z,Q,Fe){return So.apply(this,arguments)}function So(){return(So=(0,g.Z)(function*(Z,{throttleEndTimeMillis:Q,backoffCount:Fe},st,Ut=cu){const{appId:Qt,measurementId:mn}=Z;try{yield hu(st,Q)}catch(xn){if(mn)return _n.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${mn} provided in the "measurementId" field in the local Firebase config. [${xn.message}]`),{appId:Qt,measurementId:mn};throw xn}try{const xn=yield Ri(Z);return Ut.deleteThrottleMetadata(Qt),xn}catch(xn){if(!aa(xn)){if(Ut.deleteThrottleMetadata(Qt),mn)return _n.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${mn} provided in the "measurementId" field in the local Firebase config. [${xn.message}]`),{appId:Qt,measurementId:mn};throw xn}const Bn=503===Number(xn.customData.httpStatus)?(0,xe.$s)(Fe,Ut.intervalMillis,30):(0,xe.$s)(Fe,Ut.intervalMillis),sr={throttleEndTimeMillis:Date.now()+Bn,backoffCount:Fe+1};return Ut.setThrottleMetadata(Qt,sr),_n.debug(`Calling attemptFetch again in ${Bn} millis`),Qo(Z,sr,st,Ut)}})).apply(this,arguments)}function hu(Z,Q){return new Promise((Fe,st)=>{const Ut=Math.max(Q-Date.now(),0),Qt=setTimeout(Fe,Ut);Z.addEventListener(()=>{clearTimeout(Qt),st(wi.create("fetch-throttle",{throttleEndTimeMillis:Q}))})})}function aa(Z){if(!(Z instanceof xe.ZR&&Z.customData))return!1;const Q=Number(Z.customData.httpStatus);return 429===Q||500===Q||503===Q||504===Q}class bl{constructor(){this.listeners=[]}addEventListener(Q){this.listeners.push(Q)}abort(){this.listeners.forEach(Q=>Q())}}function il(){return Zn.apply(this,arguments)}function Zn(){return(Zn=(0,g.Z)(function*(){if(!(0,xe.hl)())return _n.warn(wi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,xe.eu)()}catch(Z){return _n.warn(wi.create("indexeddb-unavailable",{errorInfo:Z}).message),!1}return!0})).apply(this,arguments)}function V(){return(V=(0,g.Z)(function*(Z,Q,Fe,st,Ut,Qt,mn){var xn;const Bn=Zs(Z);Bn.then(Hi=>{Fe[Hi.measurementId]=Hi.appId,Z.options.measurementId&&Hi.measurementId!==Z.options.measurementId&&_n.warn(`The measurement ID in the local Firebase config (${Z.options.measurementId}) does not match the measurement ID fetched from the server (${Hi.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Hi=>_n.error(Hi)),Q.push(Bn);const sr=il().then(Hi=>{if(Hi)return st.getId()}),[hr,vi]=yield Promise.all([Bn,sr]);Ya()||or(Qt,hr.measurementId),Ut("js",new Date);const ki=null!==(xn=null==mn?void 0:mn.config)&&void 0!==xn?xn:{};return ki.origin="firebase",ki.update=!0,null!=vi&&(ki[de]=vi),Ut("config",hr.measurementId,ki),hr.measurementId})).apply(this,arguments)}class F{constructor(Q){this.app=Q}_delete(){return delete M[this.app.options.appId],Promise.resolve()}}let M={},J=[];const ye={};let at,pn,De="dataLayer",wn=!1;function si(Z,Q,Fe){!function Pr(){const Z=[];if((0,xe.ru)()&&Z.push("This is a browser extension environment."),(0,xe.zI)()||Z.push("Cookies are not available."),Z.length>0){const Q=Z.map((st,Ut)=>`(${Ut+1}) ${st}`).join(" "),Fe=wi.create("invalid-analytics-context",{errorInfo:Q});_n.warn(Fe.message)}}();const st=Z.options.appId;if(!st)throw wi.create("no-app-id");if(!Z.options.apiKey){if(!Z.options.measurementId)throw wi.create("no-api-key");_n.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${Z.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=M[st])throw wi.create("already-exists",{id:st});if(!wn){!function Gn(Z){let Q=[];Array.isArray(window[Z])?Q=window[Z]:window[Z]=Q}(De);const{wrappedGtag:Qt,gtagCore:mn}=function gs(Z,Q,Fe,st,Ut){let Qt=function(...mn){window[st].push(arguments)};return window[Ut]&&"function"==typeof window[Ut]&&(Qt=window[Ut]),window[Ut]=function Po(Z,Q,Fe,st){function Qt(){return(Qt=(0,g.Z)(function*(mn,xn,Bn){try{"event"===mn?yield Yr(Z,Q,Fe,xn,Bn):"config"===mn?yield dr(Z,Q,Fe,st,xn,Bn):Z("set",xn)}catch(sr){_n.error(sr)}})).apply(this,arguments)}return function Ut(mn,xn,Bn){return Qt.apply(this,arguments)}}(Qt,Z,Q,Fe),{gtagCore:Qt,wrappedGtag:window[Ut]}}(M,J,ye,De,"gtag");pn=Qt,at=mn,wn=!0}return M[st]=function Mi(Z,Q,Fe,st,Ut,Qt,mn){return V.apply(this,arguments)}(Z,J,ye,Q,at,De,Fe),new F(Z)}function Ro(){return(Ro=(0,g.Z)(function*(Z,Q,Fe,st,Ut){if(Ut&&Ut.global)Z("event",Fe,st);else{const Qt=yield Q;Z("event",Fe,Object.assign(Object.assign({},st),{send_to:Qt}))}})).apply(this,arguments)}function ei(){return Ja.apply(this,arguments)}function Ja(){return(Ja=(0,g.Z)(function*(){if((0,xe.ru)()||!(0,xe.zI)()||!(0,xe.hl)())return!1;try{return yield(0,xe.eu)()}catch(Z){return!1}})).apply(this,arguments)}const es="@firebase/analytics";!function xl(){(0,nt._registerComponent)(new Le.wA($,(Q,{options:Fe})=>si(Q.getProvider("app").getImmediate(),Q.getProvider("installations-internal").getImmediate(),Fe),"PUBLIC")),(0,nt._registerComponent)(new Le.wA("analytics-internal",function Z(Q){try{const Fe=Q.getProvider($).getImmediate();return{logEvent:(st,Ut,Qt)=>function Nl(Z,Q,Fe,st){Z=(0,xe.m9)(Z),function xi(Z,Q,Fe,st,Ut){return Ro.apply(this,arguments)}(pn,M[Z.app.options.appId],Q,Fe,st).catch(Ut=>_n.error(Ut))}(Fe,st,Ut,Qt)}}catch(Fe){throw wi.create("interop-component-reg-failed",{reason:Fe})}},"PRIVATE")),(0,nt.registerVersion)(es,"0.7.5"),(0,nt.registerVersion)(es,"0.7.5","esm2017")}();var no=H(4408),Wi=H(7565);const Ua=new class to extends Wi.v{}(class Lc extends no.o{constructor(Q,Fe){super(Q,Fe),this.scheduler=Q,this.work=Fe}schedule(Q,Fe=0){return Fe>0?super.schedule(Q,Fe):(this.delay=Fe,this.state=Q,this.scheduler.flush(this),this)}execute(Q,Fe){return Fe>0||this.closed?super.execute(Q,Fe):this._execute(Q,Fe)}requestAsyncId(Q,Fe,st=0){return null!=st&&st>0||null==st&&this.delay>0?super.requestAsyncId(Q,Fe,st):Q.flush(this)}});var Fl=H(4986),ls=H(8505),l=H(9468),d=H(5363);const h=new w.GfV("7.2.0"),E="__angularfire_symbol__analyticsIsSupported",k="__angularfire_symbol__remoteConfigIsSupported",le="__angularfire_symbol__messagingIsSupported";function xt(Z,Q,Fe){if(Q){if(1===Q.length)return Q[0];const Qt=Q.filter(mn=>mn.app===Fe);if(1===Qt.length)return Qt[0]}return Fe.container.getProvider(Z).getImmediate({optional:!0})}globalThis[E]||(globalThis[E]=ei().then(Z=>globalThis.__angularfire_symbol__analyticsIsSupportedValue=Z)),globalThis[le]||(globalThis[le]=lu().then(Z=>globalThis.__angularfire_symbol__messagingIsSupportedValue=Z)),globalThis[k]||(globalThis[k]=ga().then(Z=>globalThis.__angularfire_symbol__remoteConfigIsSupportedValue=Z));const wt=(Z,Q)=>{const Fe=Q?[Q]:(0,ue.C6)(),st=[];return Fe.forEach(Ut=>{Ut.container.getProvider(Z).instances.forEach(mn=>{st.includes(mn)||st.push(mn)})}),st};function Pt(){}class gt{constructor(Q,Fe=Ua){this.zone=Q,this.delegate=Fe}now(){return this.delegate.now()}schedule(Q,Fe,st){const Ut=this.zone;return this.delegate.schedule(function(mn){Ut.runGuarded(()=>{Q.apply(this,[mn])})},Fe,st)}}class kt{constructor(Q){this.zone=Q,this.task=null}call(Q,Fe){const st=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Pt,{},Pt,Pt)),Fe.pipe((0,ls.b)({next:st,complete:st,error:st})).subscribe(Q).add(st)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Bt=(()=>{class Z{constructor(Fe){this.ngZone=Fe,this.outsideAngular=Fe.runOutsideAngular(()=>new gt(Zone.current)),this.insideAngular=Fe.run(()=>new gt(Zone.current,Fl.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return Z.\u0275fac=function(Fe){return new(Fe||Z)(w.LFG(w.R0b))},Z.\u0275prov=w.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z})();function Jt(){const Z=globalThis.\u0275AngularFireScheduler;if(!Z)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return Z}function $n(Z){return Jt(),function Vn(Z){return function(Fe){return(Fe=Fe.lift(new kt(Z.ngZone))).pipe((0,l.R)(Z.outsideAngular),(0,d.Q)(Z.insideAngular))}}(Jt())(Z)}},2090:(Sn,Nt,H)=>{"use strict";H.d(Nt,{BH:()=>St,LL:()=>rt,ZR:()=>We,zI:()=>ee,US:()=>Le,tV:()=>fe,$s:()=>wr,r3:()=>lr,Sg:()=>pt,ne:()=>oi,vZ:()=>vr,ZB:()=>ae,pd:()=>bi,m9:()=>Ht,z$:()=>bt,jU:()=>ut,ru:()=>he,d:()=>Ae,xb:()=>Sr,w1:()=>j,hl:()=>U,uI:()=>Ct,UG:()=>ct,b$:()=>je,G6:()=>q,Mn:()=>W,xO:()=>ii,zd:()=>fi,eu:()=>Y});const nt=function(Te){const ke=[];let tt=0;for(let Ft=0;Ft<Te.length;Ft++){let vt=Te.charCodeAt(Ft);vt<128?ke[tt++]=vt:vt<2048?(ke[tt++]=vt>>6|192,ke[tt++]=63&vt|128):55296==(64512&vt)&&Ft+1<Te.length&&56320==(64512&Te.charCodeAt(Ft+1))?(vt=65536+((1023&vt)<<10)+(1023&Te.charCodeAt(++Ft)),ke[tt++]=vt>>18|240,ke[tt++]=vt>>12&63|128,ke[tt++]=vt>>6&63|128,ke[tt++]=63&vt|128):(ke[tt++]=vt>>12|224,ke[tt++]=vt>>6&63|128,ke[tt++]=63&vt|128)}return ke},Le={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(Te,ke){if(!Array.isArray(Te))throw Error("encodeByteArray takes an array as a parameter");this.init_();const tt=ke?this.byteToCharMapWebSafe_:this.byteToCharMap_,Ft=[];for(let vt=0;vt<Te.length;vt+=3){const dn=Te[vt],Pn=vt+1<Te.length,ce=Pn?Te[vt+1]:0,be=vt+2<Te.length,Oe=be?Te[vt+2]:0;let Dt=(15&ce)<<2|Oe>>6,Lt=63&Oe;be||(Lt=64,Pn||(Dt=64)),Ft.push(tt[dn>>2],tt[(3&dn)<<4|ce>>4],tt[Dt],tt[Lt])}return Ft.join("")},encodeString(Te,ke){return this.HAS_NATIVE_SUPPORT&&!ke?btoa(Te):this.encodeByteArray(nt(Te),ke)},decodeString(Te,ke){return this.HAS_NATIVE_SUPPORT&&!ke?atob(Te):function(Te){const ke=[];let tt=0,Ft=0;for(;tt<Te.length;){const vt=Te[tt++];if(vt<128)ke[Ft++]=String.fromCharCode(vt);else if(vt>191&&vt<224){const dn=Te[tt++];ke[Ft++]=String.fromCharCode((31&vt)<<6|63&dn)}else if(vt>239&&vt<365){const be=((7&vt)<<18|(63&Te[tt++])<<12|(63&Te[tt++])<<6|63&Te[tt++])-65536;ke[Ft++]=String.fromCharCode(55296+(be>>10)),ke[Ft++]=String.fromCharCode(56320+(1023&be))}else{const dn=Te[tt++],Pn=Te[tt++];ke[Ft++]=String.fromCharCode((15&vt)<<12|(63&dn)<<6|63&Pn)}}return ke.join("")}(this.decodeStringToByteArray(Te,ke))},decodeStringToByteArray(Te,ke){this.init_();const tt=ke?this.charToByteMapWebSafe_:this.charToByteMap_,Ft=[];for(let vt=0;vt<Te.length;){const dn=tt[Te.charAt(vt++)],ce=vt<Te.length?tt[Te.charAt(vt)]:0;++vt;const Oe=vt<Te.length?tt[Te.charAt(vt)]:64;++vt;const ot=vt<Te.length?tt[Te.charAt(vt)]:64;if(++vt,null==dn||null==ce||null==Oe||null==ot)throw Error();Ft.push(dn<<2|ce>>4),64!==Oe&&(Ft.push(ce<<4&240|Oe>>2),64!==ot&&Ft.push(Oe<<6&192|ot))}return Ft},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let Te=0;Te<this.ENCODED_VALS.length;Te++)this.byteToCharMap_[Te]=this.ENCODED_VALS.charAt(Te),this.charToByteMap_[this.byteToCharMap_[Te]]=Te,this.byteToCharMapWebSafe_[Te]=this.ENCODED_VALS_WEBSAFE.charAt(Te),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[Te]]=Te,Te>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(Te)]=Te,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(Te)]=Te)}}},Ue=function(Te){return function(Te){const ke=nt(Te);return Le.encodeByteArray(ke,!0)}(Te).replace(/\./g,"")},fe=function(Te){try{return Le.decodeString(Te,!0)}catch(ke){console.error("base64Decode failed: ",ke)}return null};function ae(Te,ke){if(!(ke instanceof Object))return ke;switch(ke.constructor){case Date:return new Date(ke.getTime());case Object:void 0===Te&&(Te={});break;case Array:Te=[];break;default:return ke}for(const tt in ke)!ke.hasOwnProperty(tt)||!$e(tt)||(Te[tt]=ae(Te[tt],ke[tt]));return Te}function $e(Te){return"__proto__"!==Te}class St{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((ke,tt)=>{this.resolve=ke,this.reject=tt})}wrapCallback(ke){return(tt,Ft)=>{tt?this.reject(tt):this.resolve(Ft),"function"==typeof ke&&(this.promise.catch(()=>{}),1===ke.length?ke(tt):ke(tt,Ft))}}}function pt(Te,ke){if(Te.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Ft=ke||"demo-project",vt=Te.iat||0,dn=Te.sub||Te.user_id;if(!dn)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Pn=Object.assign({iss:`https://securetoken.google.com/${Ft}`,aud:Ft,iat:vt,exp:vt+3600,auth_time:vt,sub:dn,user_id:dn,firebase:{sign_in_provider:"custom",identities:{}}},Te);return[Ue(JSON.stringify({alg:"none",type:"JWT"})),Ue(JSON.stringify(Pn)),""].join(".")}function bt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ct(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bt())}function ct(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(Te){return!1}}function ut(){return"object"==typeof self&&self.self===self}function he(){const Te="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof Te&&void 0!==Te.id}function je(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ae(){return bt().indexOf("Electron/")>=0}function j(){const Te=bt();return Te.indexOf("MSIE ")>=0||Te.indexOf("Trident/")>=0}function W(){return bt().indexOf("MSAppHost/")>=0}function q(){return!ct()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function U(){return"object"==typeof indexedDB}function Y(){return new Promise((Te,ke)=>{try{let tt=!0;const Ft="validate-browser-context-for-indexeddb-analytics-module",vt=self.indexedDB.open(Ft);vt.onsuccess=()=>{vt.result.close(),tt||self.indexedDB.deleteDatabase(Ft),Te(!0)},vt.onupgradeneeded=()=>{tt=!1},vt.onerror=()=>{var dn;ke((null===(dn=vt.error)||void 0===dn?void 0:dn.message)||"")}}catch(tt){ke(tt)}})}function ee(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class We extends Error{constructor(ke,tt,Ft){super(tt),this.code=ke,this.customData=Ft,this.name="FirebaseError",Object.setPrototypeOf(this,We.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rt.prototype.create)}}class rt{constructor(ke,tt,Ft){this.service=ke,this.serviceName=tt,this.errors=Ft}create(ke,...tt){const Ft=tt[0]||{},vt=`${this.service}/${ke}`,dn=this.errors[ke],Pn=dn?function _t(Te,ke){return Te.replace(ft,(tt,Ft)=>{const vt=ke[Ft];return null!=vt?String(vt):`<${Ft}?>`})}(dn,Ft):"Error";return new We(vt,`${this.serviceName}: ${Pn} (${vt}).`,Ft)}}const ft=/\{\$([^}]+)}/g;function lr(Te,ke){return Object.prototype.hasOwnProperty.call(Te,ke)}function Sr(Te){for(const ke in Te)if(Object.prototype.hasOwnProperty.call(Te,ke))return!1;return!0}function vr(Te,ke){if(Te===ke)return!0;const tt=Object.keys(Te),Ft=Object.keys(ke);for(const vt of tt){if(!Ft.includes(vt))return!1;const dn=Te[vt],Pn=ke[vt];if(qi(dn)&&qi(Pn)){if(!vr(dn,Pn))return!1}else if(dn!==Pn)return!1}for(const vt of Ft)if(!tt.includes(vt))return!1;return!0}function qi(Te){return null!==Te&&"object"==typeof Te}function ii(Te){const ke=[];for(const[tt,Ft]of Object.entries(Te))Array.isArray(Ft)?Ft.forEach(vt=>{ke.push(encodeURIComponent(tt)+"="+encodeURIComponent(vt))}):ke.push(encodeURIComponent(tt)+"="+encodeURIComponent(Ft));return ke.length?"&"+ke.join("&"):""}function fi(Te){const ke={};return Te.replace(/^\?/,"").split("&").forEach(Ft=>{if(Ft){const[vt,dn]=Ft.split("=");ke[decodeURIComponent(vt)]=decodeURIComponent(dn)}}),ke}function bi(Te){const ke=Te.indexOf("?");if(!ke)return"";const tt=Te.indexOf("#",ke);return Te.substring(ke,tt>0?tt:void 0)}function oi(Te,ke){const tt=new Xt(Te,ke);return tt.subscribe.bind(tt)}class Xt{constructor(ke,tt){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=tt,this.task.then(()=>{ke(this)}).catch(Ft=>{this.error(Ft)})}next(ke){this.forEachObserver(tt=>{tt.next(ke)})}error(ke){this.forEachObserver(tt=>{tt.error(ke)}),this.close(ke)}complete(){this.forEachObserver(ke=>{ke.complete()}),this.close()}subscribe(ke,tt,Ft){let vt;if(void 0===ke&&void 0===tt&&void 0===Ft)throw new Error("Missing Observer.");vt=function En(Te,ke){if("object"!=typeof Te||null===Te)return!1;for(const tt of ke)if(tt in Te&&"function"==typeof Te[tt])return!0;return!1}(ke,["next","error","complete"])?ke:{next:ke,error:tt,complete:Ft},void 0===vt.next&&(vt.next=bn),void 0===vt.error&&(vt.error=bn),void 0===vt.complete&&(vt.complete=bn);const dn=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?vt.error(this.finalError):vt.complete()}catch(Pn){}}),this.observers.push(vt),dn}unsubscribeOne(ke){void 0===this.observers||void 0===this.observers[ke]||(delete this.observers[ke],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(ke){if(!this.finalized)for(let tt=0;tt<this.observers.length;tt++)this.sendOne(tt,ke)}sendOne(ke,tt){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[ke])try{tt(this.observers[ke])}catch(Ft){"undefined"!=typeof console&&console.error&&console.error(Ft)}})}close(ke){this.finalized||(this.finalized=!0,void 0!==ke&&(this.finalError=ke),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bn(){}function wr(Te,ke=1e3,tt=2){const Ft=ke*Math.pow(tt,Te),vt=Math.round(.5*Ft*(Math.random()-.5)*2);return Math.min(144e5,Ft+vt)}function Ht(Te){return Te&&Te._delegate?Te._delegate:Te}},6170:(Sn,Nt,H)=>{"use strict";H.d(Nt,{S:()=>sa});var w="6.17.2",ue=H(5897),g=H(1446),Re=function(){return Re=Object.assign||function(B){for(var $,de=1,Ge=arguments.length;de<Ge;de++)for(var Ze in $=arguments[de])Object.prototype.hasOwnProperty.call($,Ze)&&(B[Ze]=$[Ze]);return B},Re.apply(this,arguments)};function ct(P,B){var $="function"==typeof Symbol&&P[Symbol.iterator];if(!$)return P;var Ge,Mt,de=$.call(P),Ze=[];try{for(;(void 0===B||B-- >0)&&!(Ge=de.next()).done;)Ze.push(Ge.value)}catch($t){Mt={error:$t}}finally{try{Ge&&!Ge.done&&($=de.return)&&$.call(de)}finally{if(Mt)throw Mt.error}}return Ze}function ut(){for(var P=[],B=0;B<arguments.length;B++)P=P.concat(ct(arguments[B]));return P}var nn,Pe=H(383),_e=H(3327),We=H(5535),rt=H(1090),_t=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],ft=function(){function P(B){void 0===B&&(B={}),this._options=B,this.name=P.id}return P.prototype.setupOnce=function(){(0,Pe.c)(function(B){var $=(0,ue.Gd)();if(!$)return B;var de=$.getIntegration(P);if(de){var Ge=$.getClient(),Ze=Ge?Ge.getOptions():{},Mt="function"==typeof de._mergeOptions?de._mergeOptions(Ze):{};return"function"!=typeof de._shouldDropEvent?B:de._shouldDropEvent(B,Mt)?null:B}return B})},P.prototype._shouldDropEvent=function(B,$){return this._isSentryError(B,$)?((0,_e.c)()&&g.k.warn("Event dropped due to being internal Sentry Error.\nEvent: "+(0,We.jH)(B)),!0):this._isIgnoredError(B,$)?((0,_e.c)()&&g.k.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+(0,We.jH)(B)),!0):this._isDeniedUrl(B,$)?((0,_e.c)()&&g.k.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: "+(0,We.jH)(B)+".\nUrl: "+this._getEventFilterUrl(B)),!0):!this._isAllowedUrl(B,$)&&((0,_e.c)()&&g.k.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: "+(0,We.jH)(B)+".\nUrl: "+this._getEventFilterUrl(B)),!0)},P.prototype._isSentryError=function(B,$){if(!$.ignoreInternal)return!1;try{return"SentryError"===B.exception.values[0].type}catch(de){}return!1},P.prototype._isIgnoredError=function(B,$){return!(!$.ignoreErrors||!$.ignoreErrors.length)&&this._getPossibleEventMessages(B).some(function(de){return $.ignoreErrors.some(function(Ge){return(0,rt.zC)(de,Ge)})})},P.prototype._isDeniedUrl=function(B,$){if(!$.denyUrls||!$.denyUrls.length)return!1;var de=this._getEventFilterUrl(B);return!!de&&$.denyUrls.some(function(Ge){return(0,rt.zC)(de,Ge)})},P.prototype._isAllowedUrl=function(B,$){if(!$.allowUrls||!$.allowUrls.length)return!0;var de=this._getEventFilterUrl(B);return!de||$.allowUrls.some(function(Ge){return(0,rt.zC)(de,Ge)})},P.prototype._mergeOptions=function(B){return void 0===B&&(B={}),{allowUrls:ut(this._options.whitelistUrls||[],this._options.allowUrls||[],B.whitelistUrls||[],B.allowUrls||[]),denyUrls:ut(this._options.blacklistUrls||[],this._options.denyUrls||[],B.blacklistUrls||[],B.denyUrls||[]),ignoreErrors:ut(this._options.ignoreErrors||[],B.ignoreErrors||[],_t),ignoreInternal:void 0===this._options.ignoreInternal||this._options.ignoreInternal}},P.prototype._getPossibleEventMessages=function(B){if(B.message)return[B.message];if(B.exception)try{var $=B.exception.values&&B.exception.values[0]||{},de=$.type,Ze=$.value,Mt=void 0===Ze?"":Ze;return[""+Mt,(void 0===de?"":de)+": "+Mt]}catch($t){return(0,_e.c)()&&g.k.error("Cannot extract message for event "+(0,We.jH)(B)),[]}return[]},P.prototype._getLastValidUrl=function(B){void 0===B&&(B=[]);for(var $=B.length-1;$>=0;$--){var de=B[$];if(de&&"<anonymous>"!==de.filename&&"[native code]"!==de.filename)return de.filename||null}return null},P.prototype._getEventFilterUrl=function(B){try{if(B.stacktrace)return this._getLastValidUrl(B.stacktrace.frames);var $;try{$=B.exception.values[0].stacktrace.frames}catch(de){}return $?this._getLastValidUrl($):null}catch(de){return(0,_e.c)()&&g.k.error("Cannot extract url for event "+(0,We.jH)(B)),null}},P.id="InboundFilters",P}(),Zt=H(81),qt=function(){function P(){this.name=P.id}return P.prototype.setupOnce=function(){nn=Function.prototype.toString,Function.prototype.toString=function(){for(var B=[],$=0;$<arguments.length;$++)B[$]=arguments[$];var de=(0,Zt.HK)(this)||this;return nn.apply(de,B)}},P.id="FunctionToString",P}(),An=H(7576),kn=H(3343),jn=function(P,B){return(jn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($,de){$.__proto__=de}||function($,de){for(var Ge in de)de.hasOwnProperty(Ge)&&($[Ge]=de[Ge])})(P,B)};function gr(P,B){function $(){this.constructor=P}jn(P,B),P.prototype=null===B?Object.create(B):($.prototype=B.prototype,new $)}var lr=function(){return lr=Object.assign||function(B){for(var $,de=1,Ge=arguments.length;de<Ge;de++)for(var Ze in $=arguments[de])Object.prototype.hasOwnProperty.call($,Ze)&&(B[Ze]=$[Ze]);return B},lr.apply(this,arguments)};function pi(P){var B="function"==typeof Symbol&&Symbol.iterator,$=B&&P[B],de=0;if($)return $.call(P);if(P&&"number"==typeof P.length)return{next:function(){return P&&de>=P.length&&(P=void 0),{value:P&&P[de++],done:!P}}};throw new TypeError(B?"Object is not iterable.":"Symbol.iterator is not defined.")}function oi(P,B){var $="function"==typeof Symbol&&P[Symbol.iterator];if(!$)return P;var Ge,Mt,de=$.call(P),Ze=[];try{for(;(void 0===B||B-- >0)&&!(Ge=de.next()).done;)Ze.push(Ge.value)}catch($t){Mt={error:$t}}finally{try{Ge&&!Ge.done&&($=de.return)&&$.call(de)}finally{if(Mt)throw Mt.error}}return Ze}function Xt(){for(var P=[],B=0;B<arguments.length;B++)P=P.concat(oi(arguments[B]));return P}var sn=H(832),Mn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function Jn(P,B){return P.__proto__=B,P}:function Tr(P,B){for(var $ in B)Object.prototype.hasOwnProperty.call(P,$)||(P[$]=B[$]);return P}),wr=function(P){function B($){var de=this.constructor,Ge=P.call(this,$)||this;return Ge.message=$,Ge.name=de.prototype.constructor.name,Mn(Ge,de.prototype),Ge}return(0,sn.ZT)(B,P),B}(Error),Ki=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Ht(P,B){void 0===B&&(B=!1);var de=P.path,Ge=P.pass,Ze=P.port;return P.protocol+"://"+P.publicKey+(B&&Ge?":"+Ge:"")+"@"+P.host+(Ze?":"+Ze:"")+"/"+(de&&de+"/")+P.projectId}function ke(P){return"user"in P&&!("publicKey"in P)&&(P.publicKey=P.user),{user:P.publicKey||"",protocol:P.protocol,publicKey:P.publicKey||"",pass:P.pass||"",host:P.host,port:P.port||"",path:P.path||"",projectId:P.projectId}}function Ft(P){var B="string"==typeof P?function Te(P){var B=Ki.exec(P);if(!B)throw new wr("Invalid Sentry Dsn: "+P);var $=(0,sn.CR)(B.slice(1),6),de=$[0],Ge=$[1],Ze=$[2],Mt=void 0===Ze?"":Ze,$t=$[3],_n=$[4],on=void 0===_n?"":_n,Gn="",dr=$[5],gi=dr.split("/");if(gi.length>1&&(Gn=gi.slice(0,-1).join("/"),dr=gi.pop()),dr){var Yr=dr.match(/^\d+/);Yr&&(dr=Yr[0])}return ke({host:$t,pass:Mt,path:Gn,projectId:dr,port:on,protocol:de,publicKey:Ge})}(P):ke(P);return function tt(P){if((0,_e.c)()){var B=P.port,$=P.projectId,de=P.protocol;if(["protocol","publicKey","host","projectId"].forEach(function(Ze){if(!P[Ze])throw new wr("Invalid Sentry Dsn: "+Ze+" missing")}),!$.match(/^\d+$/))throw new wr("Invalid Sentry Dsn: Invalid projectId "+$);if(!function Li(P){return"http"===P||"https"===P}(de))throw new wr("Invalid Sentry Dsn: Invalid protocol "+de);if(B&&isNaN(parseInt(B,10)))throw new wr("Invalid Sentry Dsn: Invalid port "+B)}}(B),B}var vt=H(6412),dn=H(509),Pn=H(3967),ce=[];function be(P){return P.reduce(function(B,$){return B.every(function(de){return $.name!==de.name})&&B.push($),B},[])}var Dt="Not capturing exception because it's already been captured.",Lt=function(){function P(B,$){this._integrations={},this._numProcessing=0,this._backend=new B($),this._options=$,$.dsn&&(this._dsn=Ft($.dsn))}return P.prototype.captureException=function(B,$,de){var Ge=this;if(!(0,We.YO)(B)){var Ze=$&&$.event_id;return this._process(this._getBackend().eventFromException(B,$).then(function(Mt){return Ge._captureEvent(Mt,$,de)}).then(function(Mt){Ze=Mt})),Ze}g.k.log(Dt)},P.prototype.captureMessage=function(B,$,de,Ge){var Ze=this,Mt=de&&de.event_id,$t=(0,vt.pt)(B)?this._getBackend().eventFromMessage(String(B),$,de):this._getBackend().eventFromException(B,de);return this._process($t.then(function(_n){return Ze._captureEvent(_n,de,Ge)}).then(function(_n){Mt=_n})),Mt},P.prototype.captureEvent=function(B,$,de){if(!($&&$.originalException&&(0,We.YO)($.originalException))){var Ge=$&&$.event_id;return this._process(this._captureEvent(B,$,de).then(function(Ze){Ge=Ze})),Ge}g.k.log(Dt)},P.prototype.captureSession=function(B){this._isEnabled()?"string"!=typeof B.release?(0,_e.c)()&&g.k.warn("Discarded session because of missing or non-string release"):(this._sendSession(B),B.update({init:!1})):(0,_e.c)()&&g.k.warn("SDK not enabled, will not capture session.")},P.prototype.getDsn=function(){return this._dsn},P.prototype.getOptions=function(){return this._options},P.prototype.getTransport=function(){return this._getBackend().getTransport()},P.prototype.flush=function(B){var $=this;return this._isClientDoneProcessing(B).then(function(de){return $.getTransport().close(B).then(function(Ge){return de&&Ge})})},P.prototype.close=function(B){var $=this;return this.flush(B).then(function(de){return $.getOptions().enabled=!1,de})},P.prototype.setupIntegrations=function(){this._isEnabled()&&!this._integrations.initialized&&(this._integrations=function ot(P){var B={};return function Oe(P){var B=P.defaultIntegrations&&ut(P.defaultIntegrations)||[],$=P.integrations,de=ut(be(B));Array.isArray($)?de=ut(de.filter(function(Mt){return $.every(function($t){return $t.name!==Mt.name})}),be($)):"function"==typeof $&&(de=$(de),de=Array.isArray(de)?de:[de]);var Ge=de.map(function(Mt){return Mt.name});return-1!==Ge.indexOf("Debug")&&de.push.apply(de,ut(de.splice(Ge.indexOf("Debug"),1))),de}(P).forEach(function($){B[$.name]=$,function Qe(P){-1===ce.indexOf(P.name)&&(P.setupOnce(Pe.c,ue.Gd),ce.push(P.name),g.k.log("Integration installed: "+P.name))}($)}),(0,Zt.xp)(B,"initialized",!0),B}(this._options))},P.prototype.getIntegration=function(B){try{return this._integrations[B.id]||null}catch($){return g.k.warn("Cannot retrieve integration "+B.id+" from the current Client"),null}},P.prototype._updateSessionFromEvent=function(B,$){var de,Ge,Ze=!1,Mt=!1,$t=$.exception&&$.exception.values;if($t){Mt=!0;try{for(var _n=function Ct(P){var B="function"==typeof Symbol&&Symbol.iterator,$=B&&P[B],de=0;if($)return $.call(P);if(P&&"number"==typeof P.length)return{next:function(){return P&&de>=P.length&&(P=void 0),{value:P&&P[de++],done:!P}}};throw new TypeError(B?"Object is not iterable.":"Symbol.iterator is not defined.")}($t),on=_n.next();!on.done;on=_n.next()){var Gn=on.value.mechanism;if(Gn&&!1===Gn.handled){Ze=!0;break}}}catch(Yr){de={error:Yr}}finally{try{on&&!on.done&&(Ge=_n.return)&&Ge.call(_n)}finally{if(de)throw de.error}}}var dr="ok"===B.status;(dr&&0===B.errors||dr&&Ze)&&(B.update(Re(Re({},Ze&&{status:"crashed"}),{errors:B.errors||Number(Mt||Ze)})),this.captureSession(B))},P.prototype._sendSession=function(B){this._getBackend().sendSession(B)},P.prototype._isClientDoneProcessing=function(B){var $=this;return new dn.cW(function(de){var Ge=0,Mt=setInterval(function(){0==$._numProcessing?(clearInterval(Mt),de(!0)):(Ge+=1,B&&Ge>=B&&(clearInterval(Mt),de(!1)))},1)})},P.prototype._getBackend=function(){return this._backend},P.prototype._isEnabled=function(){return!1!==this.getOptions().enabled&&void 0!==this._dsn},P.prototype._prepareEvent=function(B,$,de){var Ge=this,Ze=this.getOptions().normalizeDepth,Mt=void 0===Ze?3:Ze,$t=Re(Re({},B),{event_id:B.event_id||(de&&de.event_id?de.event_id:(0,We.DM)()),timestamp:B.timestamp||(0,Pn.yW)()});this._applyClientOptions($t),this._applyIntegrationsMetadata($t);var _n=$;de&&de.captureContext&&(_n=Pe.s.clone(_n).update(de.captureContext));var on=(0,dn.WD)($t);return _n&&(on=_n.applyToEvent($t,de)),on.then(function(or){return"number"==typeof Mt&&Mt>0?Ge._normalizeEvent(or,Mt):or})},P.prototype._normalizeEvent=function(B,$){if(!B)return null;var de=Re(Re(Re(Re(Re({},B),B.breadcrumbs&&{breadcrumbs:B.breadcrumbs.map(function(Ge){return Re(Re({},Ge),Ge.data&&{data:(0,Zt.Fv)(Ge.data,$)})})}),B.user&&{user:(0,Zt.Fv)(B.user,$)}),B.contexts&&{contexts:(0,Zt.Fv)(B.contexts,$)}),B.extra&&{extra:(0,Zt.Fv)(B.extra,$)});return B.contexts&&B.contexts.trace&&(de.contexts.trace=B.contexts.trace),B.sdkProcessingMetadata=Re(Re({},B.sdkProcessingMetadata),{baseClientNormalized:!0}),de},P.prototype._applyClientOptions=function(B){var $=this.getOptions(),Ge=$.release,Ze=$.dist,Mt=$.maxValueLength,$t=void 0===Mt?250:Mt;"environment"in B||(B.environment="environment"in $?$.environment:"production"),void 0===B.release&&void 0!==Ge&&(B.release=Ge),void 0===B.dist&&void 0!==Ze&&(B.dist=Ze),B.message&&(B.message=(0,rt.$G)(B.message,$t));var _n=B.exception&&B.exception.values&&B.exception.values[0];_n&&_n.value&&(_n.value=(0,rt.$G)(_n.value,$t));var on=B.request;on&&on.url&&(on.url=(0,rt.$G)(on.url,$t))},P.prototype._applyIntegrationsMetadata=function(B){var $=Object.keys(this._integrations);$.length>0&&(B.sdk=B.sdk||{},B.sdk.integrations=ut(B.sdk.integrations||[],$))},P.prototype._sendEvent=function(B){this._getBackend().sendEvent(B)},P.prototype._captureEvent=function(B,$,de){return this._processEvent(B,$,de).then(function(Ge){return Ge.event_id},function(Ge){g.k.error(Ge)})},P.prototype._processEvent=function(B,$,de){var Ge=this,Ze=this.getOptions(),Mt=Ze.beforeSend,$t=Ze.sampleRate,_n=this.getTransport();function on(Gn,dr){_n.recordLostEvent&&_n.recordLostEvent(Gn,dr)}if(!this._isEnabled())return(0,dn.$2)(new wr("SDK not enabled, will not capture event."));var or="transaction"===B.type;return!or&&"number"==typeof $t&&Math.random()>$t?(on("sample_rate","event"),(0,dn.$2)(new wr("Discarding event because it's not included in the random sample (sampling rate = "+$t+")"))):this._prepareEvent(B,de,$).then(function(Gn){if(null===Gn)throw on("event_processor",B.type||"event"),new wr("An event processor returned null, will not send event.");return $&&$.data&&!0===$.data.__sentry__||or||!Mt?Gn:function Je(P){var B="`beforeSend` method has to return `null` or a valid event.";if((0,vt.J8)(P))return P.then(function($){if(!(0,vt.PO)($)&&null!==$)throw new wr(B);return $},function($){throw new wr("beforeSend rejected with "+$)});if(!(0,vt.PO)(P)&&null!==P)throw new wr(B);return P}(Mt(Gn,$))}).then(function(Gn){if(null===Gn)throw on("before_send",B.type||"event"),new wr("`beforeSend` returned `null`, will not send event.");var dr=de&&de.getSession&&de.getSession();return!or&&dr&&Ge._updateSessionFromEvent(dr,Gn),Ge._sendEvent(Gn),Gn}).then(null,function(Gn){throw Gn instanceof wr?Gn:(Ge.captureException(Gn,{data:{__sentry__:!0},originalException:Gn}),new wr("Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: "+Gn))})},P.prototype._process=function(B){var $=this;this._numProcessing+=1,B.then(function(de){return $._numProcessing-=1,de},function(de){return $._numProcessing-=1,de})},P}(),Ie=function(){function P(){}return P.prototype.sendEvent=function(B){return(0,dn.WD)({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:"skipped"})},P.prototype.close=function(B){return(0,dn.WD)(!0)},P}(),ze=function(){function P(B){this._options=B,this._options.dsn||g.k.warn("No DSN provided, backend will not do anything."),this._transport=this._setupTransport()}return P.prototype.eventFromException=function(B,$){throw new wr("Backend has to implement `eventFromException` method")},P.prototype.eventFromMessage=function(B,$,de){throw new wr("Backend has to implement `eventFromMessage` method")},P.prototype.sendEvent=function(B){this._transport.sendEvent(B).then(null,function($){(0,_e.c)()&&g.k.error("Error while sending event: "+$)})},P.prototype.sendSession=function(B){this._transport.sendSession?this._transport.sendSession(B).then(null,function($){(0,_e.c)()&&g.k.error("Error while sending session: "+$)}):(0,_e.c)()&&g.k.warn("Dropping session because custom transport doesn't implement sendSession")},P.prototype.getTransport=function(){return this._transport},P.prototype._setupTransport=function(){return new Ie},P}(),Ve=(()=>{return(P=Ve||(Ve={})).Fatal="fatal",P.Error="error",P.Warning="warning",P.Log="log",P.Info="info",P.Debug="debug",P.Critical="critical",Ve;var P})(),mt=["fatal","error","warning","log","info","debug","critical"],Tt=H(8204),Dn=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,zn=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|capacitor).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,an=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Kn=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Yn=/\((\S*)(?::(\d+))(?::(\d+))\)/,Hn=/Minified React error #\d+;/i;function Ir(P){var B=null,$=0;P&&("number"==typeof P.framesToPop?$=P.framesToPop:Hn.test(P.message)&&($=1));try{if(B=function br(P){if(!P||!P.stacktrace)return null;for(var Mt,$=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,de=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\((.*)\))? in (.*):\s*$/i,Ge=P.stacktrace.split("\n"),Ze=[],$t=0;$t<Ge.length;$t+=2){var _n=null;(Mt=$.exec(Ge[$t]))?_n={url:Mt[2],func:Mt[3],args:[],line:+Mt[1],column:null}:(Mt=de.exec(Ge[$t]))&&(_n={url:Mt[6],func:Mt[3]||Mt[4],args:Mt[5]?Mt[5].split(","):[],line:+Mt[1],column:+Mt[2]}),_n&&(!_n.func&&_n.line&&(_n.func="?"),Ze.push(_n))}return Ze.length?{message:Dr(P),name:P.name,stack:Ze}:null}(P),B)return ur(B,$)}catch(de){}try{if(B=function Xn(P){var B,$;if(!P||!P.stack)return null;for(var Mt,$t,_n,de=[],Ge=P.stack.split("\n"),on=0;on<Ge.length;++on){if($t=Dn.exec(Ge[on])){var or=$t[2]&&0===$t[2].indexOf("native");$t[2]&&0===$t[2].indexOf("eval")&&(Mt=Yn.exec($t[2]))&&($t[2]=Mt[1],$t[3]=Mt[2],$t[4]=Mt[3]);var Gn=$t[2]&&0===$t[2].indexOf("address at ")?$t[2].substr("address at ".length):$t[2];_n={url:Gn=(B=oi(yn($t[1]||"?",Gn),2))[1],func:B[0],args:or?[$t[2]]:[],line:$t[3]?+$t[3]:null,column:$t[4]?+$t[4]:null}}else if($t=an.exec(Ge[on]))_n={url:$t[2],func:$t[1]||"?",args:[],line:+$t[3],column:$t[4]?+$t[4]:null};else{if(!($t=zn.exec(Ge[on])))continue;$t[3]&&$t[3].indexOf(" > eval")>-1&&(Mt=Kn.exec($t[3]))?($t[1]=$t[1]||"eval",$t[3]=Mt[1],$t[4]=Mt[2],$t[5]=""):0===on&&!$t[5]&&void 0!==P.columnNumber&&(de[0].column=P.columnNumber+1),_n={url:Gn=($=oi(yn($t[1]||"?",Gn=$t[3]),2))[1],func:$[0],args:$t[2]?$t[2].split(","):[],line:$t[4]?+$t[4]:null,column:$t[5]?+$t[5]:null}}!_n.func&&_n.line&&(_n.func="?"),de.push(_n)}return de.length?{message:Dr(P),name:P.name,stack:de}:null}(P),B)return ur(B,$)}catch(de){}return{message:Dr(P),name:P&&P.name,stack:[],failed:!0}}var yn=function(P,B){var $=-1!==P.indexOf("safari-extension"),de=-1!==P.indexOf("safari-web-extension");return $||de?[-1!==P.indexOf("@")?P.split("@")[0]:"?",$?"safari-extension:"+B:"safari-web-extension:"+B]:[P,B]};function ur(P,B){try{return lr(lr({},P),{stack:P.stack.slice(B)})}catch($){return P}}function Dr(P){var B=P&&P.message;return B?B.error&&"string"==typeof B.error.message?B.error.message:B:"No error message"}function oo(P){var B=Mr(P.stack),$={type:P.name,value:P.message};return B&&B.length&&($.stacktrace={frames:B}),void 0===$.type&&""===$.value&&($.value="Unrecoverable error caught"),$}function Ci(P){return{exception:{values:[oo(P)]}}}function Mr(P){if(!P||!P.length)return[];var B=P,$=B[0].func||"",de=B[B.length-1].func||"";return(-1!==$.indexOf("captureMessage")||-1!==$.indexOf("captureException"))&&(B=B.slice(1)),-1!==de.indexOf("sentryWrapped")&&(B=B.slice(0,-1)),B.slice(0,50).map(function(Ge){return{colno:null===Ge.column?void 0:Ge.column,filename:Ge.url||B[0].url,function:Ge.func||"?",in_app:!0,lineno:null===Ge.line?void 0:Ge.line}}).reverse()}function Vr(P,B,$){var de;if(void 0===$&&($={}),(0,vt.VW)(P)&&P.error)return Ci(Ir(P=P.error));if((0,vt.TX)(P)||(0,vt.fm)(P)){var Ze=P;if("stack"in P)de=Ci(Ir(P));else{var Mt=Ze.name||((0,vt.TX)(Ze)?"DOMError":"DOMException"),$t=Ze.message?Mt+": "+Ze.message:Mt;de=hs($t,B,$),(0,We.Db)(de,$t)}return"code"in Ze&&(de.tags=lr(lr({},de.tags),{"DOMException.code":""+Ze.code})),de}return(0,vt.VZ)(P)?de=Ci(Ir(P)):(0,vt.PO)(P)||(0,vt.cO)(P)?(de=function zr(P,B,$){var de={exception:{values:[{type:(0,vt.cO)(P)?P.constructor.name:$?"UnhandledRejection":"Error",value:"Non-Error "+($?"promise rejection":"exception")+" captured with keys: "+(0,Zt.zf)(P)}]},extra:{__serialized__:(0,Zt.Qy)(P)}};if(B){var Ze=Mr(Ir(B).stack);de.stacktrace={frames:Ze}}return de}(P,B,$.isRejection),(0,We.EG)(de,{synthetic:!0}),de):(de=hs(P,B,$),(0,We.Db)(de,""+P,void 0),(0,We.EG)(de,{synthetic:!0}),de)}function hs(P,B,$){void 0===$&&($={});var de={message:P};if($.attachStacktrace&&B){var Ze=Mr(Ir(B).stack);de.stacktrace={frames:Ze}}return de}function Pi(P){return(P.protocol?P.protocol+":":"")+"//"+P.host+(P.port?":"+P.port:"")+(P.path?"/"+P.path:"")+"/api/"}function Si(P,B){return""+Pi(P)+P.projectId+"/"+B+"/"}function xs(P){return(0,Zt._j)({sentry_key:P.publicKey,sentry_version:"7"})}function zi(P){return Si(P,"store")}function Br(P){return zi(P)+"?"+xs(P)}function _i(P,B){return B||function ds(P){return Si(P,"envelope")}(P)+"?"+xs(P)}function ou(P){if(P.metadata&&P.metadata.sdk){var B=P.metadata.sdk;return{name:B.name,version:B.version}}}!function(){function P(B,$,de){void 0===$&&($={}),this.dsn=B,this._dsnObject=Ft(B),this.metadata=$,this._tunnel=de}P.prototype.getDsn=function(){return this._dsnObject},P.prototype.forceEnvelope=function(){return!!this._tunnel},P.prototype.getBaseApiEndpoint=function(){return Pi(this._dsnObject)},P.prototype.getStoreEndpoint=function(){return zi(this._dsnObject)},P.prototype.getStoreEndpointWithUrlEncodedAuth=function(){return Br(this._dsnObject)},P.prototype.getEnvelopeEndpointWithUrlEncodedAuth=function(){return _i(this._dsnObject,this._tunnel)}}();var su,mi=(0,An.R)();function Oa(){if(su)return su;if((0,Tt.Du)(mi.fetch))return su=mi.fetch.bind(mi);var P=mi.document,B=mi.fetch;if(P&&"function"==typeof P.createElement)try{var $=P.createElement("iframe");$.hidden=!0,P.head.appendChild($);var de=$.contentWindow;de&&de.fetch&&(B=de.fetch),P.head.removeChild($)}catch(Ge){(0,_e.c)()&&g.k.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",Ge)}return su=B.bind(mi)}function Yo(P){return"event"===P?"error":P}var $a=(0,An.R)(),au=function(){function P(B){var $=this;this.options=B,this._buffer=function jo(P){var B=[];function de(Mt){return B.splice(B.indexOf(Mt),1)[0]}return{$:B,add:function Ge(Mt){if(!function $(){return void 0===P||B.length<P}())return(0,dn.$2)(new wr("Not adding Promise due to buffer limit reached."));var $t=Mt();return-1===B.indexOf($t)&&B.push($t),$t.then(function(){return de($t)}).then(null,function(){return de($t).then(null,function(){})}),$t},drain:function Ze(Mt){return new dn.cW(function($t,_n){var on=B.length;if(!on)return $t(!0);var or=setTimeout(function(){Mt&&Mt>0&&$t(!1)},Mt);B.forEach(function(Gn){(0,dn.WD)(Gn).then(function(){--on||(clearTimeout(or),$t(!0))},_n)})})}}}(30),this._rateLimits={},this._outcomes={},this._api=function Bo(P,B,$){return{initDsn:P,metadata:B||{},dsn:Ft(P),tunnel:$}}(B.dsn,B._metadata,B.tunnel),this.url=Br(this._api.dsn),this.options.sendClientReports&&$a.document&&$a.document.addEventListener("visibilitychange",function(){"hidden"===$a.document.visibilityState&&$._flushOutcomes()})}return P.prototype.sendEvent=function(B){return this._sendRequest(function Io(P,B){var on,$=ou(B),de=P.type||"event",Ge="transaction"===de||!!B.tunnel,Mt=(P.sdkProcessingMetadata||{}).transactionSampling||{},$t=Mt.method,_n=Mt.rate;(function ns(P,B){B&&(P.sdk=P.sdk||{},P.sdk.name=P.sdk.name||B.name,P.sdk.version=P.sdk.version||B.version,P.sdk.integrations=ut(P.sdk.integrations||[],B.integrations||[]),P.sdk.packages=ut(P.sdk.packages||[],B.packages||[]))})(P,B.metadata.sdk),P.tags=P.tags||{},P.extra=P.extra||{},P.sdkProcessingMetadata&&P.sdkProcessingMetadata.baseClientNormalized||(P.tags.skippedNormalization=!0),delete P.sdkProcessingMetadata;try{on=JSON.stringify(P)}catch(tr){P.tags.JSONStringifyError=!0,P.extra.JSONStringifyError=tr;try{on=JSON.stringify((0,Zt.Fv)(P))}catch(Po){on=JSON.stringify({message:"JSON.stringify error after renormalization",extra:{message:Po.message,stack:Po.stack}})}}var Gn={body:on,type:de,url:Ge?_i(B.dsn,B.tunnel):Br(B.dsn)};if(Ge){var dr=JSON.stringify(Re(Re({event_id:P.event_id,sent_at:(new Date).toISOString()},$&&{sdk:$}),!!B.tunnel&&{dsn:Ht(B.dsn)})),gi=JSON.stringify({type:de,sample_rates:[{id:$t,rate:_n}]});Gn.body=dr+"\n"+gi+"\n"+Gn.body}return Gn}(B,this._api),B)},P.prototype.sendSession=function(B){return this._sendRequest(function fs(P,B){var $=ou(B),Ge="aggregates"in P?"sessions":"session";return{body:JSON.stringify(Re(Re({sent_at:(new Date).toISOString()},$&&{sdk:$}),!!B.tunnel&&{dsn:Ht(B.dsn)}))+"\n"+JSON.stringify({type:Ge})+"\n"+JSON.stringify(P),type:Ge,url:_i(B.dsn,B.tunnel)}}(B,this._api),B)},P.prototype.close=function(B){return this._buffer.drain(B)},P.prototype.recordLostEvent=function(B,$){var de;if(this.options.sendClientReports){var Ge=Yo($)+":"+B;g.k.log("Adding outcome: "+Ge),this._outcomes[Ge]=(null!=(de=this._outcomes[Ge])?de:0)+1}},P.prototype._flushOutcomes=function(){if(this.options.sendClientReports){var B=this._outcomes;if(this._outcomes={},!Object.keys(B).length)return void g.k.log("No outcomes to flush");g.k.log("Flushing outcomes:\n"+JSON.stringify(B,null,2));var $=_i(this._api.dsn,this._api.tunnel),Mt=JSON.stringify(lr({},this._api.tunnel&&{dsn:Ht(this._api.dsn)}))+"\n"+JSON.stringify({type:"client_report"})+"\n"+JSON.stringify({timestamp:(0,Pn.yW)(),discarded_events:Object.keys(B).map(function($t){var _n=oi($t.split(":"),2);return{reason:_n[1],category:_n[0],quantity:B[$t]}})});try{!function rs(P,B){return"[object Navigator]"===Object.prototype.toString.call(mi&&mi.navigator)&&"function"==typeof mi.navigator.sendBeacon?mi.navigator.sendBeacon.bind(mi.navigator)(P,B):(0,Tt.Ak)()?function No(P){P.then(null,function(B){console.error(B)})}(Oa()(P,{body:B,method:"POST",credentials:"omit",keepalive:!0})):void 0}($,Mt)}catch($t){g.k.error($t)}}},P.prototype._handleResponse=function(B){var $=B.requestType,de=B.response,Ge=B.headers,Ze=B.resolve,Mt=B.reject,$t=function Mo(P){return P>=200&&P<300?"success":429===P?"rate_limit":P>=400&&P<500?"invalid":P>=500?"failed":"unknown"}(de.status);this._handleRateLimit(Ge)&&(0,_e.c)()&&g.k.warn("Too many "+$+" requests, backing off until: "+this._disabledUntil($)),"success"!==$t?Mt(de):Ze({status:$t})},P.prototype._disabledUntil=function(B){var $=Yo(B);return this._rateLimits[$]||this._rateLimits.all},P.prototype._isRateLimited=function(B){return this._disabledUntil(B)>new Date(Date.now())},P.prototype._handleRateLimit=function(B){var $,de,Ge,Ze,Mt=Date.now(),$t=B["x-sentry-rate-limits"],_n=B["retry-after"];if($t){try{for(var on=pi($t.trim().split(",")),or=on.next();!or.done;or=on.next()){var dr=or.value.split(":",2),gi=parseInt(dr[0],10),Yr=1e3*(isNaN(gi)?60:gi);try{for(var tr=(Ge=void 0,pi(dr[1].split(";"))),Po=tr.next();!Po.done;Po=tr.next())this._rateLimits[Po.value||"all"]=new Date(Mt+Yr)}catch(Ya){Ge={error:Ya}}finally{try{Po&&!Po.done&&(Ze=tr.return)&&Ze.call(tr)}finally{if(Ge)throw Ge.error}}}}catch(Ya){$={error:Ya}}finally{try{or&&!or.done&&(de=on.return)&&de.call(on)}finally{if($)throw $.error}}return!0}return!!_n&&(this._rateLimits.all=new Date(Mt+(0,We.JY)(Mt,_n)),!0)},P}(),fa=function(P){function B($,de){void 0===de&&(de=Oa());var Ge=P.call(this,$)||this;return Ge._fetch=de,Ge}return gr(B,P),B.prototype._sendRequest=function($,de){var Ge=this;if(this._isRateLimited($.type))return this.recordLostEvent("ratelimit_backoff",$.type),Promise.reject({event:de,type:$.type,reason:"Transport for "+$.type+" requests locked till "+this._disabledUntil($.type)+" due to too many requests.",status:429});var Ze={body:$.body,method:"POST",referrerPolicy:(0,Tt.hv)()?"origin":""};return void 0!==this.options.fetchParameters&&Object.assign(Ze,this.options.fetchParameters),void 0!==this.options.headers&&(Ze.headers=this.options.headers),this._buffer.add(function(){return new dn.cW(function(Mt,$t){Ge._fetch($.url,Ze).then(function(_n){var on={"x-sentry-rate-limits":_n.headers.get("X-Sentry-Rate-Limits"),"retry-after":_n.headers.get("Retry-After")};Ge._handleResponse({requestType:$.type,response:_n,headers:on,resolve:Mt,reject:$t})}).catch($t)})}).then(void 0,function(Mt){throw Ge.recordLostEvent(Mt instanceof wr?"queue_overflow":"network_error",$.type),Mt})},B}(au),ta=function(P){function B(){return null!==P&&P.apply(this,arguments)||this}return gr(B,P),B.prototype._sendRequest=function($,de){var Ge=this;return this._isRateLimited($.type)?(this.recordLostEvent("ratelimit_backoff",$.type),Promise.reject({event:de,type:$.type,reason:"Transport for "+$.type+" requests locked till "+this._disabledUntil($.type)+" due to too many requests.",status:429})):this._buffer.add(function(){return new dn.cW(function(Ze,Mt){var $t=new XMLHttpRequest;for(var _n in $t.onreadystatechange=function(){if(4===$t.readyState){var on={"x-sentry-rate-limits":$t.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":$t.getResponseHeader("Retry-After")};Ge._handleResponse({requestType:$.type,response:$t,headers:on,resolve:Ze,reject:Mt})}},$t.open("POST",$.url),Ge.options.headers)Object.prototype.hasOwnProperty.call(Ge.options.headers,_n)&&$t.setRequestHeader(_n,Ge.options.headers[_n]);$t.send($.body)})}).then(void 0,function(Ze){throw Ge.recordLostEvent(Ze instanceof wr?"queue_overflow":"network_error",$.type),Ze})},B}(au),pa=function(P){function B(){return null!==P&&P.apply(this,arguments)||this}return gr(B,P),B.prototype.eventFromException=function($,de){return function Gr(P,B,$){var Ge=Vr(B,$&&$.syntheticException||void 0,{attachStacktrace:P.attachStacktrace});return(0,We.EG)(Ge),Ge.level=Ve.Error,$&&$.event_id&&(Ge.event_id=$.event_id),(0,dn.WD)(Ge)}(this._options,$,de)},B.prototype.eventFromMessage=function($,de,Ge){return void 0===de&&(de=Ve.Info),function Fr(P,B,$,de){void 0===$&&($=Ve.Info);var Ze=hs(B,de&&de.syntheticException||void 0,{attachStacktrace:P.attachStacktrace});return Ze.level=$,de&&de.event_id&&(Ze.event_id=de.event_id),(0,dn.WD)(Ze)}(this._options,$,de,Ge)},B.prototype._setupTransport=function(){if(!this._options.dsn)return P.prototype._setupTransport.call(this);var $=lr(lr({},this._options.transportOptions),{dsn:this._options.dsn,tunnel:this._options.tunnel,sendClientReports:this._options.sendClientReports,_metadata:this._options._metadata});return this._options.transport?new this._options.transport($):(0,Tt.Ak)()?new fa($):new ta($)},B}(ze);function Ni(P,B){var $="function"==typeof Symbol&&P[Symbol.iterator];if(!$)return P;var Ge,Mt,de=$.call(P),Ze=[];try{for(;(void 0===B||B-- >0)&&!(Ge=de.next()).done;)Ze.push(Ge.value)}catch($t){Mt={error:$t}}finally{try{Ge&&!Ge.done&&($=de.return)&&$.call(de)}finally{if(Mt)throw Mt.error}}return Ze}function Uo(){for(var P=[],B=0;B<arguments.length;B++)P=P.concat(Ni(arguments[B]));return P}function wo(P){for(var B=[],$=1;$<arguments.length;$++)B[$-1]=arguments[$];var de=(0,ue.Gd)();if(de&&de[P])return de[P].apply(de,Uo(B));throw new Error("No hub defined or "+P+" was not found on the hub, please open a bug report.")}function Ds(P,B){var $;try{throw new Error("Sentry syntheticException")}catch(de){$=de}return wo("captureException",P,{captureContext:B,originalException:P,syntheticException:$})}function Ot(P){wo("withScope",P)}var er=(0,An.R)(),Hr=0;function li(){return Hr>0}function ni(){Hr+=1,setTimeout(function(){Hr-=1})}function Qr(P,B,$){if(void 0===B&&(B={}),"function"!=typeof P)return P;try{var de=P.__sentry_wrapped__;if(de)return de;if((0,Zt.HK)(P))return P}catch($t){return P}var Ge=function(){var $t=Array.prototype.slice.call(arguments);try{$&&"function"==typeof $&&$.apply(this,arguments);var _n=$t.map(function(on){return Qr(on,B)});return P.apply(this,_n)}catch(on){throw ni(),Ot(function(or){or.addEventProcessor(function(Gn){return B.mechanism&&((0,We.Db)(Gn,void 0,void 0),(0,We.EG)(Gn,B.mechanism)),Gn.extra=lr(lr({},Gn.extra),{arguments:$t}),Gn}),Ds(on)}),on}};try{for(var Ze in P)Object.prototype.hasOwnProperty.call(P,Ze)&&(Ge[Ze]=P[Ze])}catch($t){}(0,Zt.$Q)(Ge,P),(0,Zt.xp)(P,"__sentry_wrapped__",Ge);try{Object.getOwnPropertyDescriptor(Ge,"name").configurable&&Object.defineProperty(Ge,"name",{get:function(){return P.name}})}catch($t){}return Ge}var Vi=H(6477);function ms(P){return"warn"===P?Ve.Warning:function Di(P){return-1!==mt.indexOf(P)}(P)?P:Ve.Log}var go=function(){function P(B){this.name=P.id,this._options=lr({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},B)}return P.prototype.addSentryBreadcrumb=function(B){!this._options.sentry||(0,ue.Gd)().addBreadcrumb({category:"sentry."+("transaction"===B.type?"transaction":"event"),event_id:B.event_id,level:B.level,message:(0,We.jH)(B)},{event:B})},P.prototype.setupOnce=function(){this._options.console&&(0,kn.o)("console",ra),this._options.dom&&(0,kn.o)("dom",function Rr(P){return function B($){var de,Ge="object"==typeof P?P.serializeAttribute:void 0;"string"==typeof Ge&&(Ge=[Ge]);try{de=(0,Vi.R)($.event.target?$.event.target:$.event,Ge)}catch(Ze){de="<unknown>"}0!==de.length&&(0,ue.Gd)().addBreadcrumb({category:"ui."+$.name,message:de},{event:$.event,name:$.name,global:$.global})}}(this._options.dom)),this._options.xhr&&(0,kn.o)("xhr",La),this._options.fetch&&(0,kn.o)("fetch",Ns),this._options.history&&(0,kn.o)("history",Fs)},P.id="Breadcrumbs",P}();function ra(P){var B={category:"console",data:{arguments:P.args,logger:"console"},level:ms(P.level),message:(0,rt.nK)(P.args," ")};if("assert"===P.level){if(!1!==P.args[0])return;B.message="Assertion failed: "+((0,rt.nK)(P.args.slice(1)," ")||"console.assert"),B.data.arguments=P.args.slice(1)}(0,ue.Gd)().addBreadcrumb(B,{input:P.args,level:P.level})}function La(P){if(P.endTimestamp){if(P.xhr.__sentry_own_request__)return;var B=P.xhr.__sentry_xhr__||{},$=B.method,de=B.url,Ge=B.status_code,Ze=B.body;(0,ue.Gd)().addBreadcrumb({category:"xhr",data:{method:$,url:de,status_code:Ge},type:"http"},{xhr:P.xhr,input:Ze})}}function Ns(P){!P.endTimestamp||P.fetchData.url.match(/sentry_key/)&&"POST"===P.fetchData.method||(P.error?(0,ue.Gd)().addBreadcrumb({category:"fetch",data:P.fetchData,level:Ve.Error,type:"http"},{data:P.error,input:P.args}):(0,ue.Gd)().addBreadcrumb({category:"fetch",data:lr(lr({},P.fetchData),{status_code:P.response.status}),type:"http"},{input:P.args,response:P.response}))}function Fs(P){var B=(0,An.R)(),$=P.from,de=P.to,Ge=(0,We.en)(B.location.href),Ze=(0,We.en)($),Mt=(0,We.en)(de);Ze.path||(Ze=Ge),Ge.protocol===Mt.protocol&&Ge.host===Mt.host&&(de=Mt.relative),Ge.protocol===Ze.protocol&&Ge.host===Ze.host&&($=Ze.relative),(0,ue.Gd)().addBreadcrumb({category:"navigation",data:{from:$,to:de}})}var Na=function(P){function B($){return void 0===$&&($={}),$._metadata=$._metadata||{},$._metadata.sdk=$._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:"npm:@sentry/browser",version:w}],version:w},P.call(this,pa,$)||this}return gr(B,P),B.prototype.showReportDialog=function($){if(void 0===$&&($={}),(0,An.R)().document){if(!this._isEnabled())return void g.k.error("Trying to call showReportDialog with Sentry Client disabled");!function mo(P){if(void 0===P&&(P={}),er.document){if(!P.eventId)return void((0,_e.c)()&&g.k.error("Missing eventId option in showReportDialog call"));if(!P.dsn)return void((0,_e.c)()&&g.k.error("Missing dsn option in showReportDialog call"));var B=er.document.createElement("script");B.async=!0,B.src=function Ji(P,B){var $=Ft(P),de=Pi($)+"embed/error-page/",Ge="dsn="+Ht($);for(var Ze in B)if("dsn"!==Ze)if("user"===Ze){if(!B.user)continue;B.user.name&&(Ge+="&name="+encodeURIComponent(B.user.name)),B.user.email&&(Ge+="&email="+encodeURIComponent(B.user.email))}else Ge+="&"+encodeURIComponent(Ze)+"="+encodeURIComponent(B[Ze]);return de+"?"+Ge}(P.dsn,P),P.onLoad&&(B.onload=P.onLoad);var $=er.document.head||er.document.body;$&&$.appendChild(B)}}(lr(lr({},$),{dsn:$.dsn||this.getDsn()}))}},B.prototype._prepareEvent=function($,de,Ge){return $.platform=$.platform||"javascript",P.prototype._prepareEvent.call(this,$,de,Ge)},B.prototype._sendEvent=function($){var de=this.getIntegration(go);de&&de.addSentryBreadcrumb($),P.prototype._sendEvent.call(this,$)},B}(Lt),Xo=H(9725),vl=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Nn=function(){function P(B){this.name=P.id,this._options=lr({XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0},B)}return P.prototype.setupOnce=function(){var B=(0,An.R)();this._options.setTimeout&&(0,Zt.hl)(B,"setTimeout",Cr),this._options.setInterval&&(0,Zt.hl)(B,"setInterval",Cr),this._options.requestAnimationFrame&&(0,Zt.hl)(B,"requestAnimationFrame",Fa),this._options.XMLHttpRequest&&"XMLHttpRequest"in B&&(0,Zt.hl)(XMLHttpRequest.prototype,"send",xo);var $=this._options.eventTarget;$&&(Array.isArray($)?$:vl).forEach(Ws)},P.id="TryCatch",P}();function Cr(P){return function(){for(var B=[],$=0;$<arguments.length;$++)B[$]=arguments[$];var de=B[0];return B[0]=Qr(de,{mechanism:{data:{function:(0,Xo.$)(P)},handled:!0,type:"instrument"}}),P.apply(this,B)}}function Fa(P){return function(B){return P.call(this,Qr(B,{mechanism:{data:{function:"requestAnimationFrame",handler:(0,Xo.$)(P)},handled:!0,type:"instrument"}}))}}function xo(P){return function(){for(var B=[],$=0;$<arguments.length;$++)B[$]=arguments[$];var de=this,Ge=["onload","onerror","onprogress","onreadystatechange"];return Ge.forEach(function(Ze){Ze in de&&"function"==typeof de[Ze]&&(0,Zt.hl)(de,Ze,function(Mt){var $t={mechanism:{data:{function:Ze,handler:(0,Xo.$)(Mt)},handled:!0,type:"instrument"}},_n=(0,Zt.HK)(Mt);return _n&&($t.mechanism.data.handler=(0,Xo.$)(_n)),Qr(Mt,$t)})}),P.apply(this,B)}}function Ws(P){var B=(0,An.R)(),$=B[P]&&B[P].prototype;!$||!$.hasOwnProperty||!$.hasOwnProperty("addEventListener")||((0,Zt.hl)($,"addEventListener",function(de){return function(Ge,Ze,Mt){try{"function"==typeof Ze.handleEvent&&(Ze.handleEvent=Qr(Ze.handleEvent.bind(Ze),{mechanism:{data:{function:"handleEvent",handler:(0,Xo.$)(Ze),target:P},handled:!0,type:"instrument"}}))}catch($t){}return de.call(this,Ge,Qr(Ze,{mechanism:{data:{function:"addEventListener",handler:(0,Xo.$)(Ze),target:P},handled:!0,type:"instrument"}}),Mt)}}),(0,Zt.hl)($,"removeEventListener",function(de){return function(Ge,Ze,Mt){var $t=Ze;try{var _n=$t&&$t.__sentry_wrapped__;_n&&de.call(this,Ge,_n,Mt)}catch(on){}return de.call(this,Ge,$t,Mt)}}))}var Wa=function(){function P(B){this.name=P.id,this._installFunc={onerror:as,onunhandledrejection:zu},this._options=lr({onerror:!0,onunhandledrejection:!0},B)}return P.prototype.setupOnce=function(){Error.stackTraceLimit=50;var B=this._options;for(var $ in B){var de=this._installFunc[$];de&&B[$]&&(ya($),de(),this._installFunc[$]=void 0)}},P.id="GlobalHandlers",P}();function as(){(0,kn.o)("error",function(P){var B=oi(yo(),2),$=B[0],de=B[1];if($.getIntegration(Wa)){var Ge=P.msg,Ze=P.url,Mt=P.line,$t=P.column,_n=P.error;if(!(li()||_n&&_n.__sentry_own_request__)){var on=void 0===_n&&(0,vt.HD)(Ge)?function Du(P,B,$,de){var Ze=(0,vt.VW)(P)?P.message:P,Mt="Error",$t=Ze.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);return $t&&(Mt=$t[1],Ze=$t[2]),ju({exception:{values:[{type:Mt,value:Ze}]}},B,$,de)}(Ge,Ze,Mt,$t):ju(Vr(_n||Ge,void 0,{attachStacktrace:de,isRejection:!1}),Ze,Mt,$t);As($,_n,on,"onerror")}}})}function zu(){(0,kn.o)("unhandledrejection",function(P){var B=oi(yo(),2),$=B[0],de=B[1];if($.getIntegration(Wa)){var Ge=P;try{"reason"in P?Ge=P.reason:"detail"in P&&"reason"in P.detail&&(Ge=P.detail.reason)}catch(Mt){}if(li()||Ge&&Ge.__sentry_own_request__)return!0;var Ze=(0,vt.pt)(Ge)?function Vu(P){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(P)}]}}}(Ge):Vr(Ge,void 0,{attachStacktrace:de,isRejection:!0});Ze.level=Ve.Error,As($,Ge,Ze,"onunhandledrejection")}})}function ju(P,B,$,de){var Ge=P.exception=P.exception||{},Ze=Ge.values=Ge.values||[],Mt=Ze[0]=Ze[0]||{},$t=Mt.stacktrace=Mt.stacktrace||{},_n=$t.frames=$t.frames||[],on=isNaN(parseInt(de,10))?void 0:de,or=isNaN(parseInt($,10))?void 0:$,Gn=(0,vt.HD)(B)&&B.length>0?B:(0,Vi.l)();return 0===_n.length&&_n.push({colno:on,filename:Gn,function:"?",in_app:!0,lineno:or}),P}function ya(P){(0,_e.c)()&&g.k.log("Global Handler attached: "+P)}function As(P,B,$,de){(0,We.EG)($,{handled:!1,type:de}),P.captureEvent($,{originalException:B})}function yo(){var P=(0,ue.Gd)(),B=P.getClient();return[P,B&&B.getOptions().attachStacktrace]}var Eo=function(){function P(B){void 0===B&&(B={}),this.name=P.id,this._key=B.key||"cause",this._limit=B.limit||5}return P.prototype.setupOnce=function(){(0,Pe.c)(function(B,$){var de=(0,ue.Gd)().getIntegration(P);return de?function Us(P,B,$,de){if(!($.exception&&$.exception.values&&de&&(0,vt.V9)(de.originalException,Error)))return $;var Ge=Au(B,de.originalException,P);return $.exception.values=Xt(Ge,$.exception.values),$}(de._key,de._limit,B,$):B})},P.id="LinkedErrors",P}();function Au(P,B,$,de){if(void 0===de&&(de=[]),!(0,vt.V9)(B[$],Error)||de.length+1>=P)return de;var Ze=oo(Ir(B[$]));return Au(P,B[$],$,Xt([Ze],de))}var Fo=function(){function P(){this.name=P.id}return P.prototype.setupOnce=function(B,$){B(function(de){var Ge=$().getIntegration(P);if(Ge){try{if(function ia(P,B){return!(!B||!function Hu(P,B){var $=P.message,de=B.message;return!(!$&&!de||$&&!de||!$&&de||$!==de||!va(P,B)||!tl(P,B))}(P,B)&&!function _a(P,B){var $=$u(B),de=$u(P);return!!($&&de&&$.type===de.type&&$.value===de.value&&va(P,B)&&tl(P,B))}(P,B))}(de,Ge._previousEvent))return g.k.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(Ze){return Ge._previousEvent=de}return Ge._previousEvent=de}return de})},P.id="Dedupe",P}();function tl(P,B){var $=Mu(P),de=Mu(B);if(!$&&!de)return!0;if($&&!de||!$&&de||(de=de).length!==($=$).length)return!1;for(var Ge=0;Ge<de.length;Ge++){var Ze=de[Ge],Mt=$[Ge];if(Ze.filename!==Mt.filename||Ze.lineno!==Mt.lineno||Ze.colno!==Mt.colno||Ze.function!==Mt.function)return!1}return!0}function va(P,B){var $=P.fingerprint,de=B.fingerprint;if(!$&&!de)return!0;if($&&!de||!$&&de)return!1;$=$,de=de;try{return $.join("")===de.join("")}catch(Ge){return!1}}function $u(P){return P.exception&&P.exception.values&&P.exception.values[0]}function Mu(P){var B=P.exception;if(B)try{return B.values[0].stacktrace.frames}catch($){return}else if(P.stacktrace)return P.stacktrace.frames}var Ms=(0,An.R)(),ba=function(){function P(){this.name=P.id}return P.prototype.setupOnce=function(){(0,Pe.c)(function(B){if((0,ue.Gd)().getIntegration(P)){if(!Ms.navigator&&!Ms.location&&!Ms.document)return B;var $=B.request&&B.request.url||Ms.location&&Ms.location.href,de=(Ms.document||{}).referrer,Ge=(Ms.navigator||{}).userAgent,Ze=lr(lr(lr({},B.request&&B.request.headers),de&&{Referer:de}),Ge&&{"User-Agent":Ge}),Mt=lr(lr({},$&&{url:$}),{headers:Ze});return lr(lr({},B),{request:Mt})}return B})},P.id="UserAgent",P}(),nl=[new ft,new qt,new Nn,new go,new Wa,new Eo,new Fo,new ba];function ao(P){P.startSession({ignoreDuration:!0}),P.captureSession()}function sa(P){P._metadata=P._metadata||{},P._metadata.sdk={name:"sentry.javascript.angular",packages:[{name:"npm:@sentry/angular",version:w}],version:w},function us(P){if(void 0===P&&(P={}),void 0===P.defaultIntegrations&&(P.defaultIntegrations=nl),void 0===P.release){var B=(0,An.R)();B.SENTRY_RELEASE&&B.SENTRY_RELEASE.id&&(P.release=B.SENTRY_RELEASE.id)}void 0===P.autoSessionTracking&&(P.autoSessionTracking=!0),void 0===P.sendClientReports&&(P.sendClientReports=!0),function nt(P,B){!0===B.debug&&g.k.enable();var $=(0,ue.Gd)(),de=$.getScope();de&&de.update(B.initialScope);var Ge=new P(B);$.bindClient(Ge)}(Na,P),P.autoSessionTracking&&function Ka(){if(void 0!==(0,An.R)().document){var $=(0,ue.Gd)();!$.captureSession||(ao($),(0,kn.o)("history",function(de){var Ge=de.from;void 0===Ge||Ge===de.to||ao((0,ue.Gd)())}))}else(0,_e.c)()&&g.k.warn("Session tracking in non-browser environment with @sentry/browser is not supported.")}()}(P)}},1894:(Sn,Nt,H)=>{"use strict";H.d(Nt,{OH:()=>zt});var g=function(){return g=Object.assign||function(Te){for(var ke,tt=1,Ft=arguments.length;tt<Ft;tt++)for(var vt in ke=arguments[tt])Object.prototype.hasOwnProperty.call(ke,vt)&&(Te[vt]=ke[vt]);return Te},g.apply(this,arguments)};function xe(Ht,Te,ke,tt){var dn,Ft=arguments.length,vt=Ft<3?Te:null===tt?tt=Object.getOwnPropertyDescriptor(Te,ke):tt;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)vt=Reflect.decorate(Ht,Te,ke,tt);else for(var Pn=Ht.length-1;Pn>=0;Pn--)(dn=Ht[Pn])&&(vt=(Ft<3?dn(vt):Ft>3?dn(Te,ke,vt):dn(Te,ke))||vt);return Ft>3&&vt&&Object.defineProperty(Te,ke,vt),vt}var q=H(5e3),U=H(4259),Y=H(5897),ee=H(7576),Pe=H(1446),_e=H(5535);const We=Array.isArray||(Ht=>Ht&&"number"==typeof Ht.length);function _t(Ht){return"function"==typeof Ht}const Zt=(()=>{function Ht(Te){return Error.call(this),this.message=Te?`${Te.length} errors occurred during unsubscription:\n${Te.map((ke,tt)=>`${tt+1}) ${ke.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Te,this}return Ht.prototype=Object.create(Error.prototype),Ht})();class nn{constructor(Te){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,Te&&(this._ctorUnsubscribe=!0,this._unsubscribe=Te)}unsubscribe(){let Te;if(this.closed)return;let{_parentOrParents:ke,_ctorUnsubscribe:tt,_unsubscribe:Ft,_subscriptions:vt}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,ke instanceof nn)ke.remove(this);else if(null!==ke)for(let dn=0;dn<ke.length;++dn)ke[dn].remove(this);if(_t(Ft)){tt&&(this._unsubscribe=void 0);try{Ft.call(this)}catch(dn){Te=dn instanceof Zt?qt(dn.errors):[dn]}}if(We(vt)){let dn=-1,Pn=vt.length;for(;++dn<Pn;){const ce=vt[dn];if(null!==(Ht=ce)&&"object"==typeof Ht)try{ce.unsubscribe()}catch(be){Te=Te||[],be instanceof Zt?Te=Te.concat(qt(be.errors)):Te.push(be)}}}var Ht;if(Te)throw new Zt(Te)}add(Te){let ke=Te;if(!Te)return nn.EMPTY;switch(typeof Te){case"function":ke=new nn(Te);case"object":if(ke===this||ke.closed||"function"!=typeof ke.unsubscribe)return ke;if(this.closed)return ke.unsubscribe(),ke;if(!(ke instanceof nn)){const vt=ke;ke=new nn,ke._subscriptions=[vt]}break;default:throw new Error("unrecognized teardown "+Te+" added to Subscription.")}let{_parentOrParents:tt}=ke;if(null===tt)ke._parentOrParents=this;else if(tt instanceof nn){if(tt===this)return ke;ke._parentOrParents=[tt,this]}else{if(-1!==tt.indexOf(this))return ke;tt.push(this)}const Ft=this._subscriptions;return null===Ft?this._subscriptions=[ke]:Ft.push(ke),ke}remove(Te){const ke=this._subscriptions;if(ke){const tt=ke.indexOf(Te);-1!==tt&&ke.splice(tt,1)}}}var Ht;function qt(Ht){return Ht.reduce((Te,ke)=>Te.concat(ke instanceof Zt?ke.errors:ke),[])}nn.EMPTY=((Ht=new nn).closed=!0,Ht);let An=!1;const kn={Promise:void 0,set useDeprecatedSynchronousErrorHandling(Ht){if(Ht){const Te=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+Te.stack)}else An&&console.log("RxJS: Back to a better error behavior. Thank you. <3");An=Ht},get useDeprecatedSynchronousErrorHandling(){return An}};function jn(Ht){setTimeout(()=>{throw Ht},0)}const gr={closed:!0,next(Ht){},error(Ht){if(kn.useDeprecatedSynchronousErrorHandling)throw Ht;jn(Ht)},complete(){}},lr="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class Sr extends nn{constructor(Te,ke,tt){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=gr;break;case 1:if(!Te){this.destination=gr;break}if("object"==typeof Te){Te instanceof Sr?(this.syncErrorThrowable=Te.syncErrorThrowable,this.destination=Te,Te.add(this)):(this.syncErrorThrowable=!0,this.destination=new di(this,Te));break}default:this.syncErrorThrowable=!0,this.destination=new di(this,Te,ke,tt)}}[lr](){return this}static create(Te,ke,tt){const Ft=new Sr(Te,ke,tt);return Ft.syncErrorThrowable=!1,Ft}next(Te){this.isStopped||this._next(Te)}error(Te){this.isStopped||(this.isStopped=!0,this._error(Te))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(Te){this.destination.next(Te)}_error(Te){this.destination.error(Te),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:Te}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=Te,this}}class di extends Sr{constructor(Te,ke,tt,Ft){super(),this._parentSubscriber=Te;let vt,dn=this;_t(ke)?vt=ke:ke&&(vt=ke.next,tt=ke.error,Ft=ke.complete,ke!==gr&&(dn=Object.create(ke),_t(dn.unsubscribe)&&this.add(dn.unsubscribe.bind(dn)),dn.unsubscribe=this.unsubscribe.bind(this))),this._context=dn,this._next=vt,this._error=tt,this._complete=Ft}next(Te){if(!this.isStopped&&this._next){const{_parentSubscriber:ke}=this;kn.useDeprecatedSynchronousErrorHandling&&ke.syncErrorThrowable?this.__tryOrSetError(ke,this._next,Te)&&this.unsubscribe():this.__tryOrUnsub(this._next,Te)}}error(Te){if(!this.isStopped){const{_parentSubscriber:ke}=this,{useDeprecatedSynchronousErrorHandling:tt}=kn;if(this._error)tt&&ke.syncErrorThrowable?(this.__tryOrSetError(ke,this._error,Te),this.unsubscribe()):(this.__tryOrUnsub(this._error,Te),this.unsubscribe());else if(ke.syncErrorThrowable)tt?(ke.syncErrorValue=Te,ke.syncErrorThrown=!0):jn(Te),this.unsubscribe();else{if(this.unsubscribe(),tt)throw Te;jn(Te)}}}complete(){if(!this.isStopped){const{_parentSubscriber:Te}=this;if(this._complete){const ke=()=>this._complete.call(this._context);kn.useDeprecatedSynchronousErrorHandling&&Te.syncErrorThrowable?(this.__tryOrSetError(Te,ke),this.unsubscribe()):(this.__tryOrUnsub(ke),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(Te,ke){try{Te.call(this._context,ke)}catch(tt){if(this.unsubscribe(),kn.useDeprecatedSynchronousErrorHandling)throw tt;jn(tt)}}__tryOrSetError(Te,ke,tt){if(!kn.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{ke.call(this._context,tt)}catch(Ft){return kn.useDeprecatedSynchronousErrorHandling?(Te.syncErrorValue=Ft,Te.syncErrorThrown=!0,!0):(jn(Ft),!0)}return!1}_unsubscribe(){const{_parentSubscriber:Te}=this;this._context=null,this._parentSubscriber=null,Te.unsubscribe()}}function vr(Ht,Te){return function(tt){return tt.lift(new qi(Ht,Te))}}class qi{constructor(Te,ke){this.predicate=Te,this.thisArg=ke}call(Te,ke){return ke.subscribe(new ii(Te,this.predicate,this.thisArg))}}class ii extends Sr{constructor(Te,ke,tt){super(Te),this.predicate=ke,this.thisArg=tt,this.count=0}_next(Te){let ke;try{ke=this.predicate.call(this.thisArg,Te,this.count++)}catch(tt){return void this.destination.error(tt)}ke&&this.destination.next(Te)}}function fi(){}function bi(Ht,Te,ke){return function(Ft){return Ft.lift(new pi(Ht,Te,ke))}}class pi{constructor(Te,ke,tt){this.nextOrObserver=Te,this.error=ke,this.complete=tt}call(Te,ke){return ke.subscribe(new oi(Te,this.nextOrObserver,this.error,this.complete))}}class oi extends Sr{constructor(Te,ke,tt,Ft){super(Te),this._tapNext=fi,this._tapError=fi,this._tapComplete=fi,this._tapError=tt||fi,this._tapComplete=Ft||fi,_t(ke)?(this._context=this,this._tapNext=ke):ke&&(this._context=ke,this._tapNext=ke.next||fi,this._tapError=ke.error||fi,this._tapComplete=ke.complete||fi)}_next(Te){try{this._tapNext.call(this._context,Te)}catch(ke){return void this.destination.error(ke)}this.destination.next(Te)}_error(Te){try{this._tapError.call(this._context,Te)}catch(ke){return void this.destination.error(ke)}this.destination.error(Te)}_complete(){try{this._tapComplete.call(this._context)}catch(Te){return void this.destination.error(Te)}return this.destination.complete()}}var jt,ve,me,bn="undefined"!=typeof Zone&&!!Zone.current,re=(0,ee.R)(),zt=function ht(Ht,Te,ke){void 0===Te&&(Te=!0),void 0===ke&&(ke=!0),jt=!0,ve=Ht,me=ke,Te&&Ht({name:re.location.pathname,op:"pageload"})};function sn(){var Ht=(0,Y.Gd)();if(Ht){var Te=Ht.getScope();if(Te)return Te.getTransaction()}}!function(){function Ht(Te){var ke=this;this._router=Te,this.navStart$=this._router.events.pipe(vr(function(tt){return tt instanceof U.OD}),bi(function(tt){if(jt){var Ft=tt,vt=(0,_e.rt)(Ft.url),dn=sn();!dn&&me&&(dn=ve({name:vt,op:"navigation"})),dn&&(ke._routingSpan&&ke._routingSpan.finish(),ke._routingSpan=dn.startChild({description:""+Ft.url,op:"ui.angular.routing",tags:g({"routing.instrumentation":"@sentry/angular",url:vt},Ft.navigationTrigger&&{navigationTrigger:Ft.navigationTrigger})}))}else Pe.k.error("Angular integration has tracing enabled, but Tracing integration is not configured")})),this.navEnd$=this._router.events.pipe(vr(function(tt){return tt instanceof U.m2}),bi(function(){ke._routingSpan&&(function Wn(Ht){bn?Zone.root.run(Ht):Ht()}(function(){ke._routingSpan.finish()}),ke._routingSpan=null)})),this._routingSpan=null,this._subscription=new nn,this._subscription.add(this.navStart$.subscribe()),this._subscription.add(this.navEnd$.subscribe())}Ht.prototype.ngOnDestroy=function(){this._subscription.unsubscribe()},Ht=xe([(0,q.GSi)({providedIn:"root"})],Ht)}();var Tr=function(){function Ht(){this.componentName="unknown"}return Ht.prototype.ngOnInit=function(){var Te=sn();Te&&(this._tracingSpan=Te.startChild({description:"<"+this.componentName+">",op:"ui.angular.init"}))},Ht.prototype.ngAfterViewInit=function(){this._tracingSpan&&this._tracingSpan.finish()},xe([(0,q.IIB)("trace")],Ht.prototype,"componentName",void 0),xe([(0,q.Xek)({selector:"[trace]"})],Ht)}();!function(){function Ht(){}Ht=xe([(0,q.LVF)({declarations:[Tr],exports:[Tr]})],Ht)}()},5897:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Xb:()=>$e,Gd:()=>bt,cu:()=>St});var w=H(8907),ue=H(5535),g=H(3967),nt=H(1446),xe=H(7576),Le=H(4864),Re=H(383),Ue=H(81),fe=function(){function Ae(j){this.errors=0,this.sid=(0,ue.DM)(),this.duration=0,this.status="ok",this.init=!0,this.ignoreDuration=!1;var W=(0,g.ph)();this.timestamp=W,this.started=W,j&&this.update(j)}return Ae.prototype.update=function(j){if(void 0===j&&(j={}),j.user&&(!this.ipAddress&&j.user.ip_address&&(this.ipAddress=j.user.ip_address),!this.did&&!j.did&&(this.did=j.user.id||j.user.email||j.user.username)),this.timestamp=j.timestamp||(0,g.ph)(),j.ignoreDuration&&(this.ignoreDuration=j.ignoreDuration),j.sid&&(this.sid=32===j.sid.length?j.sid:(0,ue.DM)()),void 0!==j.init&&(this.init=j.init),!this.did&&j.did&&(this.did=""+j.did),"number"==typeof j.started&&(this.started=j.started),this.ignoreDuration)this.duration=void 0;else if("number"==typeof j.duration)this.duration=j.duration;else{var W=this.timestamp-this.started;this.duration=W>=0?W:0}j.release&&(this.release=j.release),j.environment&&(this.environment=j.environment),!this.ipAddress&&j.ipAddress&&(this.ipAddress=j.ipAddress),!this.userAgent&&j.userAgent&&(this.userAgent=j.userAgent),"number"==typeof j.errors&&(this.errors=j.errors),j.status&&(this.status=j.status)},Ae.prototype.close=function(j){j?this.update({status:j}):"ok"===this.status?this.update({status:"exited"}):this.update()},Ae.prototype.toJSON=function(){return(0,Ue.Jr)({sid:""+this.sid,init:this.init,started:new Date(1e3*this.started).toISOString(),timestamp:new Date(1e3*this.timestamp).toISOString(),status:this.status,errors:this.errors,did:"number"==typeof this.did||"string"==typeof this.did?""+this.did:void 0,duration:this.duration,attrs:{release:this.release,environment:this.environment,ip_address:this.ipAddress,user_agent:this.userAgent}})},Ae}(),$e=function(){function Ae(j,W,ge){void 0===W&&(W=new Re.s),void 0===ge&&(ge=4),this._version=ge,this._stack=[{}],this.getStackTop().scope=W,j&&this.bindClient(j)}return Ae.prototype.isOlderThan=function(j){return this._version<j},Ae.prototype.bindClient=function(j){this.getStackTop().client=j,j&&j.setupIntegrations&&j.setupIntegrations()},Ae.prototype.pushScope=function(){var j=Re.s.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:j}),j},Ae.prototype.popScope=function(){return!(this.getStack().length<=1||!this.getStack().pop())},Ae.prototype.withScope=function(j){var W=this.pushScope();try{j(W)}finally{this.popScope()}},Ae.prototype.getClient=function(){return this.getStackTop().client},Ae.prototype.getScope=function(){return this.getStackTop().scope},Ae.prototype.getStack=function(){return this._stack},Ae.prototype.getStackTop=function(){return this._stack[this._stack.length-1]},Ae.prototype.captureException=function(j,W){var ge=this._lastEventId=(0,ue.DM)(),q=W;if(!W){var U=void 0;try{throw new Error("Sentry syntheticException")}catch(Y){U=Y}q={originalException:j,syntheticException:U}}return this._invokeClient("captureException",j,(0,w.pi)((0,w.pi)({},q),{event_id:ge})),ge},Ae.prototype.captureMessage=function(j,W,ge){var q=this._lastEventId=(0,ue.DM)(),U=ge;if(!ge){var Y=void 0;try{throw new Error(j)}catch(ee){Y=ee}U={originalException:j,syntheticException:Y}}return this._invokeClient("captureMessage",j,W,(0,w.pi)((0,w.pi)({},U),{event_id:q})),q},Ae.prototype.captureEvent=function(j,W){var ge=(0,ue.DM)();return"transaction"!==j.type&&(this._lastEventId=ge),this._invokeClient("captureEvent",j,(0,w.pi)((0,w.pi)({},W),{event_id:ge})),ge},Ae.prototype.lastEventId=function(){return this._lastEventId},Ae.prototype.addBreadcrumb=function(j,W){var ge=this.getStackTop(),q=ge.scope,U=ge.client;if(q&&U){var Y=U.getOptions&&U.getOptions()||{},ee=Y.beforeBreadcrumb,Pe=void 0===ee?null:ee,_e=Y.maxBreadcrumbs,We=void 0===_e?100:_e;if(!(We<=0)){var rt=(0,g.yW)(),_t=(0,w.pi)({timestamp:rt},j),ft=Pe?(0,nt.C)(function(){return Pe(_t,W)}):_t;null!==ft&&q.addBreadcrumb(ft,We)}}},Ae.prototype.setUser=function(j){var W=this.getScope();W&&W.setUser(j)},Ae.prototype.setTags=function(j){var W=this.getScope();W&&W.setTags(j)},Ae.prototype.setExtras=function(j){var W=this.getScope();W&&W.setExtras(j)},Ae.prototype.setTag=function(j,W){var ge=this.getScope();ge&&ge.setTag(j,W)},Ae.prototype.setExtra=function(j,W){var ge=this.getScope();ge&&ge.setExtra(j,W)},Ae.prototype.setContext=function(j,W){var ge=this.getScope();ge&&ge.setContext(j,W)},Ae.prototype.configureScope=function(j){var W=this.getStackTop(),ge=W.scope;ge&&W.client&&j(ge)},Ae.prototype.run=function(j){var W=pt(this);try{j(this)}finally{pt(W)}},Ae.prototype.getIntegration=function(j){var W=this.getClient();if(!W)return null;try{return W.getIntegration(j)}catch(ge){return nt.k.warn("Cannot retrieve integration "+j.id+" from the current Hub"),null}},Ae.prototype.startSpan=function(j){return this._callExtensionMethod("startSpan",j)},Ae.prototype.startTransaction=function(j,W){return this._callExtensionMethod("startTransaction",j,W)},Ae.prototype.traceHeaders=function(){return this._callExtensionMethod("traceHeaders")},Ae.prototype.captureSession=function(j){if(void 0===j&&(j=!1),j)return this.endSession();this._sendSessionUpdate()},Ae.prototype.endSession=function(){var j=this.getStackTop(),W=j&&j.scope,ge=W&&W.getSession();ge&&ge.close(),this._sendSessionUpdate(),W&&W.setSession()},Ae.prototype.startSession=function(j){var W=this.getStackTop(),ge=W.scope,q=W.client,U=q&&q.getOptions()||{},Y=U.release,ee=U.environment,_e=((0,xe.R)().navigator||{}).userAgent,We=new fe((0,w.pi)((0,w.pi)((0,w.pi)({release:Y,environment:ee},ge&&{user:ge.getUser()}),_e&&{userAgent:_e}),j));if(ge){var rt=ge.getSession&&ge.getSession();rt&&"ok"===rt.status&&rt.update({status:"exited"}),this.endSession(),ge.setSession(We)}return We},Ae.prototype._sendSessionUpdate=function(){var j=this.getStackTop(),W=j.scope,ge=j.client;if(W){var q=W.getSession&&W.getSession();q&&ge&&ge.captureSession&&ge.captureSession(q)}},Ae.prototype._invokeClient=function(j){for(var W,ge=[],q=1;q<arguments.length;q++)ge[q-1]=arguments[q];var U=this.getStackTop(),Y=U.scope,ee=U.client;ee&&ee[j]&&(W=ee)[j].apply(W,(0,w.fl)(ge,[Y]))},Ae.prototype._callExtensionMethod=function(j){for(var W=[],ge=1;ge<arguments.length;ge++)W[ge-1]=arguments[ge];var q=St(),U=q.__SENTRY__;if(U&&U.extensions&&"function"==typeof U.extensions[j])return U.extensions[j].apply(this,W);nt.k.warn("Extension method "+j+" couldn't be found, doing nothing.")},Ae}();function St(){var Ae=(0,xe.R)();return Ae.__SENTRY__=Ae.__SENTRY__||{extensions:{},hub:void 0},Ae}function pt(Ae){var j=St(),W=he(j);return je(j,Ae),W}function bt(){var Ae=St();return(!ut(Ae)||he(Ae).isOlderThan(4))&&je(Ae,new $e),(0,Le.KV)()?function ct(Ae){try{var j=St().__SENTRY__,W=j&&j.extensions&&j.extensions.domain&&j.extensions.domain.active;if(!W)return he(Ae);if(!ut(W)||he(W).isOlderThan(4)){var ge=he(Ae).getStackTop();je(W,new $e(ge.client,Re.s.clone(ge.scope)))}return he(W)}catch(q){return he(Ae)}}(Ae):he(Ae)}function ut(Ae){return!!(Ae&&Ae.__SENTRY__&&Ae.__SENTRY__.hub)}function he(Ae){return Ae&&Ae.__SENTRY__&&Ae.__SENTRY__.hub||(Ae.__SENTRY__=Ae.__SENTRY__||{},Ae.__SENTRY__.hub=new $e),Ae.__SENTRY__.hub}function je(Ae,j){return!!Ae&&(Ae.__SENTRY__=Ae.__SENTRY__||{},Ae.__SENTRY__.hub=j,!0)}},383:(Sn,Nt,H)=>{"use strict";H.d(Nt,{s:()=>Re,c:()=>fe});var w=H(8907),ue=H(6412),g=H(3967),nt=H(509),xe=H(7576),Re=function(){function se(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={}}return se.clone=function(ae){var $e=new se;return ae&&($e._breadcrumbs=(0,w.fl)(ae._breadcrumbs),$e._tags=(0,w.pi)({},ae._tags),$e._extra=(0,w.pi)({},ae._extra),$e._contexts=(0,w.pi)({},ae._contexts),$e._user=ae._user,$e._level=ae._level,$e._span=ae._span,$e._session=ae._session,$e._transactionName=ae._transactionName,$e._fingerprint=ae._fingerprint,$e._eventProcessors=(0,w.fl)(ae._eventProcessors),$e._requestSession=ae._requestSession),$e},se.prototype.addScopeListener=function(ae){this._scopeListeners.push(ae)},se.prototype.addEventProcessor=function(ae){return this._eventProcessors.push(ae),this},se.prototype.setUser=function(ae){return this._user=ae||{},this._session&&this._session.update({user:ae}),this._notifyScopeListeners(),this},se.prototype.getUser=function(){return this._user},se.prototype.getRequestSession=function(){return this._requestSession},se.prototype.setRequestSession=function(ae){return this._requestSession=ae,this},se.prototype.setTags=function(ae){return this._tags=(0,w.pi)((0,w.pi)({},this._tags),ae),this._notifyScopeListeners(),this},se.prototype.setTag=function(ae,$e){var St;return this._tags=(0,w.pi)((0,w.pi)({},this._tags),((St={})[ae]=$e,St)),this._notifyScopeListeners(),this},se.prototype.setExtras=function(ae){return this._extra=(0,w.pi)((0,w.pi)({},this._extra),ae),this._notifyScopeListeners(),this},se.prototype.setExtra=function(ae,$e){var St;return this._extra=(0,w.pi)((0,w.pi)({},this._extra),((St={})[ae]=$e,St)),this._notifyScopeListeners(),this},se.prototype.setFingerprint=function(ae){return this._fingerprint=ae,this._notifyScopeListeners(),this},se.prototype.setLevel=function(ae){return this._level=ae,this._notifyScopeListeners(),this},se.prototype.setTransactionName=function(ae){return this._transactionName=ae,this._notifyScopeListeners(),this},se.prototype.setTransaction=function(ae){return this.setTransactionName(ae)},se.prototype.setContext=function(ae,$e){var St;return null===$e?delete this._contexts[ae]:this._contexts=(0,w.pi)((0,w.pi)({},this._contexts),((St={})[ae]=$e,St)),this._notifyScopeListeners(),this},se.prototype.setSpan=function(ae){return this._span=ae,this._notifyScopeListeners(),this},se.prototype.getSpan=function(){return this._span},se.prototype.getTransaction=function(){var ae=this.getSpan();return ae&&ae.transaction},se.prototype.setSession=function(ae){return ae?this._session=ae:delete this._session,this._notifyScopeListeners(),this},se.prototype.getSession=function(){return this._session},se.prototype.update=function(ae){if(!ae)return this;if("function"==typeof ae){var $e=ae(this);return $e instanceof se?$e:this}return ae instanceof se?(this._tags=(0,w.pi)((0,w.pi)({},this._tags),ae._tags),this._extra=(0,w.pi)((0,w.pi)({},this._extra),ae._extra),this._contexts=(0,w.pi)((0,w.pi)({},this._contexts),ae._contexts),ae._user&&Object.keys(ae._user).length&&(this._user=ae._user),ae._level&&(this._level=ae._level),ae._fingerprint&&(this._fingerprint=ae._fingerprint),ae._requestSession&&(this._requestSession=ae._requestSession)):(0,ue.PO)(ae)&&(ae=ae,this._tags=(0,w.pi)((0,w.pi)({},this._tags),ae.tags),this._extra=(0,w.pi)((0,w.pi)({},this._extra),ae.extra),this._contexts=(0,w.pi)((0,w.pi)({},this._contexts),ae.contexts),ae.user&&(this._user=ae.user),ae.level&&(this._level=ae.level),ae.fingerprint&&(this._fingerprint=ae.fingerprint),ae.requestSession&&(this._requestSession=ae.requestSession)),this},se.prototype.clear=function(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this},se.prototype.addBreadcrumb=function(ae,$e){var St="number"==typeof $e?Math.min($e,100):100;if(St<=0)return this;var pt=(0,w.pi)({timestamp:(0,g.yW)()},ae);return this._breadcrumbs=(0,w.fl)(this._breadcrumbs,[pt]).slice(-St),this._notifyScopeListeners(),this},se.prototype.clearBreadcrumbs=function(){return this._breadcrumbs=[],this._notifyScopeListeners(),this},se.prototype.applyToEvent=function(ae,$e){if(this._extra&&Object.keys(this._extra).length&&(ae.extra=(0,w.pi)((0,w.pi)({},this._extra),ae.extra)),this._tags&&Object.keys(this._tags).length&&(ae.tags=(0,w.pi)((0,w.pi)({},this._tags),ae.tags)),this._user&&Object.keys(this._user).length&&(ae.user=(0,w.pi)((0,w.pi)({},this._user),ae.user)),this._contexts&&Object.keys(this._contexts).length&&(ae.contexts=(0,w.pi)((0,w.pi)({},this._contexts),ae.contexts)),this._level&&(ae.level=this._level),this._transactionName&&(ae.transaction=this._transactionName),this._span){ae.contexts=(0,w.pi)({trace:this._span.getTraceContext()},ae.contexts);var St=this._span.transaction&&this._span.transaction.name;St&&(ae.tags=(0,w.pi)({transaction:St},ae.tags))}return this._applyFingerprint(ae),ae.breadcrumbs=(0,w.fl)(ae.breadcrumbs||[],this._breadcrumbs),ae.breadcrumbs=ae.breadcrumbs.length>0?ae.breadcrumbs:void 0,ae.sdkProcessingMetadata=this._sdkProcessingMetadata,this._notifyEventProcessors((0,w.fl)(Ue(),this._eventProcessors),ae,$e)},se.prototype.setSDKProcessingMetadata=function(ae){return this._sdkProcessingMetadata=(0,w.pi)((0,w.pi)({},this._sdkProcessingMetadata),ae),this},se.prototype._notifyEventProcessors=function(ae,$e,St,pt){var bt=this;return void 0===pt&&(pt=0),new nt.cW(function(Ct,ct){var ut=ae[pt];if(null===$e||"function"!=typeof ut)Ct($e);else{var he=ut((0,w.pi)({},$e),St);(0,ue.J8)(he)?he.then(function(je){return bt._notifyEventProcessors(ae,je,St,pt+1).then(Ct)}).then(null,ct):bt._notifyEventProcessors(ae,he,St,pt+1).then(Ct).then(null,ct)}})},se.prototype._notifyScopeListeners=function(){var ae=this;this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(function($e){$e(ae)}),this._notifyingListeners=!1)},se.prototype._applyFingerprint=function(ae){ae.fingerprint=ae.fingerprint?Array.isArray(ae.fingerprint)?ae.fingerprint:[ae.fingerprint]:[],this._fingerprint&&(ae.fingerprint=ae.fingerprint.concat(this._fingerprint)),ae.fingerprint&&!ae.fingerprint.length&&delete ae.fingerprint},se}();function Ue(){var se=(0,xe.R)();return se.__SENTRY__=se.__SENTRY__||{},se.__SENTRY__.globalEventProcessors=se.__SENTRY__.globalEventProcessors||[],se.__SENTRY__.globalEventProcessors}function fe(se){Ue().push(se)}},1633:(Sn,Nt,H)=>{"use strict";H.d(Nt,{d:()=>w,x:()=>ue});var w="finishReason",ue=["heartbeatFailed","idleTimeout","documentHidden"]},752:(Sn,Nt,H)=>{"use strict";H.d(Nt,{ro:()=>ut,lb:()=>bt});var w=H(1132),ue=H(5897),g=H(1446),nt=H(4864),xe=H(3343),Le=H(1255);function Ue(){var he=(0,Le.x1)();if(he){var je="internal_error";g.k.log("[Tracing] Transaction: "+je+" -> Global error occured"),he.setStatus(je)}}var fe=H(9819),se=H(7583);function ae(){var he=this.getScope();if(he){var je=he.getSpan();if(je)return{"sentry-trace":je.toTraceparent()}}return{}}function $e(he,je,Ae){return(0,Le.zu)(je)?void 0!==he.sampled?(he.setMetadata({transactionSampling:{method:"explicitly_set"}}),he):("function"==typeof je.tracesSampler?(j=je.tracesSampler(Ae),he.setMetadata({transactionSampling:{method:"client_sampler",rate:Number(j)}})):void 0!==Ae.parentSampled?(j=Ae.parentSampled,he.setMetadata({transactionSampling:{method:"inheritance"}})):(j=je.tracesSampleRate,he.setMetadata({transactionSampling:{method:"client_rate",rate:Number(j)}})),function St(he){return isNaN(he)||"number"!=typeof he&&"boolean"!=typeof he?(g.k.warn("[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got "+JSON.stringify(he)+" of type "+JSON.stringify(typeof he)+"."),!1):!(he<0||he>1)||(g.k.warn("[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got "+he+"."),!1)}(j)?j?(he.sampled=Math.random()<j,he.sampled?(g.k.log("[Tracing] starting "+he.op+" transaction - "+he.name),he):(g.k.log("[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = "+Number(j)+")"),he)):(g.k.log("[Tracing] Discarding transaction because "+("function"==typeof je.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),he.sampled=!1,he):(g.k.warn("[Tracing] Discarding transaction because of invalid sample rate."),he.sampled=!1,he)):(he.sampled=!1,he);var j}function pt(he,je){var Ae=this.getClient(),j=Ae&&Ae.getOptions()||{},W=new se.Y(he,this);return(W=$e(W,j,(0,w.pi)({parentSampled:he.parentSampled,transactionContext:he},je))).sampled&&W.initSpanRecorder(j._experiments&&j._experiments.maxSpans),W}function bt(he,je,Ae,j,W){var ge=he.getClient(),q=ge&&ge.getOptions()||{},U=new fe.io(je,he,Ae,j);return(U=$e(U,q,(0,w.pi)({parentSampled:je.parentSampled,transactionContext:je},W))).sampled&&U.initSpanRecorder(q._experiments&&q._experiments.maxSpans),U}function ut(){(function Ct(){var he=(0,ue.cu)();!he.__SENTRY__||(he.__SENTRY__.extensions=he.__SENTRY__.extensions||{},he.__SENTRY__.extensions.startTransaction||(he.__SENTRY__.extensions.startTransaction=pt),he.__SENTRY__.extensions.traceHeaders||(he.__SENTRY__.extensions.traceHeaders=ae))})(),(0,nt.KV)()&&function ct(){var he=(0,ue.cu)();if(he.__SENTRY__){var je={mongodb:function(){return new((0,nt.l$)(Sn,"./integrations/node/mongo").Mongo)},mongoose:function(){return new((0,nt.l$)(Sn,"./integrations/node/mongo").Mongo)({mongoose:!0})},mysql:function(){return new((0,nt.l$)(Sn,"./integrations/node/mysql").Mysql)},pg:function(){return new((0,nt.l$)(Sn,"./integrations/node/postgres").Postgres)}},Ae=Object.keys(je).filter(function(j){return!!(0,nt.$y)(j)}).map(function(j){try{return je[j]()}catch(W){return}}).filter(function(j){return j});Ae.length>0&&(he.__SENTRY__.integrations=(0,w.fl)(he.__SENTRY__.integrations||[],Ae))}}(),function Re(){(0,xe.o)("error",Ue),(0,xe.o)("unhandledrejection",Ue)}()}Sn=H.hmd(Sn)},9819:(Sn,Nt,H)=>{"use strict";H.d(Nt,{nT:()=>Re,io:()=>se});var w=H(1132),ue=H(3967),g=H(1446),nt=H(1633),xe=H(6190),Le=H(7583),Re=1e3,fe=function($e){function St(pt,bt,Ct,ct){void 0===Ct&&(Ct="");var ut=$e.call(this,ct)||this;return ut._pushActivity=pt,ut._popActivity=bt,ut.transactionSpanId=Ct,ut}return(0,w.ZT)(St,$e),St.prototype.add=function(pt){var bt=this;pt.spanId!==this.transactionSpanId&&(pt.finish=function(Ct){pt.endTimestamp="number"==typeof Ct?Ct:(0,ue._I)(),bt._popActivity(pt.spanId)},void 0===pt.endTimestamp&&this._pushActivity(pt.spanId)),$e.prototype.add.call(this,pt)},St}(xe.gB),se=function($e){function St(pt,bt,Ct,ct){void 0===Ct&&(Ct=Re),void 0===ct&&(ct=!1);var ut=$e.call(this,pt,bt)||this;return ut._idleHub=bt,ut._idleTimeout=Ct,ut._onScope=ct,ut.activities={},ut._heartbeatCounter=0,ut._finished=!1,ut._beforeFinishCallbacks=[],bt&&ct&&(ae(bt),g.k.log("Setting idle transaction on scope. Span ID: "+ut.spanId),bt.configureScope(function(he){return he.setSpan(ut)})),ut._initTimeout=setTimeout(function(){ut._finished||ut.finish()},ut._idleTimeout),ut}return(0,w.ZT)(St,$e),St.prototype.finish=function(pt){var bt,Ct,ct=this;if(void 0===pt&&(pt=(0,ue._I)()),this._finished=!0,this.activities={},this.spanRecorder){g.k.log("[Tracing] finishing IdleTransaction",new Date(1e3*pt).toISOString(),this.op);try{for(var ut=(0,w.XA)(this._beforeFinishCallbacks),he=ut.next();!he.done;he=ut.next())(0,he.value)(this,pt)}catch(Ae){bt={error:Ae}}finally{try{he&&!he.done&&(Ct=ut.return)&&Ct.call(ut)}finally{if(bt)throw bt.error}}this.spanRecorder.spans=this.spanRecorder.spans.filter(function(Ae){if(Ae.spanId===ct.spanId)return!0;Ae.endTimestamp||(Ae.endTimestamp=pt,Ae.setStatus("cancelled"),g.k.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(Ae,void 0,2)));var j=Ae.startTimestamp<pt;return j||g.k.log("[Tracing] discarding Span since it happened after Transaction was finished",JSON.stringify(Ae,void 0,2)),j}),g.k.log("[Tracing] flushing IdleTransaction")}else g.k.log("[Tracing] No active IdleTransaction");return this._onScope&&ae(this._idleHub),$e.prototype.finish.call(this,pt)},St.prototype.registerBeforeFinishCallback=function(pt){this._beforeFinishCallbacks.push(pt)},St.prototype.initSpanRecorder=function(pt){var bt=this;this.spanRecorder||(this.spanRecorder=new fe(function(ut){bt._finished||bt._pushActivity(ut)},function(ut){bt._finished||bt._popActivity(ut)},this.spanId,pt),g.k.log("Starting heartbeat"),this._pingHeartbeat()),this.spanRecorder.add(this)},St.prototype._pushActivity=function(pt){this._initTimeout&&(clearTimeout(this._initTimeout),this._initTimeout=void 0),g.k.log("[Tracing] pushActivity: "+pt),this.activities[pt]=!0,g.k.log("[Tracing] new activities count",Object.keys(this.activities).length)},St.prototype._popActivity=function(pt){var bt=this;if(this.activities[pt]&&(g.k.log("[Tracing] popActivity "+pt),delete this.activities[pt],g.k.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){var Ct=this._idleTimeout,ct=(0,ue._I)()+Ct/1e3;setTimeout(function(){bt._finished||(bt.setTag(nt.d,nt.x[1]),bt.finish(ct))},Ct)}},St.prototype._beat=function(){if(!this._finished){var pt=Object.keys(this.activities).join("");pt===this._prevHeartbeatString?this._heartbeatCounter+=1:this._heartbeatCounter=1,this._prevHeartbeatString=pt,this._heartbeatCounter>=3?(g.k.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this.setTag(nt.d,nt.x[0]),this.finish()):this._pingHeartbeat()}},St.prototype._pingHeartbeat=function(){var pt=this;g.k.log("pinging Heartbeat -> current counter: "+this._heartbeatCounter),setTimeout(function(){pt._beat()},5e3)},St}(Le.Y);function ae($e){if($e){var St=$e.getScope();St&&St.getTransaction()&&St.setSpan(void 0)}}},5340:(Sn,Nt,H)=>{"use strict";H.d(Nt,{jK:()=>w});var w={};H.r(w),H.d(w,{gE:()=>fi});var ue=H(752),g=H(1132),nt=H(1446),xe=H(7576),Le=H(9819),Re=H(1255),Ue=H(1633),fe=(0,xe.R)(),ae=H(4864),$e=H(3967),St=H(6477),pt=function(Xt,ln,En){var bn;return function(Wn){ln.value>=0&&(Wn||En)&&(ln.delta=ln.value-(bn||0),(ln.delta||void 0===bn)&&(bn=ln.value,Xt(ln)))}},Ct=function(Xt,ln){return{name:Xt,value:null!=ln?ln:-1,delta:0,entries:[],id:"v2-"+Date.now()+"-"+(Math.floor(8999999999999*Math.random())+1e12)}},ct=function(Xt,ln){try{if(PerformanceObserver.supportedEntryTypes.includes(Xt)){if("first-input"===Xt&&!("PerformanceEventTiming"in self))return;var En=new PerformanceObserver(function(bn){return bn.getEntries().map(ln)});return En.observe({type:Xt,buffered:!0}),En}}catch(bn){}},ut=function(Xt,ln){var En=function(bn){("pagehide"===bn.type||"hidden"===(0,xe.R)().document.visibilityState)&&(Xt(bn),ln&&(removeEventListener("visibilitychange",En,!0),removeEventListener("pagehide",En,!0)))};addEventListener("visibilitychange",En,!0),addEventListener("pagehide",En,!0)},je=-1,W=function(){return je<0&&(je="hidden"===(0,xe.R)().document.visibilityState?0:1/0,ut(function(Xt){je=Xt.timeStamp},!0)),{get firstHiddenTime(){return je}}},q={},Y=(0,xe.R)(),ee=function(){function Xt(ln){void 0===ln&&(ln=!1),this._reportAllChanges=ln,this._measurements={},this._performanceCursor=0,!(0,ae.KV)()&&Y&&Y.performance&&Y.document&&(Y.performance.mark&&Y.performance.mark("sentry-tracing-init"),this._trackCLS(),this._trackLCP(),this._trackFID())}return Xt.prototype.addPerformanceEntries=function(ln){var En=this;if(Y&&Y.performance&&Y.performance.getEntries&&$e.Z1){nt.k.log("[Tracing] Adding & adjusting spans using Performance API");var Wn,jt,bn=(0,Re.XL)($e.Z1);if(Y.performance.getEntries().slice(this._performanceCursor).forEach(function(me){var re=(0,Re.XL)(me.startTime),ht=(0,Re.XL)(me.duration);if(!("navigation"===ln.op&&bn+re<ln.startTimestamp))switch(me.entryType){case"navigation":(function Pe(Xt,ln,En){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(function(bn){rt(Xt,ln,bn,En)}),rt(Xt,ln,"secureConnection",En,"TLS/SSL","connectEnd"),rt(Xt,ln,"fetch",En,"cache","domainLookupStart"),rt(Xt,ln,"domainLookup",En,"DNS"),function _t(Xt,ln,En){ft(Xt,{op:"browser",description:"request",startTimestamp:En+(0,Re.XL)(ln.requestStart),endTimestamp:En+(0,Re.XL)(ln.responseEnd)}),ft(Xt,{op:"browser",description:"response",startTimestamp:En+(0,Re.XL)(ln.responseStart),endTimestamp:En+(0,Re.XL)(ln.responseEnd)})}(Xt,ln,En)})(ln,me,bn),Wn=bn+(0,Re.XL)(me.responseStart),jt=bn+(0,Re.XL)(me.requestStart);break;case"mark":case"paint":case"measure":var zt=function _e(Xt,ln,En,bn,Wn){var jt=Wn+En;return ft(Xt,{description:ln.name,endTimestamp:jt+bn,op:ln.entryType,startTimestamp:jt}),jt}(ln,me,re,ht,bn),sn=W(),Mn=me.startTime<sn.firstHiddenTime;"first-paint"===me.name&&Mn&&(nt.k.log("[Measurements] Adding FP"),En._measurements.fp={value:me.startTime},En._measurements["mark.fp"]={value:zt}),"first-contentful-paint"===me.name&&Mn&&(nt.k.log("[Measurements] Adding FCP"),En._measurements.fcp={value:me.startTime},En._measurements["mark.fcp"]={value:zt});break;case"resource":var Jn=me.name.replace(Y.location.origin,"");!function We(Xt,ln,En,bn,Wn,jt){if("xmlhttprequest"!==ln.initiatorType&&"fetch"!==ln.initiatorType){var ve={};"transferSize"in ln&&(ve["Transfer Size"]=ln.transferSize),"encodedBodySize"in ln&&(ve["Encoded Body Size"]=ln.encodedBodySize),"decodedBodySize"in ln&&(ve["Decoded Body Size"]=ln.decodedBodySize);var me=jt+bn;ft(Xt,{description:En,endTimestamp:me+Wn,op:ln.initiatorType?"resource."+ln.initiatorType:"resource",startTimestamp:me,data:ve})}}(ln,me,Jn,re,ht,bn)}}),this._performanceCursor=Math.max(performance.getEntries().length-1,0),this._trackNavigator(ln),"pageload"===ln.op){var ve=(0,Re.XL)($e.Z1);"number"==typeof Wn&&(nt.k.log("[Measurements] Adding TTFB"),this._measurements.ttfb={value:1e3*(Wn-ln.startTimestamp)},"number"==typeof jt&&jt<=Wn&&(this._measurements["ttfb.requestTime"]={value:1e3*(Wn-jt)})),["fcp","fp","lcp"].forEach(function(me){if(En._measurements[me]&&!(ve>=ln.startTimestamp)){var re=En._measurements[me].value,ht=ve+(0,Re.XL)(re),zt=Math.abs(1e3*(ht-ln.startTimestamp));nt.k.log("[Measurements] Normalized "+me+" from "+re+" to "+zt+" ("+(zt-re)+")"),En._measurements[me].value=zt}}),this._measurements["mark.fid"]&&this._measurements.fid&&ft(ln,{description:"first input delay",endTimestamp:this._measurements["mark.fid"].value+(0,Re.XL)(this._measurements.fid.value),op:"web.vitals",startTimestamp:this._measurements["mark.fid"].value}),"fcp"in this._measurements||delete this._measurements.cls,ln.setMeasurements(this._measurements),function nn(Xt,ln,En){ln&&(nt.k.log("[Measurements] Adding LCP Data"),ln.element&&Xt.setTag("lcp.element",(0,St.R)(ln.element)),ln.id&&Xt.setTag("lcp.id",ln.id),ln.url&&Xt.setTag("lcp.url",ln.url.trim().slice(0,200)),Xt.setTag("lcp.size",ln.size)),En&&En.sources&&(nt.k.log("[Measurements] Adding CLS Data"),En.sources.forEach(function(bn,Wn){return Xt.setTag("cls.source."+(Wn+1),(0,St.R)(bn.node))}))}(ln,this._lcpEntry,this._clsEntry),ln.setTag("sentry_reportAllChanges",this._reportAllChanges)}}},Xt.prototype._trackNavigator=function(ln){var En=Y.navigator;if(En){var bn=En.connection;bn&&(bn.effectiveType&&ln.setTag("effectiveConnectionType",bn.effectiveType),bn.type&&ln.setTag("connectionType",bn.type),Zt(bn.rtt)&&(this._measurements["connection.rtt"]={value:bn.rtt}),Zt(bn.downlink)&&(this._measurements["connection.downlink"]={value:bn.downlink})),Zt(En.deviceMemory)&&ln.setTag("deviceMemory",String(En.deviceMemory)),Zt(En.hardwareConcurrency)&&ln.setTag("hardwareConcurrency",String(En.hardwareConcurrency))}},Xt.prototype._trackCLS=function(){var ln=this;!function(Xt,ln){var bn,En=Ct("CLS",0),Wn=0,jt=[],ve=function(re){re&&!re.hadRecentInput&&(Wn&&0!==jt.length&&re.startTime-jt[jt.length-1].startTime<1e3&&re.startTime-jt[0].startTime<5e3?(Wn+=re.value,jt.push(re)):(Wn=re.value,jt=[re]),Wn>En.value&&(En.value=Wn,En.entries=jt,bn&&bn()))},me=ct("layout-shift",ve);me&&(bn=pt(Xt,En,void 0),ut(function(){me.takeRecords().map(ve),bn(!0)}))}(function(En){var bn=En.entries.pop();!bn||(nt.k.log("[Measurements] Adding CLS"),ln._measurements.cls={value:En.value},ln._clsEntry=bn)})},Xt.prototype._trackLCP=function(){var ln=this;!function(Xt,ln){var Wn,En=W(),bn=Ct("LCP"),jt=function(re){var ht=re.startTime;ht<En.firstHiddenTime&&(bn.value=ht,bn.entries.push(re)),Wn&&Wn()},ve=ct("largest-contentful-paint",jt);if(ve){Wn=pt(Xt,bn,ln);var me=function(){q[bn.id]||(ve.takeRecords().map(jt),ve.disconnect(),q[bn.id]=!0,Wn(!0))};["keydown","click"].forEach(function(re){addEventListener(re,me,{once:!0,capture:!0})}),ut(me,!0)}}(function(En){var bn=En.entries.pop();if(bn){var Wn=(0,Re.XL)($e.Z1),jt=(0,Re.XL)(bn.startTime);nt.k.log("[Measurements] Adding LCP"),ln._measurements.lcp={value:En.value},ln._measurements["mark.lcp"]={value:Wn+jt},ln._lcpEntry=bn}},this._reportAllChanges)},Xt.prototype._trackFID=function(){var ln=this;!function(Xt,ln){var Wn,En=W(),bn=Ct("FID"),jt=function(me){Wn&&me.startTime<En.firstHiddenTime&&(bn.value=me.processingStart-me.startTime,bn.entries.push(me),Wn(!0))},ve=ct("first-input",jt);ve&&(Wn=pt(Xt,bn,void 0),ut(function(){ve.takeRecords().map(jt),ve.disconnect()},!0))}(function(En){var bn=En.entries.pop();if(bn){var Wn=(0,Re.XL)($e.Z1),jt=(0,Re.XL)(bn.startTime);nt.k.log("[Measurements] Adding FID"),ln._measurements.fid={value:En.value},ln._measurements["mark.fid"]={value:Wn+jt}}})},Xt}();function rt(Xt,ln,En,bn,Wn,jt){var ve=jt?ln[jt]:ln[En+"End"],me=ln[En+"Start"];!me||!ve||ft(Xt,{op:"browser",description:null!=Wn?Wn:En,startTimestamp:bn+(0,Re.XL)(me),endTimestamp:bn+(0,Re.XL)(ve)})}function ft(Xt,ln){var En=ln.startTimestamp,bn=(0,g._T)(ln,["startTimestamp"]);return En&&Xt.startTimestamp>En&&(Xt.startTimestamp=En),Xt.startChild((0,g.pi)({startTimestamp:En},bn))}function Zt(Xt){return"number"==typeof Xt&&isFinite(Xt)}var qt=H(1090),An=H(3343),kn=H(6412),gr={traceFetch:!0,traceXHR:!0,tracingOrigins:["localhost",/^\//]};var di=(0,xe.R)(),ii=(0,g.pi)({idleTimeout:Le.nT,markBackgroundTransactions:!0,maxTransactionDuration:600,routingInstrumentation:function vr(Xt,ln,En){if(void 0===ln&&(ln=!0),void 0===En&&(En=!0),di&&di.location){var Wn,bn=di.location.href;ln&&(Wn=Xt({name:di.location.pathname,op:"pageload"})),En&&(0,An.o)("history",function(jt){var ve=jt.to,me=jt.from;void 0===me&&bn&&-1!==bn.indexOf(ve)?bn=void 0:me!==ve&&(bn=void 0,Wn&&(nt.k.log("[Tracing] Finishing current transaction with op: "+Wn.op),Wn.finish()),Wn=Xt({name:di.location.pathname,op:"navigation"}))})}else nt.k.warn("Could not initialize routing instrumentation due to invalid location")},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0},gr),fi=function(){function Xt(ln){this.name=Xt.id,this._emitOptionsWarning=!1,this._configuredIdleTimeout=void 0;var En=gr.tracingOrigins;ln&&(this._configuredIdleTimeout=ln.idleTimeout,ln.tracingOrigins&&Array.isArray(ln.tracingOrigins)&&0!==ln.tracingOrigins.length?En=ln.tracingOrigins:this._emitOptionsWarning=!0),this.options=(0,g.pi)((0,g.pi)((0,g.pi)({},ii),ln),{tracingOrigins:En});var bn=this.options._metricOptions;this._metrics=new ee(bn&&bn._reportAllChanges)}return Xt.prototype.setupOnce=function(ln,En){var bn=this;this._getCurrentHub=En,this._emitOptionsWarning&&(nt.k.warn("[Tracing] You need to define `tracingOrigins` in the options. Set an array of urls or patterns to trace."),nt.k.warn("[Tracing] We added a reasonable default for you: "+gr.tracingOrigins));var Wn=this.options,re=Wn.markBackgroundTransactions,ht=Wn.traceFetch,zt=Wn.traceXHR,sn=Wn.tracingOrigins,Mn=Wn.shouldCreateSpanForRequest;(0,Wn.routingInstrumentation)(function(Jn){return bn._createRouteTransaction(Jn)},Wn.startTransactionOnPageLoad,Wn.startTransactionOnLocationChange),re&&function se(){fe&&fe.document?fe.document.addEventListener("visibilitychange",function(){var Xt=(0,Re.x1)();if(fe.document.hidden&&Xt){var ln="cancelled";nt.k.log("[Tracing] Transaction: "+ln+" -> since tab moved to the background, op: "+Xt.op),Xt.status||Xt.setStatus(ln),Xt.setTag("visibilitychange","document.hidden"),Xt.setTag(Ue.d,Ue.x[2]),Xt.finish()}}):nt.k.warn("[Tracing] Could not set up background tab detection due to lack of global document")}(),function lr(Xt){var ln=(0,g.pi)((0,g.pi)({},gr),Xt),bn=ln.traceXHR,Wn=ln.tracingOrigins,jt=ln.shouldCreateSpanForRequest,ve={},me=function(zt){return ve[zt]||(ve[zt]=Wn.some(function(Mn){return(0,qt.zC)(zt,Mn)})&&!(0,qt.zC)(zt,"sentry_key")),ve[zt]},re=me;"function"==typeof jt&&(re=function(zt){return me(zt)&&jt(zt)});var ht={};ln.traceFetch&&(0,An.o)("fetch",function(zt){!function Er(Xt,ln,En){if((0,Re.zu)()&&Xt.fetchData&&ln(Xt.fetchData.url)){if(Xt.endTimestamp){var bn=Xt.fetchData.__span;if(!bn)return;return void((Wn=En[bn])&&(Xt.response?Wn.setHttpStatus(Xt.response.status):Xt.error&&Wn.setStatus("internal_error"),Wn.finish(),delete En[bn]))}var jt=(0,Re.x1)();if(jt){var Wn=jt.startChild({data:(0,g.pi)((0,g.pi)({},Xt.fetchData),{type:"fetch"}),description:Xt.fetchData.method+" "+Xt.fetchData.url,op:"http.client"});Xt.fetchData.__span=Wn.spanId,En[Wn.spanId]=Wn;var ve=Xt.args[0]=Xt.args[0],me=Xt.args[1]=Xt.args[1]||{},re=me.headers;(0,kn.V9)(ve,Request)&&(re=ve.headers),re?"function"==typeof re.append?re.append("sentry-trace",Wn.toTraceparent()):re=Array.isArray(re)?(0,g.fl)(re,[["sentry-trace",Wn.toTraceparent()]]):(0,g.pi)((0,g.pi)({},re),{"sentry-trace":Wn.toTraceparent()}):re={"sentry-trace":Wn.toTraceparent()},me.headers=re}}}(zt,re,ht)}),bn&&(0,An.o)("xhr",function(zt){!function Sr(Xt,ln,En){if(!(!(0,Re.zu)()||Xt.xhr&&Xt.xhr.__sentry_own_request__)&&Xt.xhr&&Xt.xhr.__sentry_xhr__&&ln(Xt.xhr.__sentry_xhr__.url)){var bn=Xt.xhr.__sentry_xhr__;if(Xt.endTimestamp){var Wn=Xt.xhr.__sentry_xhr_span_id__;if(!Wn)return;return void((jt=En[Wn])&&(jt.setHttpStatus(bn.status_code),jt.finish(),delete En[Wn]))}var ve=(0,Re.x1)();if(ve){var jt=ve.startChild({data:(0,g.pi)((0,g.pi)({},bn.data),{type:"xhr",method:bn.method,url:bn.url}),description:bn.method+" "+bn.url,op:"http.client"});if(Xt.xhr.__sentry_xhr_span_id__=jt.spanId,En[Xt.xhr.__sentry_xhr_span_id__]=jt,Xt.xhr.setRequestHeader)try{Xt.xhr.setRequestHeader("sentry-trace",jt.toTraceparent())}catch(re){}}}}(zt,re,ht)})}({traceFetch:ht,traceXHR:zt,tracingOrigins:sn,shouldCreateSpanForRequest:Mn})},Xt.prototype._createRouteTransaction=function(ln){var En=this;if(this._getCurrentHub){var bn=this.options,Wn=bn.beforeNavigate,jt=bn.idleTimeout,ve=bn.maxTransactionDuration,me="pageload"===ln.op?function bi(){var Xt=function pi(Xt){var ln=(0,xe.R)().document.querySelector("meta[name="+Xt+"]");return ln?ln.getAttribute("content"):null}("sentry-trace");if(Xt)return(0,Re.qG)(Xt)}():void 0,re=(0,g.pi)((0,g.pi)((0,g.pi)({},ln),me),{trimEnd:!0}),ht="function"==typeof Wn?Wn(re):re,zt=void 0===ht?(0,g.pi)((0,g.pi)({},re),{sampled:!1}):ht;!1===zt.sampled&&nt.k.log("[Tracing] Will not send "+zt.op+" transaction because of beforeNavigate."),nt.k.log("[Tracing] Starting "+zt.op+" transaction on scope");var sn=this._getCurrentHub(),Mn=(0,xe.R)().location,Jn=(0,ue.lb)(sn,zt,jt,!0,{location:Mn});return Jn.registerBeforeFinishCallback(function(Tr,wr){En._metrics.addPerformanceEntries(Tr),function oi(Xt,ln,En){var bn=En-ln.startTimestamp;En&&(bn>Xt||bn<0)&&(ln.setStatus("deadline_exceeded"),ln.setTag("maxTransactionDurationExceeded","true"))}((0,Re.WB)(ve),Tr,wr)}),Jn.setTag("idleTimeout",this._configuredIdleTimeout),Jn}nt.k.warn("[Tracing] Did not create "+ln.op+" transaction because _getCurrentHub is invalid.")},Xt.id="BrowserTracing",Xt}();(0,ue.ro)()},6190:(Sn,Nt,H)=>{"use strict";H.d(Nt,{gB:()=>xe,Dr:()=>Le});var w=H(1132),ue=H(5535),g=H(3967),nt=H(81),xe=function(){function Ue(fe){void 0===fe&&(fe=1e3),this.spans=[],this._maxlen=fe}return Ue.prototype.add=function(fe){this.spans.length>this._maxlen?fe.spanRecorder=void 0:this.spans.push(fe)},Ue}(),Le=function(){function Ue(fe){if(this.traceId=(0,ue.DM)(),this.spanId=(0,ue.DM)().substring(16),this.startTimestamp=(0,g._I)(),this.tags={},this.data={},!fe)return this;fe.traceId&&(this.traceId=fe.traceId),fe.spanId&&(this.spanId=fe.spanId),fe.parentSpanId&&(this.parentSpanId=fe.parentSpanId),"sampled"in fe&&(this.sampled=fe.sampled),fe.op&&(this.op=fe.op),fe.description&&(this.description=fe.description),fe.data&&(this.data=fe.data),fe.tags&&(this.tags=fe.tags),fe.status&&(this.status=fe.status),fe.startTimestamp&&(this.startTimestamp=fe.startTimestamp),fe.endTimestamp&&(this.endTimestamp=fe.endTimestamp)}return Ue.prototype.child=function(fe){return this.startChild(fe)},Ue.prototype.startChild=function(fe){var se=new Ue((0,w.pi)((0,w.pi)({},fe),{parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId}));return se.spanRecorder=this.spanRecorder,se.spanRecorder&&se.spanRecorder.add(se),se.transaction=this.transaction,se},Ue.prototype.setTag=function(fe,se){var ae;return this.tags=(0,w.pi)((0,w.pi)({},this.tags),((ae={})[fe]=se,ae)),this},Ue.prototype.setData=function(fe,se){var ae;return this.data=(0,w.pi)((0,w.pi)({},this.data),((ae={})[fe]=se,ae)),this},Ue.prototype.setStatus=function(fe){return this.status=fe,this},Ue.prototype.setHttpStatus=function(fe){this.setTag("http.status_code",String(fe));var se=function Re(Ue){if(Ue<400&&Ue>=100)return"ok";if(Ue>=400&&Ue<500)switch(Ue){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(Ue>=500&&Ue<600)switch(Ue){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(fe);return"unknown_error"!==se&&this.setStatus(se),this},Ue.prototype.isSuccess=function(){return"ok"===this.status},Ue.prototype.finish=function(fe){this.endTimestamp="number"==typeof fe?fe:(0,g._I)()},Ue.prototype.toTraceparent=function(){var fe="";return void 0!==this.sampled&&(fe=this.sampled?"-1":"-0"),this.traceId+"-"+this.spanId+fe},Ue.prototype.toContext=function(){return(0,nt.Jr)({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})},Ue.prototype.updateWithContext=function(fe){var se,ae,$e,St,pt;return this.data=null!=(se=fe.data)?se:{},this.description=fe.description,this.endTimestamp=fe.endTimestamp,this.op=fe.op,this.parentSpanId=fe.parentSpanId,this.sampled=fe.sampled,this.spanId=null!=(ae=fe.spanId)?ae:this.spanId,this.startTimestamp=null!=($e=fe.startTimestamp)?$e:this.startTimestamp,this.status=fe.status,this.tags=null!=(St=fe.tags)?St:{},this.traceId=null!=(pt=fe.traceId)?pt:this.traceId,this},Ue.prototype.getTraceContext=function(){return(0,nt.Jr)({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})},Ue.prototype.toJSON=function(){return(0,nt.Jr)({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})},Ue}()},7583:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Y:()=>Re});var w=H(1132),ue=H(5897),g=H(6412),nt=H(1446),xe=H(81),Le=H(6190),Re=function(Ue){function fe(se,ae){var $e=Ue.call(this,se)||this;return $e._measurements={},$e._hub=(0,ue.Gd)(),(0,g.V9)(ae,ue.Xb)&&($e._hub=ae),$e.name=se.name||"",$e.metadata=se.metadata||{},$e._trimEnd=se.trimEnd,$e.transaction=$e,$e}return(0,w.ZT)(fe,Ue),fe.prototype.setName=function(se){this.name=se},fe.prototype.initSpanRecorder=function(se){void 0===se&&(se=1e3),this.spanRecorder||(this.spanRecorder=new Le.gB(se)),this.spanRecorder.add(this)},fe.prototype.setMeasurements=function(se){this._measurements=(0,w.pi)({},se)},fe.prototype.setMetadata=function(se){this.metadata=(0,w.pi)((0,w.pi)({},this.metadata),se)},fe.prototype.finish=function(se){var ae=this;if(void 0===this.endTimestamp){if(this.name||(nt.k.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),Ue.prototype.finish.call(this,se),!0!==this.sampled){nt.k.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled.");var $e=this._hub.getClient(),St=$e&&$e.getTransport&&$e.getTransport();return void(St&&St.recordLostEvent&&St.recordLostEvent("sample_rate","transaction"))}var pt=this.spanRecorder?this.spanRecorder.spans.filter(function(ct){return ct!==ae&&ct.endTimestamp}):[];this._trimEnd&&pt.length>0&&(this.endTimestamp=pt.reduce(function(ct,ut){return ct.endTimestamp&&ut.endTimestamp?ct.endTimestamp>ut.endTimestamp?ct:ut:ct}).endTimestamp);var bt={contexts:{trace:this.getTraceContext()},spans:pt,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:this.metadata};return Object.keys(this._measurements).length>0&&(nt.k.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),bt.measurements=this._measurements),nt.k.log("[Tracing] Finishing "+this.op+" transaction: "+this.name+"."),this._hub.captureEvent(bt)}},fe.prototype.toContext=function(){var se=Ue.prototype.toContext.call(this);return(0,xe.Jr)((0,w.pi)((0,w.pi)({},se),{name:this.name,trimEnd:this._trimEnd}))},fe.prototype.updateWithContext=function(se){var ae;return Ue.prototype.updateWithContext.call(this,se),this.name=null!=(ae=se.name)?ae:"",this._trimEnd=se.trimEnd,this},fe}(Le.Dr)},1255:(Sn,Nt,H)=>{"use strict";H.d(Nt,{zu:()=>g,qG:()=>nt,x1:()=>xe,XL:()=>Le,WB:()=>Re});var w=H(5897),ue=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function g(Ue){var fe=(0,w.Gd)().getClient(),se=Ue||fe&&fe.getOptions();return!!se&&("tracesSampleRate"in se||"tracesSampler"in se)}function nt(Ue){var fe=Ue.match(ue);if(fe){var se=void 0;return"1"===fe[3]?se=!0:"0"===fe[3]&&(se=!1),{traceId:fe[1],parentSampled:se,parentSpanId:fe[2]}}}function xe(Ue){var se=(Ue||(0,w.Gd)()).getScope();return se&&se.getTransaction()}function Le(Ue){return Ue/1e3}function Re(Ue){return 1e3*Ue}},6477:(Sn,Nt,H)=>{"use strict";H.d(Nt,{R:()=>g,l:()=>xe});var w=H(7576),ue=H(6412);function g(Le,Re){try{for(var Ue=Le,ae=[],$e=0,St=0,bt=" > ".length,Ct=void 0;Ue&&$e++<5&&!("html"===(Ct=nt(Ue,Re))||$e>1&&St+ae.length*bt+Ct.length>=80);)ae.push(Ct),St+=Ct.length,Ue=Ue.parentNode;return ae.reverse().join(" > ")}catch(ct){return"<unknown>"}}function nt(Le,Re){var se,ae,$e,St,pt,Ue=Le,fe=[];if(!Ue||!Ue.tagName)return"";fe.push(Ue.tagName.toLowerCase());var bt=Re&&Re.length?Re.filter(function(ct){return Ue.getAttribute(ct)}).map(function(ct){return[ct,Ue.getAttribute(ct)]}):null;if(bt&&bt.length)bt.forEach(function(ct){fe.push("["+ct[0]+'="'+ct[1]+'"]')});else if(Ue.id&&fe.push("#"+Ue.id),(se=Ue.className)&&(0,ue.HD)(se))for(ae=se.split(/\s+/),pt=0;pt<ae.length;pt++)fe.push("."+ae[pt]);var Ct=["type","name","title","alt"];for(pt=0;pt<Ct.length;pt++)(St=Ue.getAttribute($e=Ct[pt]))&&fe.push("["+$e+'="'+St+'"]');return fe.join("")}function xe(){var Le=(0,w.R)();try{return Le.document.location.href}catch(Re){return""}}},3327:(Sn,Nt,H)=>{"use strict";function w(){return"undefined"!=typeof __SENTRY_NO_DEBUG__&&!__SENTRY_BROWSER_BUNDLE__}function ue(){return"undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&!!__SENTRY_BROWSER_BUNDLE__}H.d(Nt,{c:()=>w,n:()=>ue})},7576:(Sn,Nt,H)=>{"use strict";H.d(Nt,{R:()=>g});var w=H(4864),ue={};function g(){return(0,w.KV)()?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:ue}},3343:(Sn,Nt,H)=>{"use strict";H.d(Nt,{o:()=>St});var je,W,ge,w=H(832),ue=H(3327),g=H(7576),nt=H(6412),xe=H(1446),Le=H(81),Re=H(9725),Ue=H(8204),fe=(0,g.R)(),se={},ae={};function St(_t,ft){se[_t]=se[_t]||[],se[_t].push(ft),function $e(_t){if(!ae[_t])switch(ae[_t]=!0,_t){case"console":!function bt(){"console"in fe&&["debug","info","warn","error","log","assert"].forEach(function(_t){_t in fe.console&&(0,Le.hl)(fe.console,_t,function(ft){return function(){for(var Zt=[],nn=0;nn<arguments.length;nn++)Zt[nn]=arguments[nn];pt("console",{args:Zt,level:_t}),ft&&Function.prototype.apply.call(ft,fe.console,Zt)}})})}();break;case"dom":!function ee(){if("document"in fe){var _t=pt.bind(null,"dom"),ft=Y(_t,!0);fe.document.addEventListener("click",ft,!1),fe.document.addEventListener("keypress",ft,!1),["EventTarget","Node"].forEach(function(Zt){var nn=fe[Zt]&&fe[Zt].prototype;!nn||!nn.hasOwnProperty||!nn.hasOwnProperty("addEventListener")||((0,Le.hl)(nn,"addEventListener",function(qt){return function(An,kn,jn){if("click"===An||"keypress"==An)try{var lr=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},Er=lr[An]=lr[An]||{refCount:0};if(!Er.handler){var Sr=Y(_t);Er.handler=Sr,qt.call(this,An,Sr,jn)}Er.refCount+=1}catch(di){}return qt.call(this,An,kn,jn)}}),(0,Le.hl)(nn,"removeEventListener",function(qt){return function(An,kn,jn){if("click"===An||"keypress"==An)try{var lr=this.__sentry_instrumentation_handlers__||{},Er=lr[An];Er&&(Er.refCount-=1,Er.refCount<=0&&(qt.call(this,An,Er.handler,jn),Er.handler=void 0,delete lr[An]),0===Object.keys(lr).length&&delete this.__sentry_instrumentation_handlers__)}catch(Sr){}return qt.call(this,An,kn,jn)}}))})}}();break;case"xhr":!function he(){if("XMLHttpRequest"in fe){var _t=XMLHttpRequest.prototype;(0,Le.hl)(_t,"open",function(ft){return function(){for(var Zt=[],nn=0;nn<arguments.length;nn++)Zt[nn]=arguments[nn];var qt=this,An=Zt[1],kn=qt.__sentry_xhr__={method:(0,nt.HD)(Zt[0])?Zt[0].toUpperCase():Zt[0],url:Zt[1]};(0,nt.HD)(An)&&"POST"===kn.method&&An.match(/sentry_key/)&&(qt.__sentry_own_request__=!0);var jn=function(){if(4===qt.readyState){try{kn.status_code=qt.status}catch(gr){}pt("xhr",{args:Zt,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:qt})}};return"onreadystatechange"in qt&&"function"==typeof qt.onreadystatechange?(0,Le.hl)(qt,"onreadystatechange",function(gr){return function(){for(var lr=[],Er=0;Er<arguments.length;Er++)lr[Er]=arguments[Er];return jn(),gr.apply(qt,lr)}}):qt.addEventListener("readystatechange",jn),ft.apply(qt,Zt)}}),(0,Le.hl)(_t,"send",function(ft){return function(){for(var Zt=[],nn=0;nn<arguments.length;nn++)Zt[nn]=arguments[nn];return this.__sentry_xhr__&&void 0!==Zt[0]&&(this.__sentry_xhr__.body=Zt[0]),pt("xhr",{args:Zt,startTimestamp:Date.now(),xhr:this}),ft.apply(this,Zt)}})}}();break;case"fetch":!function Ct(){!(0,Ue.t$)()||(0,Le.hl)(fe,"fetch",function(_t){return function(){for(var ft=[],Zt=0;Zt<arguments.length;Zt++)ft[Zt]=arguments[Zt];var nn={args:ft,fetchData:{method:ct(ft),url:ut(ft)},startTimestamp:Date.now()};return pt("fetch",(0,w.pi)({},nn)),_t.apply(fe,ft).then(function(qt){return pt("fetch",(0,w.pi)((0,w.pi)({},nn),{endTimestamp:Date.now(),response:qt})),qt},function(qt){throw pt("fetch",(0,w.pi)((0,w.pi)({},nn),{endTimestamp:Date.now(),error:qt})),qt})}})}();break;case"history":!function Ae(){if((0,Ue.Bf)()){var _t=fe.onpopstate;fe.onpopstate=function(){for(var Zt=[],nn=0;nn<arguments.length;nn++)Zt[nn]=arguments[nn];var qt=fe.location.href,An=je;if(je=qt,pt("history",{from:An,to:qt}),_t)try{return _t.apply(this,Zt)}catch(kn){}},(0,Le.hl)(fe.history,"pushState",ft),(0,Le.hl)(fe.history,"replaceState",ft)}function ft(Zt){return function(){for(var nn=[],qt=0;qt<arguments.length;qt++)nn[qt]=arguments[qt];var An=nn.length>2?nn[2]:void 0;if(An){var kn=je,jn=String(An);je=jn,pt("history",{from:kn,to:jn})}return Zt.apply(this,nn)}}}();break;case"error":!function _e(){Pe=fe.onerror,fe.onerror=function(_t,ft,Zt,nn,qt){return pt("error",{column:nn,error:qt,line:Zt,msg:_t,url:ft}),!!Pe&&Pe.apply(this,arguments)}}();break;case"unhandledrejection":!function rt(){We=fe.onunhandledrejection,fe.onunhandledrejection=function(_t){return pt("unhandledrejection",_t),!We||We.apply(this,arguments)}}();break;default:xe.k.warn("unknown instrumentation type:",_t)}}(_t)}function pt(_t,ft){var Zt,nn;if(_t&&se[_t])try{for(var qt=(0,w.XA)(se[_t]||[]),An=qt.next();!An.done;An=qt.next()){var kn=An.value;try{kn(ft)}catch(jn){(0,ue.c)()&&xe.k.error("Error while triggering instrumentation handler.\nType: "+_t+"\nName: "+(0,Re.$)(kn)+"\nError: "+jn)}}}catch(jn){Zt={error:jn}}finally{try{An&&!An.done&&(nn=qt.return)&&nn.call(qt)}finally{if(Zt)throw Zt.error}}}function ct(_t){return void 0===_t&&(_t=[]),"Request"in fe&&(0,nt.V9)(_t[0],Request)&&_t[0].method?String(_t[0].method).toUpperCase():_t[1]&&_t[1].method?String(_t[1].method).toUpperCase():"GET"}function ut(_t){return void 0===_t&&(_t=[]),"string"==typeof _t[0]?_t[0]:"Request"in fe&&(0,nt.V9)(_t[0],Request)?_t[0].url:String(_t[0])}function Y(_t,ft){return void 0===ft&&(ft=!1),function(Zt){if(Zt&&ge!==Zt&&!function U(_t){if("keypress"!==_t.type)return!1;try{var ft=_t.target;if(!ft||!ft.tagName)return!0;if("INPUT"===ft.tagName||"TEXTAREA"===ft.tagName||ft.isContentEditable)return!1}catch(Zt){}return!0}(Zt)){var nn="keypress"===Zt.type?"input":Zt.type;(void 0===W||function q(_t,ft){if(!_t||_t.type!==ft.type)return!0;try{if(_t.target!==ft.target)return!0}catch(Zt){}return!1}(ge,Zt))&&(_t({event:Zt,name:nn,global:ft}),ge=Zt),clearTimeout(W),W=fe.setTimeout(function(){W=void 0},1e3)}}}var Pe=null,We=null},6412:(Sn,Nt,H)=>{"use strict";H.d(Nt,{VZ:()=>ue,VW:()=>nt,TX:()=>xe,fm:()=>Le,HD:()=>Re,pt:()=>Ue,PO:()=>fe,cO:()=>se,kK:()=>ae,Kj:()=>$e,J8:()=>St,Cy:()=>pt,V9:()=>bt});var w=Object.prototype.toString;function ue(Ct){switch(w.call(Ct)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return bt(Ct,Error)}}function g(Ct,ct){return w.call(Ct)==="[object "+ct+"]"}function nt(Ct){return g(Ct,"ErrorEvent")}function xe(Ct){return g(Ct,"DOMError")}function Le(Ct){return g(Ct,"DOMException")}function Re(Ct){return g(Ct,"String")}function Ue(Ct){return null===Ct||"object"!=typeof Ct&&"function"!=typeof Ct}function fe(Ct){return g(Ct,"Object")}function se(Ct){return"undefined"!=typeof Event&&bt(Ct,Event)}function ae(Ct){return"undefined"!=typeof Element&&bt(Ct,Element)}function $e(Ct){return g(Ct,"RegExp")}function St(Ct){return Boolean(Ct&&Ct.then&&"function"==typeof Ct.then)}function pt(Ct){return fe(Ct)&&"nativeEvent"in Ct&&"preventDefault"in Ct&&"stopPropagation"in Ct}function bt(Ct,ct){try{return Ct instanceof ct}catch(ut){return!1}}},1446:(Sn,Nt,H)=>{"use strict";H.d(Nt,{C:()=>nt,k:()=>Le});var w=H(7576),ue=(0,w.R)(),g="Sentry Logger ";function nt(Re){var Ue=(0,w.R)();if(!("console"in Ue))return Re();var se=Ue.console,ae={};["debug","info","warn","error","log","assert"].forEach(function(St){St in Ue.console&&se[St].__sentry_original__&&(ae[St]=se[St],se[St]=se[St].__sentry_original__)});var $e=Re();return Object.keys(ae).forEach(function(St){se[St]=ae[St]}),$e}var xe=function(){function Re(){this._enabled=!1}return Re.prototype.disable=function(){this._enabled=!1},Re.prototype.enable=function(){this._enabled=!0},Re.prototype.log=function(){for(var Ue=[],fe=0;fe<arguments.length;fe++)Ue[fe]=arguments[fe];!this._enabled||nt(function(){ue.console.log(g+"[Log]: "+Ue.join(" "))})},Re.prototype.warn=function(){for(var Ue=[],fe=0;fe<arguments.length;fe++)Ue[fe]=arguments[fe];!this._enabled||nt(function(){ue.console.warn(g+"[Warn]: "+Ue.join(" "))})},Re.prototype.error=function(){for(var Ue=[],fe=0;fe<arguments.length;fe++)Ue[fe]=arguments[fe];!this._enabled||nt(function(){ue.console.error(g+"[Error]: "+Ue.join(" "))})},Re}();ue.__SENTRY__=ue.__SENTRY__||{};var Le=ue.__SENTRY__.logger||(ue.__SENTRY__.logger=new xe)},5535:(Sn,Nt,H)=>{"use strict";H.d(Nt,{DM:()=>nt,en:()=>xe,jH:()=>Re,Db:()=>Ue,EG:()=>fe,JY:()=>St,rt:()=>bt,YO:()=>Ct});var w=H(832),ue=H(7576),g=H(81);function nt(){var ct=(0,ue.R)(),ut=ct.crypto||ct.msCrypto;if(void 0!==ut&&ut.getRandomValues){var he=new Uint16Array(8);ut.getRandomValues(he),he[3]=4095&he[3]|16384,he[4]=16383&he[4]|32768;var je=function(Ae){for(var j=Ae.toString(16);j.length<4;)j="0"+j;return j};return je(he[0])+je(he[1])+je(he[2])+je(he[3])+je(he[4])+je(he[5])+je(he[6])+je(he[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(Ae){var j=16*Math.random()|0;return("x"===Ae?j:3&j|8).toString(16)})}function xe(ct){if(!ct)return{};var ut=ct.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);return ut?{host:ut[4],path:ut[5],protocol:ut[2],relative:ut[5]+(ut[6]||"")+(ut[8]||"")}:{}}function Le(ct){return ct.exception&&ct.exception.values?ct.exception.values[0]:void 0}function Re(ct){var ut=ct.message,he=ct.event_id;if(ut)return ut;var je=Le(ct);return je?je.type&&je.value?je.type+": "+je.value:je.type||je.value||he||"<unknown>":he||"<unknown>"}function Ue(ct,ut,he){var je=ct.exception=ct.exception||{},Ae=je.values=je.values||[],j=Ae[0]=Ae[0]||{};j.value||(j.value=ut||""),j.type||(j.type=he||"Error")}function fe(ct,ut){var he=Le(ct);if(he){var Ae=he.mechanism;if(he.mechanism=(0,w.pi)((0,w.pi)((0,w.pi)({},{type:"generic",handled:!0}),Ae),ut),ut&&"data"in ut){var j=(0,w.pi)((0,w.pi)({},Ae&&Ae.data),ut.data);he.mechanism.data=j}}}function St(ct,ut){if(!ut)return 6e4;var he=parseInt(""+ut,10);if(!isNaN(he))return 1e3*he;var je=Date.parse(""+ut);return isNaN(je)?6e4:je-ct}function bt(ct){return ct.split(/[\?#]/,1)[0]}function Ct(ct){if(ct&&ct.__sentry_captured__)return!0;try{(0,g.xp)(ct,"__sentry_captured__",!0)}catch(ut){}return!1}},4864:(Sn,Nt,H)=>{"use strict";H.d(Nt,{KV:()=>ue,l$:()=>g,$y:()=>nt});var w=H(3327);function ue(){return!(0,w.n)()&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function g(xe,Le){return xe.require(Le)}function nt(xe){var Le;try{Le=g(Sn,xe)}catch(Ue){}try{var Re=g(Sn,"process").cwd;Le=g(Sn,Re()+"/node_modules/"+xe)}catch(Ue){}return Le}Sn=H.hmd(Sn)},81:(Sn,Nt,H)=>{"use strict";H.d(Nt,{xp:()=>Ue,Jr:()=>Ae,zf:()=>je,hl:()=>Re,HK:()=>se,$Q:()=>fe,Fv:()=>he,Qy:()=>bt,_j:()=>ae});var w=H(832),ue=H(6477),g=H(6412),xe=H(9725),Le=H(1090);function Re(W,ge,q){if(ge in W){var U=W[ge],Y=q(U);if("function"==typeof Y)try{fe(Y,U)}catch(ee){}W[ge]=Y}}function Ue(W,ge,q){Object.defineProperty(W,ge,{value:q})}function fe(W,ge){W.prototype=ge.prototype=ge.prototype||{},Ue(W,"__sentry_original__",ge)}function se(W){return W.__sentry_original__}function ae(W){return Object.keys(W).map(function(ge){return encodeURIComponent(ge)+"="+encodeURIComponent(W[ge])}).join("&")}function $e(W){if((0,g.VZ)(W)){var ge=W,q={message:ge.message,name:ge.name,stack:ge.stack};for(var U in ge)Object.prototype.hasOwnProperty.call(ge,U)&&(q[U]=ge[U]);return q}if((0,g.cO)(W)){var Y=W,ee={};ee.type=Y.type;try{ee.target=(0,g.kK)(Y.target)?(0,ue.R)(Y.target):Object.prototype.toString.call(Y.target)}catch(_e){ee.target="<unknown>"}try{ee.currentTarget=(0,g.kK)(Y.currentTarget)?(0,ue.R)(Y.currentTarget):Object.prototype.toString.call(Y.currentTarget)}catch(_e){ee.currentTarget="<unknown>"}for(var Pe in"undefined"!=typeof CustomEvent&&(0,g.V9)(W,CustomEvent)&&(ee.detail=Y.detail),Y)Object.prototype.hasOwnProperty.call(Y,Pe)&&(ee[Pe]=Y[Pe]);return ee}return W}function bt(W,ge,q){void 0===ge&&(ge=3),void 0===q&&(q=102400);var U=he(W,ge);return function pt(W){return function St(W){return~-encodeURI(W).split(/%..|./).length}(JSON.stringify(W))}(U)>q?bt(W,ge-1,q):U}function ct(W,ge){return"domain"===ge&&W&&"object"==typeof W&&W._events?"[Domain]":"domainEmitter"===ge?"[DomainEmitter]":"undefined"!=typeof global&&W===global?"[Global]":"undefined"!=typeof window&&W===window?"[Window]":"undefined"!=typeof document&&W===document?"[Document]":(0,g.Cy)(W)?"[SyntheticEvent]":"number"==typeof W&&W!=W?"[NaN]":void 0===W?"[undefined]":"function"==typeof W?"[Function: "+(0,xe.$)(W)+"]":"symbol"==typeof W?"["+String(W)+"]":"bigint"==typeof W?"[BigInt: "+String(W)+"]":W}function ut(W,ge,q,U){if(void 0===q&&(q=1/0),void 0===U&&(U=function nt(){var W="function"==typeof WeakSet,ge=W?new WeakSet:[];return[function q(Y){if(W)return!!ge.has(Y)||(ge.add(Y),!1);for(var ee=0;ee<ge.length;ee++)if(ge[ee]===Y)return!0;return ge.push(Y),!1},function U(Y){if(W)ge.delete(Y);else for(var ee=0;ee<ge.length;ee++)if(ge[ee]===Y){ge.splice(ee,1);break}}]}()),0===q)return function Ct(W){if("string"==typeof W)return W;var ge=Object.prototype.toString.call(W);if("[object Object]"===ge)return"[Object]";if("[object Array]"===ge)return"[Array]";var q=ct(W);return(0,g.pt)(q)?q:ge}(ge);if(null!=ge&&"function"==typeof ge.toJSON)return ge.toJSON();var Y=ct(ge,W);if((0,g.pt)(Y))return Y;var ee=$e(ge),Pe=Array.isArray(ge)?[]:{};if(U[0](ge))return"[Circular ~]";for(var _e in ee)!Object.prototype.hasOwnProperty.call(ee,_e)||(Pe[_e]=ut(_e,ee[_e],q-1,U));return U[1](ge),Pe}function he(W,ge){try{return JSON.parse(JSON.stringify(W,function(q,U){return ut(q,U,ge)}))}catch(q){return"**non-serializable**"}}function je(W,ge){void 0===ge&&(ge=40);var q=Object.keys($e(W));if(q.sort(),!q.length)return"[object has no keys]";if(q[0].length>=ge)return(0,Le.$G)(q[0],ge);for(var U=q.length;U>0;U--){var Y=q.slice(0,U).join(", ");if(!(Y.length>ge))return U===q.length?Y:(0,Le.$G)(Y,ge)}return""}function Ae(W){var ge,q;if((0,g.PO)(W)){var U=W,Y={};try{for(var ee=(0,w.XA)(Object.keys(U)),Pe=ee.next();!Pe.done;Pe=ee.next()){var _e=Pe.value;void 0!==U[_e]&&(Y[_e]=Ae(U[_e]))}}catch(We){ge={error:We}}finally{try{Pe&&!Pe.done&&(q=ee.return)&&q.call(ee)}finally{if(ge)throw ge.error}}return Y}return Array.isArray(W)?W.map(Ae):W}},9725:(Sn,Nt,H)=>{"use strict";H.d(Nt,{$:()=>ue});var w="<anonymous>";function ue(g){try{return g&&"function"==typeof g&&g.name||w}catch(nt){return w}}},1090:(Sn,Nt,H)=>{"use strict";H.d(Nt,{$G:()=>ue,nK:()=>nt,zC:()=>xe});var w=H(6412);function ue(Re,Ue){return void 0===Ue&&(Ue=0),"string"!=typeof Re||0===Ue||Re.length<=Ue?Re:Re.substr(0,Ue)+"..."}function nt(Re,Ue){if(!Array.isArray(Re))return"";for(var fe=[],se=0;se<Re.length;se++){var ae=Re[se];try{fe.push(String(ae))}catch($e){fe.push("[value cannot be serialized]")}}return fe.join(Ue)}function xe(Re,Ue){return!!(0,w.HD)(Re)&&((0,w.Kj)(Ue)?Ue.test(Re):"string"==typeof Ue&&-1!==Re.indexOf(Ue))}},8204:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Ak:()=>Re,Du:()=>Ue,t$:()=>fe,hv:()=>ae,Bf:()=>$e});var w=H(3327),ue=H(7576),g=H(1446);function Re(){if(!("fetch"in(0,ue.R)()))return!1;try{return new Headers,new Request(""),new Response,!0}catch(St){return!1}}function Ue(St){return St&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(St.toString())}function fe(){if(!Re())return!1;var St=(0,ue.R)();if(Ue(St.fetch))return!0;var pt=!1,bt=St.document;if(bt&&"function"==typeof bt.createElement)try{var Ct=bt.createElement("iframe");Ct.hidden=!0,bt.head.appendChild(Ct),Ct.contentWindow&&Ct.contentWindow.fetch&&(pt=Ue(Ct.contentWindow.fetch)),bt.head.removeChild(Ct)}catch(ct){(0,w.c)()&&g.k.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",ct)}return pt}function ae(){if(!Re())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(St){return!1}}function $e(){var St=(0,ue.R)(),pt=St.chrome;return!(pt&&pt.app&&pt.app.runtime||!("history"in St)||!St.history.pushState||!St.history.replaceState)}},509:(Sn,Nt,H)=>{"use strict";H.d(Nt,{WD:()=>ue,$2:()=>g,cW:()=>nt});var w=H(6412);function ue(xe){return new nt(function(Le){Le(xe)})}function g(xe){return new nt(function(Le,Re){Re(xe)})}var nt=function(){function xe(Le){var Re=this;this._state=0,this._handlers=[],this._resolve=function(Ue){Re._setResult(1,Ue)},this._reject=function(Ue){Re._setResult(2,Ue)},this._setResult=function(Ue,fe){if(0===Re._state){if((0,w.J8)(fe))return void fe.then(Re._resolve,Re._reject);Re._state=Ue,Re._value=fe,Re._executeHandlers()}},this._executeHandlers=function(){if(0!==Re._state){var Ue=Re._handlers.slice();Re._handlers=[],Ue.forEach(function(fe){fe[0]||(1===Re._state&&fe[1](Re._value),2===Re._state&&fe[2](Re._value),fe[0]=!0)})}};try{Le(this._resolve,this._reject)}catch(Ue){this._reject(Ue)}}return xe.prototype.then=function(Le,Re){var Ue=this;return new xe(function(fe,se){Ue._handlers.push([!1,function(ae){if(Le)try{fe(Le(ae))}catch($e){se($e)}else fe(ae)},function(ae){if(Re)try{fe(Re(ae))}catch($e){se($e)}else se(ae)}]),Ue._executeHandlers()})},xe.prototype.catch=function(Le){return this.then(function(Re){return Re},Le)},xe.prototype.finally=function(Le){var Re=this;return new xe(function(Ue,fe){var se,ae;return Re.then(function($e){ae=!1,se=$e,Le&&Le()},function($e){ae=!0,se=$e,Le&&Le()}).then(function(){ae?fe(se):Ue(se)})})},xe}()},3967:(Sn,Nt,H)=>{"use strict";H.d(Nt,{yW:()=>Ue,ph:()=>fe,_I:()=>se,Z1:()=>St});var w=H(7576),ue=H(4864);Sn=H.hmd(Sn);var g={nowSeconds:function(){return Date.now()/1e3}},Le=(0,ue.KV)()?function xe(){try{return(0,ue.l$)(Sn,"perf_hooks").performance}catch(bt){return}}():function nt(){var pt=(0,w.R)().performance;if(pt&&pt.now)return{now:function(){return pt.now()},timeOrigin:Date.now()-pt.now()}}(),Re=void 0===Le?g:{nowSeconds:function(){return(Le.timeOrigin+Le.now())/1e3}},Ue=g.nowSeconds.bind(g),fe=Re.nowSeconds.bind(Re),se=fe,St=function(){var pt=(0,w.R)().performance;if(pt&&pt.now){var bt=36e5,Ct=pt.now(),ct=Date.now(),ut=pt.timeOrigin?Math.abs(pt.timeOrigin+Ct-ct):bt,he=ut<bt,je=pt.timing&&pt.timing.navigationStart,j="number"==typeof je?Math.abs(je+Ct-ct):bt;return he||j<bt?ut<=j?pt.timeOrigin:je:ct}}()},5867:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Mq:()=>w.getApp,C6:()=>w.getApps});var w=H(9681);(0,w.registerVersion)("firebase","9.6.4","app")},127:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Z:()=>w.Z});var w=H(3942);w.Z.registerVersion("firebase","9.6.4","app-compat")},1488:(Sn,Nt,H)=>{"use strict";H.r(Nt);var w=H(5861),ue=H(3942),g=H(2090),nt=H(9681),xe=H(655),Le=H(1877),Re=H(4859);const bt=function St(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Ct=function pt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ct=new g.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),he=new Le.Yd("@firebase/auth");function je(A,...b){he.logLevel<=Le.in.ERROR&&he.error(`Auth (${nt.SDK_VERSION}): ${A}`,...b)}function Ae(A,...b){throw q(A,...b)}function j(A,...b){return q(A,...b)}function W(A,b,I){const N=Object.assign(Object.assign({},Ct()),{[b]:I});return new g.LL("auth","Firebase",N).create(b,{appName:A.name})}function ge(A,b,I){if(!(b instanceof I))throw I.name!==b.constructor.name&&Ae(A,"argument-error"),W(A,"argument-error",`Type of ${b.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function q(A,...b){if("string"!=typeof A){const I=b[0],N=[...b.slice(1)];return N[0]&&(N[0].appName=A.name),A._errorFactory.create(I,...N)}return ct.create(A,...b)}function U(A,b,...I){if(!A)throw q(b,...I)}function Y(A){const b="INTERNAL ASSERTION FAILED: "+A;throw je(b),new Error(b)}function ee(A,b){A||Y(b)}const Pe=new Map;function _e(A){ee(A instanceof Function,"Expected a class definition");let b=Pe.get(A);return b?(ee(b instanceof A,"Instance stored in cache mismatched with class"),b):(b=new A,Pe.set(A,b),b)}function _t(){var A;return"undefined"!=typeof self&&(null===(A=self.location)||void 0===A?void 0:A.href)||""}function ft(){return"http:"===Zt()||"https:"===Zt()}function Zt(){var A;return"undefined"!=typeof self&&(null===(A=self.location)||void 0===A?void 0:A.protocol)||null}class An{constructor(b,I){this.shortDelay=b,this.longDelay=I,ee(I>b,"Short delay should be less than long delay!"),this.isMobile=(0,g.uI)()||(0,g.b$)()}get(){return function nn(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(ft()||(0,g.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function kn(A,b){ee(A.emulator,"Emulator should always be set here");const{url:I}=A.emulator;return b?`${I}${b.startsWith("/")?b.slice(1):b}`:I}class jn{static initialize(b,I,N){this.fetchImpl=b,I&&(this.headersImpl=I),N&&(this.responseImpl=N)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Y("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Y("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Y("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},lr=new An(3e4,6e4);function Er(A,b){return A.tenantId&&!b.tenantId?Object.assign(Object.assign({},b),{tenantId:A.tenantId}):b}function Sr(A,b,I,N){return di.apply(this,arguments)}function di(){return(di=(0,w.Z)(function*(A,b,I,N,we={}){return vr(A,we,(0,w.Z)(function*(){let lt={},Yt={};N&&("GET"===b?Yt=N:lt={body:JSON.stringify(N)});const In=(0,g.xO)(Object.assign({key:A.config.apiKey},Yt)).slice(1),ar=yield A._getAdditionalHeaders();return ar["Content-Type"]="application/json",A.languageCode&&(ar["X-Firebase-Locale"]=A.languageCode),jn.fetch()(bi(A,A.config.apiHost,I,In),Object.assign({method:b,headers:ar,referrerPolicy:"no-referrer"},lt))}))})).apply(this,arguments)}function vr(A,b,I){return qi.apply(this,arguments)}function qi(){return(qi=(0,w.Z)(function*(A,b,I){A._canInitEmulator=!1;const N=Object.assign(Object.assign({},gr),b);try{const we=new pi(A),lt=yield Promise.race([I(),we.promise]);we.clearNetworkTimeout();const Yt=yield lt.json();if("needConfirmation"in Yt)throw oi(A,"account-exists-with-different-credential",Yt);if(lt.ok&&!("errorMessage"in Yt))return Yt;{const In=lt.ok?Yt.errorMessage:Yt.error.message,[ar,Lr]=In.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===ar)throw oi(A,"credential-already-in-use",Yt);if("EMAIL_EXISTS"===ar)throw oi(A,"email-already-in-use",Yt);const ai=N[ar]||ar.toLowerCase().replace(/[_\s]+/g,"-");if(Lr)throw W(A,ai,Lr);Ae(A,ai)}}catch(we){if(we instanceof g.ZR)throw we;Ae(A,"network-request-failed")}})).apply(this,arguments)}function ii(A,b,I,N){return fi.apply(this,arguments)}function fi(){return(fi=(0,w.Z)(function*(A,b,I,N,we={}){const lt=yield Sr(A,b,I,N,we);return"mfaPendingCredential"in lt&&Ae(A,"multi-factor-auth-required",{_serverResponse:lt}),lt})).apply(this,arguments)}function bi(A,b,I,N){const we=`${b}${I}?${N}`;return A.config.emulator?kn(A.config,we):`${A.config.apiScheme}://${we}`}class pi{constructor(b){this.auth=b,this.timer=null,this.promise=new Promise((I,N)=>{this.timer=setTimeout(()=>N(j(this.auth,"network-request-failed")),lr.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function oi(A,b,I){const N={appName:A.name};I.email&&(N.email=I.email),I.phoneNumber&&(N.phoneNumber=I.phoneNumber);const we=j(A,b,N);return we.customData._tokenResponse=I,we}function ln(){return(ln=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:delete",b)})).apply(this,arguments)}function En(A,b){return bn.apply(this,arguments)}function bn(){return(bn=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:update",b)})).apply(this,arguments)}function Wn(A,b){return jt.apply(this,arguments)}function jt(){return(jt=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:lookup",b)})).apply(this,arguments)}function ve(A){if(A)try{const b=new Date(Number(A));if(!isNaN(b.getTime()))return b.toUTCString()}catch(b){}}function ht(){return(ht=(0,w.Z)(function*(A,b=!1){const I=(0,g.m9)(A),N=yield I.getIdToken(b),we=sn(N);U(we&&we.exp&&we.auth_time&&we.iat,I.auth,"internal-error");const lt="object"==typeof we.firebase?we.firebase:void 0,Yt=null==lt?void 0:lt.sign_in_provider;return{claims:we,token:N,authTime:ve(zt(we.auth_time)),issuedAtTime:ve(zt(we.iat)),expirationTime:ve(zt(we.exp)),signInProvider:Yt||null,signInSecondFactor:(null==lt?void 0:lt.sign_in_second_factor)||null}})).apply(this,arguments)}function zt(A){return 1e3*Number(A)}function sn(A){const[b,I,N]=A.split(".");if(void 0===b||void 0===I||void 0===N)return je("JWT malformed, contained fewer than 3 sections"),null;try{const we=(0,g.tV)(I);return we?JSON.parse(we):(je("Failed to decode base64 JWT payload"),null)}catch(we){return je("Caught error parsing JWT payload as JSON",we),null}}function Jn(A,b){return Tr.apply(this,arguments)}function Tr(){return(Tr=(0,w.Z)(function*(A,b,I=!1){if(I)return b;try{return yield b}catch(N){throw N instanceof g.ZR&&wr(N)&&A.auth.currentUser===A&&(yield A.auth.signOut()),N}})).apply(this,arguments)}function wr({code:A}){return"auth/user-disabled"===A||"auth/user-token-expired"===A}class Ki{constructor(b){this.user=b,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(b){var I;if(b){const N=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),N}{this.errorBackoff=3e4;const we=(null!==(I=this.user.stsTokenManager.expirationTime)&&void 0!==I?I:0)-Date.now()-3e5;return Math.max(0,we)}}schedule(b=!1){var I=this;if(!this.isRunning)return;const N=this.getInterval(b);this.timerId=setTimeout((0,w.Z)(function*(){yield I.iteration()}),N)}iteration(){var b=this;return(0,w.Z)(function*(){try{yield b.user.getIdToken(!0)}catch(I){return void("auth/network-request-failed"===I.code&&b.schedule(!0))}b.schedule()})()}}class Li{constructor(b,I){this.createdAt=b,this.lastLoginAt=I,this._initializeTime()}_initializeTime(){this.lastSignInTime=ve(this.lastLoginAt),this.creationTime=ve(this.createdAt)}_copy(b){this.createdAt=b.createdAt,this.lastLoginAt=b.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Ht(A){return Te.apply(this,arguments)}function Te(){return(Te=(0,w.Z)(function*(A){var b;const I=A.auth,N=yield A.getIdToken(),we=yield Jn(A,Wn(I,{idToken:N}));U(null==we?void 0:we.users.length,I,"internal-error");const lt=we.users[0];A._notifyReloadListener(lt);const Yt=(null===(b=lt.providerUserInfo)||void 0===b?void 0:b.length)?vt(lt.providerUserInfo):[],In=Ft(A.providerData,Yt),ai=!!A.isAnonymous&&!(A.email&&lt.passwordHash||(null==In?void 0:In.length)),Xr={uid:lt.localId,displayName:lt.displayName||null,photoURL:lt.photoUrl||null,email:lt.email||null,emailVerified:lt.emailVerified||!1,phoneNumber:lt.phoneNumber||null,tenantId:lt.tenantId||null,providerData:In,metadata:new Li(lt.createdAt,lt.lastLoginAt),isAnonymous:ai};Object.assign(A,Xr)})).apply(this,arguments)}function tt(){return(tt=(0,w.Z)(function*(A){const b=(0,g.m9)(A);yield Ht(b),yield b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)})).apply(this,arguments)}function Ft(A,b){return[...A.filter(N=>!b.some(we=>we.providerId===N.providerId)),...b]}function vt(A){return A.map(b=>{var{providerId:I}=b,N=(0,xe._T)(b,["providerId"]);return{providerId:I,uid:N.rawId||"",displayName:N.displayName||null,email:N.email||null,phoneNumber:N.phoneNumber||null,photoURL:N.photoUrl||null}})}function Pn(){return(Pn=(0,w.Z)(function*(A,b){const I=yield vr(A,{},(0,w.Z)(function*(){const N=(0,g.xO)({grant_type:"refresh_token",refresh_token:b}).slice(1),{tokenApiHost:we,apiKey:lt}=A.config,Yt=bi(A,we,"/v1/token",`key=${lt}`),In=yield A._getAdditionalHeaders();return In["Content-Type"]="application/x-www-form-urlencoded",jn.fetch()(Yt,{method:"POST",headers:In,body:N})}));return{accessToken:I.access_token,expiresIn:I.expires_in,refreshToken:I.refresh_token}})).apply(this,arguments)}class ce{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(b){U(b.idToken,"internal-error"),U(void 0!==b.idToken,"internal-error"),U(void 0!==b.refreshToken,"internal-error");const I="expiresIn"in b&&void 0!==b.expiresIn?Number(b.expiresIn):function Mn(A){const b=sn(A);return U(b,"internal-error"),U(void 0!==b.exp,"internal-error"),U(void 0!==b.iat,"internal-error"),Number(b.exp)-Number(b.iat)}(b.idToken);this.updateTokensAndExpiration(b.idToken,b.refreshToken,I)}getToken(b,I=!1){var N=this;return(0,w.Z)(function*(){return U(!N.accessToken||N.refreshToken,b,"user-token-expired"),I||!N.accessToken||N.isExpired?N.refreshToken?(yield N.refresh(b,N.refreshToken),N.accessToken):null:N.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(b,I){var N=this;return(0,w.Z)(function*(){const{accessToken:we,refreshToken:lt,expiresIn:Yt}=yield function dn(A,b){return Pn.apply(this,arguments)}(b,I);N.updateTokensAndExpiration(we,lt,Number(Yt))})()}updateTokensAndExpiration(b,I,N){this.refreshToken=I||null,this.accessToken=b||null,this.expirationTime=Date.now()+1e3*N}static fromJSON(b,I){const{refreshToken:N,accessToken:we,expirationTime:lt}=I,Yt=new ce;return N&&(U("string"==typeof N,"internal-error",{appName:b}),Yt.refreshToken=N),we&&(U("string"==typeof we,"internal-error",{appName:b}),Yt.accessToken=we),lt&&(U("number"==typeof lt,"internal-error",{appName:b}),Yt.expirationTime=lt),Yt}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(b){this.accessToken=b.accessToken,this.refreshToken=b.refreshToken,this.expirationTime=b.expirationTime}_clone(){return Object.assign(new ce,this.toJSON())}_performRefresh(){return Y("not implemented")}}function be(A,b){U("string"==typeof A||void 0===A,"internal-error",{appName:b})}class Oe{constructor(b){var{uid:I,auth:N,stsTokenManager:we}=b,lt=(0,xe._T)(b,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Ki(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=I,this.auth=N,this.stsTokenManager=we,this.accessToken=we.accessToken,this.displayName=lt.displayName||null,this.email=lt.email||null,this.emailVerified=lt.emailVerified||!1,this.phoneNumber=lt.phoneNumber||null,this.photoURL=lt.photoURL||null,this.isAnonymous=lt.isAnonymous||!1,this.tenantId=lt.tenantId||null,this.metadata=new Li(lt.createdAt||void 0,lt.lastLoginAt||void 0)}getIdToken(b){var I=this;return(0,w.Z)(function*(){const N=yield Jn(I,I.stsTokenManager.getToken(I.auth,b));return U(N,I.auth,"internal-error"),I.accessToken!==N&&(I.accessToken=N,yield I.auth._persistUserIfCurrent(I),I.auth._notifyListenersIfCurrent(I)),N})()}getIdTokenResult(b){return function re(A){return ht.apply(this,arguments)}(this,b)}reload(){return function ke(A){return tt.apply(this,arguments)}(this)}_assign(b){this!==b&&(U(this.uid===b.uid,this.auth,"internal-error"),this.displayName=b.displayName,this.photoURL=b.photoURL,this.email=b.email,this.emailVerified=b.emailVerified,this.phoneNumber=b.phoneNumber,this.isAnonymous=b.isAnonymous,this.tenantId=b.tenantId,this.providerData=b.providerData.map(I=>Object.assign({},I)),this.metadata._copy(b.metadata),this.stsTokenManager._assign(b.stsTokenManager))}_clone(b){return new Oe(Object.assign(Object.assign({},this),{auth:b,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(b){U(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=b,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(b){this.reloadListener?this.reloadListener(b):this.reloadUserInfo=b}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(b,I=!1){var N=this;return(0,w.Z)(function*(){let we=!1;b.idToken&&b.idToken!==N.stsTokenManager.accessToken&&(N.stsTokenManager.updateFromServerResponse(b),we=!0),I&&(yield Ht(N)),yield N.auth._persistUserIfCurrent(N),we&&N.auth._notifyListenersIfCurrent(N)})()}delete(){var b=this;return(0,w.Z)(function*(){const I=yield b.getIdToken();return yield Jn(b,function Xt(A,b){return ln.apply(this,arguments)}(b.auth,{idToken:I})),b.stsTokenManager.clearRefreshToken(),b.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(b=>Object.assign({},b)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(b,I){var N,we,lt,Yt,In,ar,Lr,ai;const Xr=null!==(N=I.displayName)&&void 0!==N?N:void 0,Qs=null!==(we=I.email)&&void 0!==we?we:void 0,Un=null!==(lt=I.phoneNumber)&&void 0!==lt?lt:void 0,Al=null!==(Yt=I.photoURL)&&void 0!==Yt?Yt:void 0,nu=null!==(In=I.tenantId)&&void 0!==In?In:void 0,Xl=null!==(ar=I._redirectEventId)&&void 0!==ar?ar:void 0,ea=null!==(Lr=I.createdAt)&&void 0!==Lr?Lr:void 0,Ju=null!==(ai=I.lastLoginAt)&&void 0!==ai?ai:void 0,{uid:Ma,emailVerified:vu,isAnonymous:wc,providerData:ca,stsTokenManager:wd}=I;U(Ma&&wd,b,"internal-error");const ru=ce.fromJSON(this.name,wd);U("string"==typeof Ma,b,"internal-error"),be(Xr,b.name),be(Qs,b.name),U("boolean"==typeof vu,b,"internal-error"),U("boolean"==typeof wc,b,"internal-error"),be(Un,b.name),be(Al,b.name),be(nu,b.name),be(Xl,b.name),be(ea,b.name),be(Ju,b.name);const $h=new Oe({uid:Ma,auth:b,email:Qs,emailVerified:vu,displayName:Xr,isAnonymous:wc,photoURL:Al,phoneNumber:Un,tenantId:nu,stsTokenManager:ru,createdAt:ea,lastLoginAt:Ju});return ca&&Array.isArray(ca)&&($h.providerData=ca.map(xd=>Object.assign({},xd))),Xl&&($h._redirectEventId=Xl),$h}static _fromIdTokenResponse(b,I,N=!1){return(0,w.Z)(function*(){const we=new ce;we.updateFromServerResponse(I);const lt=new Oe({uid:I.localId,auth:b,stsTokenManager:we,isAnonymous:N});return yield Ht(lt),lt})()}}const ot=(()=>{class A{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,w.Z)(function*(){return!0})()}_set(I,N){var we=this;return(0,w.Z)(function*(){we.storage[I]=N})()}_get(I){var N=this;return(0,w.Z)(function*(){const we=N.storage[I];return void 0===we?null:we})()}_remove(I){var N=this;return(0,w.Z)(function*(){delete N.storage[I]})()}_addListener(I,N){}_removeListener(I,N){}}return A.type="NONE",A})();function Dt(A,b,I){return`firebase:${A}:${b}:${I}`}class Lt{constructor(b,I,N){this.persistence=b,this.auth=I,this.userKey=N;const{config:we,name:lt}=this.auth;this.fullUserKey=Dt(this.userKey,we.apiKey,lt),this.fullPersistenceKey=Dt("persistence",we.apiKey,lt),this.boundEventHandler=I._onStorageEvent.bind(I),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(b){return this.persistence._set(this.fullUserKey,b.toJSON())}getCurrentUser(){var b=this;return(0,w.Z)(function*(){const I=yield b.persistence._get(b.fullUserKey);return I?Oe._fromJSON(b.auth,I):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(b){var I=this;return(0,w.Z)(function*(){if(I.persistence===b)return;const N=yield I.getCurrentUser();return yield I.removeCurrentUser(),I.persistence=b,N?I.setCurrentUser(N):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(b,I,N="authUser"){return(0,w.Z)(function*(){if(!I.length)return new Lt(_e(ot),b,N);const we=(yield Promise.all(I.map(function(){var Lr=(0,w.Z)(function*(ai){if(yield ai._isAvailable())return ai});return function(ai){return Lr.apply(this,arguments)}}()))).filter(Lr=>Lr);let lt=we[0]||_e(ot);const Yt=Dt(N,b.config.apiKey,b.name);let In=null;for(const Lr of I)try{const ai=yield Lr._get(Yt);if(ai){const Xr=Oe._fromJSON(b,ai);Lr!==lt&&(In=Xr),lt=Lr;break}}catch(ai){}const ar=we.filter(Lr=>Lr._shouldAllowMigration);return lt._shouldAllowMigration&&ar.length?(lt=ar[0],In&&(yield lt._set(Yt,In.toJSON())),yield Promise.all(I.map(function(){var Lr=(0,w.Z)(function*(ai){if(ai!==lt)try{yield ai._remove(Yt)}catch(Xr){}});return function(ai){return Lr.apply(this,arguments)}}())),new Lt(lt,b,N)):new Lt(lt,b,N)})()}}function Je(A){const b=A.toLowerCase();if(b.includes("opera/")||b.includes("opr/")||b.includes("opios/"))return"Opera";if(mt(b))return"IEMobile";if(b.includes("msie")||b.includes("trident/"))return"IE";if(b.includes("edge/"))return"Edge";if(Ie(b))return"Firefox";if(b.includes("silk/"))return"Silk";if(en(b))return"Blackberry";if(Dn(b))return"Webos";if(ze(b))return"Safari";if((b.includes("chrome/")||Ve(b))&&!b.includes("edge/"))return"Chrome";if(Tt(b))return"Android";{const N=A.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==N?void 0:N.length))return N[1]}return"Other"}function Ie(A=(0,g.z$)()){return/firefox\//i.test(A)}function ze(A=(0,g.z$)()){const b=A.toLowerCase();return b.includes("safari/")&&!b.includes("chrome/")&&!b.includes("crios/")&&!b.includes("android")}function Ve(A=(0,g.z$)()){return/crios\//i.test(A)}function mt(A=(0,g.z$)()){return/iemobile/i.test(A)}function Tt(A=(0,g.z$)()){return/android/i.test(A)}function en(A=(0,g.z$)()){return/blackberry/i.test(A)}function Dn(A=(0,g.z$)()){return/webos/i.test(A)}function zn(A=(0,g.z$)()){return/iphone|ipad|ipod/i.test(A)}function Hn(A=(0,g.z$)()){return zn(A)||Tt(A)||Dn(A)||en(A)||/windows phone/i.test(A)||mt(A)}function Xn(A,b=[]){let I;switch(A){case"Browser":I=Je((0,g.z$)());break;case"Worker":I=`${Je((0,g.z$)())}-${A}`;break;default:I=A}const N=b.length?b.join(","):"FirebaseCore-web";return`${I}/JsCore/${nt.SDK_VERSION}/${N}`}class br{constructor(b,I){this.app=b,this.config=I,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ur(this),this.idTokenSubscription=new ur(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ct,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=b.name,this.clientVersion=I.sdkClientVersion}_initializeWithPersistence(b,I){var N=this;return I&&(this._popupRedirectResolver=_e(I)),this._initializationPromise=this.queue((0,w.Z)(function*(){var we,lt;if(!N._deleted&&(N.persistenceManager=yield Lt.create(N,b),!N._deleted)){if(null===(we=N._popupRedirectResolver)||void 0===we?void 0:we._shouldInitProactively)try{yield N._popupRedirectResolver._initialize(N)}catch(Yt){}yield N.initializeCurrentUser(I),N.lastNotifiedUid=(null===(lt=N.currentUser)||void 0===lt?void 0:lt.uid)||null,!N._deleted&&(N._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var b=this;return(0,w.Z)(function*(){if(b._deleted)return;const I=yield b.assertedPersistence.getCurrentUser();if(b.currentUser||I){if(b.currentUser&&I&&b.currentUser.uid===I.uid)return b._currentUser._assign(I),void(yield b.currentUser.getIdToken());yield b._updateCurrentUser(I)}})()}initializeCurrentUser(b){var I=this;return(0,w.Z)(function*(){var N;let we=yield I.assertedPersistence.getCurrentUser();if(b&&I.config.authDomain){yield I.getOrInitRedirectPersistenceManager();const lt=null===(N=I.redirectUser)||void 0===N?void 0:N._redirectEventId,Yt=null==we?void 0:we._redirectEventId,In=yield I.tryRedirectSignIn(b);(!lt||lt===Yt)&&(null==In?void 0:In.user)&&(we=In.user)}return we?we._redirectEventId?(U(I._popupRedirectResolver,I,"argument-error"),yield I.getOrInitRedirectPersistenceManager(),I.redirectUser&&I.redirectUser._redirectEventId===we._redirectEventId?I.directlySetCurrentUser(we):I.reloadAndSetCurrentUserOrClear(we)):I.reloadAndSetCurrentUserOrClear(we):I.directlySetCurrentUser(null)})()}tryRedirectSignIn(b){var I=this;return(0,w.Z)(function*(){let N=null;try{N=yield I._popupRedirectResolver._completeRedirectFn(I,b,!0)}catch(we){yield I._setRedirectUser(null)}return N})()}reloadAndSetCurrentUserOrClear(b){var I=this;return(0,w.Z)(function*(){try{yield Ht(b)}catch(N){if("auth/network-request-failed"!==N.code)return I.directlySetCurrentUser(null)}return I.directlySetCurrentUser(b)})()}useDeviceLanguage(){this.languageCode=function qt(){if("undefined"==typeof navigator)return null;const A=navigator;return A.languages&&A.languages[0]||A.language||null}()}_delete(){var b=this;return(0,w.Z)(function*(){b._deleted=!0})()}updateCurrentUser(b){var I=this;return(0,w.Z)(function*(){const N=b?(0,g.m9)(b):null;return N&&U(N.auth.config.apiKey===I.config.apiKey,I,"invalid-user-token"),I._updateCurrentUser(N&&N._clone(I))})()}_updateCurrentUser(b){var I=this;return(0,w.Z)(function*(){if(!I._deleted)return b&&U(I.tenantId===b.tenantId,I,"tenant-id-mismatch"),I.queue((0,w.Z)(function*(){yield I.directlySetCurrentUser(b),I.notifyAuthListeners()}))})()}signOut(){var b=this;return(0,w.Z)(function*(){return(b.redirectPersistenceManager||b._popupRedirectResolver)&&(yield b._setRedirectUser(null)),b._updateCurrentUser(null)})()}setPersistence(b){var I=this;return this.queue((0,w.Z)(function*(){yield I.assertedPersistence.setPersistence(_e(b))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(b){this._errorFactory=new g.LL("auth","Firebase",b())}onAuthStateChanged(b,I,N){return this.registerStateListener(this.authStateSubscription,b,I,N)}onIdTokenChanged(b,I,N){return this.registerStateListener(this.idTokenSubscription,b,I,N)}toJSON(){var b;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(b=this._currentUser)||void 0===b?void 0:b.toJSON()}}_setRedirectUser(b,I){var N=this;return(0,w.Z)(function*(){const we=yield N.getOrInitRedirectPersistenceManager(I);return null===b?we.removeCurrentUser():we.setCurrentUser(b)})()}getOrInitRedirectPersistenceManager(b){var I=this;return(0,w.Z)(function*(){if(!I.redirectPersistenceManager){const N=b&&_e(b)||I._popupRedirectResolver;U(N,I,"argument-error"),I.redirectPersistenceManager=yield Lt.create(I,[_e(N._redirectPersistence)],"redirectUser"),I.redirectUser=yield I.redirectPersistenceManager.getCurrentUser()}return I.redirectPersistenceManager})()}_redirectUserForId(b){var I=this;return(0,w.Z)(function*(){var N,we;return I._isInitialized&&(yield I.queue((0,w.Z)(function*(){}))),(null===(N=I._currentUser)||void 0===N?void 0:N._redirectEventId)===b?I._currentUser:(null===(we=I.redirectUser)||void 0===we?void 0:we._redirectEventId)===b?I.redirectUser:null})()}_persistUserIfCurrent(b){var I=this;return(0,w.Z)(function*(){if(b===I.currentUser)return I.queue((0,w.Z)(function*(){return I.directlySetCurrentUser(b)}))})()}_notifyListenersIfCurrent(b){b===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var b,I;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const N=null!==(I=null===(b=this.currentUser)||void 0===b?void 0:b.uid)&&void 0!==I?I:null;this.lastNotifiedUid!==N&&(this.lastNotifiedUid=N,this.authStateSubscription.next(this.currentUser))}registerStateListener(b,I,N,we){if(this._deleted)return()=>{};const lt="function"==typeof I?I:I.next.bind(I),Yt=this._isInitialized?Promise.resolve():this._initializationPromise;return U(Yt,this,"internal-error"),Yt.then(()=>lt(this.currentUser)),"function"==typeof I?b.addObserver(I,N,we):b.addObserver(I)}directlySetCurrentUser(b){var I=this;return(0,w.Z)(function*(){I.currentUser&&I.currentUser!==b&&(I._currentUser._stopProactiveRefresh(),b&&I.isProactiveRefreshEnabled&&b._startProactiveRefresh()),I.currentUser=b,b?yield I.assertedPersistence.setCurrentUser(b):yield I.assertedPersistence.removeCurrentUser()})()}queue(b){return this.operations=this.operations.then(b,b),this.operations}get assertedPersistence(){return U(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(b){!b||this.frameworks.includes(b)||(this.frameworks.push(b),this.frameworks.sort(),this.clientVersion=Xn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var b=this;return(0,w.Z)(function*(){const I={"X-Client-Version":b.clientVersion};return b.app.options.appId&&(I["X-Firebase-gmpid"]=b.app.options.appId),I})()}}function yn(A){return(0,g.m9)(A)}class ur{constructor(b){this.auth=b,this.observer=null,this.addObserver=(0,g.ne)(I=>this.observer=I)}get next(){return U(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function jr(A){const b=A.indexOf(":");return b<0?"":A.substr(0,b+1)}function zr(A){if(!A)return null;const b=Number(A);return isNaN(b)?null:b}class Mr{constructor(b,I){this.providerId=b,this.signInMethod=I}toJSON(){return Y("not implemented")}_getIdTokenResponse(b){return Y("not implemented")}_linkToIdToken(b,I){return Y("not implemented")}_getReauthenticationResolver(b){return Y("not implemented")}}function Gr(A,b){return Fr.apply(this,arguments)}function Fr(){return(Fr=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:resetPassword",Er(A,b))})).apply(this,arguments)}function Vr(A,b){return hs.apply(this,arguments)}function hs(){return(hs=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:update",b)})).apply(this,arguments)}function Yi(A,b){return Ao.apply(this,arguments)}function Ao(){return(Ao=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:update",Er(A,b))})).apply(this,arguments)}function Pi(){return(Pi=(0,w.Z)(function*(A,b){return ii(A,"POST","/v1/accounts:signInWithPassword",Er(A,b))})).apply(this,arguments)}function Si(A,b){return xs.apply(this,arguments)}function xs(){return(xs=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:sendOobCode",Er(A,b))})).apply(this,arguments)}function zi(A,b){return Br.apply(this,arguments)}function Br(){return(Br=(0,w.Z)(function*(A,b){return Si(A,b)})).apply(this,arguments)}function ds(A,b){return _i.apply(this,arguments)}function _i(){return(_i=(0,w.Z)(function*(A,b){return Si(A,b)})).apply(this,arguments)}function fo(A,b){return Ji.apply(this,arguments)}function Ji(){return(Ji=(0,w.Z)(function*(A,b){return Si(A,b)})).apply(this,arguments)}function ou(A,b){return ns.apply(this,arguments)}function ns(){return(ns=(0,w.Z)(function*(A,b){return Si(A,b)})).apply(this,arguments)}function Io(){return(Io=(0,w.Z)(function*(A,b){return ii(A,"POST","/v1/accounts:signInWithEmailLink",Er(A,b))})).apply(this,arguments)}function Mo(){return(Mo=(0,w.Z)(function*(A,b){return ii(A,"POST","/v1/accounts:signInWithEmailLink",Er(A,b))})).apply(this,arguments)}class No extends Mr{constructor(b,I,N,we=null){super("password",N),this._email=b,this._password=I,this._tenantId=we}static _fromEmailAndPassword(b,I){return new No(b,I,"password")}static _fromEmailAndCode(b,I,N=null){return new No(b,I,"emailLink",N)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(b){const I="string"==typeof b?JSON.parse(b):b;if((null==I?void 0:I.email)&&(null==I?void 0:I.password)){if("password"===I.signInMethod)return this._fromEmailAndPassword(I.email,I.password);if("emailLink"===I.signInMethod)return this._fromEmailAndCode(I.email,I.password,I.tenantId)}return null}_getIdTokenResponse(b){var I=this;return(0,w.Z)(function*(){switch(I.signInMethod){case"password":return function Bo(A,b){return Pi.apply(this,arguments)}(b,{returnSecureToken:!0,email:I._email,password:I._password});case"emailLink":return function fs(A,b){return Io.apply(this,arguments)}(b,{email:I._email,oobCode:I._password});default:Ae(b,"internal-error")}})()}_linkToIdToken(b,I){var N=this;return(0,w.Z)(function*(){switch(N.signInMethod){case"password":return Vr(b,{idToken:I,returnSecureToken:!0,email:N._email,password:N._password});case"emailLink":return function jo(A,b){return Mo.apply(this,arguments)}(b,{idToken:I,email:N._email,oobCode:N._password});default:Ae(b,"internal-error")}})()}_getReauthenticationResolver(b){return this._getIdTokenResponse(b)}}function mi(A,b){return su.apply(this,arguments)}function su(){return(su=(0,w.Z)(function*(A,b){return ii(A,"POST","/v1/accounts:signInWithIdp",Er(A,b))})).apply(this,arguments)}class rs extends Mr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(b){const I=new rs(b.providerId,b.signInMethod);return b.idToken||b.accessToken?(b.idToken&&(I.idToken=b.idToken),b.accessToken&&(I.accessToken=b.accessToken),b.nonce&&!b.pendingToken&&(I.nonce=b.nonce),b.pendingToken&&(I.pendingToken=b.pendingToken)):b.oauthToken&&b.oauthTokenSecret?(I.accessToken=b.oauthToken,I.secret=b.oauthTokenSecret):Ae("argument-error"),I}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(b){const I="string"==typeof b?JSON.parse(b):b,{providerId:N,signInMethod:we}=I,lt=(0,xe._T)(I,["providerId","signInMethod"]);if(!N||!we)return null;const Yt=new rs(N,we);return Yt.idToken=lt.idToken||void 0,Yt.accessToken=lt.accessToken||void 0,Yt.secret=lt.secret,Yt.nonce=lt.nonce,Yt.pendingToken=lt.pendingToken||null,Yt}_getIdTokenResponse(b){return mi(b,this.buildRequest())}_linkToIdToken(b,I){const N=this.buildRequest();return N.idToken=I,mi(b,N)}_getReauthenticationResolver(b){const I=this.buildRequest();return I.autoCreate=!1,mi(b,I)}buildRequest(){const b={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)b.pendingToken=this.pendingToken;else{const I={};this.idToken&&(I.id_token=this.idToken),this.accessToken&&(I.access_token=this.accessToken),this.secret&&(I.oauth_token_secret=this.secret),I.providerId=this.providerId,this.nonce&&!this.pendingToken&&(I.nonce=this.nonce),b.postBody=(0,g.xO)(I)}return b}}function Yo(A,b){return $a.apply(this,arguments)}function $a(){return($a=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:sendVerificationCode",Er(A,b))})).apply(this,arguments)}function fa(){return(fa=(0,w.Z)(function*(A,b){return ii(A,"POST","/v1/accounts:signInWithPhoneNumber",Er(A,b))})).apply(this,arguments)}function pa(){return(pa=(0,w.Z)(function*(A,b){const I=yield ii(A,"POST","/v1/accounts:signInWithPhoneNumber",Er(A,b));if(I.temporaryProof)throw oi(A,"account-exists-with-different-credential",I);return I})).apply(this,arguments)}const Tu={USER_NOT_FOUND:"user-not-found"};function ma(){return(ma=(0,w.Z)(function*(A,b){return ii(A,"POST","/v1/accounts:signInWithPhoneNumber",Er(A,Object.assign(Object.assign({},b),{operation:"REAUTH"})),Tu)})).apply(this,arguments)}class Ss extends Mr{constructor(b){super("phone","phone"),this.params=b}static _fromVerification(b,I){return new Ss({verificationId:b,verificationCode:I})}static _fromTokenResponse(b,I){return new Ss({phoneNumber:b,temporaryProof:I})}_getIdTokenResponse(b){return function au(A,b){return fa.apply(this,arguments)}(b,this._makeVerificationRequest())}_linkToIdToken(b,I){return function ta(A,b){return pa.apply(this,arguments)}(b,Object.assign({idToken:I},this._makeVerificationRequest()))}_getReauthenticationResolver(b){return function Uu(A,b){return ma.apply(this,arguments)}(b,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:b,phoneNumber:I,verificationId:N,verificationCode:we}=this.params;return b&&I?{temporaryProof:b,phoneNumber:I}:{sessionInfo:N,code:we}}toJSON(){const b={providerId:this.providerId};return this.params.phoneNumber&&(b.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(b.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(b.verificationCode=this.params.verificationCode),this.params.verificationId&&(b.verificationId=this.params.verificationId),b}static fromJSON(b){"string"==typeof b&&(b=JSON.parse(b));const{verificationId:I,verificationCode:N,phoneNumber:we,temporaryProof:lt}=b;return N||I||we||lt?new Ss({verificationId:I,verificationCode:N,phoneNumber:we,temporaryProof:lt}):null}}class Ho{constructor(b){var I,N,we,lt,Yt,In;const ar=(0,g.zd)((0,g.pd)(b)),Lr=null!==(I=ar.apiKey)&&void 0!==I?I:null,ai=null!==(N=ar.oobCode)&&void 0!==N?N:null,Xr=function Ls(A){switch(A){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(we=ar.mode)&&void 0!==we?we:null);U(Lr&&ai&&Xr,"argument-error"),this.apiKey=Lr,this.operation=Xr,this.code=ai,this.continueUrl=null!==(lt=ar.continueUrl)&&void 0!==lt?lt:null,this.languageCode=null!==(Yt=ar.languageCode)&&void 0!==Yt?Yt:null,this.tenantId=null!==(In=ar.tenantId)&&void 0!==In?In:null}static parseLink(b){const I=function $s(A){const b=(0,g.zd)((0,g.pd)(A)).link,I=b?(0,g.zd)((0,g.pd)(b)).deep_link_id:null,N=(0,g.zd)((0,g.pd)(A)).deep_link_id;return(N?(0,g.zd)((0,g.pd)(N)).link:null)||N||I||b||A}(b);try{return new Ho(I)}catch(N){return null}}}let Cs=(()=>{class A{constructor(){this.providerId=A.PROVIDER_ID}static credential(I,N){return No._fromEmailAndPassword(I,N)}static credentialWithLink(I,N){const we=Ho.parseLink(N);return U(we,"argument-error"),No._fromEmailAndCode(I,we.code,we.tenantId)}}return A.PROVIDER_ID="password",A.EMAIL_PASSWORD_SIGN_IN_METHOD="password",A.EMAIL_LINK_SIGN_IN_METHOD="emailLink",A})();class Es{constructor(b){this.providerId=b,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(b){this.defaultLanguageCode=b}setCustomParameters(b){return this.customParameters=b,this}getCustomParameters(){return this.customParameters}}class is extends Es{constructor(){super(...arguments),this.scopes=[]}addScope(b){return this.scopes.includes(b)||this.scopes.push(b),this}getScopes(){return[...this.scopes]}}class po extends is{static credentialFromJSON(b){const I="string"==typeof b?JSON.parse(b):b;return U("providerId"in I&&"signInMethod"in I,"argument-error"),rs._fromParams(I)}credential(b){return this._credential(Object.assign(Object.assign({},b),{nonce:b.rawNonce}))}_credential(b){return U(b.idToken||b.accessToken,"argument-error"),rs._fromParams(Object.assign(Object.assign({},b),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(b){return po.oauthCredentialFromTaggedObject(b)}static credentialFromError(b){return po.oauthCredentialFromTaggedObject(b.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{oauthIdToken:I,oauthAccessToken:N,oauthTokenSecret:we,pendingToken:lt,nonce:Yt,providerId:In}=b;if(!N&&!we&&!I&&!lt||!In)return null;try{return new po(In)._credential({idToken:I,accessToken:N,nonce:Yt,pendingToken:lt})}catch(ar){return null}}}let Ni=(()=>{class A extends is{constructor(){super("facebook.com")}static credential(I){return rs._fromParams({providerId:A.PROVIDER_ID,signInMethod:A.FACEBOOK_SIGN_IN_METHOD,accessToken:I})}static credentialFromResult(I){return A.credentialFromTaggedObject(I)}static credentialFromError(I){return A.credentialFromTaggedObject(I.customData||{})}static credentialFromTaggedObject({_tokenResponse:I}){if(!I||!("oauthAccessToken"in I)||!I.oauthAccessToken)return null;try{return A.credential(I.oauthAccessToken)}catch(N){return null}}}return A.FACEBOOK_SIGN_IN_METHOD="facebook.com",A.PROVIDER_ID="facebook.com",A})(),Uo=(()=>{class A extends is{constructor(){super("google.com"),this.addScope("profile")}static credential(I,N){return rs._fromParams({providerId:A.PROVIDER_ID,signInMethod:A.GOOGLE_SIGN_IN_METHOD,idToken:I,accessToken:N})}static credentialFromResult(I){return A.credentialFromTaggedObject(I)}static credentialFromError(I){return A.credentialFromTaggedObject(I.customData||{})}static credentialFromTaggedObject({_tokenResponse:I}){if(!I)return null;const{oauthIdToken:N,oauthAccessToken:we}=I;if(!N&&!we)return null;try{return A.credential(N,we)}catch(lt){return null}}}return A.GOOGLE_SIGN_IN_METHOD="google.com",A.PROVIDER_ID="google.com",A})(),el=(()=>{class A extends is{constructor(){super("github.com")}static credential(I){return rs._fromParams({providerId:A.PROVIDER_ID,signInMethod:A.GITHUB_SIGN_IN_METHOD,accessToken:I})}static credentialFromResult(I){return A.credentialFromTaggedObject(I)}static credentialFromError(I){return A.credentialFromTaggedObject(I.customData||{})}static credentialFromTaggedObject({_tokenResponse:I}){if(!I||!("oauthAccessToken"in I)||!I.oauthAccessToken)return null;try{return A.credential(I.oauthAccessToken)}catch(N){return null}}}return A.GITHUB_SIGN_IN_METHOD="github.com",A.PROVIDER_ID="github.com",A})();class uu extends Mr{constructor(b,I){super(b,b),this.pendingToken=I}_getIdTokenResponse(b){return mi(b,this.buildRequest())}_linkToIdToken(b,I){const N=this.buildRequest();return N.idToken=I,mi(b,N)}_getReauthenticationResolver(b){const I=this.buildRequest();return I.autoCreate=!1,mi(b,I)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(b){const I="string"==typeof b?JSON.parse(b):b,{providerId:N,signInMethod:we,pendingToken:lt}=I;return N&&we&&lt&&N===we?new uu(N,lt):null}static _create(b,I){return new uu(b,I)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Gs extends Es{constructor(b){U(b.startsWith("saml."),"argument-error"),super(b)}static credentialFromResult(b){return Gs.samlCredentialFromTaggedObject(b)}static credentialFromError(b){return Gs.samlCredentialFromTaggedObject(b.customData||{})}static credentialFromJSON(b){const I=uu.fromJSON(b);return U(I,"argument-error"),I}static samlCredentialFromTaggedObject({_tokenResponse:b}){if(!b)return null;const{pendingToken:I,providerId:N}=b;if(!I||!N)return null;try{return uu._create(N,I)}catch(we){return null}}}let os=(()=>{class A extends is{constructor(){super("twitter.com")}static credential(I,N){return rs._fromParams({providerId:A.PROVIDER_ID,signInMethod:A.TWITTER_SIGN_IN_METHOD,oauthToken:I,oauthTokenSecret:N})}static credentialFromResult(I){return A.credentialFromTaggedObject(I)}static credentialFromError(I){return A.credentialFromTaggedObject(I.customData||{})}static credentialFromTaggedObject({_tokenResponse:I}){if(!I)return null;const{oauthAccessToken:N,oauthTokenSecret:we}=I;if(!N||!we)return null;try{return A.credential(N,we)}catch(lt){return null}}}return A.TWITTER_SIGN_IN_METHOD="twitter.com",A.PROVIDER_ID="twitter.com",A})();function qs(A,b){return so.apply(this,arguments)}function so(){return(so=(0,w.Z)(function*(A,b){return ii(A,"POST","/v1/accounts:signUp",Er(A,b))})).apply(this,arguments)}class ss{constructor(b){this.user=b.user,this.providerId=b.providerId,this._tokenResponse=b._tokenResponse,this.operationType=b.operationType}static _fromIdTokenResponse(b,I,N,we=!1){return(0,w.Z)(function*(){const lt=yield Oe._fromIdTokenResponse(b,N,we),Yt=Su(N);return new ss({user:lt,providerId:Yt,_tokenResponse:N,operationType:I})})()}static _forOperation(b,I,N){return(0,w.Z)(function*(){yield b._updateTokensIfNecessary(N,!0);const we=Su(N);return new ss({user:b,providerId:we,_tokenResponse:N,operationType:I})})()}}function Su(A){return A.providerId?A.providerId:"phoneNumber"in A?"phone":null}function Ds(){return(Ds=(0,w.Z)(function*(A){var b;const I=yn(A);if(yield I._initializationPromise,null===(b=I.currentUser)||void 0===b?void 0:b.isAnonymous)return new ss({user:I.currentUser,providerId:null,operationType:"signIn"});const N=yield qs(I,{returnSecureToken:!0}),we=yield ss._fromIdTokenResponse(I,"signIn",N,!0);return yield I._updateCurrentUser(we.user),we})).apply(this,arguments)}class qa extends g.ZR{constructor(b,I,N,we){var lt;super(I.code,I.message),this.operationType=N,this.user=we,Object.setPrototypeOf(this,qa.prototype),this.customData={appName:b.name,tenantId:null!==(lt=b.tenantId)&&void 0!==lt?lt:void 0,_serverResponse:I.customData._serverResponse,operationType:N}}static _fromErrorAndOperation(b,I,N,we){return new qa(b,I,N,we)}}function eo(A,b,I,N){return("reauthenticate"===b?I._getReauthenticationResolver(A):I._getIdTokenResponse(A)).catch(lt=>{throw"auth/multi-factor-auth-required"===lt.code?qa._fromErrorAndOperation(A,lt,b,N):lt})}function Cu(A){return new Set(A.map(({providerId:b})=>b).filter(b=>!!b))}function Jo(){return(Jo=(0,w.Z)(function*(A,b){const I=(0,g.m9)(A);yield qe(!0,I,b);const{providerUserInfo:N}=yield En(I.auth,{idToken:yield I.getIdToken(),deleteProvider:[b]}),we=Cu(N||[]);return I.providerData=I.providerData.filter(lt=>we.has(lt.providerId)),we.has("phone")||(I.phoneNumber=null),yield I.auth._persistUserIfCurrent(I),I})).apply(this,arguments)}function qr(A,b){return oe.apply(this,arguments)}function oe(){return(oe=(0,w.Z)(function*(A,b,I=!1){const N=yield Jn(A,b._linkToIdToken(A.auth,yield A.getIdToken()),I);return ss._forOperation(A,"link",N)})).apply(this,arguments)}function qe(A,b,I){return ne.apply(this,arguments)}function ne(){return(ne=(0,w.Z)(function*(A,b,I){yield Ht(b);const we=!1===A?"provider-already-linked":"no-such-provider";U(Cu(b.providerData).has(I)===A,b.auth,we)})).apply(this,arguments)}function et(A,b){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,w.Z)(function*(A,b,I=!1){const{auth:N}=A,we="reauthenticate";try{const lt=yield Jn(A,eo(N,we,b,A),I);U(lt.idToken,N,"internal-error");const Yt=sn(lt.idToken);U(Yt,N,"internal-error");const{sub:In}=Yt;return U(A.uid===In,N,"user-mismatch"),ss._forOperation(A,we,lt)}catch(lt){throw"auth/user-not-found"===(null==lt?void 0:lt.code)&&Ae(N,"user-mismatch"),lt}})).apply(this,arguments)}function vn(A,b){return On.apply(this,arguments)}function On(){return(On=(0,w.Z)(function*(A,b,I=!1){const N="signIn",we=yield eo(A,N,b),lt=yield ss._fromIdTokenResponse(A,N,we);return I||(yield A._updateCurrentUser(lt.user)),lt})).apply(this,arguments)}function er(A,b){return Hr.apply(this,arguments)}function Hr(){return(Hr=(0,w.Z)(function*(A,b){return vn(yn(A),b)})).apply(this,arguments)}function li(A,b){return ni.apply(this,arguments)}function ni(){return(ni=(0,w.Z)(function*(A,b){const I=(0,g.m9)(A);return yield qe(!1,I,b.providerId),qr(I,b)})).apply(this,arguments)}function Qr(A,b){return mo.apply(this,arguments)}function mo(){return(mo=(0,w.Z)(function*(A,b){return et((0,g.m9)(A),b)})).apply(this,arguments)}function Vi(A,b){return Di.apply(this,arguments)}function Di(){return(Di=(0,w.Z)(function*(A,b){return ii(A,"POST","/v1/accounts:signInWithCustomToken",Er(A,b))})).apply(this,arguments)}function go(){return(go=(0,w.Z)(function*(A,b){const I=yn(A),N=yield Vi(I,{token:b,returnSecureToken:!0}),we=yield ss._fromIdTokenResponse(I,"signIn",N);return yield I._updateCurrentUser(we.user),we})).apply(this,arguments)}class Rr{constructor(b,I){this.factorId=b,this.uid=I.mfaEnrollmentId,this.enrollmentTime=new Date(I.enrolledAt).toUTCString(),this.displayName=I.displayName}static _fromServerResponse(b,I){return"phoneInfo"in I?ra._fromServerResponse(b,I):Ae(b,"internal-error")}}class ra extends Rr{constructor(b){super("phone",b),this.phoneNumber=b.phoneInfo}static _fromServerResponse(b,I){return new ra(I)}}function La(A,b,I){var N;U((null===(N=I.url)||void 0===N?void 0:N.length)>0,A,"invalid-continue-uri"),U(void 0===I.dynamicLinkDomain||I.dynamicLinkDomain.length>0,A,"invalid-dynamic-link-domain"),b.continueUrl=I.url,b.dynamicLinkDomain=I.dynamicLinkDomain,b.canHandleCodeInApp=I.handleCodeInApp,I.iOS&&(U(I.iOS.bundleId.length>0,A,"missing-ios-bundle-id"),b.iOSBundleId=I.iOS.bundleId),I.android&&(U(I.android.packageName.length>0,A,"missing-android-pkg-name"),b.androidInstallApp=I.android.installApp,b.androidMinimumVersionCode=I.android.minimumVersion,b.androidPackageName=I.android.packageName)}function Fs(){return(Fs=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A),we={requestType:"PASSWORD_RESET",email:b};I&&La(N,we,I),yield ds(N,we)})).apply(this,arguments)}function Xo(){return(Xo=(0,w.Z)(function*(A,b,I){yield Gr((0,g.m9)(A),{oobCode:b,newPassword:I})})).apply(this,arguments)}function Nn(){return(Nn=(0,w.Z)(function*(A,b){yield Yi((0,g.m9)(A),{oobCode:b})})).apply(this,arguments)}function Cr(A,b){return Fa.apply(this,arguments)}function Fa(){return(Fa=(0,w.Z)(function*(A,b){const I=(0,g.m9)(A),N=yield Gr(I,{oobCode:b}),we=N.requestType;switch(U(we,I,"internal-error"),we){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":U(N.newEmail,I,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":U(N.mfaInfo,I,"internal-error");default:U(N.email,I,"internal-error")}let lt=null;return N.mfaInfo&&(lt=Rr._fromServerResponse(yn(I),N.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===N.requestType?N.newEmail:N.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===N.requestType?N.email:N.newEmail)||null,multiFactorInfo:lt},operation:we}})).apply(this,arguments)}function Ws(){return(Ws=(0,w.Z)(function*(A,b){const{data:I}=yield Cr((0,g.m9)(A),b);return I.email})).apply(this,arguments)}function as(){return(as=(0,w.Z)(function*(A,b,I){const N=yn(A),we=yield qs(N,{returnSecureToken:!0,email:b,password:I}),lt=yield ss._fromIdTokenResponse(N,"signIn",we);return yield N._updateCurrentUser(lt.user),lt})).apply(this,arguments)}function Du(){return(Du=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A),we={requestType:"EMAIL_SIGNIN",email:b};U(I.handleCodeInApp,N,"argument-error"),I&&La(N,we,I),yield fo(N,we)})).apply(this,arguments)}function As(){return(As=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A),we=Cs.credentialWithLink(b,I||_t());return U(we._tenantId===(N.tenantId||null),N,"tenant-id-mismatch"),er(N,we)})).apply(this,arguments)}function yo(A,b){return Bs.apply(this,arguments)}function Bs(){return(Bs=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:createAuthUri",Er(A,b))})).apply(this,arguments)}function Eo(){return(Eo=(0,w.Z)(function*(A,b){const N={identifier:b,continueUri:ft()?_t():"http://localhost"},{signinMethods:we}=yield yo((0,g.m9)(A),N);return we||[]})).apply(this,arguments)}function Au(){return(Au=(0,w.Z)(function*(A,b){const I=(0,g.m9)(A),we={requestType:"VERIFY_EMAIL",idToken:yield A.getIdToken()};b&&La(I.auth,we,b);const{email:lt}=yield zi(I.auth,we);lt!==A.email&&(yield A.reload())})).apply(this,arguments)}function ia(){return(ia=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A),lt={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield A.getIdToken(),newEmail:b};I&&La(N.auth,lt,I);const{email:Yt}=yield ou(N.auth,lt);Yt!==A.email&&(yield A.reload())})).apply(this,arguments)}function Hu(A,b){return _a.apply(this,arguments)}function _a(){return(_a=(0,w.Z)(function*(A,b){return Sr(A,"POST","/v1/accounts:update",b)})).apply(this,arguments)}function va(){return(va=(0,w.Z)(function*(A,{displayName:b,photoURL:I}){if(void 0===b&&void 0===I)return;const N=(0,g.m9)(A),lt={idToken:yield N.getIdToken(),displayName:b,photoUrl:I,returnSecureToken:!0},Yt=yield Jn(N,Hu(N.auth,lt));N.displayName=Yt.displayName||null,N.photoURL=Yt.photoUrl||null;const In=N.providerData.find(({providerId:ar})=>"password"===ar);In&&(In.displayName=N.displayName,In.photoURL=N.photoURL),yield N._updateTokensIfNecessary(Yt)})).apply(this,arguments)}function Ms(A,b,I){return ba.apply(this,arguments)}function ba(){return(ba=(0,w.Z)(function*(A,b,I){const{auth:N}=A,lt={idToken:yield A.getIdToken(),returnSecureToken:!0};b&&(lt.email=b),I&&(lt.password=I);const Yt=yield Jn(A,Vr(N,lt));yield A._updateTokensIfNecessary(Yt,!0)})).apply(this,arguments)}class us{constructor(b,I,N={}){this.isNewUser=b,this.providerId=I,this.profile=N}}class rl extends us{constructor(b,I,N,we){super(b,I,N),this.username=we}}class fl extends us{constructor(b,I){super(b,"facebook.com",I)}}class lu extends rl{constructor(b,I){super(b,"github.com",I,"string"==typeof(null==I?void 0:I.login)?null==I?void 0:I.login:null)}}class oa extends us{constructor(b,I){super(b,"google.com",I)}}class kl extends rl{constructor(b,I,N){super(b,"twitter.com",I,N)}}function To(A){const{user:b,_tokenResponse:I}=A;return b.isAnonymous&&!I?{providerId:null,isNewUser:!1,profile:null}:function nl(A){var b,I;if(!A)return null;const{providerId:N}=A,we=A.rawUserInfo?JSON.parse(A.rawUserInfo):{},lt=A.isNewUser||"identitytoolkit#SignupNewUserResponse"===A.kind;if(!N&&(null==A?void 0:A.idToken)){const Yt=null===(I=null===(b=sn(A.idToken))||void 0===b?void 0:b.firebase)||void 0===I?void 0:I.sign_in_provider;if(Yt)return new us(lt,"anonymous"!==Yt&&"custom"!==Yt?Yt:null)}if(!N)return null;switch(N){case"facebook.com":return new fl(lt,we);case"github.com":return new lu(lt,we);case"google.com":return new oa(lt,we);case"twitter.com":return new kl(lt,we,A.screenName||null);case"custom":case"anonymous":return new us(lt,null);default:return new us(lt,N,we)}}(I)}class Ge{constructor(b,I){this.type=b,this.credential=I}static _fromIdtoken(b){return new Ge("enroll",b)}static _fromMfaPendingCredential(b){return new Ge("signin",b)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(b){var I,N;if(null==b?void 0:b.multiFactorSession){if(null===(I=b.multiFactorSession)||void 0===I?void 0:I.pendingCredential)return Ge._fromMfaPendingCredential(b.multiFactorSession.pendingCredential);if(null===(N=b.multiFactorSession)||void 0===N?void 0:N.idToken)return Ge._fromIdtoken(b.multiFactorSession.idToken)}return null}}class Ze{constructor(b,I,N){this.session=b,this.hints=I,this.signInResolver=N}static _fromError(b,I){const N=yn(b),we=I.customData._serverResponse,lt=(we.mfaInfo||[]).map(In=>Rr._fromServerResponse(N,In));U(we.mfaPendingCredential,N,"internal-error");const Yt=Ge._fromMfaPendingCredential(we.mfaPendingCredential);return new Ze(Yt,lt,function(){var In=(0,w.Z)(function*(ar){const Lr=yield ar._process(N,Yt);delete we.mfaInfo,delete we.mfaPendingCredential;const ai=Object.assign(Object.assign({},we),{idToken:Lr.idToken,refreshToken:Lr.refreshToken});switch(I.operationType){case"signIn":const Xr=yield ss._fromIdTokenResponse(N,I.operationType,ai);return yield N._updateCurrentUser(Xr.user),Xr;case"reauthenticate":return U(I.user,N,"internal-error"),ss._forOperation(I.user,I.operationType,ai);default:Ae(N,"internal-error")}});return function(ar){return In.apply(this,arguments)}}())}resolveSignIn(b){var I=this;return(0,w.Z)(function*(){return I.signInResolver(b)})()}}function $t(A,b){return Sr(A,"POST","/v2/accounts/mfaEnrollment:start",Er(A,b))}class or{constructor(b){this.user=b,this.enrolledFactors=[],b._onReload(I=>{I.mfaInfo&&(this.enrolledFactors=I.mfaInfo.map(N=>Rr._fromServerResponse(b.auth,N)))})}static _fromUser(b){return new or(b)}getSession(){var b=this;return(0,w.Z)(function*(){return Ge._fromIdtoken(yield b.user.getIdToken())})()}enroll(b,I){var N=this;return(0,w.Z)(function*(){const we=b,lt=yield N.getSession(),Yt=yield Jn(N.user,we._process(N.user.auth,lt,I));return yield N.user._updateTokensIfNecessary(Yt),N.user.reload()})()}unenroll(b){var I=this;return(0,w.Z)(function*(){const N="string"==typeof b?b:b.uid,we=yield I.user.getIdToken(),lt=yield Jn(I.user,function on(A,b){return Sr(A,"POST","/v2/accounts/mfaEnrollment:withdraw",Er(A,b))}(I.user.auth,{idToken:we,mfaEnrollmentId:N}));I.enrolledFactors=I.enrolledFactors.filter(({uid:Yt})=>Yt!==N),yield I.user._updateTokensIfNecessary(lt);try{yield I.user.reload()}catch(Yt){if("auth/user-token-expired"!==Yt.code)throw Yt}})()}}const Gn=new WeakMap,gi="__sak";class Yr{constructor(b,I){this.storageRetriever=b,this.type=I}_isAvailable(){try{return this.storage?(this.storage.setItem(gi,"1"),this.storage.removeItem(gi),Promise.resolve(!0)):Promise.resolve(!1)}catch(b){return Promise.resolve(!1)}}_set(b,I){return this.storage.setItem(b,JSON.stringify(I)),Promise.resolve()}_get(b){const I=this.storage.getItem(b);return Promise.resolve(I?JSON.parse(I):null)}_remove(b){return this.storage.removeItem(b),Promise.resolve()}get storage(){return this.storageRetriever()}}const wa=(()=>{class A extends Yr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(I,N)=>this.onStorageEvent(I,N),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function tr(){const A=(0,g.z$)();return ze(A)||zn(A)}()&&function Ir(){try{return!(!window||window===window.top)}catch(A){return!1}}(),this.fallbackToPolling=Hn(),this._shouldAllowMigration=!0}forAllChangedKeys(I){for(const N of Object.keys(this.listeners)){const we=this.storage.getItem(N),lt=this.localCache[N];we!==lt&&I(N,lt,we)}}onStorageEvent(I,N=!1){if(!I.key)return void this.forAllChangedKeys((In,ar,Lr)=>{this.notifyListeners(In,Lr)});const we=I.key;if(N?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const In=this.storage.getItem(we);if(I.newValue!==In)null!==I.newValue?this.storage.setItem(we,I.newValue):this.storage.removeItem(we);else if(this.localCache[we]===I.newValue&&!N)return}const lt=()=>{const In=this.storage.getItem(we);!N&&this.localCache[we]===In||this.notifyListeners(we,In)},Yt=this.storage.getItem(we);!function Yn(){return(0,g.w1)()&&10===document.documentMode}()||Yt===I.newValue||I.newValue===I.oldValue?lt():setTimeout(lt,10)}notifyListeners(I,N){this.localCache[I]=N;const we=this.listeners[I];if(we)for(const lt of Array.from(we))lt(N&&JSON.parse(N))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((I,N,we)=>{this.onStorageEvent(new StorageEvent("storage",{key:I,oldValue:N,newValue:we}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(I,N){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[I]||(this.listeners[I]=new Set,this.localCache[I]=this.storage.getItem(I)),this.listeners[I].add(N)}_removeListener(I,N){this.listeners[I]&&(this.listeners[I].delete(N),0===this.listeners[I].size&&delete this.listeners[I]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(I,N){var we=()=>super._set,lt=this;return(0,w.Z)(function*(){yield we().call(lt,I,N),lt.localCache[I]=JSON.stringify(N)})()}_get(I){var N=()=>super._get,we=this;return(0,w.Z)(function*(){const lt=yield N().call(we,I);return we.localCache[I]=JSON.stringify(lt),lt})()}_remove(I){var N=()=>super._remove,we=this;return(0,w.Z)(function*(){yield N().call(we,I),delete we.localCache[I]})()}}return A.type="LOCAL",A})(),Ba=(()=>{class A extends Yr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(I,N){}_removeListener(I,N){}}return A.type="SESSION",A})();let Gu=(()=>{class A{constructor(I){this.eventTarget=I,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(I){const N=this.receivers.find(lt=>lt.isListeningto(I));if(N)return N;const we=new A(I);return this.receivers.push(we),we}isListeningto(I){return this.eventTarget===I}handleEvent(I){var N=this;return(0,w.Z)(function*(){const we=I,{eventId:lt,eventType:Yt,data:In}=we.data,ar=N.handlersMap[Yt];if(!(null==ar?void 0:ar.size))return;we.ports[0].postMessage({status:"ack",eventId:lt,eventType:Yt});const Lr=Array.from(ar).map(function(){var Xr=(0,w.Z)(function*(Qs){return Qs(we.origin,In)});return function(Qs){return Xr.apply(this,arguments)}}()),ai=yield function rr(A){return Promise.all(A.map(function(){var b=(0,w.Z)(function*(I){try{return{fulfilled:!0,value:yield I}}catch(N){return{fulfilled:!1,reason:N}}});return function(I){return b.apply(this,arguments)}}()))}(Lr);we.ports[0].postMessage({status:"done",eventId:lt,eventType:Yt,response:ai})})()}_subscribe(I,N){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[I]||(this.handlersMap[I]=new Set),this.handlersMap[I].add(N)}_unsubscribe(I,N){this.handlersMap[I]&&N&&this.handlersMap[I].delete(N),(!N||0===this.handlersMap[I].size)&&delete this.handlersMap[I],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return A.receivers=[],A})();function cu(A="",b=10){let I="";for(let N=0;N<b;N++)I+=Math.floor(10*Math.random());return A+I}class Ol{constructor(b){this.target=b,this.handlers=new Set}removeMessageHandler(b){b.messageChannel&&(b.messageChannel.port1.removeEventListener("message",b.onMessage),b.messageChannel.port1.close()),this.handlers.delete(b)}_send(b,I,N=50){var we=this;return(0,w.Z)(function*(){const lt="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!lt)throw new Error("connection_unavailable");let Yt,In;return new Promise((ar,Lr)=>{const ai=cu("",20);lt.port1.start();const Xr=setTimeout(()=>{Lr(new Error("unsupported_event"))},N);In={messageChannel:lt,onMessage(Qs){const Un=Qs;if(Un.data.eventId===ai)switch(Un.data.status){case"ack":clearTimeout(Xr),Yt=setTimeout(()=>{Lr(new Error("timeout"))},3e3);break;case"done":clearTimeout(Yt),ar(Un.data.response);break;default:clearTimeout(Xr),clearTimeout(Yt),Lr(new Error("invalid_response"))}}},we.handlers.add(In),lt.port1.addEventListener("message",In.onMessage),we.target.postMessage({eventType:b,eventId:ai,data:I},[lt.port2])}).finally(()=>{In&&we.removeMessageHandler(In)})})()}}function Ri(){return window}function Zs(){return void 0!==Ri().WorkerGlobalScope&&"function"==typeof Ri().importScripts}function Qo(){return(Qo=(0,w.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(A){return null}})).apply(this,arguments)}const aa="firebaseLocalStorageDb",il="firebaseLocalStorage",Zn="fbase_key";class Mi{constructor(b){this.request=b}toPromise(){return new Promise((b,I)=>{this.request.addEventListener("success",()=>{b(this.request.result)}),this.request.addEventListener("error",()=>{I(this.request.error)})})}}function V(A,b){return A.transaction([il],b?"readwrite":"readonly").objectStore(il)}function M(){const A=indexedDB.open(aa,1);return new Promise((b,I)=>{A.addEventListener("error",()=>{I(A.error)}),A.addEventListener("upgradeneeded",()=>{const N=A.result;try{N.createObjectStore(il,{keyPath:Zn})}catch(we){I(we)}}),A.addEventListener("success",(0,w.Z)(function*(){const N=A.result;N.objectStoreNames.contains(il)?b(N):(N.close(),yield function F(){const A=indexedDB.deleteDatabase(aa);return new Mi(A).toPromise()}(),b(yield M()))}))})}function J(A,b,I){return ye.apply(this,arguments)}function ye(){return(ye=(0,w.Z)(function*(A,b,I){const N=V(A,!0).put({[Zn]:b,value:I});return new Mi(N).toPromise()})).apply(this,arguments)}function Ne(){return(Ne=(0,w.Z)(function*(A,b){const I=V(A,!1).get(b),N=yield new Mi(I).toPromise();return void 0===N?null:N.value})).apply(this,arguments)}function at(A,b){const I=V(A,!0).delete(b);return new Mi(I).toPromise()}const Pr=(()=>{class A{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var I=this;return(0,w.Z)(function*(){return I.db||(I.db=yield M()),I.db})()}_withRetries(I){var N=this;return(0,w.Z)(function*(){let we=0;for(;;)try{const lt=yield N._openDb();return yield I(lt)}catch(lt){if(we++>3)throw lt;N.db&&(N.db.close(),N.db=void 0)}})()}initializeServiceWorkerMessaging(){var I=this;return(0,w.Z)(function*(){return Zs()?I.initializeReceiver():I.initializeSender()})()}initializeReceiver(){var I=this;return(0,w.Z)(function*(){I.receiver=Gu._getInstance(function hu(){return Zs()?self:null}()),I.receiver._subscribe("keyChanged",function(){var N=(0,w.Z)(function*(we,lt){return{keyProcessed:(yield I._poll()).includes(lt.key)}});return function(we,lt){return N.apply(this,arguments)}}()),I.receiver._subscribe("ping",function(){var N=(0,w.Z)(function*(we,lt){return["keyChanged"]});return function(we,lt){return N.apply(this,arguments)}}())})()}initializeSender(){var I=this;return(0,w.Z)(function*(){var N,we;if(I.activeServiceWorker=yield function qu(){return Qo.apply(this,arguments)}(),!I.activeServiceWorker)return;I.sender=new Ol(I.activeServiceWorker);const lt=yield I.sender._send("ping",{},800);!lt||(null===(N=lt[0])||void 0===N?void 0:N.fulfilled)&&(null===(we=lt[0])||void 0===we?void 0:we.value.includes("keyChanged"))&&(I.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(I){var N=this;return(0,w.Z)(function*(){if(N.sender&&N.activeServiceWorker&&function So(){var A;return(null===(A=null==navigator?void 0:navigator.serviceWorker)||void 0===A?void 0:A.controller)||null}()===N.activeServiceWorker)try{yield N.sender._send("keyChanged",{key:I},N.serviceWorkerReceiverAvailable?800:50)}catch(we){}})()}_isAvailable(){return(0,w.Z)(function*(){try{if(!indexedDB)return!1;const I=yield M();return yield J(I,gi,"1"),yield at(I,gi),!0}catch(I){}return!1})()}_withPendingWrite(I){var N=this;return(0,w.Z)(function*(){N.pendingWrites++;try{yield I()}finally{N.pendingWrites--}})()}_set(I,N){var we=this;return(0,w.Z)(function*(){return we._withPendingWrite((0,w.Z)(function*(){return yield we._withRetries(lt=>J(lt,I,N)),we.localCache[I]=N,we.notifyServiceWorker(I)}))})()}_get(I){var N=this;return(0,w.Z)(function*(){const we=yield N._withRetries(lt=>function De(A,b){return Ne.apply(this,arguments)}(lt,I));return N.localCache[I]=we,we})()}_remove(I){var N=this;return(0,w.Z)(function*(){return N._withPendingWrite((0,w.Z)(function*(){return yield N._withRetries(we=>at(we,I)),delete N.localCache[I],N.notifyServiceWorker(I)}))})()}_poll(){var I=this;return(0,w.Z)(function*(){const N=yield I._withRetries(Yt=>{const In=V(Yt,!1).getAll();return new Mi(In).toPromise()});if(!N)return[];if(0!==I.pendingWrites)return[];const we=[],lt=new Set;for(const{fbase_key:Yt,value:In}of N)lt.add(Yt),JSON.stringify(I.localCache[Yt])!==JSON.stringify(In)&&(I.notifyListeners(Yt,In),we.push(Yt));for(const Yt of Object.keys(I.localCache))I.localCache[Yt]&&!lt.has(Yt)&&(I.notifyListeners(Yt,null),we.push(Yt));return we})()}notifyListeners(I,N){this.localCache[I]=N;const we=this.listeners[I];if(we)for(const lt of Array.from(we))lt(N)}startPolling(){var I=this;this.stopPolling(),this.pollTimer=setInterval((0,w.Z)(function*(){return I._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(I,N){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[I]||(this.listeners[I]=new Set,this._get(I)),this.listeners[I].add(N)}_removeListener(I,N){this.listeners[I]&&(this.listeners[I].delete(N),0===this.listeners[I].size&&delete this.listeners[I]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return A.type="LOCAL",A})();function si(A,b){return Sr(A,"POST","/v2/accounts/mfaSignIn:start",Er(A,b))}function Co(){return(Co=(0,w.Z)(function*(A){return(yield Sr(A,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ea(A){return new Promise((b,I)=>{const N=document.createElement("script");N.setAttribute("src",A),N.onload=b,N.onerror=we=>{const lt=j("internal-error");lt.customData=we,I(lt)},N.type="text/javascript",N.charset="UTF-8",function xa(){var A,b;return null!==(b=null===(A=document.getElementsByTagName("head"))||void 0===A?void 0:A[0])&&void 0!==b?b:document}().appendChild(N)})}function Wr(A){return`__${A}${Math.floor(1e6*Math.random())}`}const Jr=1e12;class du{constructor(b){this.auth=b,this.counter=Jr,this._widgets=new Map}render(b,I){const N=this.counter;return this._widgets.set(N,new Pu(b,this.auth.name,I||{})),this.counter++,N}reset(b){var I;const N=b||Jr;null===(I=this._widgets.get(N))||void 0===I||I.delete(),this._widgets.delete(N)}getResponse(b){var I;return(null===(I=this._widgets.get(b||Jr))||void 0===I?void 0:I.getResponse())||""}execute(b){var I=this;return(0,w.Z)(function*(){var N;return null===(N=I._widgets.get(b||Jr))||void 0===N||N.execute(),""})()}}class Pu{constructor(b,I,N){this.params=N,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const we="string"==typeof b?document.getElementById(b):b;U(we,"argument-error",{appName:I}),this.container=we,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function ji(A){const b=[],I="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let N=0;N<A;N++)b.push(I.charAt(Math.floor(Math.random()*I.length)));return b.join("")}(50);const{callback:b,"expired-callback":I}=this.params;if(b)try{b(this.responseToken)}catch(N){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,I)try{I()}catch(N){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const ei=Wr("rcb"),Ja=new An(3e4,6e4);class Ll{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Ri().grecaptcha}load(b,I=""){return U(function wl(A){return A.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(A)}(I),b,"argument-error"),this.shouldResolveImmediately(I)?Promise.resolve(Ri().grecaptcha):new Promise((N,we)=>{const lt=Ri().setTimeout(()=>{we(j(b,"network-request-failed"))},Ja.get());Ri()[ei]=()=>{Ri().clearTimeout(lt),delete Ri()[ei];const In=Ri().grecaptcha;if(!In)return void we(j(b,"internal-error"));const ar=In.render;In.render=(Lr,ai)=>{const Xr=ar(Lr,ai);return this.counter++,Xr},this.hostLanguage=I,N(In)},Ea(`https://www.google.com/recaptcha/api.js??${(0,g.xO)({onload:ei,render:"explicit",hl:I})}`).catch(()=>{clearTimeout(lt),we(j(b,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(b){return!!Ri().grecaptcha&&(b===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class uo{load(b){return(0,w.Z)(function*(){return new du(b)})()}clearedOneInstance(){}}const Nl="recaptcha",es={theme:"light",type:"image"};class pl{constructor(b,I=Object.assign({},es),N){this.parameters=I,this.type=Nl,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=yn(N),this.isInvisible="invisible"===this.parameters.size,U("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const we="string"==typeof b?document.getElementById(b):b;U(we,this.auth,"argument-error"),this.container=we,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new uo:new Ll,this.validateStartingState()}verify(){var b=this;return(0,w.Z)(function*(){b.assertNotDestroyed();const I=yield b.render(),N=b.getAssertedRecaptcha();return N.getResponse(I)||new Promise(lt=>{const Yt=In=>{!In||(b.tokenChangeListeners.delete(Yt),lt(In))};b.tokenChangeListeners.add(Yt),b.isInvisible&&N.execute(I)})})()}render(){try{this.assertNotDestroyed()}catch(b){return Promise.reject(b)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(b=>{throw this.renderPromise=null,b})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(b=>{this.container.removeChild(b)})}validateStartingState(){U(!this.parameters.sitekey,this.auth,"argument-error"),U(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),U("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(b){return I=>{if(this.tokenChangeListeners.forEach(N=>N(I)),"function"==typeof b)b(I);else if("string"==typeof b){const N=Ri()[b];"function"==typeof N&&N(I)}}}assertNotDestroyed(){U(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var b=this;return(0,w.Z)(function*(){if(yield b.init(),!b.widgetId){let I=b.container;if(!b.isInvisible){const N=document.createElement("div");I.appendChild(N),I=N}b.widgetId=b.getAssertedRecaptcha().render(I,b.parameters)}return b.widgetId})()}init(){var b=this;return(0,w.Z)(function*(){U(ft()&&!Zs(),b.auth,"internal-error"),yield function xl(){let A=null;return new Promise(b=>{"complete"!==document.readyState?(A=()=>b(),window.addEventListener("load",A)):b()}).catch(b=>{throw A&&window.removeEventListener("load",A),b})}(),b.recaptcha=yield b._recaptchaLoader.load(b.auth,b.auth.languageCode||void 0);const I=yield function Ro(A){return Co.apply(this,arguments)}(b.auth);U(I,b.auth,"internal-error"),b.parameters.sitekey=I})()}getAssertedRecaptcha(){return U(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class no{constructor(b,I){this.verificationId=b,this.onConfirmation=I}confirm(b){const I=Ss._fromVerification(this.verificationId,b);return this.onConfirmation(I)}}function Wi(){return(Wi=(0,w.Z)(function*(A,b,I){const N=yn(A),we=yield ls(N,b,(0,g.m9)(I));return new no(we,lt=>er(N,lt))})).apply(this,arguments)}function Ua(){return(Ua=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A);yield qe(!1,N,"phone");const we=yield ls(N.auth,b,(0,g.m9)(I));return new no(we,lt=>li(N,lt))})).apply(this,arguments)}function Fl(){return(Fl=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A),we=yield ls(N.auth,b,(0,g.m9)(I));return new no(we,lt=>Qr(N,lt))})).apply(this,arguments)}function ls(A,b,I){return l.apply(this,arguments)}function l(){return(l=(0,w.Z)(function*(A,b,I){var N;const we=yield I.verify();try{let lt;if(U("string"==typeof we,A,"argument-error"),U(I.type===Nl,A,"argument-error"),lt="string"==typeof b?{phoneNumber:b}:b,"session"in lt){const Yt=lt.session;if("phoneNumber"in lt)return U("enroll"===Yt.type,A,"internal-error"),(yield $t(A,{idToken:Yt.credential,phoneEnrollmentInfo:{phoneNumber:lt.phoneNumber,recaptchaToken:we}})).phoneSessionInfo.sessionInfo;{U("signin"===Yt.type,A,"internal-error");const In=(null===(N=lt.multiFactorHint)||void 0===N?void 0:N.uid)||lt.multiFactorUid;return U(In,A,"missing-multi-factor-info"),(yield si(A,{mfaPendingCredential:Yt.credential,mfaEnrollmentId:In,phoneSignInInfo:{recaptchaToken:we}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Yt}=yield Yo(A,{phoneNumber:lt.phoneNumber,recaptchaToken:we});return Yt}}finally{I._reset()}})).apply(this,arguments)}function h(){return(h=(0,w.Z)(function*(A,b){yield qr((0,g.m9)(A),b)})).apply(this,arguments)}let m=(()=>{class A{constructor(I){this.providerId=A.PROVIDER_ID,this.auth=yn(I)}verifyPhoneNumber(I,N){return ls(this.auth,I,(0,g.m9)(N))}static credential(I,N){return Ss._fromVerification(I,N)}static credentialFromResult(I){return A.credentialFromTaggedObject(I)}static credentialFromError(I){return A.credentialFromTaggedObject(I.customData||{})}static credentialFromTaggedObject({_tokenResponse:I}){if(!I)return null;const{phoneNumber:N,temporaryProof:we}=I;return N&&we?Ss._fromTokenResponse(N,we):null}}return A.PROVIDER_ID="phone",A.PHONE_SIGN_IN_METHOD="phone",A})();function E(A,b){return b?_e(b):(U(A._popupRedirectResolver,A,"argument-error"),A._popupRedirectResolver)}class D extends Mr{constructor(b){super("custom","custom"),this.params=b}_getIdTokenResponse(b){return mi(b,this._buildIdpRequest())}_linkToIdToken(b,I){return mi(b,this._buildIdpRequest(I))}_getReauthenticationResolver(b){return mi(b,this._buildIdpRequest())}_buildIdpRequest(b){const I={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return b&&(I.idToken=b),I}}function k(A){return vn(A.auth,new D(A),A.bypassAuthState)}function G(A){const{auth:b,user:I}=A;return U(I,b,"internal-error"),et(I,new D(A),A.bypassAuthState)}function le(A){return Se.apply(this,arguments)}function Se(){return(Se=(0,w.Z)(function*(A){const{auth:b,user:I}=A;return U(I,b,"internal-error"),qr(I,new D(A),A.bypassAuthState)})).apply(this,arguments)}class Ke{constructor(b,I,N,we,lt=!1){this.auth=b,this.resolver=N,this.user=we,this.bypassAuthState=lt,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(I)?I:[I]}execute(){var b=this;return new Promise(function(){var I=(0,w.Z)(function*(N,we){b.pendingPromise={resolve:N,reject:we};try{b.eventManager=yield b.resolver._initialize(b.auth),yield b.onExecution(),b.eventManager.registerConsumer(b)}catch(lt){b.reject(lt)}});return function(N,we){return I.apply(this,arguments)}}())}onAuthEvent(b){var I=this;return(0,w.Z)(function*(){const{urlResponse:N,sessionId:we,postBody:lt,tenantId:Yt,error:In,type:ar}=b;if(In)return void I.reject(In);const Lr={auth:I.auth,requestUri:N,sessionId:we,tenantId:Yt||void 0,postBody:lt||void 0,user:I.user,bypassAuthState:I.bypassAuthState};try{I.resolve(yield I.getIdpTask(ar)(Lr))}catch(ai){I.reject(ai)}})()}onError(b){this.reject(b)}getIdpTask(b){switch(b){case"signInViaPopup":case"signInViaRedirect":return k;case"linkViaPopup":case"linkViaRedirect":return le;case"reauthViaPopup":case"reauthViaRedirect":return G;default:Ae(this.auth,"internal-error")}}resolve(b){ee(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(b),this.unregisterAndCleanUp()}reject(b){ee(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(b),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Xe=new An(2e3,1e4);function xt(){return(xt=(0,w.Z)(function*(A,b,I){const N=yn(A);ge(A,b,Es);const we=E(N,I);return new Bt(N,"signInViaPopup",b,we).executeNotNull()})).apply(this,arguments)}function Pt(){return(Pt=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A);ge(N.auth,b,Es);const we=E(N.auth,I);return new Bt(N.auth,"reauthViaPopup",b,we,N).executeNotNull()})).apply(this,arguments)}function kt(){return(kt=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A);ge(N.auth,b,Es);const we=E(N.auth,I);return new Bt(N.auth,"linkViaPopup",b,we,N).executeNotNull()})).apply(this,arguments)}let Bt=(()=>{class A extends Ke{constructor(I,N,we,lt,Yt){super(I,N,lt,Yt),this.provider=we,this.authWindow=null,this.pollId=null,A.currentPopupAction&&A.currentPopupAction.cancel(),A.currentPopupAction=this}executeNotNull(){var I=this;return(0,w.Z)(function*(){const N=yield I.execute();return U(N,I.auth,"internal-error"),N})()}onExecution(){var I=this;return(0,w.Z)(function*(){ee(1===I.filter.length,"Popup operations only handle one event");const N=cu();I.authWindow=yield I.resolver._openPopup(I.auth,I.provider,I.filter[0],N),I.authWindow.associatedEvent=N,I.resolver._originValidation(I.auth).catch(we=>{I.reject(we)}),I.resolver._isIframeWebStorageSupported(I.auth,we=>{we||I.reject(j(I.auth,"web-storage-unsupported"))}),I.pollUserCancellation()})()}get eventId(){var I;return(null===(I=this.authWindow)||void 0===I?void 0:I.associatedEvent)||null}cancel(){this.reject(j(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,A.currentPopupAction=null}pollUserCancellation(){const I=()=>{var N,we;this.pollId=(null===(we=null===(N=this.authWindow)||void 0===N?void 0:N.window)||void 0===we?void 0:we.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(j(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(I,Xe.get())};I()}}return A.currentPopupAction=null,A})();const tn=new Map;class un extends Ke{constructor(b,I,N=!1){super(b,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],I,void 0,N),this.eventId=null}execute(){var b=()=>super.execute,I=this;return(0,w.Z)(function*(){let N=tn.get(I.auth._key());if(!N){try{const lt=(yield function gn(A,b){return Rn.apply(this,arguments)}(I.resolver,I.auth))?yield b().call(I):null;N=()=>Promise.resolve(lt)}catch(we){N=()=>Promise.reject(we)}tn.set(I.auth._key(),N)}return I.bypassAuthState||tn.set(I.auth._key(),()=>Promise.resolve(null)),N()})()}onAuthEvent(b){var I=()=>super.onAuthEvent,N=this;return(0,w.Z)(function*(){if("signInViaRedirect"===b.type)return I().call(N,b);if("unknown"!==b.type){if(b.eventId){const we=yield N.auth._redirectUserForId(b.eventId);if(we)return N.user=we,I().call(N,b);N.resolve(null)}}else N.resolve(null)})()}onExecution(){return(0,w.Z)(function*(){})()}cleanUp(){}}function Rn(){return(Rn=(0,w.Z)(function*(A,b){const I=Z(b),N=yr(A);if(!(yield N._isAvailable()))return!1;const we="true"===(yield N._get(I));return yield N._remove(I),we})).apply(this,arguments)}function $n(A,b){return Vn.apply(this,arguments)}function Vn(){return(Vn=(0,w.Z)(function*(A,b){return yr(A)._set(Z(b),"true")})).apply(this,arguments)}function yr(A){return _e(A._redirectPersistence)}function Z(A){return Dt("pendingRedirect",A.config.apiKey,A.name)}function st(){return(st=(0,w.Z)(function*(A,b,I){const N=yn(A);ge(A,b,Es);const we=E(N,I);return yield $n(we,N),we._openRedirect(N,b,"signInViaRedirect")})).apply(this,arguments)}function mn(){return(mn=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A);ge(N.auth,b,Es);const we=E(N.auth,I);yield $n(we,N.auth);const lt=yield $o(N);return we._openRedirect(N.auth,b,"reauthViaRedirect",lt)})).apply(this,arguments)}function sr(){return(sr=(0,w.Z)(function*(A,b,I){const N=(0,g.m9)(A);ge(N.auth,b,Es);const we=E(N.auth,I);yield qe(!1,N,b.providerId),yield $n(we,N.auth);const lt=yield $o(N);return we._openRedirect(N.auth,b,"linkViaRedirect",lt)})).apply(this,arguments)}function vi(){return(vi=(0,w.Z)(function*(A,b){return yield yn(A)._initializationPromise,ki(A,b,!1)})).apply(this,arguments)}function ki(A,b){return Hi.apply(this,arguments)}function Hi(){return(Hi=(0,w.Z)(function*(A,b,I=!1){const N=yn(A),we=E(N,b),Yt=yield new un(N,we,I).execute();return Yt&&!I&&(delete Yt.user._redirectEventId,yield N._persistUserIfCurrent(Yt.user),yield N._setRedirectUser(null,b)),Yt})).apply(this,arguments)}function $o(A){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,w.Z)(function*(A){const b=cu(`${A.uid}:::`);return A._redirectEventId=b,yield A.auth._setRedirectUser(A),yield A.auth._persistUserIfCurrent(A),b})).apply(this,arguments)}class ko{constructor(b){this.auth=b,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(b){this.consumers.add(b),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,b)&&(this.sendToConsumer(this.queuedRedirectEvent,b),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(b){this.consumers.delete(b)}onEvent(b){if(this.hasEventBeenHandled(b))return!1;let I=!1;return this.consumers.forEach(N=>{this.isEventForConsumer(b,N)&&(I=!0,this.sendToConsumer(b,N),this.saveEventToCache(b))}),this.hasHandledPotentialRedirect||!function ua(A){switch(A.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Xa(A);default:return!1}}(b)||(this.hasHandledPotentialRedirect=!0,I||(this.queuedRedirectEvent=b,I=!0)),I}sendToConsumer(b,I){var N;if(b.error&&!Xa(b)){const we=(null===(N=b.error.code)||void 0===N?void 0:N.split("auth/")[1])||"internal-error";I.onError(j(this.auth,we))}else I.onAuthEvent(b)}isEventForConsumer(b,I){const N=null===I.eventId||!!b.eventId&&b.eventId===I.eventId;return I.filter.includes(b.type)&&N}hasEventBeenHandled(b){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(vo(b))}saveEventToCache(b){this.cachedEventUids.add(vo(b)),this.lastProcessedEventTime=Date.now()}}function vo(A){return[A.type,A.eventId,A.sessionId,A.tenantId].filter(b=>b).join("-")}function Xa({type:A,error:b}){return"unknown"===A&&"auth/no-auth-event"===(null==b?void 0:b.code)}function za(A){return Ys.apply(this,arguments)}function Ys(){return(Ys=(0,w.Z)(function*(A,b={}){return Sr(A,"GET","/v1/projects",b)})).apply(this,arguments)}const ol=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ia=/^https?/;function Ta(){return(Ta=(0,w.Z)(function*(A){if(A.config.emulator)return;const{authorizedDomains:b}=yield za(A);for(const I of b)try{if(ml(I))return}catch(N){}Ae(A,"unauthorized-domain")})).apply(this,arguments)}function ml(A){const b=_t(),{protocol:I,hostname:N}=new URL(b);if(A.startsWith("chrome-extension://")){const Yt=new URL(A);return""===Yt.hostname&&""===N?"chrome-extension:"===I&&A.replace("chrome-extension://","")===b.replace("chrome-extension://",""):"chrome-extension:"===I&&Yt.hostname===N}if(!Ia.test(I))return!1;if(ol.test(A))return N===A;const we=A.replace(/\./g,"\\.");return new RegExp("^(.+\\."+we+"|"+we+")$","i").test(N)}const Wu=new An(3e4,6e4);function Il(){const A=Ri().___jsl;if(null==A?void 0:A.H)for(const b of Object.keys(A.H))if(A.H[b].r=A.H[b].r||[],A.H[b].L=A.H[b].L||[],A.H[b].r=[...A.H[b].L],A.CP)for(let I=0;I<A.CP.length;I++)A.CP[I]=null}let ys=null;function Tl(A){return ys=ys||function Zu(A){return new Promise((b,I)=>{var N,we,lt;function Yt(){Il(),gapi.load("gapi.iframes",{callback:()=>{b(gapi.iframes.getContext())},ontimeout:()=>{Il(),I(j(A,"network-request-failed"))},timeout:Wu.get()})}if(null===(we=null===(N=Ri().gapi)||void 0===N?void 0:N.iframes)||void 0===we?void 0:we.Iframe)b(gapi.iframes.getContext());else{if(!(null===(lt=Ri().gapi)||void 0===lt?void 0:lt.load)){const In=Wr("iframefcb");return Ri()[In]=()=>{gapi.load?Yt():I(j(A,"network-request-failed"))},Ea(`https://apis.google.com/js/api.js?onload=${In}`).catch(ar=>I(ar))}Yt()}}).catch(b=>{throw ys=null,b})}(A),ys}const Sl=new An(5e3,15e3),Va={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Sa=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ru(A){const b=A.config;U(b.authDomain,A,"auth-domain-config-required");const I=b.emulator?kn(b,"emulator/auth/iframe"):`https://${A.config.authDomain}/__/auth/iframe`,N={apiKey:b.apiKey,appName:A.name,v:nt.SDK_VERSION},we=Sa.get(A.config.apiHost);we&&(N.eid=we);const lt=A._getFrameworks();return lt.length&&(N.fw=lt.join(",")),`${I}?${(0,g.xO)(N).slice(1)}`}function Ku(){return Ku=(0,w.Z)(function*(A){const b=yield Tl(A),I=Ri().gapi;return U(I,A,"internal-error"),b.open({where:document.body,url:Ru(A),messageHandlersFilter:I.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Va,dontclear:!0},N=>new Promise(function(){var we=(0,w.Z)(function*(lt,Yt){yield N.restyle({setHideOnLeave:!1});const In=j(A,"network-request-failed"),ar=Ri().setTimeout(()=>{Yt(In)},Sl.get());function Lr(){Ri().clearTimeout(ar),lt(N)}N.ping(Lr).then(Lr,()=>{Yt(In)})});return function(lt,Yt){return we.apply(this,arguments)}}()))}),Ku.apply(this,arguments)}const Qd={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class uh{constructor(b){this.window=b,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(b){}}}function lh(A,b,I,N,we,lt){U(A.config.authDomain,A,"auth-domain-config-required"),U(A.config.apiKey,A,"invalid-api-key");const Yt={apiKey:A.config.apiKey,appName:A.name,authType:I,redirectUrl:N,v:nt.SDK_VERSION,eventId:we};if(b instanceof Es){b.setDefaultLanguage(A.languageCode),Yt.providerId=b.providerId||"",(0,g.xb)(b.getCustomParameters())||(Yt.customParameters=JSON.stringify(b.getCustomParameters()));for(const[ar,Lr]of Object.entries(lt||{}))Yt[ar]=Lr}if(b instanceof is){const ar=b.getScopes().filter(Lr=>""!==Lr);ar.length>0&&(Yt.scopes=ar.join(","))}A.tenantId&&(Yt.tid=A.tenantId);const In=Yt;for(const ar of Object.keys(In))void 0===In[ar]&&delete In[ar];return`${function fd({config:A}){return A.emulator?kn(A,"emulator/auth/handler"):`https://${A.authDomain}/__/auth/handler`}(A)}?${(0,g.xO)(In).slice(1)}`}const Cl="webStorageSupport";class Fc extends class Gf{constructor(b){this.factorId=b}_process(b,I,N){switch(I.type){case"enroll":return this._finalizeEnroll(b,I.credential,N);case"signin":return this._finalizeSignIn(b,I.credential);default:return Y("unexpected MultiFactorSessionType")}}}{constructor(b){super("phone"),this.credential=b}static _fromCredential(b){return new Fc(b)}_finalizeEnroll(b,I,N){return function _n(A,b){return Sr(A,"POST","/v2/accounts/mfaEnrollment:finalize",Er(A,b))}(b,{idToken:I,displayName:N,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(b,I){return function xi(A,b){return Sr(A,"POST","/v2/accounts/mfaSignIn:finalize",Er(A,b))}(b,{mfaPendingCredential:I,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let ch=(()=>{class A{constructor(){}static assertion(I){return Fc._fromCredential(I)}}return A.FACTOR_ID="phone",A})();var mu="@firebase/auth";class ef{constructor(b){this.auth=b,this.internalListeners=new Map}getUid(){var b;return this.assertAuthConfigured(),(null===(b=this.auth.currentUser)||void 0===b?void 0:b.uid)||null}getToken(b){var I=this;return(0,w.Z)(function*(){return I.assertAuthConfigured(),yield I.auth._initializationPromise,I.auth.currentUser?{accessToken:yield I.auth.currentUser.getIdToken(b)}:null})()}addAuthTokenListener(b){if(this.assertAuthConfigured(),this.internalListeners.has(b))return;const I=this.auth.onIdTokenChanged(N=>{var we;b((null===(we=N)||void 0===we?void 0:we.stsTokenManager.accessToken)||null)});this.internalListeners.set(b,I),this.updateProactiveRefresh()}removeAuthTokenListener(b){this.assertAuthConfigured();const I=this.internalListeners.get(b);!I||(this.internalListeners.delete(b),I(),this.updateProactiveRefresh())}assertAuthConfigured(){U(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Uc(){return window}function Ul(){return(Ul=(0,w.Z)(function*(A,b,I){var N;const{BuildInfo:we}=Uc();ee(b.sessionId,"AuthEvent did not contain a session ID");const lt=yield nf(b.sessionId),Yt={};return zn()?Yt.ibi=we.packageName:Tt()?Yt.apn=we.packageName:Ae(A,"operation-not-supported-in-this-environment"),we.displayName&&(Yt.appDisplayName=we.displayName),Yt.sessionId=lt,lh(A,I,b.type,void 0,null!==(N=b.eventId)&&void 0!==N?N:void 0,Yt)})).apply(this,arguments)}function lo(){return(lo=(0,w.Z)(function*(A){const{BuildInfo:b}=Uc(),I={};zn()?I.iosBundleId=b.packageName:Tt()?I.androidPackageName=b.packageName:Ae(A,"operation-not-supported-in-this-environment"),yield za(A,I)})).apply(this,arguments)}function Go(){return(Go=(0,w.Z)(function*(A,b,I){const{cordova:N}=Uc();let we=()=>{};try{yield new Promise((lt,Yt)=>{let In=null;function ar(){var Xr;lt();const Qs=null===(Xr=N.plugins.browsertab)||void 0===Xr?void 0:Xr.close;"function"==typeof Qs&&Qs(),"function"==typeof(null==I?void 0:I.close)&&I.close()}function Lr(){In||(In=window.setTimeout(()=>{Yt(j(A,"redirect-cancelled-by-user"))},2e3))}function ai(){"visible"===(null==document?void 0:document.visibilityState)&&Lr()}b.addPassiveListener(ar),document.addEventListener("resume",Lr,!1),Tt()&&document.addEventListener("visibilitychange",ai,!1),we=()=>{b.removePassiveListener(ar),document.removeEventListener("resume",Lr,!1),document.removeEventListener("visibilitychange",ai,!1),In&&window.clearTimeout(In)}})}finally{we()}})).apply(this,arguments)}function nf(A){return gu.apply(this,arguments)}function gu(){return(gu=(0,w.Z)(function*(A){const b=md(A),I=yield crypto.subtle.digest("SHA-256",b);return Array.from(new Uint8Array(I)).map(we=>we.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function md(A){if(ee(/[0-9a-zA-Z]+/.test(A),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(A);const b=new ArrayBuffer(A.length),I=new Uint8Array(b);for(let N=0;N<A.length;N++)I[N]=A.charCodeAt(N);return I}!function Bh(A){(0,nt._registerComponent)(new Re.wA("auth",(b,{options:I})=>{const N=b.getProvider("app").getImmediate(),{apiKey:we,authDomain:lt}=N.options;return(Yt=>{U(we&&!we.includes(":"),"invalid-api-key",{appName:Yt.name}),U(!(null==lt?void 0:lt.includes(":")),"argument-error",{appName:Yt.name});const In={apiKey:we,authDomain:lt,clientPlatform:A,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Xn(A)},ar=new br(Yt,In);return function rt(A,b){const I=(null==b?void 0:b.persistence)||[],N=(Array.isArray(I)?I:[I]).map(_e);(null==b?void 0:b.errorMap)&&A._updateErrorMap(b.errorMap),A._initializeWithPersistence(N,null==b?void 0:b.popupRedirectResolver)}(ar,I),ar})(N)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((b,I,N)=>{b.getProvider("auth-internal").initialize()})),(0,nt._registerComponent)(new Re.wA("auth-internal",b=>{const I=yn(b.getProvider("auth").getImmediate());return new ef(I)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,nt.registerVersion)(mu,"0.19.6",function qf(A){switch(A){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(A)),(0,nt.registerVersion)(mu,"0.19.6","esm2017")}("Browser");class gd extends ko{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(b=>{this.resolveInialized=b})}addPassiveListener(b){this.passiveListeners.add(b)}removePassiveListener(b){this.passiveListeners.delete(b)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(b){return this.resolveInialized(),this.passiveListeners.forEach(I=>I(b)),super.onEvent(b)}initialized(){var b=this;return(0,w.Z)(function*(){yield b.initPromise})()}}function Oo(A){return yd.apply(this,arguments)}function yd(){return(yd=(0,w.Z)(function*(A){const b=yield Zl()._get(dh(A));return b&&(yield Zl()._remove(dh(A))),b})).apply(this,arguments)}function Uh(){const A=[],b="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let I=0;I<20;I++){const N=Math.floor(Math.random()*b.length);A.push(b.charAt(N))}return A.join("")}function Zl(){return _e(wa)}function dh(A){return Dt("authEvent",A.config.apiKey,A.name)}function yu(A){if(!(null==A?void 0:A.includes("?")))return{};const[b,...I]=A.split("?");return(0,g.zd)(I.join("?"))}function of(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:j("no-auth-event")}}function Vh(){var A;return(null===(A=null==self?void 0:self.location)||void 0===A?void 0:A.protocol)||null}function _d(A=(0,g.z$)()){return!("file:"!==Vh()&&"ionic:"!==Vh()||!A.toLowerCase().match(/iphone|ipad|ipod|android/))}function Xs(){try{const A=self.localStorage,b=cu();if(A)return A.setItem(b,"1"),A.removeItem(b),!function Jl(A=(0,g.z$)()){return function Kl(){return(0,g.w1)()&&11===(null==document?void 0:document.documentMode)}()||function Yl(A=(0,g.z$)()){return/Edge\/\d+/.test(A)}(A)}()||(0,g.hl)()}catch(A){return Aa()&&(0,g.hl)()}return!1}function Aa(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function jh(){return(function Da(){return"http:"===Vh()||"https:"===Vh()}()||(0,g.ru)()||_d())&&!function Xf(){return(0,g.b$)()||(0,g.UG)()}()&&Xs()&&!Aa()}function vd(){return _d()&&"undefined"!=typeof document}function Dl(){return(Dl=(0,w.Z)(function*(){return!!vd()&&new Promise(A=>{const b=setTimeout(()=>{A(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(b),A(!0)})})})).apply(this,arguments)}const _u={LOCAL:"local",NONE:"none",SESSION:"session"},vc=U,sf="persistence";function bd(A){return ph.apply(this,arguments)}function ph(){return(ph=(0,w.Z)(function*(A){yield A._initializationPromise;const b=af(),I=Dt(sf,A.config.apiKey,A.name);(null==b?void 0:b.sessionStorage)&&b.sessionStorage.setItem(I,A._getPersistence())})).apply(this,arguments)}function af(){return"undefined"!=typeof window?window:null}const uf=U;class zl{constructor(){this.browserResolver=_e(class pc{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ba,this._completeRedirectFn=ki}_openPopup(b,I,N,we){var lt=this;return(0,w.Z)(function*(){var Yt;ee(null===(Yt=lt.eventManagers[b._key()])||void 0===Yt?void 0:Yt.manager,"_initialize() not called before _openPopup()");const In=lh(b,I,N,_t(),we);return function Qa(A,b,I,N=500,we=600){const lt=Math.max((window.screen.availHeight-we)/2,0).toString(),Yt=Math.max((window.screen.availWidth-N)/2,0).toString();let In="";const ar=Object.assign(Object.assign({},Qd),{width:N.toString(),height:we.toString(),top:lt,left:Yt}),Lr=(0,g.z$)().toLowerCase();I&&(In=Ve(Lr)?"_blank":I),Ie(Lr)&&(b=b||"http://localhost",ar.scrollbars="yes");const ai=Object.entries(ar).reduce((Qs,[Un,Al])=>`${Qs}${Un}=${Al},`,"");if(function Kn(A=(0,g.z$)()){var b;return zn(A)&&!!(null===(b=window.navigator)||void 0===b?void 0:b.standalone)}(Lr)&&"_self"!==In)return function pu(A,b){const I=document.createElement("a");I.href=A,I.target=b;const N=document.createEvent("MouseEvent");N.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),I.dispatchEvent(N)}(b||"",In),new uh(null);const Xr=window.open(b||"",In,ai);U(Xr,A,"popup-blocked");try{Xr.focus()}catch(Qs){}return new uh(Xr)}(b,In,cu())})()}_openRedirect(b,I,N,we){var lt=this;return(0,w.Z)(function*(){return yield lt._originValidation(b),function zs(A){Ri().location.href=A}(lh(b,I,N,_t(),we)),new Promise(()=>{})})()}_initialize(b){const I=b._key();if(this.eventManagers[I]){const{manager:we,promise:lt}=this.eventManagers[I];return we?Promise.resolve(we):(ee(lt,"If manager is not set, promise should be"),lt)}const N=this.initAndGetManager(b);return this.eventManagers[I]={promise:N},N.catch(()=>{delete this.eventManagers[I]}),N}initAndGetManager(b){var I=this;return(0,w.Z)(function*(){const N=yield function dc(A){return Ku.apply(this,arguments)}(b),we=new ko(b);return N.register("authEvent",lt=>(U(null==lt?void 0:lt.authEvent,b,"invalid-auth-event"),{status:we.onEvent(lt.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),I.eventManagers[b._key()]={manager:we},I.iframes[b._key()]=N,we})()}_isIframeWebStorageSupported(b,I){this.iframes[b._key()].send(Cl,{type:Cl},we=>{var lt;const Yt=null===(lt=null==we?void 0:we[0])||void 0===lt?void 0:lt[Cl];void 0!==Yt&&I(!!Yt),Ae(b,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(b){const I=b._key();return this.originValidationPromises[I]||(this.originValidationPromises[I]=function El(A){return Ta.apply(this,arguments)}(b)),this.originValidationPromises[I]}get _shouldInitProactively(){return Hn()||ze()||zn()}}),this.cordovaResolver=_e(class Kf{constructor(){this._redirectPersistence=Ba,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ki}_initialize(b){var I=this;return(0,w.Z)(function*(){const N=b._key();let we=I.eventManagers.get(N);return we||(we=new gd(b),I.eventManagers.set(N,we),I.attachCallbackListeners(b,we)),we})()}_openPopup(b){Ae(b,"operation-not-supported-in-this-environment")}_openRedirect(b,I,N,we){var lt=this;return(0,w.Z)(function*(){!function pd(A){var b,I,N,we,lt,Yt,In,ar,Lr,ai;const Xr=Uc();U("function"==typeof(null===(b=null==Xr?void 0:Xr.universalLinks)||void 0===b?void 0:b.subscribe),A,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),U(void 0!==(null===(I=null==Xr?void 0:Xr.BuildInfo)||void 0===I?void 0:I.packageName),A,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),U("function"==typeof(null===(lt=null===(we=null===(N=null==Xr?void 0:Xr.cordova)||void 0===N?void 0:N.plugins)||void 0===we?void 0:we.browsertab)||void 0===lt?void 0:lt.openUrl),A,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U("function"==typeof(null===(ar=null===(In=null===(Yt=null==Xr?void 0:Xr.cordova)||void 0===Yt?void 0:Yt.plugins)||void 0===In?void 0:In.browsertab)||void 0===ar?void 0:ar.isAvailable),A,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),U("function"==typeof(null===(ai=null===(Lr=null==Xr?void 0:Xr.cordova)||void 0===Lr?void 0:Lr.InAppBrowser)||void 0===ai?void 0:ai.open),A,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(b);const Yt=yield lt._initialize(b);yield Yt.initialized(),Yt.resetRedirect(),function cr(){tn.clear()}(),yield lt._originValidation(b);const In=function gc(A,b,I=null){return{type:b,eventId:I,urlResponse:null,sessionId:Uh(),postBody:null,tenantId:A.tenantId,error:j(A,"no-auth-event")}}(b,N,we);yield function Zf(A,b){return Zl()._set(dh(A),b)}(b,In);const ar=yield function bo(A,b,I){return Ul.apply(this,arguments)}(b,In,I),Lr=yield function mc(A){const{cordova:b}=Uc();return new Promise(I=>{b.plugins.browsertab.isAvailable(N=>{let we=null;N?b.plugins.browsertab.openUrl(A):we=b.InAppBrowser.open(A,function an(A=(0,g.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(A)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(A)}()?"_blank":"_system","location=yes"),I(we)})})}(ar);return function $i(A,b,I){return Go.apply(this,arguments)}(b,Yt,Lr)})()}_isIframeWebStorageSupported(b,I){throw new Error("Method not implemented.")}_originValidation(b){const I=b._key();return this.originValidationPromises[I]||(this.originValidationPromises[I]=function tf(A){return lo.apply(this,arguments)}(b)),this.originValidationPromises[I]}attachCallbackListeners(b,I){const{universalLinks:N,handleOpenURL:we,BuildInfo:lt}=Uc(),Yt=setTimeout((0,w.Z)(function*(){yield Oo(b),I.onEvent(of())}),500),In=function(){var ai=(0,w.Z)(function*(Xr){clearTimeout(Yt);const Qs=yield Oo(b);let Un=null;Qs&&(null==Xr?void 0:Xr.url)&&(Un=function yc(A,b){var I,N;const we=function zc(A){const b=yu(A),I=b.link?decodeURIComponent(b.link):void 0,N=yu(I).link,we=b.deep_link_id?decodeURIComponent(b.deep_link_id):void 0;return yu(we).link||we||N||I||A}(b);if(we.includes("/__/auth/callback")){const lt=yu(we),Yt=lt.firebaseError?function zh(A){try{return JSON.parse(A)}catch(b){return null}}(decodeURIComponent(lt.firebaseError)):null,In=null===(N=null===(I=null==Yt?void 0:Yt.code)||void 0===I?void 0:I.split("auth/"))||void 0===N?void 0:N[1],ar=In?j(In):null;return ar?{type:A.type,eventId:A.eventId,tenantId:A.tenantId,error:ar,urlResponse:null,sessionId:null,postBody:null}:{type:A.type,eventId:A.eventId,tenantId:A.tenantId,sessionId:A.sessionId,urlResponse:we,postBody:null}}return null}(Qs,Xr.url)),I.onEvent(Un||of())});return function(Qs){return ai.apply(this,arguments)}}();void 0!==N&&"function"==typeof N.subscribe&&N.subscribe(null,In);const ar=we,Lr=`${lt.packageName.toLowerCase()}://`;Uc().handleOpenURL=function(){var ai=(0,w.Z)(function*(Xr){if(Xr.toLowerCase().startsWith(Lr)&&In({url:Xr}),"function"==typeof ar)try{ar(Xr)}catch(Qs){console.error(Qs)}});return function(Xr){return ai.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Ba,this._completeRedirectFn=ki}_initialize(b){var I=this;return(0,w.Z)(function*(){return yield I.selectUnderlyingResolver(),I.assertedUnderlyingResolver._initialize(b)})()}_openPopup(b,I,N,we){var lt=this;return(0,w.Z)(function*(){return yield lt.selectUnderlyingResolver(),lt.assertedUnderlyingResolver._openPopup(b,I,N,we)})()}_openRedirect(b,I,N,we){var lt=this;return(0,w.Z)(function*(){return yield lt.selectUnderlyingResolver(),lt.assertedUnderlyingResolver._openRedirect(b,I,N,we)})()}_isIframeWebStorageSupported(b,I){this.assertedUnderlyingResolver._isIframeWebStorageSupported(b,I)}_originValidation(b){return this.assertedUnderlyingResolver._originValidation(b)}get _shouldInitProactively(){return vd()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return uf(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var b=this;return(0,w.Z)(function*(){if(b.underlyingResolver)return;const I=yield function eu(){return Dl.apply(this,arguments)}();b.underlyingResolver=I?b.cordovaResolver:b.browserResolver})()}}function Hh(A){return A.unwrap()}function Yp(A){return Vc(A)}function Vc(A){const{_tokenResponse:b}=A instanceof g.ZR?A.customData:A;if(!b)return null;if(!(A instanceof g.ZR)&&"temporaryProof"in b&&"phoneNumber"in b)return m.credentialFromResult(A);const I=b.providerId;if(!I||"password"===I)return null;let N;switch(I){case"google.com":N=Uo;break;case"facebook.com":N=Ni;break;case"github.com":N=el;break;case"twitter.com":N=os;break;default:const{oauthIdToken:we,oauthAccessToken:lt,oauthTokenSecret:Yt,pendingToken:In,nonce:ar}=b;return lt||Yt||we||In?In?I.startsWith("saml.")?uu._create(I,In):rs._fromParams({providerId:I,signInMethod:I,pendingToken:In,idToken:we,accessToken:lt}):new po(I).credential({idToken:we,accessToken:lt,rawNonce:ar}):null}return A instanceof g.ZR?N.credentialFromError(A):N.credentialFromResult(A)}function ku(A,b){return b.catch(I=>{throw I instanceof g.ZR&&function bc(A,b){var I;const N=null===(I=b.customData)||void 0===I?void 0:I._tokenResponse;if("auth/multi-factor-auth-required"===b.code)b.resolver=new mh(A,function Mt(A,b){var I;const N=(0,g.m9)(A),we=b;return U(b.customData.operationType,N,"argument-error"),U(null===(I=we.customData._serverResponse)||void 0===I?void 0:I.mfaPendingCredential,N,"argument-error"),Ze._fromError(N,we)}(A,b));else if(N){const we=Vc(b),lt=b;we&&(lt.credential=we,lt.tenantId=N.tenantId||void 0,lt.email=N.email||void 0,lt.phoneNumber=N.phoneNumber||void 0)}}(A,I),I}).then(I=>{const we=I.user;return{operationType:I.operationType,credential:Yp(I),additionalUserInfo:To(I),user:la.getOrCreate(we)}})}function jc(A,b){return lf.apply(this,arguments)}function lf(){return(lf=(0,w.Z)(function*(A,b){const I=yield b;return{verificationId:I.verificationId,confirm:N=>ku(A,I.confirm(N))}})).apply(this,arguments)}class mh{constructor(b,I){this.resolver=I,this.auth=function ep(A){return A.wrapped()}(b)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(b){return ku(Hh(this.auth),this.resolver.resolveSignIn(b))}}class la{constructor(b){this._delegate=b,this.multiFactor=function dr(A){const b=(0,g.m9)(A);return Gn.has(b)||Gn.set(b,or._fromUser(b)),Gn.get(b)}(b)}static getOrCreate(b){return la.USER_MAP.has(b)||la.USER_MAP.set(b,new la(b)),la.USER_MAP.get(b)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(b){return this._delegate.getIdTokenResult(b)}getIdToken(b){return this._delegate.getIdToken(b)}linkAndRetrieveDataWithCredential(b){return this.linkWithCredential(b)}linkWithCredential(b){var I=this;return(0,w.Z)(function*(){return ku(I.auth,li(I._delegate,b))})()}linkWithPhoneNumber(b,I){var N=this;return(0,w.Z)(function*(){return jc(N.auth,function to(A,b,I){return Ua.apply(this,arguments)}(N._delegate,b,I))})()}linkWithPopup(b){var I=this;return(0,w.Z)(function*(){return ku(I.auth,function gt(A,b,I){return kt.apply(this,arguments)}(I._delegate,b,zl))})()}linkWithRedirect(b){var I=this;return(0,w.Z)(function*(){return yield bd(yn(I.auth)),function xn(A,b,I){return function Bn(A,b,I){return sr.apply(this,arguments)}(A,b,I)}(I._delegate,b,zl)})()}reauthenticateAndRetrieveDataWithCredential(b){return this.reauthenticateWithCredential(b)}reauthenticateWithCredential(b){var I=this;return(0,w.Z)(function*(){return ku(I.auth,Qr(I._delegate,b))})()}reauthenticateWithPhoneNumber(b,I){return jc(this.auth,function Wl(A,b,I){return Fl.apply(this,arguments)}(this._delegate,b,I))}reauthenticateWithPopup(b){return ku(this.auth,function wt(A,b,I){return Pt.apply(this,arguments)}(this._delegate,b,zl))}reauthenticateWithRedirect(b){var I=this;return(0,w.Z)(function*(){return yield bd(yn(I.auth)),function Ut(A,b,I){return function Qt(A,b,I){return mn.apply(this,arguments)}(A,b,I)}(I._delegate,b,zl)})()}sendEmailVerification(b){return function Us(A,b){return Au.apply(this,arguments)}(this._delegate,b)}unlink(b){var I=this;return(0,w.Z)(function*(){return yield function ps(A,b){return Jo.apply(this,arguments)}(I._delegate,b),I})()}updateEmail(b){return function $u(A,b){return Ms((0,g.m9)(A),b,null)}(this._delegate,b)}updatePassword(b){return function Mu(A,b){return Ms((0,g.m9)(A),null,b)}(this._delegate,b)}updatePhoneNumber(b){return function d(A,b){return h.apply(this,arguments)}(this._delegate,b)}updateProfile(b){return function tl(A,b){return va.apply(this,arguments)}(this._delegate,b)}verifyBeforeUpdateEmail(b,I){return function Fo(A,b,I){return ia.apply(this,arguments)}(this._delegate,b,I)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}la.USER_MAP=new WeakMap;const gh=U;let yh=(()=>{class A{constructor(I,N){if(this.app=I,N.isInitialized())return this._delegate=N.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:we}=I.options;gh(we,"invalid-api-key",{appName:I.name}),gh(we,"invalid-api-key",{appName:I.name});const lt="undefined"!=typeof window?zl:void 0;this._delegate=N.initialize({options:{persistence:tp(we,I.name),popupRedirectResolver:lt}}),this._delegate._updateErrorMap(bt),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?la.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(I){this._delegate.languageCode=I}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(I){this._delegate.tenantId=I}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(I,N){!function Dr(A,b,I){const N=yn(A);U(N._canInitEmulator,N,"emulator-config-failed"),U(/^https?:\/\//.test(b),N,"invalid-emulator-scheme");const we=!!(null==I?void 0:I.disableWarnings),lt=jr(b),{host:Yt,port:In}=function oo(A){const b=jr(A),I=/(\/\/)?([^?#/]+)/.exec(A.substr(b.length));if(!I)return{host:"",port:null};const N=I[2].split("@").pop()||"",we=/^(\[[^\]]+\])(:|$)/.exec(N);if(we){const lt=we[1];return{host:lt,port:zr(N.substr(lt.length+1))}}{const[lt,Yt]=N.split(":");return{host:lt,port:zr(Yt)}}}(b);N.config.emulator={url:`${lt}//${Yt}${null===In?"":`:${In}`}/`},N.settings.appVerificationDisabledForTesting=!0,N.emulatorConfig=Object.freeze({host:Yt,port:In,protocol:lt.replace(":",""),options:Object.freeze({disableWarnings:we})}),we||function Ci(){function A(){const b=document.createElement("p"),I=b.style;b.innerText="Running in emulator mode. Do not use with production credentials.",I.position="fixed",I.width="100%",I.backgroundColor="#ffffff",I.border=".1em solid #000000",I.color="#b50000",I.bottom="0px",I.left="0px",I.margin="0px",I.zIndex="10000",I.textAlign="center",b.classList.add("firebase-emulator-warning"),document.body.appendChild(b)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",A):A())}()}(this._delegate,I,N)}applyActionCode(I){return function vl(A,b){return Nn.apply(this,arguments)}(this._delegate,I)}checkActionCode(I){return Cr(this._delegate,I)}confirmPasswordReset(I,N){return function Na(A,b,I){return Xo.apply(this,arguments)}(this._delegate,I,N)}createUserWithEmailAndPassword(I,N){var we=this;return(0,w.Z)(function*(){return ku(we._delegate,function Wa(A,b,I){return as.apply(this,arguments)}(we._delegate,I,N))})()}fetchProvidersForEmail(I){return this.fetchSignInMethodsForEmail(I)}fetchSignInMethodsForEmail(I){return function Za(A,b){return Eo.apply(this,arguments)}(this._delegate,I)}isSignInWithEmailLink(I){return function ju(A,b){const I=Ho.parseLink(b);return"EMAIL_SIGNIN"===(null==I?void 0:I.operation)}(0,I)}getRedirectResult(){var I=this;return(0,w.Z)(function*(){gh(jh(),I._delegate,"operation-not-supported-in-this-environment");const N=yield function hr(A,b){return vi.apply(this,arguments)}(I._delegate,zl);return N?ku(I._delegate,Promise.resolve(N)):{credential:null,user:null}})()}addFrameworkForLogging(I){!function Yf(A,b){yn(A)._logFramework(b)}(this._delegate,I)}onAuthStateChanged(I,N,we){const{next:lt,error:Yt,complete:In}=Bi(I,N,we);return this._delegate.onAuthStateChanged(lt,Yt,In)}onIdTokenChanged(I,N,we){const{next:lt,error:Yt,complete:In}=Bi(I,N,we);return this._delegate.onIdTokenChanged(lt,Yt,In)}sendSignInLinkToEmail(I,N){return function Vu(A,b,I){return Du.apply(this,arguments)}(this._delegate,I,N)}sendPasswordResetEmail(I,N){return function Ns(A,b,I){return Fs.apply(this,arguments)}(this._delegate,I,N||void 0)}setPersistence(I){var N=this;return(0,w.Z)(function*(){let we;switch(function Qf(A,b){vc(Object.values(_u).includes(b),A,"invalid-persistence-type"),(0,g.b$)()?vc(b!==_u.SESSION,A,"unsupported-persistence-type"):(0,g.UG)()?vc(b===_u.NONE,A,"unsupported-persistence-type"):Aa()?vc(b===_u.NONE||b===_u.LOCAL&&(0,g.hl)(),A,"unsupported-persistence-type"):vc(b===_u.NONE||Xs(),A,"unsupported-persistence-type")}(N._delegate,I),I){case _u.SESSION:we=Ba;break;case _u.LOCAL:we=(yield _e(Pr)._isAvailable())?Pr:wa;break;case _u.NONE:we=ot;break;default:return Ae("argument-error",{appName:N._delegate.name})}return N._delegate.setPersistence(we)})()}signInAndRetrieveDataWithCredential(I){return this.signInWithCredential(I)}signInAnonymously(){return ku(this._delegate,function wo(A){return Ds.apply(this,arguments)}(this._delegate))}signInWithCredential(I){return ku(this._delegate,er(this._delegate,I))}signInWithCustomToken(I){return ku(this._delegate,function ms(A,b){return go.apply(this,arguments)}(this._delegate,I))}signInWithEmailAndPassword(I,N){return ku(this._delegate,function zu(A,b,I){return er((0,g.m9)(A),Cs.credential(b,I))}(this._delegate,I,N))}signInWithEmailLink(I,N){return ku(this._delegate,function ya(A,b,I){return As.apply(this,arguments)}(this._delegate,I,N))}signInWithPhoneNumber(I,N){return jc(this._delegate,function Lc(A,b,I){return Wi.apply(this,arguments)}(this._delegate,I,N))}signInWithPopup(I){var N=this;return(0,w.Z)(function*(){return gh(jh(),N._delegate,"operation-not-supported-in-this-environment"),ku(N._delegate,function it(A,b,I){return xt.apply(this,arguments)}(N._delegate,I,zl))})()}signInWithRedirect(I){var N=this;return(0,w.Z)(function*(){return gh(jh(),N._delegate,"operation-not-supported-in-this-environment"),yield bd(N._delegate),function Q(A,b,I){return function Fe(A,b,I){return st.apply(this,arguments)}(A,b,I)}(N._delegate,I,zl)})()}updateCurrentUser(I){return this._delegate.updateCurrentUser(I)}verifyPasswordResetCode(I){return function xo(A,b){return Ws.apply(this,arguments)}(this._delegate,I)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return A.Persistence=_u,A})();function Bi(A,b,I){let N=A;"function"!=typeof A&&({next:N,error:b,complete:I}=A);const we=N;return{next:Yt=>we(Yt&&la.getOrCreate(Yt)),error:b,complete:I}}function tp(A,b){const I=function ja(A,b){const I=af();if(!(null==I?void 0:I.sessionStorage))return[];const N=Dt(sf,A,b);switch(I.sessionStorage.getItem(N)){case _u.NONE:return[ot];case _u.LOCAL:return[Pr,Ba];case _u.SESSION:return[Ba];default:return[]}}(A,b);if("undefined"!=typeof self&&!I.includes(Pr)&&I.push(Pr),"undefined"!=typeof window)for(const N of[wa,Ba])I.includes(N)||I.push(N);return I.includes(ot)||I.push(ot),I}class Ps{constructor(){this.providerId="phone",this._delegate=new m(Hh(ue.Z.auth()))}static credential(b,I){return m.credential(b,I)}verifyPhoneNumber(b,I){return this._delegate.verifyPhoneNumber(b,I)}unwrap(){return this._delegate}}Ps.PHONE_SIGN_IN_METHOD=m.PHONE_SIGN_IN_METHOD,Ps.PROVIDER_ID=m.PROVIDER_ID;const sl=U;class cs{constructor(b,I,N=ue.Z.app()){var we;sl(null===(we=N.options)||void 0===we?void 0:we.apiKey,"invalid-api-key",{appName:N.name}),this._delegate=new pl(b,I,N.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function np(A){A.INTERNAL.registerComponent(new Re.wA("auth-compat",b=>{const I=b.getProvider("app-compat").getImmediate(),N=b.getProvider("auth");return new yh(I,N)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Cs,FacebookAuthProvider:Ni,GithubAuthProvider:el,GoogleAuthProvider:Uo,OAuthProvider:po,SAMLAuthProvider:Gs,PhoneAuthProvider:Ps,PhoneMultiFactorGenerator:ch,RecaptchaVerifier:cs,TwitterAuthProvider:os,Auth:yh,AuthCredential:Mr,Error:g.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),A.registerVersion("@firebase/auth-compat","0.2.6")}(ue.Z)},1292:(Sn,Nt,H)=>{"use strict";H.d(Nt,{PF:()=>gr,pC:()=>Wn,zF:()=>jt,wC:()=>Er});var w=H(5e3),ue=H(655),g=H(7579),nt=H(9646),xe=H(9770),Le=H(8996),Re=H(590),Ue=H(8505),fe=H(3900),se=H(520),ae=H(9808),$e=H(2313);function St(ve,me){if(1&ve){const re=w.EpF();w.TgZ(0,"a",2),w.NdJ("click",function(){return w.CHM(re),w.oxw().params.fixme()}),w.qZA()}if(2&ve){const re=w.oxw();w.Q6J("innerHTML",re.params.fixmeMessage,w.oJD)}}function pt(ve,me){if(1&ve){const re=w.EpF();w.ynx(0),w.TgZ(1,"button",3),w.NdJ("click",function(){const sn=w.CHM(re).$implicit;return w.oxw().onSubmit(sn)})("animationend",function(){return w.CHM(re),w.oxw().content.reportUpdated(null)}),w._UZ(2,"span",4),w.qZA(),w.BQk()}if(2&ve){const re=me.$implicit,ht=w.oxw();w.xp6(1),w.Tol(re.class||""),w.ekj("active",ht.active)("selected",ht.isSelected&&ht.equalsSelected(re.value))("echo",re.echo)("not-selected",ht.isSelected&&!ht.equalsSelected(re.value)),w.Q6J("disabled",!ht.enabled),w.xp6(1),w.Q6J("innerHtml",re.display,w.oJD)}}function bt(ve,me){if(1&ve){const re=w.EpF();w.TgZ(0,"a",5),w.NdJ("click",function(){return w.CHM(re),w.oxw().params.fixme()}),w.qZA()}if(2&ve){const re=w.oxw();w.Q6J("innerHTML",re.params.fixmeMessage,w.oJD)}}function Ct(ve,me){if(1&ve){const re=w.EpF();w.ynx(0),w.TgZ(1,"button",3),w.NdJ("click",function(){const sn=w.CHM(re).$implicit,Mn=w.oxw();return sn.field?Mn.toggle(sn.field):Mn.onSubmit()})("animationend",function(){return w.CHM(re),w.oxw().content.reportUpdated(null)}),w._UZ(2,"span",4),w.qZA(),w.BQk()}if(2&ve){const re=me.$implicit,ht=w.oxw();w.xp6(1),w.Tol(re.class||""),w.ekj("active",ht.active)("selected",!!ht.value[re.field])("echo",re.echo)("not-selected",ht.selected&&!ht.value[re.field]),w.Q6J("disabled",!ht.enabled),w.xp6(1),w.Q6J("innerHtml",re.display,w.oJD)}}function ct(ve,me){if(1&ve){const re=w.EpF();w.TgZ(0,"a",5),w.NdJ("click",function(){return w.CHM(re),w.oxw().params.fixme()}),w.qZA()}if(2&ve){const re=w.oxw();w.Q6J("innerHTML",re.params.fixmeMessage,w.oJD)}}const he=["file"];function je(ve,me){if(1&ve&&(w.TgZ(0,"div",5),w._uU(1),w.qZA()),2&ve){const re=w.oxw();w.xp6(1),w.Oqu(re.content.uploadFileText)}}function Ae(ve,me){if(1&ve&&(w.TgZ(0,"div",5),w._uU(1),w.qZA()),2&ve){const re=w.oxw();w.xp6(1),w.Oqu(re.selectedFile.name)}}function j(ve,me){if(1&ve&&(w.TgZ(0,"div",5),w._uU(1),w.qZA()),2&ve){const re=w.oxw();w.xp6(1),w.Oqu(re.content.uploadedFileText)}}function W(ve,me){if(1&ve&&(w.TgZ(0,"div",5),w._uU(1),w.qZA()),2&ve){const re=w.oxw();w.xp6(1),w.Oqu(re.content.notUploadedFileText)}}function ge(ve,me){if(1&ve&&(w.TgZ(0,"div",6),w._UZ(1,"div",7),w.qZA()),2&ve){const re=w.oxw();w.xp6(1),w.Udp("left",re.progressInternal-100+"%")}}function q(ve,me){}function U(ve,me){if(1&ve&&w._UZ(0,"htl-message-from",3),2&ve){const re=w.oxw();w.Q6J("content",re.content)("params",re.item.params)("first",re.item.first)}}function Y(ve,me){if(1&ve&&w._UZ(0,"htl-message-to",3),2&ve){const re=w.oxw();w.Q6J("content",re.content)("params",re.item.params)("first",re.item.first)}}function ee(ve,me){if(1&ve&&w._UZ(0,"htl-message-typing",4),2&ve){const re=w.oxw();w.Q6J("content",re.content)}}function Pe(ve,me){if(1&ve&&w._UZ(0,"htl-message-options",5),2&ve){const re=w.oxw();w.Q6J("content",re.content)("params",re.item.params)}}function _e(ve,me){if(1&ve&&w._UZ(0,"htl-message-multi-options",5),2&ve){const re=w.oxw();w.Q6J("content",re.content)("params",re.item.params)}}function We(ve,me){if(1&ve&&w._UZ(0,"htl-message-uploader",5),2&ve){const re=w.oxw();w.Q6J("content",re.content)("params",re.item.params)}}function rt(ve,me){if(1&ve&&w._UZ(0,"htl-message-custom-component",5),2&ve){const re=w.oxw();w.Q6J("content",re.content)("params",re.item.params)}}const _t=["container"];function ft(ve,me){if(1&ve&&(w.ynx(0),w.TgZ(1,"htl-message-switch",3),w._uU(2," >"),w.qZA(),w.BQk()),2&ve){const re=me.$implicit,ht=w.oxw();w.xp6(1),w.Udp("display",ht.content.visibleRevision<re.revision?"none":"block"),w.Q6J("content",ht.content)("item",re)}}const Zt=["input"];function nn(ve,me){if(1&ve){const re=w.EpF();w.ynx(0),w.TgZ(1,"div",1),w.TgZ(2,"textarea",2,3),w.NdJ("keyup",function(){return w.CHM(re),w.oxw().validate()})("change",function(){return w.CHM(re),w.oxw().validate()}),w.qZA(),w.TgZ(4,"button",4),w.NdJ("click",function(){return w.CHM(re),w.oxw().onSubmit()}),w.qZA(),w.qZA(),w.BQk()}if(2&ve){const re=w.oxw();w.xp6(2),w.Q6J("placeholder",re.placeholder||re.content.inputPlaceholder),w.xp6(2),w.Q6J("innerHTML",re.content.sendButtonText,w.oJD)("disabled",!re.valid)}}function qt(ve,me){if(1&ve){const re=w.EpF();w.TgZ(0,"span",10),w.NdJ("click",function(){const sn=w.CHM(re).$implicit;return w.oxw(3).selectSuggestion(sn)})("touchstart",function(zt){const Mn=w.CHM(re).$implicit;return w.oxw(3).selectSuggestion(Mn,zt)}),w.TgZ(1,"strong"),w._uU(2),w.qZA(),w._uU(3),w.qZA()}if(2&ve){const re=me.$implicit;w.xp6(2),w.Oqu(re[0]),w.xp6(1),w.hij("",re[1]," ")}}function An(ve,me){if(1&ve&&(w.TgZ(0,"div",7),w.TgZ(1,"div",8),w.YNc(2,qt,4,2,"span",9),w.qZA(),w.qZA()),2&ve){const re=w.oxw(2);w.xp6(2),w.Q6J("ngForOf",re.visibleSuggestions)}}function kn(ve,me){if(1&ve){const re=w.EpF();w.TgZ(0,"div",11),w.TgZ(1,"input",12,3),w.NdJ("keyup",function(zt){w.CHM(re);const sn=w.oxw(2);return sn.validate()&&13==zt.keyCode&&sn.onSubmit()})("change",function(){return w.CHM(re),w.oxw(2).validate()}),w.qZA(),w.TgZ(3,"button",13),w.NdJ("click",function(){return w.CHM(re),w.oxw(2).onSubmit()}),w.qZA(),w.qZA()}if(2&ve){const re=w.oxw(2);w.ekj("invalid",!re.valid),w.xp6(1),w.Q6J("type",re.inputKind)("disabled",!re.inputEnabled)("placeholder",re.placeholder||re.content.inputPlaceholder),w.uIk("min",re.inputMin)("max",re.inputMax)("step",re.inputStep),w.xp6(2),w.Q6J("disabled",!re.valid)("innerHTML",re.content.sendButtonText,w.oJD)}}function jn(ve,me){if(1&ve&&(w.ynx(0),w.YNc(1,An,3,1,"div",5),w.YNc(2,kn,4,10,"div",6),w.BQk()),2&ve){const re=w.oxw();w.xp6(1),w.Q6J("ngIf",re.visibleSuggestions&&re.visibleSuggestions.length>0),w.xp6(1),w.Q6J("ngIf",re.inputEnabled)}}class gr{constructor(){this.messages=[],this.revision=0,this.visibleRevision=0,this.inputs=new g.x,this.updated=new g.x,this.inputEnabled=!1,this.textArea=!1,this.inputKind="text",this.placeholder="",this.validator=null,this.fastScroll=!1,this.scrollLock=!1,this.fixme=null,this.debug=!1,this.sendButtonText="Send",this.inputPlaceholder="Type something...",this.uploadFileText="Upload File...",this.uploadedFileText="Uploaded Successfully",this.notUploadedFileText="Failed to upload file",this.fixmeMessage="Fix",this.timeout=1e3,this.toQueue=[]}clear(){this.messages=[],this.toQueue=[]}reportValue(me){this.inputs.next(me)}reportUpdated(me){this.debug&&console.log("CONTENT UPDATED",this.timeout),this.timeout&&window.setTimeout(()=>{this.updated.next(me)},this.timeout)}add(me,re){this.messages.push({kind:me,params:re,first:0===this.messages.length||me!==this.messages[this.messages.length-1].kind,revision:this.revision})}queue(me,re){this.toQueue.push({kind:me,params:re}),1===this.toQueue.length&&this.typing()}queueFunction(me){return new Promise(re=>{this.queue("function",{callable:me,resolve:re})})}typing(){if(this.debug&&console.log("TYPING, queue len="+this.toQueue.length),this.toQueue.length>0){const me=this.toQueue[0];if(this.debug&&console.log("item=",me),"function"===me.kind)this.debug&&console.log("RUNNING FUNCTION",me),this.toQueue.shift(),me.params.callable().then(ht=>{this.debug&&console.log("FUNCTION RESOLVED to",ht,me),me.params.resolve(ht),this.typing()});else{this.add("typing",null);const re=()=>{this.toQueue.shift(),this.debug&&console.log("handling item=",me),this.replace(me.kind,me.params),this.typing()};let ht=this.timeout;if(this.toQueue.length>0){let zt=this.toQueue[0].params.timeout;(zt||0===zt)&&(ht=zt)}0===ht?re():window.setTimeout(()=>{re(),this.reportUpdated(me)},ht)}}else window.setTimeout(()=>(0,ue.mG)(this,void 0,void 0,function*(){this.reportUpdated(null)}),this.timeout)}replace(me,re){this.messages[this.messages.length-1]={kind:me,params:re,first:this.messages.length<2||me!==this.messages[this.messages.length-2].kind}}addFrom(me){this.add("from",{message:me,fixme:this.fixme,fixmeMessage:this.fixmeMessage})}reportInput(me){this.reportValue(me),this.reportUpdated(me),this.textArea=!1,this.placeholder="",this.validator=null}queueFrom(me,re){this.queue("from",{message:me,fixme:this.fixme,fixmeMessage:this.fixmeMessage,timeout:re})}addTo(me,re){this.queue("to",{message:me,timeout:re})}addOptions(me,re,ht,zt){me&&this.queue("to",{message:me}),this.queue("options",{options:re,selected:ht,multi:zt,fixme:this.fixme,fixmeMessage:this.fixmeMessage})}addUploader(me,re){me&&this.queue("to",{message:me}),this.queue("uploader",re)}addCustomComponent(me,re,ht){return new Promise(zt=>{this.queue("component",{step:me,timeout:ht,componentCreatedCallback:()=>(this.debug&&console.log("CUSTOM COMPONENT CREATED",me),zt())})}).then(()=>{if(re)return this.queueFunction(()=>me.__instance.wait())})}setTextArea(){this.textArea=!0}setInputKind(me,re,ht,zt,sn){this.inputKind=me||"text",this.inputRequired=!!re,this.inputMin=void 0===ht?null:ht,this.inputMax=void 0===zt?null:zt,this.inputStep=void 0===sn?null:sn}setInputSuggestions(me){this.inputSuggestions=me}setPlaceholder(me){this.placeholder=me}setValidator(me){this.validator=me}setFixme(me){this.fixme=me}setFastScroll(me){this.fastScroll=me}setScrollLock(me){this.scrollLock!==me&&(this.scrollLock=me,me?this.revision+=1:(this.visibleRevision=this.revision,this.debug&&console.log("SETTING VISIBLE REVISION",this.visibleRevision,"LAST MESSAGE",this.messages[this.messages.length-1])))}waitForInput(me){return(0,ue.mG)(this,void 0,void 0,function*(){return(me=!1!==me)&&(yield this.queueFunction(()=>(0,ue.mG)(this,void 0,void 0,function*(){this.debug&&console.log("ENABLING INPUT"),this.inputEnabled=!0}))),this.inputs.pipe((0,Re.P)(),(0,Ue.b)(re=>{this.debug&&console.log("DISABLING INPUT, value=",re),this.inputEnabled=!1})).toPromise()})}setQueueTimeout(me){let re=!1;0===this.timeout&&0!==me&&(re=!0),this.timeout=me,re&&this.reportUpdated(null)}}let lr=(()=>{class ve{constructor(){this.M=new gr}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275prov=w.Yz7({token:ve,factory:ve.\u0275fac,providedIn:"root"}),ve})();class Er{constructor(me,re,ht,zt=null){this.http=me,this.content=re,this.locale=ht,this.customComponents=zt,this.record={},this.context={},this.snippets={},this.runFastInternal=!1,this.lastMessage="",this.debug=!1,this.fixme=null,this.RETURN=0,this.COMPLETE=-1,this.BREAK=-2,this.state={},this.TIMEOUT=1e3,console.log("Running with locale",this.locale)}set timeout(me){this.TIMEOUT=me}set runFast(me){this.runFastInternal=me,this.content.setScrollLock(me),window.setTimeout(()=>{this.content.setFastScroll(me),me||this.content.queueFunction(()=>(0,ue.mG)(this,void 0,void 0,function*(){this.content.reportUpdated(null)}))},0)}get runFast(){return this.runFastInternal}registerCustomComponents(me){this.customComponents=me}i18n(me){return me&&me[".tx"]?this.locale&&me[".tx"][this.locale]?me[".tx"][this.locale]:me[".tx"]._:me}get(me,re){const ht=re.split(".");for(const zt of ht)me=me[zt]||{};return me.constructor!==Object||Object.entries(me).length>0?me:null}getDefault(me){const re=this.get(this.record,me);return re?re+"":me}fillIn(me){return me.trim().replace(RegExp("(\\{\\{((\\p{L}|\\p{N}|_|\\.)+)\\}\\})","gum"),(re,ht,zt)=>this.getDefault(zt))}run(me,re,ht,zt,sn){this.context=ht,this.setCallback=zt||((Jn,Tr)=>null),this.record=sn||this.record,this.runFast=this.state&&Object.keys(this.state).length>0,this.content.setQueueTimeout(this.runFast?0:this.TIMEOUT),this.debug&&(console.log("STATE:",this.state,Object.keys(this.state)),console.log("RUN FAST enabled:",this.runFast));let Mn=null;return Mn=me.hasOwnProperty("s")?(0,nt.of)(me):this.http.get(me),Mn.pipe((0,fe.w)(Jn=>{Jn=Jn.s[re];for(const Tr of Jn.snippets)this.snippets[Tr.name]=Tr;return this.runSnippet(this.snippets.default)}))}check_res(me,re){if(this.debug&&(console.log("RETURN VALUE:",me),console.log("CURRENT SNIPPET:",re)),0===(""+me).indexOf("pop:")){if(!re.hasOwnProperty("name")||me.slice(4)!==re.name)return me}else{if(me<0)return me;if(me>0)return re.name?me-1:me}return 0}isInState(me){return me&&this.state.hasOwnProperty(me)}clearState(me){this.isInState(me)&&delete this.state[me]}getState(me){return this.state[me]}setState(me,re){me&&(this.state[me]=re)}isCustomStep(me){if(me.__component)return!0;if(this.customComponents)for(const re of this.customComponents)if(me.hasOwnProperty(re.keyword))return me.__component=re,!0;return!1}doCommand(me,re){return(0,ue.mG)(this,void 0,void 0,function*(){let ht=this.context[me.cmd];const zt=[];if(me.params)for(const sn of me.params)if("record"===sn)zt.push(this.record);else if("context"===sn)zt.push(this.context);else if("uploader"===sn){if(this.content.addUploader(null),this.isInState(re)){ht=null,this.content.queueFrom("...");break}zt.push(yield this.content.waitForInput(!1)),this.setState(re,!0)}else zt.push(this.i18n(sn));if(ht){const sn=yield this.content.queueFunction(()=>(0,ue.mG)(this,void 0,void 0,function*(){return yield ht(...zt)}));return this.debug&&console.log("CALLABLE",me.cmd,"RETURNED",sn),me.variable&&(this.record[me.variable]=sn,yield this.setCallback(me.variable,sn,this.record)),sn}return console.log(`ERROR: function ${me.cmd} is not defined`),null})}runSnippet(me){return(0,ue.mG)(this,void 0,void 0,function*(){this.debug&&console.log("RUN SNIPPET",me);for(const re of me.steps){const ht=this.lastMessage+"-"+re.uid;if(this.debug&&console.log("STEP:",re),re.hasOwnProperty("say")){const zt=this.fillIn(this.i18n(re.say));this.lastMessage=zt,this.content.addTo(zt)}else if(re.hasOwnProperty("wait")){let zt=null;if(ht&&this.fixme&&this.content.setFixme(()=>{this.clearState(ht),this.fixme()}),re.wait.optionsFrom&&(re.wait.options=this.record[re.wait.optionsFrom]),re.wait.options){const sn=[];for(const Jn of re.wait.options){Jn.value=Jn.hasOwnProperty("value")?Jn.value:Jn.show,Jn.value=Jn.value.hasOwnProperty(".tx")?Jn.value[".tx"]._:Jn.value;const Tr={display:this.i18n(Jn.show),value:Jn.value,field:Jn.field,class:Jn.class,echo:!1!==Jn.echo,func:Jn.do?()=>(0,ue.mG)(this,void 0,void 0,function*(){return yield this.doCommand(Jn.do)}):null};Jn.unless&&this.record[Jn.unless]&&(Tr.class="unless "+(Tr.class||"")),sn.push(Tr)}const Mn=!!re.wait.multi;this.isInState(ht)&&this.runFast?(zt=this.getState(ht),this.content.addOptions(null,sn,zt,Mn)):(this.runFast&&(this.debug&&console.log("RUN FAST TURNED OFF"),yield this.content.queueFunction(()=>(0,ue.mG)(this,void 0,void 0,function*(){this.content.setQueueTimeout(this.TIMEOUT),this.runFast=!1}))),this.content.addOptions(null,sn,null,Mn),zt=yield this.content.waitForInput(!1),this.setState(ht,zt)),re.wait.variable&&(this.record[re.wait.variable]=zt,yield this.setCallback(re.wait.variable,zt,this.record));for(const Jn of re.wait.options)if(zt===Jn.value){if(this.runFast&&Jn.do&&(yield this.doCommand(Jn.do)),Jn.steps){let Tr=yield this.runSnippet(Jn);if(Tr=this.check_res(Tr,me),0!==Tr)return Tr}break}}else{if(re.wait.long&&this.content.setTextArea(),this.content.setInputKind(re.wait["input-kind"]||"text",!1!==re.wait.required,re.wait["input-min"],re.wait["input-max"],re.wait["input-step"]),re.wait.suggestionsFrom&&(re.wait.suggestions=this.record[re.wait.suggestionsFrom]),this.content.setInputSuggestions(re.wait.suggestions),re.wait.placeholder&&this.content.setPlaceholder(this.i18n(re.wait.placeholder)),re.wait.validation){const Mn=new RegExp("^"+re.wait.validation+"$");this.content.setValidator(Jn=>Mn.test(Jn))}else this.content.setValidator(Mn=>!0);this.isInState(ht)&&this.runFast?zt=this.getState(ht):(this.runFast&&(this.debug&&console.log("RUN FAST TURNED OFF"),yield this.content.queueFunction(()=>(0,ue.mG)(this,void 0,void 0,function*(){this.content.setQueueTimeout(this.TIMEOUT),this.runFast=!1}))),this.content.queueFunction(()=>(0,ue.mG)(this,void 0,void 0,function*(){this.content.reportUpdated(null)})),zt=yield this.content.waitForInput(!0),this.setState(ht,zt)),this.record[re.wait.variable]=zt;let sn=zt+"";re.wait.response&&re.wait.response.length&&(sn=this.fillIn(re.wait.response)),this.debug&&console.log(`FORMATTED ${JSON.stringify(zt)} to "${sn}" (using ${re.wait.response})`),sn.length&&this.content.queueFrom(sn),yield this.setCallback(re.wait.variable,zt,this.record)}this.content.setFixme(null)}else if(re.hasOwnProperty("do"))yield this.doCommand(re.do,ht);else if(re.hasOwnProperty("switch")){const zt=re.switch.arg,sn=this.get(this.record,zt);this.debug&&console.log("SWITCH on value",sn,"(",zt,",",this.record,")");let Mn=null,Jn=null;for(const Tr of re.switch.cases)this.debug&&console.log("CASE",Tr),Tr.default&&(this.debug&&console.log("CASE DEFAULT"),Jn=Tr),(Tr.hasOwnProperty("match")&&Tr.match===sn||Tr.hasOwnProperty("pattern")&&RegExp(Tr.pattern).test(sn)||Tr.hasOwnProperty("undefined")&&Tr.undefined&&null==sn)&&(Mn=Tr);if(this.debug&&console.log("CASE SELECTED",Mn),Mn=Mn||Jn,Mn){if(Mn.steps){let Tr=yield this.runSnippet(Mn);if(Tr=this.check_res(Tr,me),0!==Tr)return Tr}}else console.log(`ERROR: no viable option for ${sn} (${re.switch.arg}) in switch`)}else if(re.hasOwnProperty("goto")){if("complete"===re.goto)return this.COMPLETE;if("break"===re.goto)return this.BREAK;if("return"===re.goto)return this.RETURN+2;const zt=this.snippets[re.goto];if(zt){let sn=yield this.runSnippet(zt);if(sn=this.check_res(sn,me),0!==sn)return sn}else console.log(`ERROR: unknown snippet requested ${re.goto}`)}else{if(re.hasOwnProperty("pop"))return"pop:"+re.pop;if(!this.isCustomStep(re))throw new Error(`Bad step ${JSON.stringify(re)}`);{re.__runner=this,re.__runFast=this.runFast;let zt=null;this.isInState(ht)&&this.runFast?(yield this.content.addCustomComponent(re,!1),zt=this.getState(ht)):(zt=yield this.content.addCustomComponent(re,!0,re.__component.timeout),this.setState(ht,zt)),zt&&this.content.queueFrom(zt,0)}}}return this.RETURN})}}let di=(()=>{class ve{constructor(){}ngOnInit(){}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-message-from"]],inputs:{params:"params",first:"first",content:"content"},decls:5,vars:6,consts:[[1,"speech-bubble"],["class","fixme",3,"innerHTML","click",4,"ngIf"],[1,"fixme",3,"innerHTML","click"]],template:function(re,ht){1&re&&(w.TgZ(0,"div"),w.TgZ(1,"p",0),w.TgZ(2,"span"),w._uU(3),w.qZA(),w.qZA(),w.YNc(4,St,1,1,"a",1),w.qZA()),2&re&&(w.ekj("message-from-wrapper",!0)("first",ht.first),w.xp6(3),w.Oqu(ht.params.message),w.xp6(1),w.Q6J("ngIf",ht.params.fixme))},directives:[ae.O5],styles:["[_nghost-%COMP%]{display:flex;justify-content:right;flex:0 0 auto;align-items:flex-start;justify-content:flex-start}[_nghost-%COMP%]   .message-from-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:flex-end;flex-flow:row}[_nghost-%COMP%]   p[_ngcontent-%COMP%]{flex:0 1 auto;text-align:right}"]}),ve})(),vr=(()=>{class ve{constructor(){}ngOnInit(){}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-message-to"]],inputs:{params:"params",first:"first",content:"content"},decls:3,vars:3,consts:[[1,"message-to-wrapper"],[1,"speech-bubble"],[3,"innerHtml"]],template:function(re,ht){1&re&&(w.TgZ(0,"div",0),w.TgZ(1,"p",1),w._UZ(2,"span",2),w.qZA(),w.qZA()),2&re&&(w.ekj("first",ht.first),w.xp6(2),w.Q6J("innerHtml",ht.params.message,w.oJD))},styles:["[_nghost-%COMP%]{display:flex;justify-content:left;flex:0 0 auto;align-items:flex-end;justify-content:flex-end}[_nghost-%COMP%]   .message-to-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:flex-start;flex-flow:row}[_nghost-%COMP%]   p[_ngcontent-%COMP%]{flex:0 1 auto;text-align:right}"]}),ve})(),qi=(()=>{class ve{constructor(){}ngOnInit(){}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-message-typing"]],inputs:{content:"content"},decls:4,vars:0,consts:[[1,"typing","is-typing-init","is-typing-active"],[1,"typing__bullet"]],template:function(re,ht){1&re&&(w.TgZ(0,"div",0),w._UZ(1,"span",1),w._UZ(2,"span",1),w._UZ(3,"span",1),w.qZA())},styles:["[_nghost-%COMP%]{display:flex;flex-flow:row;justify-content:flex-end;flex:0 0 auto}[_nghost-%COMP%]   .typing[_ngcontent-%COMP%]{direction:ltr;display:none;padding:35px;font-size:0;animation:fadeInUp .2s linear 1 both}[_nghost-%COMP%]   .typing__bullet[_ngcontent-%COMP%]{display:inline-block;width:7px;height:7px;border-radius:50%;background-color:#0000004d;transition:all .3s linear}[_nghost-%COMP%]   .typing__bullet[_ngcontent-%COMP%]:not(:last-child){margin-right:3px}[_nghost-%COMP%]   .typing.is-typing-init[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .typing.is-typing-active[_ngcontent-%COMP%]   .typing__bullet[_ngcontent-%COMP%]{background-color:#000;animation:bounce .6s linear infinite both}[_nghost-%COMP%]   .typing.is-typing-active[_ngcontent-%COMP%]   .typing__bullet[_ngcontent-%COMP%]:nth-child(2){animation-delay:.15s}[_nghost-%COMP%]   .typing.is-typing-active[_ngcontent-%COMP%]   .typing__bullet[_ngcontent-%COMP%]:nth-child(3){animation-delay:.3s}@keyframes bounce{0%,80%,to{opacity:1;transform:translateY(0)}50%{opacity:.5;transform:translateY(-100%)}}@keyframes fadeInUp{0%{opacity:0;transform:translateY(50%)}to{opacity:1;transform:translateY(0)}}"]}),ve})(),ii=(()=>{class ve{constructor(){this.active=!1,this.enabled=!0,this.selected=null,this.isSelected=!1,this.echoSelected=!1}ngOnInit(){null!=this.params.selected&&(this.selected=this.params.selected,this.isSelected=!0),this.selectedJson=JSON.stringify(this.selected)}get multi(){return!!this.params.multi}equalsSelected(re){return JSON.stringify(re)===this.selectedJson}ngAfterViewInit(){setTimeout(()=>{this.active=!0},0)}onSubmit(re){const ht=re.value;let zt=null;zt=re.func?(0,xe.P)(re.func):(0,Le.D)([ht]),zt.subscribe(sn=>{null!==sn&&(this.enabled=!1,this.selected=sn,this.isSelected=!0,this.echoSelected=re.echo,this.selectedJson=JSON.stringify(this.selected),this.content.reportValue(this.selected))})}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-message-options"]],inputs:{params:"params",content:"content"},decls:3,vars:4,consts:[[1,"options"],[4,"ngFor","ngForOf"],["class","fixme",3,"innerHTML","click",4,"ngIf"],[3,"disabled","click","animationend"],[3,"innerHtml"],[1,"fixme",3,"innerHTML","click"]],template:function(re,ht){1&re&&(w.TgZ(0,"span",0),w.YNc(1,pt,3,12,"ng-container",1),w.YNc(2,bt,1,1,"a",2),w.qZA()),2&re&&(w.ekj("selected",ht.isSelected),w.xp6(1),w.Q6J("ngForOf",ht.params.options),w.xp6(1),w.Q6J("ngIf",ht.params.fixme&&ht.echoSelected))},directives:[ae.sg,ae.O5],styles:["[_nghost-%COMP%]{flex:0 0 auto}[_nghost-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:space-evenly}"]}),ve})(),fi=(()=>{class ve{constructor(){this.active=!1,this.enabled=!0,this.selected=!1,this.checked=!1,this.value=null}ngOnInit(){this.value=this.params.selected||{},this.selected=!!this.params.selected,this.checkChecked()}get multi(){return!!this.params.multi}ngAfterViewInit(){setTimeout(()=>{this.active=!0,this.content.reportUpdated(null)},0)}toggle(re){this.value[re]=!this.value[re],this.checkChecked()}onSubmit(){this.enabled=!1,this.selected=!0,this.content.reportValue(this.value)}checkChecked(){this.checked=Object.values(this.value).indexOf(!0)>=0}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-message-multi-options"]],inputs:{params:"params",content:"content"},decls:3,vars:6,consts:[[1,"options"],[4,"ngFor","ngForOf"],["class","fixme",3,"innerHTML","click",4,"ngIf"],[3,"disabled","click","animationend"],[3,"innerHtml"],[1,"fixme",3,"innerHTML","click"]],template:function(re,ht){1&re&&(w.TgZ(0,"span",0),w.YNc(1,Ct,3,12,"ng-container",1),w.YNc(2,ct,1,1,"a",2),w.qZA()),2&re&&(w.ekj("selected",ht.selected)("checked",ht.checked),w.xp6(1),w.Q6J("ngForOf",ht.params.options),w.xp6(1),w.Q6J("ngIf",ht.params.fixme))},directives:[ae.sg,ae.O5],styles:["[_nghost-%COMP%]{flex:0 0 auto}[_nghost-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:space-evenly}"]}),ve})(),bi=(()=>{class ve{constructor(){this.progressInternal=0,this.activeInternal=!1,this.successInternal=!1,this.selectedInternal=!1,this.selectedFile=null}ngOnInit(){}addFiles(){this.file.nativeElement.click()}onFilesAdded(){const re=this.file.nativeElement.files;for(const ht in re)if(!isNaN(parseInt(ht,10))){this.selectedFile=re[ht],this.selectedInternal=!0,this.content.reportValue(this);break}}set progress(re){this.selectedInternal&&this.activeInternal&&(this.progressInternal=re)}set active(re){this.selectedInternal&&(this.activeInternal=re)}set success(re){this.activeInternal&&(this.successInternal=re,this.activeInternal=!1,this.progressInternal=100)}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-message-uploader"]],viewQuery:function(re,ht){if(1&re&&w.Gf(he,7),2&re){let zt;w.iGM(zt=w.CRH())&&(ht.file=zt.first)}},inputs:{params:"params",content:"content"},decls:8,vars:11,consts:[["type","file",3,"change"],["file",""],[1,"button",3,"click"],["class","message",4,"ngIf"],["class","progress",4,"ngIf"],[1,"message"],[1,"progress"],[1,"bar"]],template:function(re,ht){1&re&&(w.TgZ(0,"input",0,1),w.NdJ("change",function(){return ht.onFilesAdded()}),w.qZA(),w.TgZ(2,"div",2),w.NdJ("click",function(){return ht.addFiles()}),w.YNc(3,je,2,1,"div",3),w.YNc(4,Ae,2,1,"div",3),w.YNc(5,j,2,1,"div",3),w.YNc(6,W,2,1,"div",3),w.YNc(7,ge,2,2,"div",4),w.qZA()),2&re&&(w.xp6(2),w.ekj("selected",ht.selectedInternal)("active",ht.activeInternal)("success",ht.successInternal),w.xp6(1),w.Q6J("ngIf",!ht.activeInternal&&!ht.selectedInternal),w.xp6(1),w.Q6J("ngIf",ht.activeInternal),w.xp6(1),w.Q6J("ngIf",!ht.activeInternal&&ht.selectedInternal&&ht.successInternal),w.xp6(1),w.Q6J("ngIf",!ht.activeInternal&&ht.selectedInternal&&!ht.successInternal),w.xp6(1),w.Q6J("ngIf",ht.activeInternal))},directives:[ae.O5],styles:["[_nghost-%COMP%]{display:flex;flex-flow:row;justify-content:center;flex:0 0 auto}[_nghost-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .button[_ngcontent-%COMP%]{display:flex;flex-flow:column;justify-content:center;align-items:center}[_nghost-%COMP%]   .button[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{width:100%;text-align:center}[_nghost-%COMP%]   .button[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{height:2px;width:80%;border:none;background-color:#ccc;overflow:hidden}[_nghost-%COMP%]   .button[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;background-color:green}"]}),ve})(),pi=(()=>{class ve{constructor(re){this.viewContainerRef=re}}return ve.\u0275fac=function(re){return new(re||ve)(w.Y36(w.s_b))},ve.\u0275dir=w.lG2({type:ve,selectors:[["","htlMessageCustomComponentAux",""]]}),ve})(),oi=(()=>{class ve{constructor(re){this.componentFactoryResolver=re}ngOnInit(){const re=this.componentFactoryResolver.resolveComponentFactory(this.params.step.__component.cls),ht=this.inner.viewContainerRef;ht.clear();const zt=ht.createComponent(re);zt.instance.content=this.content,zt.instance.params=this.params.step,this.params.step.__instance=zt.instance,this.params.componentCreatedCallback()}}return ve.\u0275fac=function(re){return new(re||ve)(w.Y36(w._Vd))},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-message-custom-component"]],viewQuery:function(re,ht){if(1&re&&w.Gf(pi,7),2&re){let zt;w.iGM(zt=w.CRH())&&(ht.inner=zt.first)}},inputs:{content:"content",params:"params"},decls:1,vars:0,consts:[["htlMessageCustomComponentAux",""]],template:function(re,ht){1&re&&w.YNc(0,q,0,0,"ng-template",0)},directives:[pi],styles:[""]}),ve})(),Xt=(()=>{class ve{constructor(){}ngOnInit(){}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-message-switch"]],inputs:{content:"content",item:"item"},decls:7,vars:7,consts:[[3,"content","params","first",4,"ngIf"],[3,"content",4,"ngIf"],[3,"content","params",4,"ngIf"],[3,"content","params","first"],[3,"content"],[3,"content","params"]],template:function(re,ht){1&re&&(w.YNc(0,U,1,3,"htl-message-from",0),w.YNc(1,Y,1,3,"htl-message-to",0),w.YNc(2,ee,1,1,"htl-message-typing",1),w.YNc(3,Pe,1,2,"htl-message-options",2),w.YNc(4,_e,1,2,"htl-message-multi-options",2),w.YNc(5,We,1,2,"htl-message-uploader",2),w.YNc(6,rt,1,2,"htl-message-custom-component",2)),2&re&&(w.Q6J("ngIf","from"==ht.item.kind),w.xp6(1),w.Q6J("ngIf","to"==ht.item.kind),w.xp6(1),w.Q6J("ngIf","typing"==ht.item.kind),w.xp6(1),w.Q6J("ngIf","options"==ht.item.kind&&!ht.item.params.multi),w.xp6(1),w.Q6J("ngIf","options"==ht.item.kind&&!!ht.item.params.multi),w.xp6(1),w.Q6J("ngIf","uploader"==ht.item.kind),w.xp6(1),w.Q6J("ngIf","component"==ht.item.kind))},directives:[di,vr,qi,ii,fi,bi,oi,ae.O5],styles:["[_nghost-%COMP%]{display:block;width:100%}"]}),ve})(),ln=(()=>{class ve{constructor(){}resize(re){this.updateScroll()}updateScroll(){setTimeout(()=>{const re=this.container.nativeElement;this.content.debug&&console.log("SCROLLING TO BOTTOM"),re.scrollTo({left:0,top:re.scrollHeight,behavior:this.content.fastScroll?"auto":"smooth"})},0)}ngOnInit(){}ngOnChanges(){this.updatedSub&&this.updatedSub.unsubscribe(),this.updatedSub=this.content.updated.subscribe(()=>{this.updateScroll()})}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-messages"]],viewQuery:function(re,ht){if(1&re&&w.Gf(_t,7),2&re){let zt;w.iGM(zt=w.CRH())&&(ht.container=zt.first)}},hostBindings:function(re,ht){1&re&&w.NdJ("resize",function(sn){return ht.resize(sn)},!1,w.Jf7)},inputs:{content:"content"},features:[w.TTD],decls:3,vars:5,consts:[[1,"container"],["container",""],[4,"ngFor","ngForOf"],[3,"content","item"]],template:function(re,ht){1&re&&(w.TgZ(0,"div",0,1),w.YNc(2,ft,3,4,"ng-container",2),w.qZA()),2&re&&(w.ekj("fast-scroll",ht.content.fastScroll)("scroll-lock",ht.content.scrollLock),w.xp6(2),w.Q6J("ngForOf",ht.content.messages))},directives:[Xt,ae.sg],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column;justify-content:flex-end;overflow-y:hidden;flex:1 1 100%}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;flex-flow:column;height:100%;margin-left:0;margin-right:0;flex-basis:auto;flex-grow:1;flex-shrink:1;overflow-wrap:break-word;overflow-y:auto;overflow:-moz-scrollbars-none;-ms-overflow-style:none;scroll-behavior:smooth}[_nghost-%COMP%]   .container.scroll-lock[_ngcontent-%COMP%]{overflow-y:hidden}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]::-webkit-scrollbar{width:0!important}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{margin-top:auto}[_nghost-%COMP%]   .container.fast-scroll[_ngcontent-%COMP%]{scroll-behavior:auto}"]}),ve})(),En=(()=>{class ve{constructor(){this.inputRequired=!0,this.suggestions=null,this.visibleSuggestions=null,this.value=null,this.valid=!0;try{const re=new Intl.Collator(["he","en","ru","ar","fr","es"],{sensitivity:"base"});this.comparer=re.compare}catch(re){this.comparer=(ht,zt)=>ht.toUpperCase()===zt.toUpperCase()?0:1}}ngOnInit(){setTimeout(()=>{this.validate()},0)}ngOnChanges(){window.setTimeout(()=>{if(this.input){const re=this.input.nativeElement;re&&re.focus()}},0)}onSubmit(){const re=this.input.nativeElement;this.value=re.value,this.visibleSuggestions=null,re.value="",this.content.reportInput(this.value)}updateSuggestions(re){if(this.suggestions&&this.suggestions.length&&re.length>1){this.visibleSuggestions=[];const ht=re.length;for(const zt of this.suggestions){const sn=zt.slice(0,ht);0===this.comparer(re,sn)&&this.visibleSuggestions.push([sn,zt.slice(ht)])}}else this.visibleSuggestions=null}selectSuggestion(re,ht){re=re[0]+re[1],this.input&&(this.input.nativeElement.value=re,this.validate(),this.valid&&(this.onSubmit(),this.visibleSuggestions=null)),ht&&ht.preventDefault()}validate(){if(this.input){const re=this.input.nativeElement.value;if(this.updateSuggestions(re),this.valid=!this.inputRequired||!!re,!this.valid)return console.log("invalid as inputRequired="+this.inputRequired+", value="+re),!1;if(this.valid=!this.input.nativeElement.validity||this.input.nativeElement.validity.valid,!this.valid)return console.log("invalid as nativeElement.validity="+this.input.nativeElement.validity+", validity.valid="+this.input.nativeElement.validity.valid),!1;if(this.valid=!this.validator||this.validator(re),!this.valid)return console.log("invalid as validator="+this.validator+", validator(value)="+this.validator(re)),!1}else if(this.valid=!this.validator||this.validator(""),!this.valid)return console.log("invalid as validator="+this.validator+', validator("")='+this.validator("")),!1;return this.valid}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-input"]],viewQuery:function(re,ht){if(1&re&&w.Gf(Zt,5),2&re){let zt;w.iGM(zt=w.CRH())&&(ht.input=zt.first)}},inputs:{content:"content",inputEnabled:"inputEnabled",textArea:"textArea",inputKind:"inputKind",inputMin:"inputMin",inputMax:"inputMax",inputStep:"inputStep",placeholder:"placeholder",inputRequired:"inputRequired",suggestions:"suggestions",validator:"validator"},features:[w.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"textarea"],["rows","4","autofocus","",3,"placeholder","keyup","change"],["input",""],[3,"innerHTML","disabled","click"],["class","suggestions-wrapper",4,"ngIf"],["class","input",3,"invalid",4,"ngIf"],[1,"suggestions-wrapper"],[1,"suggestions"],["class","suggestion",3,"click","touchstart",4,"ngFor","ngForOf"],[1,"suggestion",3,"click","touchstart"],[1,"input"],["autofocus","",3,"type","disabled","placeholder","keyup","change"],[3,"disabled","innerHTML","click"]],template:function(re,ht){1&re&&(w.YNc(0,nn,5,3,"ng-container",0),w.YNc(1,jn,3,2,"ng-container",0)),2&re&&(w.Q6J("ngIf",ht.textArea&&ht.inputEnabled),w.xp6(1),w.Q6J("ngIf",!ht.textArea||!ht.inputEnabled))},directives:[ae.O5,ae.sg],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column;flex:0 0 auto}[_nghost-%COMP%]   .textarea[_ngcontent-%COMP%], [_nghost-%COMP%]   .input[_ngcontent-%COMP%]{display:flex;flex-flow:row;justify-content:stretch;align-items:center}[_nghost-%COMP%]   .textarea[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], [_nghost-%COMP%]   .input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:0 0 auto}[_nghost-%COMP%]   .textarea[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], [_nghost-%COMP%]   .input[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], [_nghost-%COMP%]   .textarea[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], [_nghost-%COMP%]   .input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1 1 100%}[_nghost-%COMP%]   .suggestions-wrapper[_ngcontent-%COMP%]{position:relative;overflow:visible;width:100%;height:0px}[_nghost-%COMP%]   .suggestions-wrapper[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]{position:absolute;bottom:0px;border:1px solid #89a9a8;margin:8px 0;z-index:1;width:100%;max-height:200px;overflow-y:scroll;overflow-x:hidden;display:flex;flex-flow:column;align-items:stretch;padding:0 8px;border-radius:8px;box-shadow:0 4px 8px #0000001f;background-color:#fff}[_nghost-%COMP%]   .suggestions-wrapper[_ngcontent-%COMP%]   .suggestions[_ngcontent-%COMP%]   .suggestion[_ngcontent-%COMP%]{display:flex;flex:0 0 auto;flex-flow:row;align-items:center;justify-content:flex-start;height:40px;font-size:22px;border-bottom:solid 1px rgba(0,0,0,.12);padding:0 8px;white-space:pre;cursor:pointer}"]}),ve})(),bn=(()=>{class ve{constructor(){}ngOnInit(){}}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-chatbox"]],inputs:{content:"content"},decls:2,vars:14,consts:[[3,"content"],[3,"inputEnabled","textArea","inputKind","inputMin","inputMax","inputStep","inputRequired","suggestions","content","placeholder","validator"]],template:function(re,ht){1&re&&(w._UZ(0,"htl-messages",0),w._UZ(1,"htl-input",1)),2&re&&(w.Q6J("content",ht.content),w.xp6(1),w.ekj("enabled",ht.content.inputEnabled),w.Q6J("inputEnabled",ht.content.inputEnabled)("textArea",ht.content.textArea)("inputKind",ht.content.inputKind)("inputMin",ht.content.inputMin)("inputMax",ht.content.inputMax)("inputStep",ht.content.inputStep)("inputRequired",ht.content.inputRequired)("suggestions",ht.content.inputSuggestions)("content",ht.content)("placeholder",ht.content.placeholder)("validator",ht.content.validator))},directives:[ln,En],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-flow:column}"]}),ve})(),Wn=(()=>{class ve{constructor(re){this.contentService=re}ngOnInit(){this.content=this.content?this.content:this.contentService.M}}return ve.\u0275fac=function(re){return new(re||ve)(w.Y36(lr))},ve.\u0275cmp=w.Xpm({type:ve,selectors:[["htl-hatool"]],inputs:{content:"content"},decls:1,vars:1,consts:[[3,"content"]],template:function(re,ht){1&re&&w._UZ(0,"htl-chatbox",0),2&re&&w.Q6J("content",ht.content)},directives:[bn],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}"]}),ve})(),jt=(()=>{class ve{}return ve.\u0275fac=function(re){return new(re||ve)},ve.\u0275mod=w.oAB({type:ve}),ve.\u0275inj=w.cJS({imports:[[$e.b2,se.JF]]}),ve})()},2940:function(Sn,Nt){!function(H){"use strict";function w(ct){return Array.prototype.slice.call(ct)}function ue(ct){return new Promise(function(ut,he){ct.onsuccess=function(){ut(ct.result)},ct.onerror=function(){he(ct.error)}})}function g(ct,ut,he){var je,Ae=new Promise(function(j,W){ue(je=ct[ut].apply(ct,he)).then(j,W)});return Ae.request=je,Ae}function nt(ct,ut,he){var je=g(ct,ut,he);return je.then(function(Ae){if(Ae)return new se(Ae,je.request)})}function xe(ct,ut,he){he.forEach(function(je){Object.defineProperty(ct.prototype,je,{get:function(){return this[ut][je]},set:function(Ae){this[ut][je]=Ae}})})}function Le(ct,ut,he,je){je.forEach(function(Ae){Ae in he.prototype&&(ct.prototype[Ae]=function(){return g(this[ut],Ae,arguments)})})}function Re(ct,ut,he,je){je.forEach(function(Ae){Ae in he.prototype&&(ct.prototype[Ae]=function(){return this[ut][Ae].apply(this[ut],arguments)})})}function Ue(ct,ut,he,je){je.forEach(function(Ae){Ae in he.prototype&&(ct.prototype[Ae]=function(){return nt(this[ut],Ae,arguments)})})}function fe(ct){this._index=ct}function se(ct,ut){this._cursor=ct,this._request=ut}function ae(ct){this._store=ct}function $e(ct){this._tx=ct,this.complete=new Promise(function(ut,he){ct.oncomplete=function(){ut()},ct.onerror=function(){he(ct.error)},ct.onabort=function(){he(ct.error)}})}function St(ct,ut,he){this._db=ct,this.oldVersion=ut,this.transaction=new $e(he)}function pt(ct){this._db=ct}xe(fe,"_index",["name","keyPath","multiEntry","unique"]),Le(fe,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),Ue(fe,"_index",IDBIndex,["openCursor","openKeyCursor"]),xe(se,"_cursor",["direction","key","primaryKey","value"]),Le(se,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(ct){ct in IDBCursor.prototype&&(se.prototype[ct]=function(){var ut=this,he=arguments;return Promise.resolve().then(function(){return ut._cursor[ct].apply(ut._cursor,he),ue(ut._request).then(function(je){if(je)return new se(je,ut._request)})})})}),ae.prototype.createIndex=function(){return new fe(this._store.createIndex.apply(this._store,arguments))},ae.prototype.index=function(){return new fe(this._store.index.apply(this._store,arguments))},xe(ae,"_store",["name","keyPath","indexNames","autoIncrement"]),Le(ae,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),Ue(ae,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),Re(ae,"_store",IDBObjectStore,["deleteIndex"]),$e.prototype.objectStore=function(){return new ae(this._tx.objectStore.apply(this._tx,arguments))},xe($e,"_tx",["objectStoreNames","mode"]),Re($e,"_tx",IDBTransaction,["abort"]),St.prototype.createObjectStore=function(){return new ae(this._db.createObjectStore.apply(this._db,arguments))},xe(St,"_db",["name","version","objectStoreNames"]),Re(St,"_db",IDBDatabase,["deleteObjectStore","close"]),pt.prototype.transaction=function(){return new $e(this._db.transaction.apply(this._db,arguments))},xe(pt,"_db",["name","version","objectStoreNames"]),Re(pt,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(ct){[ae,fe].forEach(function(ut){ct in ut.prototype&&(ut.prototype[ct.replace("open","iterate")]=function(){var he=w(arguments),je=he[he.length-1],Ae=this._store||this._index,j=Ae[ct].apply(Ae,he.slice(0,-1));j.onsuccess=function(){je(j.result)}})})}),[fe,ae].forEach(function(ct){ct.prototype.getAll||(ct.prototype.getAll=function(ut,he){var je=this,Ae=[];return new Promise(function(j){je.iterateCursor(ut,function(W){W?(Ae.push(W.value),void 0===he||Ae.length!=he?W.continue():j(Ae)):j(Ae)})})})}),H.openDb=function bt(ct,ut,he){var je=g(indexedDB,"open",[ct,ut]),Ae=je.request;return Ae&&(Ae.onupgradeneeded=function(j){he&&he(new St(Ae.result,j.oldVersion,Ae.transaction))}),je.then(function(j){return new pt(j)})},H.deleteDb=function Ct(ct){return g(indexedDB,"deleteDatabase",[ct])},Object.defineProperty(H,"__esModule",{value:!0})}(Nt)},9898:function(Sn){Sn.exports=function(){"use strict";var Nt,H,w;function ue(g,nt){if(Nt)if(H){var xe="var sharedChunk = {}; ("+Nt+")(sharedChunk); ("+H+")(sharedChunk);",Le={};Nt(Le),w=nt(Le),"undefined"!=typeof window&&(w.workerUrl=window.URL.createObjectURL(new Blob([xe],{type:"text/javascript"})))}else H=nt;else Nt=nt}return ue(0,function(g){function nt(t,i){return t(i={exports:{}},i.exports),i.exports}var xe=Le;function Le(t,i,u,p){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(p-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=p,this.p2x=u,this.p2y=p}Le.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Le.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Le.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Le.prototype.solveCurveX=function(t,i){var u,p,v,x,C;for(void 0===i&&(i=1e-6),v=t,C=0;C<8;C++){if(x=this.sampleCurveX(v)-t,Math.abs(x)<i)return v;var O=this.sampleCurveDerivativeX(v);if(Math.abs(O)<1e-6)break;v-=x/O}if((v=t)<(u=0))return u;if(v>(p=1))return p;for(;u<p;){if(x=this.sampleCurveX(v),Math.abs(x-t)<i)return v;t>x?u=v:p=v,v=.5*(p-u)+u}return v},Le.prototype.solve=function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))};var Re=Ue;function Ue(t,i){this.x=t,this.y=i}Ue.prototype={clone:function(){return new Ue(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,i){return this.clone()._rotateAround(t,i)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var i=t.x-this.x,u=t.y-this.y;return i*i+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,i){return Math.atan2(this.x*i-this.y*t,this.x*t+this.y*i)},_matMult:function(t){var i=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var i=Math.cos(t),u=Math.sin(t),p=u*this.x+i*this.y;return this.x=i*this.x-u*this.y,this.y=p,this},_rotateAround:function(t,i){var u=Math.cos(t),p=Math.sin(t),v=i.y+p*(this.x-i.x)+u*(this.y-i.y);return this.x=i.x+u*(this.x-i.x)-p*(this.y-i.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ue.convert=function(t){return t instanceof Ue?t:Array.isArray(t)?new Ue(t[0],t[1]):t};var fe="undefined"!=typeof self?self:{},se=Math.pow(2,53)-1;function ae(t,i,u,p){var v=new xe(t,i,u,p);return function(x){return v.solve(x)}}var $e=ae(.25,.1,.25,1);function St(t,i,u){return Math.min(u,Math.max(i,t))}function pt(t,i,u){var p=u-i,v=((t-i)%p+p)%p+i;return v===i?u:v}function bt(t){for(var i=[],u=arguments.length-1;u-- >0;)i[u]=arguments[u+1];for(var p=0,v=i;p<v.length;p+=1){var x=v[p];for(var C in x)t[C]=x[C]}return t}var Ct=1;function ct(){return Ct++}function ut(){return function t(i){return i?(i^16*Math.random()>>i/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function he(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function je(t,i){t.forEach(function(u){i[u]&&(i[u]=i[u].bind(i))})}function Ae(t,i){return-1!==t.indexOf(i,t.length-i.length)}function j(t,i,u){var p={};for(var v in t)p[v]=i.call(u||this,t[v],v,t);return p}function W(t,i,u){var p={};for(var v in t)i.call(u||this,t[v],v,t)&&(p[v]=t[v]);return p}function ge(t){return Array.isArray(t)?t.map(ge):"object"==typeof t&&t?j(t,ge):t}var q={};function U(t){q[t]||("undefined"!=typeof console&&console.warn(t),q[t]=!0)}function Y(t,i,u){return(u.y-t.y)*(i.x-t.x)>(i.y-t.y)*(u.x-t.x)}function ee(t){for(var i=0,u=0,p=t.length,v=p-1,x=void 0,C=void 0;u<p;v=u++)i+=((C=t[v]).x-(x=t[u]).x)*(x.y+C.y);return i}function Pe(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function _e(t){var i={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(p,v,x,C){var O=x||C;return i[v]=!O||O.toLowerCase(),""}),i["max-age"]){var u=parseInt(i["max-age"],10);isNaN(u)?delete i["max-age"]:i["max-age"]=u}return i}var We=null;function rt(t){if(null==We){var i=t.navigator?t.navigator.userAgent:null;We=!!t.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return We}function _t(t){try{var i=fe[t];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch(u){return!1}}var ft,Zt,nn,qt,An=fe.performance&&fe.performance.now?fe.performance.now.bind(fe.performance):Date.now.bind(Date),kn=fe.requestAnimationFrame||fe.mozRequestAnimationFrame||fe.webkitRequestAnimationFrame||fe.msRequestAnimationFrame,jn=fe.cancelAnimationFrame||fe.mozCancelAnimationFrame||fe.webkitCancelAnimationFrame||fe.msCancelAnimationFrame,gr={now:An,frame:function(t){var i=kn(t);return{cancel:function(){return jn(i)}}},getImageData:function(t,i){void 0===i&&(i=0);var u=fe.document.createElement("canvas"),p=u.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,p.drawImage(t,0,0,t.width,t.height),p.getImageData(-i,-i,t.width+2*i,t.height+2*i)},resolveURL:function(t){return ft||(ft=fe.document.createElement("a")),ft.href=t,ft.href},hardwareConcurrency:fe.navigator&&fe.navigator.hardwareConcurrency||4,get devicePixelRatio(){return fe.devicePixelRatio},get prefersReducedMotion(){return!!fe.matchMedia&&(null==Zt&&(Zt=fe.matchMedia("(prefers-reduced-motion: reduce)")),Zt.matches)}},lr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Er={supported:!1,testSupport:function(t){!Sr&&qt&&(di?vr(t):nn=t)}},Sr=!1,di=!1;function vr(t){var i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,qt),t.isContextLost())return;Er.supported=!0}catch(u){}t.deleteTexture(i),Sr=!0}fe.document&&((qt=fe.document.createElement("img")).onload=function(){nn&&vr(nn),nn=null,di=!0},qt.onerror=function(){Sr=!0,nn=null},qt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var qi="01",ii=function(t,i){this._transformRequestFn=t,this._customAccessToken=i,this._createSkuToken()};function fi(t){return 0===t.indexOf("mapbox:")}ii.prototype._createSkuToken=function(){var t=function(){for(var i="",u=0;u<10;u++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",qi,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},ii.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ii.prototype.transformRequest=function(t,i){return this._transformRequestFn&&this._transformRequestFn(t,i)||{url:t}},ii.prototype.normalizeStyleURL=function(t,i){if(!fi(t))return t;var u=Xt(t);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||i)},ii.prototype.normalizeGlyphsURL=function(t,i){if(!fi(t))return t;var u=Xt(t);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||i)},ii.prototype.normalizeSourceURL=function(t,i){if(!fi(t))return t;var u=Xt(t);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||i)},ii.prototype.normalizeSpriteURL=function(t,i,u,p){var v=Xt(t);return fi(t)?(v.path="/styles/v1"+v.path+"/sprite"+i+u,this._makeAPIURL(v,this._customAccessToken||p)):(v.path+=""+i+u,ln(v))},ii.prototype.normalizeTileURL=function(t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!fi(t))return t;var u=Xt(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(gr.devicePixelRatio>=2||512===i?"@2x":"")+(Er.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var p=this._customAccessToken||function(v){for(var x=0,C=v;x<C.length;x+=1){var O=C[x].match(/^access_token=(.*)$/);if(O)return O[1]}return null}(u.params)||lr.ACCESS_TOKEN;return lr.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,p)},ii.prototype.canonicalizeTileURL=function(t,i){var u=Xt(t);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return t;var p="mapbox://tiles/";p+=u.path.replace("/v4/","");var v=u.params;return i&&(v=v.filter(function(x){return!x.match(/^access_token=/)})),v.length&&(p+="?"+v.join("&")),p},ii.prototype.canonicalizeTileset=function(t,i){for(var u=!!i&&fi(i),p=[],v=0,x=t.tiles||[];v<x.length;v+=1){var C=x[v];pi(C)?p.push(this.canonicalizeTileURL(C,u)):p.push(C)}return p},ii.prototype._makeAPIURL=function(t,i){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",p=Xt(lr.API_URL);if(t.protocol=p.protocol,t.authority=p.authority,"http"===t.protocol){var v=t.params.indexOf("secure");v>=0&&t.params.splice(v,1)}if("/"!==p.path&&(t.path=""+p.path+t.path),!lr.REQUIRE_ACCESS_TOKEN)return ln(t);if(!(i=i||lr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if("s"===i[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return t.params=t.params.filter(function(x){return-1===x.indexOf("access_token")}),t.params.push("access_token="+i),ln(t)};var bi=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function pi(t){return bi.test(t)}var oi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Xt(t){var i=t.match(oi);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function ln(t){var i=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+i}function En(t){if(!t)return null;var i=t.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(fe.atob(i[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(u){return null}}var bn=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};bn.prototype.getStorageKey=function(t){var i,u=En(lr.ACCESS_TOKEN);return i=u&&u.u?fe.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(p,v){return String.fromCharCode(Number("0x"+v))})):lr.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+i:"mapbox.eventData:"+i},bn.prototype.fetchEventData=function(){var t=_t("localStorage"),i=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{var p=fe.localStorage.getItem(i);p&&(this.eventData=JSON.parse(p));var v=fe.localStorage.getItem(u);v&&(this.anonId=v)}catch(x){U("Unable to read from LocalStorage")}},bn.prototype.saveEventData=function(){var t=_t("localStorage"),i=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{fe.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&fe.localStorage.setItem(i,JSON.stringify(this.eventData))}catch(p){U("Unable to write to LocalStorage")}},bn.prototype.processRequests=function(t){},bn.prototype.postEvent=function(t,i,u,p){var v=this;if(lr.EVENTS_URL){var x=Xt(lr.EVENTS_URL);x.params.push("access_token="+(p||lr.ACCESS_TOKEN||""));var C={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:qi,userId:this.anonId},O=i?bt(C,i):C,K={url:ln(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([O])};this.pendingRequest=Pn(K,function(ie){v.pendingRequest=null,u(ie),v.saveEventData(),v.processRequests(p)})}},bn.prototype.queueRequest=function(t,i){this.queue.push(t),this.processRequests(i)};var Wn,jt,ve=function(t){function i(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.postMapLoadEvent=function(u,p,v,x){this.skuToken=v,(lr.EVENTS_URL&&x||lr.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(C){return fi(C)||pi(C)}))&&this.queueRequest({id:p,timestamp:Date.now()},x)},i.prototype.processRequests=function(u){var p=this;if(!this.pendingRequest&&0!==this.queue.length){var v=this.queue.shift(),x=v.id,C=v.timestamp;x&&this.success[x]||(this.anonId||this.fetchEventData(),he(this.anonId)||(this.anonId=ut()),this.postEvent(C,{skuToken:this.skuToken},function(O){O||x&&(p.success[x]=!0)},u))}},i}(bn),me=new(function(t){function i(u){t.call(this,"appUserTurnstile"),this._customAccessToken=u}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.postTurnstileEvent=function(u,p){lr.EVENTS_URL&&lr.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(v){return fi(v)||pi(v)})&&this.queueRequest(Date.now(),p)},i.prototype.processRequests=function(u){var p=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var v=En(lr.ACCESS_TOKEN),x=v?v.u:lr.ACCESS_TOKEN,C=x!==this.eventData.tokenU;he(this.anonId)||(this.anonId=ut(),C=!0);var O=this.queue.shift();if(this.eventData.lastSuccess){var K=new Date(this.eventData.lastSuccess),ie=new Date(O),pe=(O-this.eventData.lastSuccess)/864e5;C=C||pe>=1||pe<-1||K.getDate()!==ie.getDate()}else C=!0;if(!C)return this.processRequests();this.postEvent(O,{"enabled.telemetry":!1},function(Ee){Ee||(p.eventData.lastSuccess=O,p.eventData.tokenU=x)},u)}},i}(bn)),re=me.postTurnstileEvent.bind(me),ht=new ve,zt=ht.postMapLoadEvent.bind(ht),sn=500,Mn=50;function Jn(){fe.caches&&!Wn&&(Wn=fe.caches.open("mapbox-tiles"))}function Tr(t){var i=t.indexOf("?");return i<0?t:t.slice(0,i)}var wr,Ki=1/0;function Li(){return null==wr&&(wr=fe.OffscreenCanvas&&new fe.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof fe.createImageBitmap),wr}var Ht={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Ht);var tt,Ft,Te=function(t){function i(u,p,v){401===p&&pi(v)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,u),this.status=p,this.url=v,this.name=this.constructor.name,this.message=u}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},i}(Error),ke=Pe()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===fe.location.protocol?fe.parent:fe).location.href},vt=function(t,i){if(!(/^file:/.test(u=t.url)||/^file:/.test(ke())&&!/^\w+:/.test(u))){if(fe.fetch&&fe.Request&&fe.AbortController&&fe.Request.prototype.hasOwnProperty("signal"))return function(p,v){var x,C=new fe.AbortController,O=new fe.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:ke(),signal:C.signal}),K=!1,ie=!1,pe=(x=O.url).indexOf("sku=")>0&&pi(x);"json"===p.type&&O.headers.set("Accept","application/json");var Ee=function(Ye,yt,Et){if(!ie){if(Ye&&"SecurityError"!==Ye.message&&U(Ye),yt&&Et)return Be(yt);var Vt=Date.now();fe.fetch(O).then(function(At){if(At.ok){var Wt=pe?At.clone():null;return Be(At,Wt,Vt)}return v(new Te(At.statusText,At.status,p.url))}).catch(function(At){20!==At.code&&v(new Error(At.message))})}},Be=function(Ye,yt,Et){("arrayBuffer"===p.type?Ye.arrayBuffer():"json"===p.type?Ye.json():Ye.text()).then(function(Vt){ie||(yt&&Et&&function(At,Wt,rn){if(Jn(),Wn){var fn={status:Wt.status,statusText:Wt.statusText,headers:new fe.Headers};Wt.headers.forEach(function(Tn,qn){return fn.headers.set(qn,Tn)});var cn=_e(Wt.headers.get("Cache-Control")||"");cn["no-store"]||(cn["max-age"]&&fn.headers.set("Expires",new Date(rn+1e3*cn["max-age"]).toUTCString()),new Date(fn.headers.get("Expires")).getTime()-rn<42e4||function(Tn,qn){if(void 0===jt)try{new Response(new ReadableStream),jt=!0}catch(ir){jt=!1}jt?qn(Tn.body):Tn.blob().then(qn)}(Wt,function(Tn){var qn=new fe.Response(Tn,fn);Jn(),Wn&&Wn.then(function(ir){return ir.put(Tr(At.url),qn)}).catch(function(ir){return U(ir.message)})}))}}(O,yt,Et),K=!0,v(null,Vt,Ye.headers.get("Cache-Control"),Ye.headers.get("Expires")))}).catch(function(Vt){ie||v(new Error(Vt.message))})};return pe?function(Ye,yt){if(Jn(),!Wn)return yt(null);var Et=Tr(Ye.url);Wn.then(function(Vt){Vt.match(Et).then(function(At){var Wt=function(rn){if(!rn)return!1;var fn=new Date(rn.headers.get("Expires")||0),cn=_e(rn.headers.get("Cache-Control")||"");return fn>Date.now()&&!cn["no-cache"]}(At);Vt.delete(Et),Wt&&Vt.put(Et,At.clone()),yt(null,At,Wt)}).catch(yt)}).catch(yt)}(O,Ee):Ee(null,null),{cancel:function(){ie=!0,K||C.abort()}}}(t,i);if(Pe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,i,void 0,!0)}var u;return function(p,v){var x=new fe.XMLHttpRequest;for(var C in x.open(p.method||"GET",p.url,!0),"arrayBuffer"===p.type&&(x.responseType="arraybuffer"),p.headers)x.setRequestHeader(C,p.headers[C]);return"json"===p.type&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials="include"===p.credentials,x.onerror=function(){v(new Error(x.statusText))},x.onload=function(){if((x.status>=200&&x.status<300||0===x.status)&&null!==x.response){var O=x.response;if("json"===p.type)try{O=JSON.parse(x.response)}catch(K){return v(K)}v(null,O,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else v(new Te(x.statusText,x.status,p.url))},x.send(p.body),{cancel:function(){return x.abort()}}}(t,i)},dn=function(t,i){return vt(bt(t,{type:"arrayBuffer"}),i)},Pn=function(t,i){return vt(bt(t,{method:"POST"}),i)},ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";tt=[],Ft=0;var be=function(t,i){if(Er.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Ft>=lr.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:i,cancelled:!1,cancel:function(){this.cancelled=!0}};return tt.push(u),u}Ft++;var p=!1,v=function(){if(!p)for(p=!0,Ft--;tt.length&&Ft<lr.MAX_PARALLEL_IMAGE_REQUESTS;){var C=tt.shift();C.cancelled||(C.cancel=be(C.requestParameters,C.callback).cancel)}},x=dn(t,function(C,O,K,ie){var Ee,Be;v(),C?i(C):O&&(Li()?(Ee=i,Be=new fe.Blob([new Uint8Array(O)],{type:"image/png"}),fe.createImageBitmap(Be).then(function(Ye){Ee(null,Ye)}).catch(function(Ye){Ee(new Error("Could not load image because of "+Ye.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(pe,Ee,Be,Ye){var yt=new fe.Image,Et=fe.URL;yt.onload=function(){Ee(null,yt),Et.revokeObjectURL(yt.src),yt.onload=null,yt.src=ce},yt.onerror=function(){return Ee(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Vt=new fe.Blob([new Uint8Array(pe)],{type:"image/png"});yt.cacheControl=Be,yt.expires=Ye,yt.src=pe.byteLength?Et.createObjectURL(Vt):ce}(O,i,K,ie))});return{cancel:function(){x.cancel(),v()}}};function Oe(t,i,u){u[t]&&-1!==u[t].indexOf(i)||(u[t]=u[t]||[],u[t].push(i))}function Qe(t,i,u){if(u&&u[t]){var p=u[t].indexOf(i);-1!==p&&u[t].splice(p,1)}}var ot=function(t,i){void 0===i&&(i={}),bt(this,i),this.type=t},Dt=function(t){function i(u,p){void 0===p&&(p={}),t.call(this,"error",bt({error:u},p))}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(ot),Lt=function(){};Lt.prototype.on=function(t,i){return this._listeners=this._listeners||{},Oe(t,i,this._listeners),this},Lt.prototype.off=function(t,i){return Qe(t,i,this._listeners),Qe(t,i,this._oneTimeListeners),this},Lt.prototype.once=function(t,i){return this._oneTimeListeners=this._oneTimeListeners||{},Oe(t,i,this._oneTimeListeners),this},Lt.prototype.fire=function(t,i){"string"==typeof t&&(t=new ot(t,i||{}));var u=t.type;if(this.listens(u)){t.target=this;for(var p=0,v=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];p<v.length;p+=1)v[p].call(this,t);for(var x=0,C=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];x<C.length;x+=1){var O=C[x];Qe(u,O,this._oneTimeListeners),O.call(this,t)}var K=this._eventedParent;K&&(bt(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),K.fire(t))}else t instanceof Dt&&console.error(t.error);return this},Lt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},Lt.prototype.setEventedParent=function(t,i){return this._eventedParent=t,this._eventedParentData=i,this};var Je={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ie=function(t,i,u,p){this.message=(t?t+": ":"")+u,p&&(this.identifier=p),null!=i&&i.__line__&&(this.line=i.__line__)};function ze(t){var i=t.value;return i?[new Ie(t.key,i,"constants have been deprecated as of v8")]:[]}function Ve(t){for(var i=[],u=arguments.length-1;u-- >0;)i[u]=arguments[u+1];for(var p=0,v=i;p<v.length;p+=1){var x=v[p];for(var C in x)t[C]=x[C]}return t}function mt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Tt(t){if(Array.isArray(t))return t.map(Tt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var i={};for(var u in t)i[u]=Tt(t[u]);return i}return mt(t)}var en=function(t){function i(u,p){t.call(this,p),this.message=p,this.key=u}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(Error),Dn=function(t,i){void 0===i&&(i=[]),this.parent=t,this.bindings={};for(var u=0,p=i;u<p.length;u+=1){var v=p[u];this.bindings[v[0]]=v[1]}};Dn.prototype.concat=function(t){return new Dn(this,t)},Dn.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Dn.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var zn={kind:"null"},an={kind:"number"},Kn={kind:"string"},Yn={kind:"boolean"},Hn={kind:"color"},Ir={kind:"object"},Xn={kind:"value"},br={kind:"collator"},yn={kind:"formatted"},ur={kind:"resolvedImage"};function Dr(t,i){return{kind:"array",itemType:t,N:i}}function jr(t){if("array"===t.kind){var i=jr(t.itemType);return"number"==typeof t.N?"array<"+i+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+i+">"}return t.kind}var oo=[zn,an,Kn,Yn,Hn,yn,Ir,Dr(Xn),ur];function zr(t,i){if("error"===i.kind)return null;if("array"===t.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!zr(t.itemType,i.itemType))&&("number"!=typeof t.N||t.N===i.N))return null}else{if(t.kind===i.kind)return null;if("value"===t.kind)for(var u=0,p=oo;u<p.length;u+=1)if(!zr(p[u],i))return null}return"Expected "+jr(t)+" but found "+jr(i)+" instead."}function Ci(t,i){return i.some(function(u){return u.kind===t.kind})}function Mr(t,i){return i.some(function(u){return"null"===u?null===t:"array"===u?Array.isArray(t):"object"===u?t&&!Array.isArray(t)&&"object"==typeof t:u===typeof t})}var Gr=nt(function(t,i){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function p(O){return(O=Math.round(O))<0?0:O>255?255:O}function v(O){return p("%"===O[O.length-1]?parseFloat(O)/100*255:parseInt(O))}function x(O){return(K="%"===O[O.length-1]?parseFloat(O)/100:parseFloat(O))<0?0:K>1?1:K;var K}function C(O,K,ie){return ie<0?ie+=1:ie>1&&(ie-=1),6*ie<1?O+(K-O)*ie*6:2*ie<1?K:3*ie<2?O+(K-O)*(2/3-ie)*6:O}try{i.parseCSSColor=function(O){var K,ie=O.replace(/ /g,"").toLowerCase();if(ie in u)return u[ie].slice();if("#"===ie[0])return 4===ie.length?(K=parseInt(ie.substr(1),16))>=0&&K<=4095?[(3840&K)>>4|(3840&K)>>8,240&K|(240&K)>>4,15&K|(15&K)<<4,1]:null:7===ie.length&&(K=parseInt(ie.substr(1),16))>=0&&K<=16777215?[(16711680&K)>>16,(65280&K)>>8,255&K,1]:null;var pe=ie.indexOf("("),Ee=ie.indexOf(")");if(-1!==pe&&Ee+1===ie.length){var Be=ie.substr(0,pe),Ye=ie.substr(pe+1,Ee-(pe+1)).split(","),yt=1;switch(Be){case"rgba":if(4!==Ye.length)return null;yt=x(Ye.pop());case"rgb":return 3!==Ye.length?null:[v(Ye[0]),v(Ye[1]),v(Ye[2]),yt];case"hsla":if(4!==Ye.length)return null;yt=x(Ye.pop());case"hsl":if(3!==Ye.length)return null;var Et=(parseFloat(Ye[0])%360+360)%360/360,Vt=x(Ye[1]),At=x(Ye[2]),Wt=At<=.5?At*(Vt+1):At+Vt-At*Vt,rn=2*At-Wt;return[p(255*C(rn,Wt,Et+1/3)),p(255*C(rn,Wt,Et)),p(255*C(rn,Wt,Et-1/3)),yt];default:return null}}return null}}catch(O){}}).parseCSSColor,Fr=function(t,i,u,p){void 0===p&&(p=1),this.r=t,this.g=i,this.b=u,this.a=p};Fr.parse=function(t){if(t){if(t instanceof Fr)return t;if("string"==typeof t){var i=Gr(t);if(i)return new Fr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3])}}},Fr.prototype.toString=function(){var t=this.toArray(),i=t[1],u=t[2],p=t[3];return"rgba("+Math.round(t[0])+","+Math.round(i)+","+Math.round(u)+","+p+")"},Fr.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Fr.black=new Fr(0,0,0,1),Fr.white=new Fr(1,1,1,1),Fr.transparent=new Fr(0,0,0,0),Fr.red=new Fr(1,0,0,1);var Vr=function(t,i,u){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Vr.prototype.compare=function(t,i){return this.collator.compare(t,i)},Vr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var hs=function(t,i,u,p,v){this.text=t,this.image=i,this.scale=u,this.fontStack=p,this.textColor=v},Yi=function(t){this.sections=t};Yi.fromString=function(t){return new Yi([new hs(t,null,null,null,null)])},Yi.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},Yi.factory=function(t){return t instanceof Yi?t:Yi.fromString(t)},Yi.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},Yi.prototype.serialize=function(){for(var t=["format"],i=0,u=this.sections;i<u.length;i+=1){var p=u[i];if(p.image)t.push(["image",p.image.name]);else{t.push(p.text);var v={};p.fontStack&&(v["text-font"]=["literal",p.fontStack.split(",")]),p.scale&&(v["font-scale"]=p.scale),p.textColor&&(v["text-color"]=["rgba"].concat(p.textColor.toArray())),t.push(v)}}return t};var Ao=function(t){this.name=t.name,this.available=t.available};function Bo(t,i,u,p){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===p||"number"==typeof p&&p>=0&&p<=1?null:"Invalid rgba value ["+[t,i,u,p].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof p?[t,i,u,p]:[t,i,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Pi(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof Fr||t instanceof Vr||t instanceof Yi||t instanceof Ao)return!0;if(Array.isArray(t)){for(var i=0,u=t;i<u.length;i+=1)if(!Pi(u[i]))return!1;return!0}if("object"==typeof t){for(var p in t)if(!Pi(t[p]))return!1;return!0}return!1}function Si(t){if(null===t)return zn;if("string"==typeof t)return Kn;if("boolean"==typeof t)return Yn;if("number"==typeof t)return an;if(t instanceof Fr)return Hn;if(t instanceof Vr)return br;if(t instanceof Yi)return yn;if(t instanceof Ao)return ur;if(Array.isArray(t)){for(var i,u=t.length,p=0,v=t;p<v.length;p+=1){var x=Si(v[p]);if(i){if(i===x)continue;i=Xn;break}i=x}return Dr(i||Xn,u)}return Ir}function xs(t){var i=typeof t;return null===t?"":"string"===i||"number"===i||"boolean"===i?String(t):t instanceof Fr||t instanceof Yi||t instanceof Ao?t.toString():JSON.stringify(t)}Ao.prototype.toString=function(){return this.name},Ao.fromString=function(t){return t?new Ao({name:t,available:!1}):null},Ao.prototype.serialize=function(){return["image",this.name]};var zi=function(t,i){this.type=t,this.value=i};zi.parse=function(t,i){if(2!==t.length)return i.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!Pi(t[1]))return i.error("invalid value");var u=t[1],p=Si(u),v=i.expectedType;return"array"!==p.kind||0!==p.N||!v||"array"!==v.kind||"number"==typeof v.N&&0!==v.N||(p=v),new zi(p,u)},zi.prototype.evaluate=function(){return this.value},zi.prototype.eachChild=function(){},zi.prototype.outputDefined=function(){return!0},zi.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Fr?["rgba"].concat(this.value.toArray()):this.value instanceof Yi?this.value.serialize():this.value};var Br=function(t){this.name="ExpressionEvaluationError",this.message=t};Br.prototype.toJSON=function(){return this.message};var ds={string:Kn,number:an,boolean:Yn,object:Ir},_i=function(t,i){this.type=t,this.args=i};_i.parse=function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var u,p=1,v=t[0];if("array"===v){var x,C;if(t.length>2){var O=t[1];if("string"!=typeof O||!(O in ds)||"object"===O)return i.error('The item type argument of "array" must be one of string, number, boolean',1);x=ds[O],p++}else x=Xn;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);C=t[2],p++}u=Dr(x,C)}else u=ds[v];for(var K=[];p<t.length;p++){var ie=i.parse(t[p],p,Xn);if(!ie)return null;K.push(ie)}return new _i(u,K)},_i.prototype.evaluate=function(t){for(var i=0;i<this.args.length;i++){var u=this.args[i].evaluate(t);if(!zr(this.type,Si(u)))return u;if(i===this.args.length-1)throw new Br("Expected value to be of type "+jr(this.type)+", but found "+jr(Si(u))+" instead.")}return null},_i.prototype.eachChild=function(t){this.args.forEach(t)},_i.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},_i.prototype.serialize=function(){var t=this.type,i=[t.kind];if("array"===t.kind){var u=t.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){i.push(u.kind);var p=t.N;("number"==typeof p||this.args.length>1)&&i.push(p)}}return i.concat(this.args.map(function(v){return v.serialize()}))};var fo=function(t){this.type=yn,this.sections=t};fo.parse=function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var u=t[1];if(!Array.isArray(u)&&"object"==typeof u)return i.error("First argument must be an image or text section.");for(var p=[],v=!1,x=1;x<=t.length-1;++x){var C=t[x];if(v&&"object"==typeof C&&!Array.isArray(C)){v=!1;var O=null;if(C["font-scale"]&&!(O=i.parse(C["font-scale"],1,an)))return null;var K=null;if(C["text-font"]&&!(K=i.parse(C["text-font"],1,Dr(Kn))))return null;var ie=null;if(C["text-color"]&&!(ie=i.parse(C["text-color"],1,Hn)))return null;var pe=p[p.length-1];pe.scale=O,pe.font=K,pe.textColor=ie}else{var Ee=i.parse(t[x],1,Xn);if(!Ee)return null;var Be=Ee.type.kind;if("string"!==Be&&"value"!==Be&&"null"!==Be&&"resolvedImage"!==Be)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:Ee,scale:null,font:null,textColor:null})}}return new fo(p)},fo.prototype.evaluate=function(t){return new Yi(this.sections.map(function(i){var u=i.content.evaluate(t);return Si(u)===ur?new hs("",u,null,null,null):new hs(xs(u),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))},fo.prototype.eachChild=function(t){for(var i=0,u=this.sections;i<u.length;i+=1){var p=u[i];t(p.content),p.scale&&t(p.scale),p.font&&t(p.font),p.textColor&&t(p.textColor)}},fo.prototype.outputDefined=function(){return!1},fo.prototype.serialize=function(){for(var t=["format"],i=0,u=this.sections;i<u.length;i+=1){var p=u[i];t.push(p.content.serialize());var v={};p.scale&&(v["font-scale"]=p.scale.serialize()),p.font&&(v["text-font"]=p.font.serialize()),p.textColor&&(v["text-color"]=p.textColor.serialize()),t.push(v)}return t};var Ji=function(t){this.type=ur,this.input=t};Ji.parse=function(t,i){if(2!==t.length)return i.error("Expected two arguments.");var u=i.parse(t[1],1,Kn);return u?new Ji(u):i.error("No image name provided.")},Ji.prototype.evaluate=function(t){var i=this.input.evaluate(t),u=Ao.fromString(i);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(i)>-1),u},Ji.prototype.eachChild=function(t){t(this.input)},Ji.prototype.outputDefined=function(){return!1},Ji.prototype.serialize=function(){return["image",this.input.serialize()]};var ou={"to-boolean":Yn,"to-color":Hn,"to-number":an,"to-string":Kn},ns=function(t,i){this.type=t,this.args=i};ns.parse=function(t,i){if(t.length<2)return i.error("Expected at least one argument.");var u=t[0];if(("to-boolean"===u||"to-string"===u)&&2!==t.length)return i.error("Expected one argument.");for(var p=ou[u],v=[],x=1;x<t.length;x++){var C=i.parse(t[x],x,Xn);if(!C)return null;v.push(C)}return new ns(p,v)},ns.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var i,u,p=0,v=this.args;p<v.length;p+=1){if(u=null,(i=v[p].evaluate(t))instanceof Fr)return i;if("string"==typeof i){var x=t.parseColor(i);if(x)return x}else if(Array.isArray(i)&&!(u=i.length<3||i.length>4?"Invalid rbga value "+JSON.stringify(i)+": expected an array containing either three or four numeric values.":Bo(i[0],i[1],i[2],i[3])))return new Fr(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Br(u||"Could not parse color from value '"+("string"==typeof i?i:String(JSON.stringify(i)))+"'")}if("number"===this.type.kind){for(var C=null,O=0,K=this.args;O<K.length;O+=1){if(null===(C=K[O].evaluate(t)))return 0;var ie=Number(C);if(!isNaN(ie))return ie}throw new Br("Could not convert "+JSON.stringify(C)+" to number.")}return"formatted"===this.type.kind?Yi.fromString(xs(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Ao.fromString(xs(this.args[0].evaluate(t))):xs(this.args[0].evaluate(t))},ns.prototype.eachChild=function(t){this.args.forEach(t)},ns.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},ns.prototype.serialize=function(){if("formatted"===this.type.kind)return new fo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ji(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(i){t.push(i.serialize())}),t};var fs=["Unknown","Point","LineString","Polygon"],Io=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Io.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Io.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?fs[this.feature.type]:this.feature.type:null},Io.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Io.prototype.canonicalID=function(){return this.canonical},Io.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Io.prototype.parseColor=function(t){var i=this._parseColorCache[t];return i||(i=this._parseColorCache[t]=Fr.parse(t)),i};var jo=function(t,i,u,p){this.name=t,this.type=i,this._evaluate=u,this.args=p};jo.prototype.evaluate=function(t){return this._evaluate(t,this.args)},jo.prototype.eachChild=function(t){this.args.forEach(t)},jo.prototype.outputDefined=function(){return!1},jo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},jo.parse=function(t,i){var u,p=t[0],v=jo.definitions[p];if(!v)return i.error('Unknown expression "'+p+'". If you wanted a literal array, use ["literal", [...]].',0);for(var x=Array.isArray(v)?v[0]:v.type,C=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,O=C.filter(function(Ur){var mr=Ur[0];return!Array.isArray(mr)||mr.length===t.length-1}),K=null,ie=0,pe=O;ie<pe.length;ie+=1){var Ee=pe[ie],Be=Ee[0],Ye=Ee[1];K=new Es(i.registry,i.path,null,i.scope);for(var yt=[],Et=!1,Vt=1;Vt<t.length;Vt++){var At=t[Vt],Wt=Array.isArray(Be)?Be[Vt-1]:Be.type,rn=K.parse(At,1+yt.length,Wt);if(!rn){Et=!0;break}yt.push(rn)}if(!Et)if(Array.isArray(Be)&&Be.length!==yt.length)K.error("Expected "+Be.length+" arguments, but found "+yt.length+" instead.");else{for(var fn=0;fn<yt.length;fn++){var cn=Array.isArray(Be)?Be[fn]:Be.type,Tn=yt[fn];K.concat(fn+1).checkSubtype(cn,Tn.type)}if(0===K.errors.length)return new jo(p,x,Ye,yt)}}if(1===O.length)(u=i.errors).push.apply(u,K.errors);else{for(var qn=(O.length?O:C).map(function(Ur){var mr;return mr=Ur[0],Array.isArray(mr)?"("+mr.map(jr).join(", ")+")":"("+jr(mr.type)+"...)"}).join(" | "),ir=[],kr=1;kr<t.length;kr++){var pr=i.parse(t[kr],1+ir.length);if(!pr)return null;ir.push(jr(pr.type))}i.error("Expected arguments of type "+qn+", but found ("+ir.join(", ")+") instead.")}return null},jo.register=function(t,i){for(var u in jo.definitions=i,i)t[u]=jo};var Mo=function(t,i,u){this.type=br,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=i};function No(t,i){t[0]=Math.min(t[0],i[0]),t[1]=Math.min(t[1],i[1]),t[2]=Math.max(t[2],i[0]),t[3]=Math.max(t[3],i[1])}function mi(t,i){return!(t[0]<=i[0]||t[2]>=i[2]||t[1]<=i[1]||t[3]>=i[3])}function su(t,i){var u=(180+t[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,v=Math.pow(2,i.z);return[Math.round(u*v*8192),Math.round(p*v*8192)]}function Oa(t,i,u){return i[1]>t[1]!=u[1]>t[1]&&t[0]<(u[0]-i[0])*(t[1]-i[1])/(u[1]-i[1])+i[0]}function rs(t,i){for(var u,p,v,x,C,O,K,ie=!1,pe=0,Ee=i.length;pe<Ee;pe++)for(var Be=i[pe],Ye=0,yt=Be.length;Ye<yt-1;Ye++){if((x=(u=t)[0]-(p=Be[Ye])[0])*(K=u[1]-(v=Be[Ye+1])[1])-(O=u[0]-v[0])*(C=u[1]-p[1])==0&&x*O<=0&&C*K<=0)return!1;Oa(t,Be[Ye],Be[Ye+1])&&(ie=!ie)}return ie}function Yo(t,i){for(var u=0;u<i.length;u++)if(rs(t,i[u]))return!0;return!1}function $a(t,i,u,p){var v=p[0]-u[0],x=p[1]-u[1],C=(t[0]-u[0])*x-v*(t[1]-u[1]),O=(i[0]-u[0])*x-v*(i[1]-u[1]);return C>0&&O<0||C<0&&O>0}function au(t,i,u){for(var p=0,v=u;p<v.length;p+=1)for(var x=v[p],C=0;C<x.length-1;++C)if((Ee=[(pe=x[C+1])[0]-(ie=x[C])[0],pe[1]-ie[1]])[0]*(Be=[(K=i)[0]-(O=t)[0],K[1]-O[1]])[1]-Ee[1]*Be[0]!=0&&$a(O,K,ie,pe)&&$a(ie,pe,O,K))return!0;var O,K,ie,pe,Ee,Be;return!1}function fa(t,i){for(var u=0;u<t.length;++u)if(!rs(t[u],i))return!1;for(var p=0;p<t.length-1;++p)if(au(t[p],t[p+1],i))return!1;return!0}function ta(t,i){for(var u=0;u<i.length;u++)if(fa(t,i[u]))return!0;return!1}function pa(t,i,u){for(var p=[],v=0;v<t.length;v++){for(var x=[],C=0;C<t[v].length;C++){var O=su(t[v][C],u);No(i,O),x.push(O)}p.push(x)}return p}function Tu(t,i,u){for(var p=[],v=0;v<t.length;v++){var x=pa(t[v],i,u);p.push(x)}return p}function Uu(t,i,u,p){if(t[0]<u[0]||t[0]>u[2]){var v=.5*p,x=t[0]-u[0]>v?-p:u[0]-t[0]>v?p:0;0===x&&(x=t[0]-u[2]>v?-p:u[2]-t[0]>v?p:0),t[0]+=x}No(i,t)}function ma(t,i,u,p){for(var v=8192*Math.pow(2,p.z),x=[8192*p.x,8192*p.y],C=[],O=0,K=t;O<K.length;O+=1)for(var ie=0,pe=K[O];ie<pe.length;ie+=1){var Ee=pe[ie],Be=[Ee.x+x[0],Ee.y+x[1]];Uu(Be,i,u,v),C.push(Be)}return C}function Ss(t,i,u,p){for(var v,x=8192*Math.pow(2,p.z),C=[8192*p.x,8192*p.y],O=[],K=0,ie=t;K<ie.length;K+=1){for(var pe=[],Ee=0,Be=ie[K];Ee<Be.length;Ee+=1){var Ye=Be[Ee],yt=[Ye.x+C[0],Ye.y+C[1]];No(i,yt),pe.push(yt)}O.push(pe)}if(i[2]-i[0]<=x/2){(v=i)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(var Et=0,Vt=O;Et<Vt.length;Et+=1)for(var At=0,Wt=Vt[Et];At<Wt.length;At+=1)Uu(Wt[At],i,u,x)}return O}Mo.parse=function(t,i){if(2!==t.length)return i.error("Expected one argument.");var u=t[1];if("object"!=typeof u||Array.isArray(u))return i.error("Collator options argument must be an object.");var p=i.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,Yn);if(!p)return null;var v=i.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,Yn);if(!v)return null;var x=null;return u.locale&&!(x=i.parse(u.locale,1,Kn))?null:new Mo(p,v,x)},Mo.prototype.evaluate=function(t){return new Vr(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Mo.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Mo.prototype.outputDefined=function(){return!1},Mo.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Ls=function(t,i){this.type=Yn,this.geojson=t,this.geometries=i};function $s(t){if(t instanceof jo&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Ls)return!1;var i=!0;return t.eachChild(function(u){i&&!$s(u)&&(i=!1)}),i}function Ho(t){if(t instanceof jo&&"feature-state"===t.name)return!1;var i=!0;return t.eachChild(function(u){i&&!Ho(u)&&(i=!1)}),i}function ga(t,i){if(t instanceof jo&&i.indexOf(t.name)>=0)return!1;var u=!0;return t.eachChild(function(p){u&&!ga(p,i)&&(u=!1)}),u}Ls.parse=function(t,i){if(2!==t.length)return i.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(Pi(t[1])){var u=t[1];if("FeatureCollection"===u.type)for(var p=0;p<u.features.length;++p){var v=u.features[p].geometry.type;if("Polygon"===v||"MultiPolygon"===v)return new Ls(u,u.features[p].geometry)}else if("Feature"===u.type){var x=u.geometry.type;if("Polygon"===x||"MultiPolygon"===x)return new Ls(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new Ls(u,u)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Ls.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(i,u){var p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=i.canonicalID();if("Polygon"===u.type){var C=pa(u.coordinates,v,x),O=ma(i.geometry(),p,v,x);if(!mi(p,v))return!1;for(var K=0,ie=O;K<ie.length;K+=1)if(!rs(ie[K],C))return!1}if("MultiPolygon"===u.type){var pe=Tu(u.coordinates,v,x),Ee=ma(i.geometry(),p,v,x);if(!mi(p,v))return!1;for(var Be=0,Ye=Ee;Be<Ye.length;Be+=1)if(!Yo(Ye[Be],pe))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(i,u){var p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=i.canonicalID();if("Polygon"===u.type){var C=pa(u.coordinates,v,x),O=Ss(i.geometry(),p,v,x);if(!mi(p,v))return!1;for(var K=0,ie=O;K<ie.length;K+=1)if(!fa(ie[K],C))return!1}if("MultiPolygon"===u.type){var pe=Tu(u.coordinates,v,x),Ee=Ss(i.geometry(),p,v,x);if(!mi(p,v))return!1;for(var Be=0,Ye=Ee;Be<Ye.length;Be+=1)if(!ta(Ye[Be],pe))return!1}return!0}(t,this.geometries)}return!1},Ls.prototype.eachChild=function(){},Ls.prototype.outputDefined=function(){return!0},Ls.prototype.serialize=function(){return["within",this.geojson]};var Cs=function(t,i){this.type=i.type,this.name=t,this.boundExpression=i};Cs.parse=function(t,i){if(2!==t.length||"string"!=typeof t[1])return i.error("'var' expression requires exactly one string literal argument.");var u=t[1];return i.scope.has(u)?new Cs(u,i.scope.get(u)):i.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},Cs.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Cs.prototype.eachChild=function(){},Cs.prototype.outputDefined=function(){return!1},Cs.prototype.serialize=function(){return["var",this.name]};var Es=function(t,i,u,p,v){void 0===i&&(i=[]),void 0===p&&(p=new Dn),void 0===v&&(v=[]),this.registry=t,this.path=i,this.key=i.map(function(x){return"["+x+"]"}).join(""),this.scope=p,this.errors=v,this.expectedType=u};function is(t,i){for(var u,p=t.length-1,v=0,x=p,C=0;v<=x;)if((u=t[C=Math.floor((v+x)/2)])<=i){if(C===p||i<t[C+1])return C;v=C+1}else{if(!(u>i))throw new Br("Input is not a number.");x=C-1}return 0}Es.prototype.parse=function(t,i,u,p,v){return void 0===v&&(v={}),i?this.concat(i,u,p)._parse(t,v):this._parse(t,v)},Es.prototype._parse=function(t,i){function u(ie,pe,Ee){return"assert"===Ee?new _i(pe,[ie]):"coerce"===Ee?new ns(pe,[ie]):ie}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var p=t[0];if("string"!=typeof p)return this.error("Expression name must be a string, but found "+typeof p+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var v=this.registry[p];if(v){var x=v.parse(t,this);if(!x)return null;if(this.expectedType){var C=this.expectedType,O=x.type;if("string"!==C.kind&&"number"!==C.kind&&"boolean"!==C.kind&&"object"!==C.kind&&"array"!==C.kind||"value"!==O.kind)if("color"!==C.kind&&"formatted"!==C.kind&&"resolvedImage"!==C.kind||"value"!==O.kind&&"string"!==O.kind){if(this.checkSubtype(C,O))return null}else x=u(x,C,i.typeAnnotation||"coerce");else x=u(x,C,i.typeAnnotation||"assert")}if(!(x instanceof zi)&&"resolvedImage"!==x.type.kind&&function ie(pe){if(pe instanceof Cs)return ie(pe.boundExpression);if(pe instanceof jo&&"error"===pe.name||pe instanceof Mo||pe instanceof Ls)return!1;var Ee=pe instanceof ns||pe instanceof _i,Be=!0;return pe.eachChild(function(Ye){Be=Ee?Be&&ie(Ye):Be&&Ye instanceof zi}),!!Be&&$s(pe)&&ga(pe,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(x)){var K=new Io;try{x=new zi(x.type,x.evaluate(K))}catch(ie){return this.error(ie.message),null}}return x}return this.error('Unknown expression "'+p+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},Es.prototype.concat=function(t,i,u){var p="number"==typeof t?this.path.concat(t):this.path,v=u?this.scope.concat(u):this.scope;return new Es(this.registry,p,i||null,v,this.errors)},Es.prototype.error=function(t){for(var i=[],u=arguments.length-1;u-- >0;)i[u]=arguments[u+1];var p=""+this.key+i.map(function(v){return"["+v+"]"}).join("");this.errors.push(new en(p,t))},Es.prototype.checkSubtype=function(t,i){var u=zr(t,i);return u&&this.error(u),u};var po=function(t,i,u){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(var p=0,v=u;p<v.length;p+=1){var x=v[p],C=x[1];this.labels.push(x[0]),this.outputs.push(C)}};function Ni(t,i,u){return t*(1-u)+i*u}po.parse=function(t,i){if(t.length-1<4)return i.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");var u=i.parse(t[1],1,an);if(!u)return null;var p=[],v=null;i.expectedType&&"value"!==i.expectedType.kind&&(v=i.expectedType);for(var x=1;x<t.length;x+=2){var C=1===x?-1/0:t[x],O=t[x+1],K=x,ie=x+1;if("number"!=typeof C)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(p.length&&p[p.length-1][0]>=C)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',K);var pe=i.parse(O,ie,v);if(!pe)return null;v=v||pe.type,p.push([C,pe])}return new po(v,u,p)},po.prototype.evaluate=function(t){var i=this.labels,u=this.outputs;if(1===i.length)return u[0].evaluate(t);var p=this.input.evaluate(t);if(p<=i[0])return u[0].evaluate(t);var v=i.length;return p>=i[v-1]?u[v-1].evaluate(t):u[is(i,p)].evaluate(t)},po.prototype.eachChild=function(t){t(this.input);for(var i=0,u=this.outputs;i<u.length;i+=1)t(u[i])},po.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},po.prototype.serialize=function(){for(var t=["step",this.input.serialize()],i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t};var Uo=Object.freeze({__proto__:null,number:Ni,color:function(t,i,u){return new Fr(Ni(t.r,i.r,u),Ni(t.g,i.g,u),Ni(t.b,i.b,u),Ni(t.a,i.a,u))},array:function(t,i,u){return t.map(function(p,v){return Ni(p,i[v],u)})}}),el=6/29*3*(6/29),na=Math.PI/180,uu=180/Math.PI;function Ga(t){return t>.008856451679035631?Math.pow(t,1/3):t/el+4/29}function Gs(t){return t>6/29?t*t*t:el*(t-4/29)}function os(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function qs(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function so(t){var i=qs(t.r),u=qs(t.g),p=qs(t.b),v=Ga((.4124564*i+.3575761*u+.1804375*p)/.95047),x=Ga((.2126729*i+.7151522*u+.072175*p)/1);return{l:116*x-16,a:500*(v-x),b:200*(x-Ga((.0193339*i+.119192*u+.9503041*p)/1.08883)),alpha:t.a}}function ss(t){var i=(t.l+16)/116,u=isNaN(t.a)?i:i+t.a/500,p=isNaN(t.b)?i:i-t.b/200;return i=1*Gs(i),u=.95047*Gs(u),p=1.08883*Gs(p),new Fr(os(3.2404542*u-1.5371385*i-.4985314*p),os(-.969266*u+1.8760108*i+.041556*p),os(.0556434*u-.2040259*i+1.0572252*p),t.alpha)}function Su(t,i,u){var p=i-t;return t+u*(p>180||p<-180?p-360*Math.round(p/360):p)}var wo={forward:so,reverse:ss,interpolate:function(t,i,u){return{l:Ni(t.l,i.l,u),a:Ni(t.a,i.a,u),b:Ni(t.b,i.b,u),alpha:Ni(t.alpha,i.alpha,u)}}},Ds={forward:function(t){var i=so(t),u=i.l,p=i.a,v=i.b,x=Math.atan2(v,p)*uu;return{h:x<0?x+360:x,c:Math.sqrt(p*p+v*v),l:u,alpha:t.a}},reverse:function(t){var i=t.h*na,u=t.c;return ss({l:t.l,a:Math.cos(i)*u,b:Math.sin(i)*u,alpha:t.alpha})},interpolate:function(t,i,u){return{h:Su(t.h,i.h,u),c:Ni(t.c,i.c,u),l:Ni(t.l,i.l,u),alpha:Ni(t.alpha,i.alpha,u)}}},qa=Object.freeze({__proto__:null,lab:wo,hcl:Ds}),eo=function(t,i,u,p,v){this.type=t,this.operator=i,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(var x=0,C=v;x<C.length;x+=1){var O=C[x],K=O[1];this.labels.push(O[0]),this.outputs.push(K)}};function Cu(t,i,u,p){var v=p-u,x=t-u;return 0===v?0:1===i?x/v:(Math.pow(i,x)-1)/(Math.pow(i,v)-1)}eo.interpolationFactor=function(t,i,u,p){var v=0;if("exponential"===t.name)v=Cu(i,t.base,u,p);else if("linear"===t.name)v=Cu(i,1,u,p);else if("cubic-bezier"===t.name){var x=t.controlPoints;v=new xe(x[0],x[1],x[2],x[3]).solve(Cu(i,1,u,p))}return v},eo.parse=function(t,i){var u=t[0],p=t[1],v=t[2],x=t.slice(3);if(!Array.isArray(p)||0===p.length)return i.error("Expected an interpolation type expression.",1);if("linear"===p[0])p={name:"linear"};else if("exponential"===p[0]){var C=p[1];if("number"!=typeof C)return i.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:C}}else{if("cubic-bezier"!==p[0])return i.error("Unknown interpolation type "+String(p[0]),1,0);var O=p.slice(1);if(4!==O.length||O.some(function(Vt){return"number"!=typeof Vt||Vt<0||Vt>1}))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:O}}if(t.length-1<4)return i.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(!(v=i.parse(v,2,an)))return null;var K=[],ie=null;"interpolate-hcl"===u||"interpolate-lab"===u?ie=Hn:i.expectedType&&"value"!==i.expectedType.kind&&(ie=i.expectedType);for(var pe=0;pe<x.length;pe+=2){var Ee=x[pe],Be=x[pe+1],Ye=pe+3,yt=pe+4;if("number"!=typeof Ee)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ye);if(K.length&&K[K.length-1][0]>=Ee)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ye);var Et=i.parse(Be,yt,ie);if(!Et)return null;ie=ie||Et.type,K.push([Ee,Et])}return"number"===ie.kind||"color"===ie.kind||"array"===ie.kind&&"number"===ie.itemType.kind&&"number"==typeof ie.N?new eo(ie,u,p,v,K):i.error("Type "+jr(ie)+" is not interpolatable.")},eo.prototype.evaluate=function(t){var i=this.labels,u=this.outputs;if(1===i.length)return u[0].evaluate(t);var p=this.input.evaluate(t);if(p<=i[0])return u[0].evaluate(t);var v=i.length;if(p>=i[v-1])return u[v-1].evaluate(t);var x=is(i,p),C=eo.interpolationFactor(this.interpolation,p,i[x],i[x+1]),O=u[x].evaluate(t),K=u[x+1].evaluate(t);return"interpolate"===this.operator?Uo[this.type.kind.toLowerCase()](O,K,C):"interpolate-hcl"===this.operator?Ds.reverse(Ds.interpolate(Ds.forward(O),Ds.forward(K),C)):wo.reverse(wo.interpolate(wo.forward(O),wo.forward(K),C))},eo.prototype.eachChild=function(t){t(this.input);for(var i=0,u=this.outputs;i<u.length;i+=1)t(u[i])},eo.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},eo.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var i=[this.operator,t,this.input.serialize()],u=0;u<this.labels.length;u++)i.push(this.labels[u],this.outputs[u].serialize());return i};var ps=function(t,i){this.type=t,this.args=i};ps.parse=function(t,i){if(t.length<2)return i.error("Expectected at least one argument.");var u=null,p=i.expectedType;p&&"value"!==p.kind&&(u=p);for(var v=[],x=0,C=t.slice(1);x<C.length;x+=1){var O=i.parse(C[x],1+v.length,u,void 0,{typeAnnotation:"omit"});if(!O)return null;u=u||O.type,v.push(O)}var K=p&&v.some(function(ie){return zr(p,ie.type)});return new ps(K?Xn:u,v)},ps.prototype.evaluate=function(t){for(var i,u=null,p=0,v=0,x=this.args;v<x.length&&(p++,(u=x[v].evaluate(t))&&u instanceof Ao&&!u.available&&(i||(i=u.name),u=null,p===this.args.length&&(u=i)),null===u);v+=1);return u},ps.prototype.eachChild=function(t){this.args.forEach(t)},ps.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},ps.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(i){t.push(i.serialize())}),t};var Jo=function(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i};Jo.prototype.evaluate=function(t){return this.result.evaluate(t)},Jo.prototype.eachChild=function(t){for(var i=0,u=this.bindings;i<u.length;i+=1)t(u[i][1]);t(this.result)},Jo.parse=function(t,i){if(t.length<4)return i.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var u=[],p=1;p<t.length-1;p+=2){var v=t[p];if("string"!=typeof v)return i.error("Expected string, but found "+typeof v+" instead.",p);if(/[^a-zA-Z0-9_]/.test(v))return i.error("Variable names must contain only alphanumeric characters or '_'.",p);var x=i.parse(t[p+1],p+1);if(!x)return null;u.push([v,x])}var C=i.parse(t[t.length-1],t.length-1,i.expectedType,u);return C?new Jo(u,C):null},Jo.prototype.outputDefined=function(){return this.result.outputDefined()},Jo.prototype.serialize=function(){for(var t=["let"],i=0,u=this.bindings;i<u.length;i+=1){var p=u[i];t.push(p[0],p[1].serialize())}return t.push(this.result.serialize()),t};var qr=function(t,i,u){this.type=t,this.index=i,this.input=u};qr.parse=function(t,i){if(3!==t.length)return i.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1,an),p=i.parse(t[2],2,Dr(i.expectedType||Xn));return u&&p?new qr(p.type.itemType,u,p):null},qr.prototype.evaluate=function(t){var i=this.index.evaluate(t),u=this.input.evaluate(t);if(i<0)throw new Br("Array index out of bounds: "+i+" < 0.");if(i>=u.length)throw new Br("Array index out of bounds: "+i+" > "+(u.length-1)+".");if(i!==Math.floor(i))throw new Br("Array index must be an integer, but found "+i+" instead.");return u[i]},qr.prototype.eachChild=function(t){t(this.index),t(this.input)},qr.prototype.outputDefined=function(){return!1},qr.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var oe=function(t,i){this.type=Yn,this.needle=t,this.haystack=i};oe.parse=function(t,i){if(3!==t.length)return i.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1,Xn),p=i.parse(t[2],2,Xn);return u&&p?Ci(u.type,[Yn,Kn,an,zn,Xn])?new oe(u,p):i.error("Expected first argument to be of type boolean, string, number or null, but found "+jr(u.type)+" instead"):null},oe.prototype.evaluate=function(t){var i=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!Mr(i,["boolean","string","number","null"]))throw new Br("Expected first argument to be of type boolean, string, number or null, but found "+jr(Si(i))+" instead.");if(!Mr(u,["string","array"]))throw new Br("Expected second argument to be of type array or string, but found "+jr(Si(u))+" instead.");return u.indexOf(i)>=0},oe.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},oe.prototype.outputDefined=function(){return!0},oe.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var qe=function(t,i,u){this.type=an,this.needle=t,this.haystack=i,this.fromIndex=u};qe.parse=function(t,i){if(t.length<=2||t.length>=5)return i.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1,Xn),p=i.parse(t[2],2,Xn);if(!u||!p)return null;if(!Ci(u.type,[Yn,Kn,an,zn,Xn]))return i.error("Expected first argument to be of type boolean, string, number or null, but found "+jr(u.type)+" instead");if(4===t.length){var v=i.parse(t[3],3,an);return v?new qe(u,p,v):null}return new qe(u,p)},qe.prototype.evaluate=function(t){var i=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Mr(i,["boolean","string","number","null"]))throw new Br("Expected first argument to be of type boolean, string, number or null, but found "+jr(Si(i))+" instead.");if(!Mr(u,["string","array"]))throw new Br("Expected second argument to be of type array or string, but found "+jr(Si(u))+" instead.");if(this.fromIndex){var p=this.fromIndex.evaluate(t);return u.indexOf(i,p)}return u.indexOf(i)},qe.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},qe.prototype.outputDefined=function(){return!1},qe.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ne=function(t,i,u,p,v,x){this.inputType=t,this.type=i,this.input=u,this.cases=p,this.outputs=v,this.otherwise=x};ne.parse=function(t,i){if(t.length<5)return i.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return i.error("Expected an even number of arguments.");var u,p;i.expectedType&&"value"!==i.expectedType.kind&&(p=i.expectedType);for(var v={},x=[],C=2;C<t.length-1;C+=2){var O=t[C],K=t[C+1];Array.isArray(O)||(O=[O]);var ie=i.concat(C);if(0===O.length)return ie.error("Expected at least one branch label.");for(var pe=0,Ee=O;pe<Ee.length;pe+=1){var Be=Ee[pe];if("number"!=typeof Be&&"string"!=typeof Be)return ie.error("Branch labels must be numbers or strings.");if("number"==typeof Be&&Math.abs(Be)>Number.MAX_SAFE_INTEGER)return ie.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof Be&&Math.floor(Be)!==Be)return ie.error("Numeric branch labels must be integer values.");if(u){if(ie.checkSubtype(u,Si(Be)))return null}else u=Si(Be);if(void 0!==v[String(Be)])return ie.error("Branch labels must be unique.");v[String(Be)]=x.length}var Ye=i.parse(K,C,p);if(!Ye)return null;p=p||Ye.type,x.push(Ye)}var yt=i.parse(t[1],1,Xn);if(!yt)return null;var Et=i.parse(t[t.length-1],t.length-1,p);return Et?"value"!==yt.type.kind&&i.concat(1).checkSubtype(u,yt.type)?null:new ne(u,p,yt,v,x,Et):null},ne.prototype.evaluate=function(t){var i=this.input.evaluate(t);return(Si(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)},ne.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},ne.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},ne.prototype.serialize=function(){for(var t=this,i=["match",this.input.serialize()],u=[],p={},v=0,x=Object.keys(this.cases).sort();v<x.length;v+=1){var C=x[v];void 0===(Ee=p[this.cases[C]])?(p[this.cases[C]]=u.length,u.push([this.cases[C],[C]])):u[Ee][1].push(C)}for(var O=function(Ye){return"number"===t.inputType.kind?Number(Ye):Ye},K=0,ie=u;K<ie.length;K+=1){var pe=ie[K],Ee=pe[0],Be=pe[1];i.push(1===Be.length?O(Be[0]):Be.map(O)),i.push(this.outputs[outputIndex$1].serialize())}return i.push(this.otherwise.serialize()),i};var et=function(t,i,u){this.type=t,this.branches=i,this.otherwise=u};et.parse=function(t,i){if(t.length<4)return i.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return i.error("Expected an odd number of arguments.");var u;i.expectedType&&"value"!==i.expectedType.kind&&(u=i.expectedType);for(var p=[],v=1;v<t.length-1;v+=2){var x=i.parse(t[v],v,Yn);if(!x)return null;var C=i.parse(t[v+1],v+1,u);if(!C)return null;p.push([x,C]),u=u||C.type}var O=i.parse(t[t.length-1],t.length-1,u);return O?new et(u,p,O):null},et.prototype.evaluate=function(t){for(var i=0,u=this.branches;i<u.length;i+=1){var p=u[i],v=p[1];if(p[0].evaluate(t))return v.evaluate(t)}return this.otherwise.evaluate(t)},et.prototype.eachChild=function(t){for(var i=0,u=this.branches;i<u.length;i+=1){var p=u[i],v=p[1];t(p[0]),t(v)}t(this.otherwise)},et.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},et.prototype.serialize=function(){var t=["case"];return this.eachChild(function(i){t.push(i.serialize())}),t};var Ot=function(t,i,u,p){this.type=t,this.input=i,this.beginIndex=u,this.endIndex=p};function vn(t,i){return"=="===t||"!="===t?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function On(t,i,u,p){return 0===p.compare(i,u)}function er(t,i,u){var p="=="!==t&&"!="!==t;return function(){function v(x,C,O){this.type=Yn,this.lhs=x,this.rhs=C,this.collator=O,this.hasUntypedArgument="value"===x.type.kind||"value"===C.type.kind}return v.parse=function(x,C){if(3!==x.length&&4!==x.length)return C.error("Expected two or three arguments.");var O=x[0],K=C.parse(x[1],1,Xn);if(!K)return null;if(!vn(O,K.type))return C.concat(1).error('"'+O+"\" comparisons are not supported for type '"+jr(K.type)+"'.");var ie=C.parse(x[2],2,Xn);if(!ie)return null;if(!vn(O,ie.type))return C.concat(2).error('"'+O+"\" comparisons are not supported for type '"+jr(ie.type)+"'.");if(K.type.kind!==ie.type.kind&&"value"!==K.type.kind&&"value"!==ie.type.kind)return C.error("Cannot compare types '"+jr(K.type)+"' and '"+jr(ie.type)+"'.");p&&("value"===K.type.kind&&"value"!==ie.type.kind?K=new _i(ie.type,[K]):"value"!==K.type.kind&&"value"===ie.type.kind&&(ie=new _i(K.type,[ie])));var pe=null;if(4===x.length){if("string"!==K.type.kind&&"string"!==ie.type.kind&&"value"!==K.type.kind&&"value"!==ie.type.kind)return C.error("Cannot use collator to compare non-string types.");if(!(pe=C.parse(x[3],3,br)))return null}return new v(K,ie,pe)},v.prototype.evaluate=function(x){var C=this.lhs.evaluate(x),O=this.rhs.evaluate(x);if(p&&this.hasUntypedArgument){var K=Si(C),ie=Si(O);if(K.kind!==ie.kind||"string"!==K.kind&&"number"!==K.kind)throw new Br('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+K.kind+", "+ie.kind+") instead.")}if(this.collator&&!p&&this.hasUntypedArgument){var pe=Si(C),Ee=Si(O);if("string"!==pe.kind||"string"!==Ee.kind)return i(x,C,O)}return this.collator?u(x,C,O,this.collator.evaluate(x)):i(x,C,O)},v.prototype.eachChild=function(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)},v.prototype.outputDefined=function(){return!0},v.prototype.serialize=function(){var x=[t];return this.eachChild(function(C){x.push(C.serialize())}),x},v}()}Ot.parse=function(t,i){if(t.length<=2||t.length>=5)return i.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1,Xn),p=i.parse(t[2],2,an);if(!u||!p)return null;if(!Ci(u.type,[Dr(Xn),Kn,Xn]))return i.error("Expected first argument to be of type array or string, but found "+jr(u.type)+" instead");if(4===t.length){var v=i.parse(t[3],3,an);return v?new Ot(u.type,u,p,v):null}return new Ot(u.type,u,p)},Ot.prototype.evaluate=function(t){var i=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!Mr(i,["string","array"]))throw new Br("Expected first argument to be of type array or string, but found "+jr(Si(i))+" instead.");if(this.endIndex){var p=this.endIndex.evaluate(t);return i.slice(u,p)}return i.slice(u)},Ot.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Ot.prototype.outputDefined=function(){return!1},Ot.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Hr=er("==",function(t,i,u){return i===u},On),li=er("!=",function(t,i,u){return i!==u},function(t,i,u,p){return!On(0,i,u,p)}),ni=er("<",function(t,i,u){return i<u},function(t,i,u,p){return p.compare(i,u)<0}),Qr=er(">",function(t,i,u){return i>u},function(t,i,u,p){return p.compare(i,u)>0}),mo=er("<=",function(t,i,u){return i<=u},function(t,i,u,p){return p.compare(i,u)<=0}),Vi=er(">=",function(t,i,u){return i>=u},function(t,i,u,p){return p.compare(i,u)>=0}),Di=function(t,i,u,p,v){this.type=Kn,this.number=t,this.locale=i,this.currency=u,this.minFractionDigits=p,this.maxFractionDigits=v};Di.parse=function(t,i){if(3!==t.length)return i.error("Expected two arguments.");var u=i.parse(t[1],1,an);if(!u)return null;var p=t[2];if("object"!=typeof p||Array.isArray(p))return i.error("NumberFormat options argument must be an object.");var v=null;if(p.locale&&!(v=i.parse(p.locale,1,Kn)))return null;var x=null;if(p.currency&&!(x=i.parse(p.currency,1,Kn)))return null;var C=null;if(p["min-fraction-digits"]&&!(C=i.parse(p["min-fraction-digits"],1,an)))return null;var O=null;return p["max-fraction-digits"]&&!(O=i.parse(p["max-fraction-digits"],1,an))?null:new Di(u,v,x,C,O)},Di.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Di.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Di.prototype.outputDefined=function(){return!1},Di.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var ms=function(t){this.type=an,this.input=t};ms.parse=function(t,i){if(2!==t.length)return i.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var u=i.parse(t[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?i.error("Expected argument of type string or array, but found "+jr(u.type)+" instead."):new ms(u):null},ms.prototype.evaluate=function(t){var i=this.input.evaluate(t);if("string"==typeof i||Array.isArray(i))return i.length;throw new Br("Expected value to be of type string or array, but found "+jr(Si(i))+" instead.")},ms.prototype.eachChild=function(t){t(this.input)},ms.prototype.outputDefined=function(){return!1},ms.prototype.serialize=function(){var t=["length"];return this.eachChild(function(i){t.push(i.serialize())}),t};var go={"==":Hr,"!=":li,">":Qr,"<":ni,">=":Vi,"<=":mo,array:_i,at:qr,boolean:_i,case:et,coalesce:ps,collator:Mo,format:fo,image:Ji,in:oe,"index-of":qe,interpolate:eo,"interpolate-hcl":eo,"interpolate-lab":eo,length:ms,let:Jo,literal:zi,match:ne,number:_i,"number-format":Di,object:_i,slice:Ot,step:po,string:_i,"to-boolean":ns,"to-color":ns,"to-number":ns,"to-string":ns,var:Cs,within:Ls};function Rr(t,i){var u=i[0],p=i[1],v=i[2],x=i[3];u=u.evaluate(t),p=p.evaluate(t),v=v.evaluate(t);var C=x?x.evaluate(t):1,O=Bo(u,p,v,C);if(O)throw new Br(O);return new Fr(u/255*C,p/255*C,v/255*C,C)}function ra(t,i){return t in i}function La(t,i){var u=i[t];return void 0===u?null:u}function Ns(t){return{type:t}}function Fs(t){return{result:"success",value:t}}function Na(t){return{result:"error",value:t}}function Xo(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function vl(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Nn(t){return!!t.expression&&t.expression.interpolated}function Cr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Fa(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function xo(t){return t}function Ws(t,i,u){return void 0!==t?t:void 0!==i?i:void 0!==u?u:void 0}function Wa(t,i,u,p,v){return Ws(typeof u===v?p[u]:void 0,t.default,i.default)}function as(t,i,u){if("number"!==Cr(u))return Ws(t.default,i.default);var p=t.stops.length;if(1===p||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[p-1][0])return t.stops[p-1][1];var v=is(t.stops.map(function(x){return x[0]}),u);return t.stops[v][1]}function zu(t,i,u){var p=void 0!==t.base?t.base:1;if("number"!==Cr(u))return Ws(t.default,i.default);var v=t.stops.length;if(1===v||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[v-1][0])return t.stops[v-1][1];var Be,Ye,Et,Vt,x=is(t.stops.map(function(Ee){return Ee[0]}),u),C=(Be=p,Vt=u-(Ye=t.stops[x][0]),0==(Et=t.stops[x+1][0]-Ye)?0:1===Be?Vt/Et:(Math.pow(Be,Vt)-1)/(Math.pow(Be,Et)-1)),O=t.stops[x][1],K=t.stops[x+1][1],ie=Uo[i.type]||xo;if(t.colorSpace&&"rgb"!==t.colorSpace){var pe=qa[t.colorSpace];ie=function(Ee,Be){return pe.reverse(pe.interpolate(pe.forward(Ee),pe.forward(Be),C))}}return"function"==typeof O.evaluate?{evaluate:function(){for(var Ee=[],Be=arguments.length;Be--;)Ee[Be]=arguments[Be];var Ye=O.evaluate.apply(void 0,Ee),yt=K.evaluate.apply(void 0,Ee);if(void 0!==Ye&&void 0!==yt)return ie(Ye,yt,C)}}:ie(O,K,C)}function Vu(t,i,u){return"color"===i.type?u=Fr.parse(u):"formatted"===i.type?u=Yi.fromString(u.toString()):"resolvedImage"===i.type?u=Ao.fromString(u.toString()):Cr(u)===i.type||"enum"===i.type&&i.values[u]||(u=void 0),Ws(u,t.default,i.default)}jo.register(go,{error:[{kind:"error"},[Kn],function(t,i){throw new Br(i[0].evaluate(t))}],typeof:[Kn,[Xn],function(t,i){return jr(Si(i[0].evaluate(t)))}],"to-rgba":[Dr(an,4),[Hn],function(t,i){return i[0].evaluate(t).toArray()}],rgb:[Hn,[an,an,an],Rr],rgba:[Hn,[an,an,an,an],Rr],has:{type:Yn,overloads:[[[Kn],function(t,i){return ra(i[0].evaluate(t),t.properties())}],[[Kn,Ir],function(t,i){var u=i[1];return ra(i[0].evaluate(t),u.evaluate(t))}]]},get:{type:Xn,overloads:[[[Kn],function(t,i){return La(i[0].evaluate(t),t.properties())}],[[Kn,Ir],function(t,i){var u=i[1];return La(i[0].evaluate(t),u.evaluate(t))}]]},"feature-state":[Xn,[Kn],function(t,i){return La(i[0].evaluate(t),t.featureState||{})}],properties:[Ir,[],function(t){return t.properties()}],"geometry-type":[Kn,[],function(t){return t.geometryType()}],id:[Xn,[],function(t){return t.id()}],zoom:[an,[],function(t){return t.globals.zoom}],"heatmap-density":[an,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[an,[],function(t){return t.globals.lineProgress||0}],accumulated:[Xn,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[an,Ns(an),function(t,i){for(var u=0,p=0,v=i;p<v.length;p+=1)u+=v[p].evaluate(t);return u}],"*":[an,Ns(an),function(t,i){for(var u=1,p=0,v=i;p<v.length;p+=1)u*=v[p].evaluate(t);return u}],"-":{type:an,overloads:[[[an,an],function(t,i){var u=i[1];return i[0].evaluate(t)-u.evaluate(t)}],[[an],function(t,i){return-i[0].evaluate(t)}]]},"/":[an,[an,an],function(t,i){var u=i[1];return i[0].evaluate(t)/u.evaluate(t)}],"%":[an,[an,an],function(t,i){var u=i[1];return i[0].evaluate(t)%u.evaluate(t)}],ln2:[an,[],function(){return Math.LN2}],pi:[an,[],function(){return Math.PI}],e:[an,[],function(){return Math.E}],"^":[an,[an,an],function(t,i){var u=i[1];return Math.pow(i[0].evaluate(t),u.evaluate(t))}],sqrt:[an,[an],function(t,i){return Math.sqrt(i[0].evaluate(t))}],log10:[an,[an],function(t,i){return Math.log(i[0].evaluate(t))/Math.LN10}],ln:[an,[an],function(t,i){return Math.log(i[0].evaluate(t))}],log2:[an,[an],function(t,i){return Math.log(i[0].evaluate(t))/Math.LN2}],sin:[an,[an],function(t,i){return Math.sin(i[0].evaluate(t))}],cos:[an,[an],function(t,i){return Math.cos(i[0].evaluate(t))}],tan:[an,[an],function(t,i){return Math.tan(i[0].evaluate(t))}],asin:[an,[an],function(t,i){return Math.asin(i[0].evaluate(t))}],acos:[an,[an],function(t,i){return Math.acos(i[0].evaluate(t))}],atan:[an,[an],function(t,i){return Math.atan(i[0].evaluate(t))}],min:[an,Ns(an),function(t,i){return Math.min.apply(Math,i.map(function(u){return u.evaluate(t)}))}],max:[an,Ns(an),function(t,i){return Math.max.apply(Math,i.map(function(u){return u.evaluate(t)}))}],abs:[an,[an],function(t,i){return Math.abs(i[0].evaluate(t))}],round:[an,[an],function(t,i){var u=i[0].evaluate(t);return u<0?-Math.round(-u):Math.round(u)}],floor:[an,[an],function(t,i){return Math.floor(i[0].evaluate(t))}],ceil:[an,[an],function(t,i){return Math.ceil(i[0].evaluate(t))}],"filter-==":[Yn,[Kn,Xn],function(t,i){var u=i[0],p=i[1];return t.properties()[u.value]===p.value}],"filter-id-==":[Yn,[Xn],function(t,i){var u=i[0];return t.id()===u.value}],"filter-type-==":[Yn,[Kn],function(t,i){var u=i[0];return t.geometryType()===u.value}],"filter-<":[Yn,[Kn,Xn],function(t,i){var u=i[0],p=i[1],v=t.properties()[u.value],x=p.value;return typeof v==typeof x&&v<x}],"filter-id-<":[Yn,[Xn],function(t,i){var u=i[0],p=t.id(),v=u.value;return typeof p==typeof v&&p<v}],"filter->":[Yn,[Kn,Xn],function(t,i){var u=i[0],p=i[1],v=t.properties()[u.value],x=p.value;return typeof v==typeof x&&v>x}],"filter-id->":[Yn,[Xn],function(t,i){var u=i[0],p=t.id(),v=u.value;return typeof p==typeof v&&p>v}],"filter-<=":[Yn,[Kn,Xn],function(t,i){var u=i[0],p=i[1],v=t.properties()[u.value],x=p.value;return typeof v==typeof x&&v<=x}],"filter-id-<=":[Yn,[Xn],function(t,i){var u=i[0],p=t.id(),v=u.value;return typeof p==typeof v&&p<=v}],"filter->=":[Yn,[Kn,Xn],function(t,i){var u=i[0],p=i[1],v=t.properties()[u.value],x=p.value;return typeof v==typeof x&&v>=x}],"filter-id->=":[Yn,[Xn],function(t,i){var u=i[0],p=t.id(),v=u.value;return typeof p==typeof v&&p>=v}],"filter-has":[Yn,[Xn],function(t,i){return i[0].value in t.properties()}],"filter-has-id":[Yn,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Yn,[Dr(Kn)],function(t,i){return i[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Yn,[Dr(Xn)],function(t,i){return i[0].value.indexOf(t.id())>=0}],"filter-in-small":[Yn,[Kn,Dr(Xn)],function(t,i){var u=i[0];return i[1].value.indexOf(t.properties()[u.value])>=0}],"filter-in-large":[Yn,[Kn,Dr(Xn)],function(t,i){var u=i[0],p=i[1];return function(v,x,C,O){for(;C<=O;){var K=C+O>>1;if(x[K]===v)return!0;x[K]>v?O=K-1:C=K+1}return!1}(t.properties()[u.value],p.value,0,p.value.length-1)}],all:{type:Yn,overloads:[[[Yn,Yn],function(t,i){var u=i[1];return i[0].evaluate(t)&&u.evaluate(t)}],[Ns(Yn),function(t,i){for(var u=0,p=i;u<p.length;u+=1)if(!p[u].evaluate(t))return!1;return!0}]]},any:{type:Yn,overloads:[[[Yn,Yn],function(t,i){var u=i[1];return i[0].evaluate(t)||u.evaluate(t)}],[Ns(Yn),function(t,i){for(var u=0,p=i;u<p.length;u+=1)if(p[u].evaluate(t))return!0;return!1}]]},"!":[Yn,[Yn],function(t,i){return!i[0].evaluate(t)}],"is-supported-script":[Yn,[Kn],function(t,i){var u=t.globals&&t.globals.isSupportedScript;return!u||u(i[0].evaluate(t))}],upcase:[Kn,[Kn],function(t,i){return i[0].evaluate(t).toUpperCase()}],downcase:[Kn,[Kn],function(t,i){return i[0].evaluate(t).toLowerCase()}],concat:[Kn,Ns(Xn),function(t,i){return i.map(function(u){return xs(u.evaluate(t))}).join("")}],"resolved-locale":[Kn,[br],function(t,i){return i[0].evaluate(t).resolvedLocale()}]});var Du=function(t,i){var u;this.expression=t,this._warningHistory={},this._evaluator=new Io,this._defaultValue=i?"color"===(u=i).type&&Fa(u.default)?new Fr(0,0,0,0):"color"===u.type?Fr.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=i&&"enum"===i.type?i.values:null};function ju(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in go}function ya(t,i){var v,x,u=new Es(go,[],i?(x={color:Hn,string:Kn,number:an,enum:Kn,boolean:Yn,formatted:yn,resolvedImage:ur},"array"===(v=i).type?Dr(x[v.value]||Xn,v.length):x[v.type]):void 0),p=u.parse(t,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return p?Fs(new Du(p,i)):Na(u.errors)}Du.prototype.evaluateWithoutErrorHandling=function(t,i,u,p,v,x){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=u,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)},Du.prototype.evaluate=function(t,i,u,p,v,x){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{var C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Br("Expected value to be one of "+Object.keys(this._enumValues).map(function(O){return JSON.stringify(O)}).join(", ")+", but found "+JSON.stringify(C)+" instead.");return C}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,"undefined"!=typeof console&&console.warn(O.message)),this._defaultValue}};var As=function(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent="constant"!==t&&!Ho(i.expression)};As.prototype.evaluateWithoutErrorHandling=function(t,i,u,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(t,i,u,p,v,x)},As.prototype.evaluate=function(t,i,u,p,v,x){return this._styleExpression.evaluate(t,i,u,p,v,x)};var yo=function(t,i,u,p){this.kind=t,this.zoomStops=u,this._styleExpression=i,this.isStateDependent="camera"!==t&&!Ho(i.expression),this.interpolationType=p};function Bs(t,i){if("error"===(t=ya(t,i)).result)return t;var u=t.value.expression,p=$s(u);if(!p&&!Xo(i))return Na([new en("","data expressions not supported")]);var v=ga(u,["zoom"]);if(!v&&!vl(i))return Na([new en("","zoom expressions not supported")]);var x=function C(O){var K=null;if(O instanceof Jo)K=C(O.result);else if(O instanceof ps)for(var ie=0,pe=O.args;ie<pe.length&&!(K=C(pe[ie]));ie+=1);else(O instanceof po||O instanceof eo)&&O.input instanceof jo&&"zoom"===O.input.name&&(K=O);return K instanceof en||O.eachChild(function(Ee){var Be=C(Ee);Be instanceof en?K=Be:!K&&Be?K=new en("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):K&&Be&&K!==Be&&(K=new en("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),K}(u);return x||v?x instanceof en?Na([x]):x instanceof eo&&!Nn(i)?Na([new en("",'"interpolate" expressions cannot be used with this property')]):Fs(x?new yo(p?"camera":"composite",t.value,x.labels,x instanceof eo?x.interpolation:void 0):new As(p?"constant":"source",t.value)):Na([new en("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}yo.prototype.evaluateWithoutErrorHandling=function(t,i,u,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(t,i,u,p,v,x)},yo.prototype.evaluate=function(t,i,u,p,v,x){return this._styleExpression.evaluate(t,i,u,p,v,x)},yo.prototype.interpolationFactor=function(t,i,u){return this.interpolationType?eo.interpolationFactor(this.interpolationType,t,i,u):0};var Za=function(t,i){this._parameters=t,this._specification=i,Ve(this,function u(p,v){var x,C,O,K="color"===v.type,ie=p.stops&&"object"==typeof p.stops[0][0],pe=ie||!(ie||void 0!==p.property),Ee=p.type||(Nn(v)?"exponential":"interval");if(K&&((p=Ve({},p)).stops&&(p.stops=p.stops.map(function(pr){return[pr[0],Fr.parse(pr[1])]})),p.default=Fr.parse(p.default?p.default:v.default)),p.colorSpace&&"rgb"!==p.colorSpace&&!qa[p.colorSpace])throw new Error("Unknown color space: "+p.colorSpace);if("exponential"===Ee)x=zu;else if("interval"===Ee)x=as;else if("categorical"===Ee){x=Wa,C=Object.create(null);for(var Be=0,Ye=p.stops;Be<Ye.length;Be+=1){var yt=Ye[Be];C[yt[0]]=yt[1]}O=typeof p.stops[0][0]}else{if("identity"!==Ee)throw new Error('Unknown function type "'+Ee+'"');x=Vu}if(ie){for(var Et={},Vt=[],At=0;At<p.stops.length;At++){var Wt=p.stops[At],rn=Wt[0].zoom;void 0===Et[rn]&&(Et[rn]={zoom:rn,type:p.type,property:p.property,default:p.default,stops:[]},Vt.push(rn)),Et[rn].stops.push([Wt[0].value,Wt[1]])}for(var fn=[],cn=0,Tn=Vt;cn<Tn.length;cn+=1){var qn=Tn[cn];fn.push([Et[qn].zoom,u(Et[qn],v)])}var ir={name:"linear"};return{kind:"composite",interpolationType:ir,interpolationFactor:eo.interpolationFactor.bind(void 0,ir),zoomStops:fn.map(function(pr){return pr[0]}),evaluate:function(pr,Ur){var mr=pr.zoom;return zu({stops:fn,base:p.base},v,mr).evaluate(mr,Ur)}}}if(pe){var kr="exponential"===Ee?{name:"exponential",base:void 0!==p.base?p.base:1}:null;return{kind:"camera",interpolationType:kr,interpolationFactor:eo.interpolationFactor.bind(void 0,kr),zoomStops:p.stops.map(function(pr){return pr[0]}),evaluate:function(pr){return x(p,v,pr.zoom,C,O)}}}return{kind:"source",evaluate:function(pr,Ur){var mr=Ur&&Ur.properties?Ur.properties[p.property]:void 0;return void 0===mr?Ws(p.default,v.default):x(p,v,mr,C,O)}}}(this._parameters,this._specification))};function Eo(t){var i=t.key,u=t.value,p=t.valueSpec||{},v=t.objectElementValidators||{},x=t.style,C=t.styleSpec,O=[],K=Cr(u);if("object"!==K)return[new Ie(i,u,"object expected, "+K+" found")];for(var ie in u){var pe=ie.split(".")[0],Ee=p[pe]||p["*"],Be=void 0;if(v[pe])Be=v[pe];else if(p[pe])Be=P;else if(v["*"])Be=v["*"];else{if(!p["*"]){O.push(new Ie(i,u[ie],'unknown property "'+ie+'"'));continue}Be=P}O=O.concat(Be({key:(i&&i+".")+ie,value:u[ie],valueSpec:Ee,style:x,styleSpec:C,object:u,objectKey:ie},u))}for(var Ye in p)v[Ye]||p[Ye].required&&void 0===p[Ye].default&&void 0===u[Ye]&&O.push(new Ie(i,u,'missing required property "'+Ye+'"'));return O}function Us(t){var i=t.value,u=t.valueSpec,p=t.style,v=t.styleSpec,x=t.key,C=t.arrayElementValidator||P;if("array"!==Cr(i))return[new Ie(x,i,"array expected, "+Cr(i)+" found")];if(u.length&&i.length!==u.length)return[new Ie(x,i,"array length "+u.length+" expected, length "+i.length+" found")];if(u["min-length"]&&i.length<u["min-length"])return[new Ie(x,i,"array length at least "+u["min-length"]+" expected, length "+i.length+" found")];var O={type:u.value,values:u.values};v.$version<7&&(O.function=u.function),"object"===Cr(u.value)&&(O=u.value);for(var K=[],ie=0;ie<i.length;ie++)K=K.concat(C({array:i,arrayIndex:ie,value:i[ie],valueSpec:O,style:p,styleSpec:v,key:x+"["+ie+"]"}));return K}function Au(t){var i=t.key,u=t.value,p=t.valueSpec,v=Cr(u);return"number"===v&&u!=u&&(v="NaN"),"number"!==v?[new Ie(i,u,"number expected, "+v+" found")]:"minimum"in p&&u<p.minimum?[new Ie(i,u,u+" is less than the minimum value "+p.minimum)]:"maximum"in p&&u>p.maximum?[new Ie(i,u,u+" is greater than the maximum value "+p.maximum)]:[]}function Fo(t){var i,u,p,v=t.valueSpec,x=mt(t.value.type),C={},O="categorical"!==x&&void 0===t.value.property,K=!O,ie="array"===Cr(t.value.stops)&&"array"===Cr(t.value.stops[0])&&"object"===Cr(t.value.stops[0][0]),pe=Eo({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(Ye){if("identity"===x)return[new Ie(Ye.key,Ye.value,'identity function may not have a "stops" property')];var yt=[],Et=Ye.value;return yt=yt.concat(Us({key:Ye.key,value:Et,valueSpec:Ye.valueSpec,style:Ye.style,styleSpec:Ye.styleSpec,arrayElementValidator:Ee})),"array"===Cr(Et)&&0===Et.length&&yt.push(new Ie(Ye.key,Et,"array must have at least one stop")),yt},default:function(Ye){return P({key:Ye.key,value:Ye.value,valueSpec:v,style:Ye.style,styleSpec:Ye.styleSpec})}}});return"identity"===x&&O&&pe.push(new Ie(t.key,t.value,'missing required property "property"')),"identity"===x||t.value.stops||pe.push(new Ie(t.key,t.value,'missing required property "stops"')),"exponential"===x&&t.valueSpec.expression&&!Nn(t.valueSpec)&&pe.push(new Ie(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(K&&!Xo(t.valueSpec)?pe.push(new Ie(t.key,t.value,"property functions not supported")):O&&!vl(t.valueSpec)&&pe.push(new Ie(t.key,t.value,"zoom functions not supported"))),"categorical"!==x&&!ie||void 0!==t.value.property||pe.push(new Ie(t.key,t.value,'"property" property is required')),pe;function Ee(Ye){var yt=[],Et=Ye.value,Vt=Ye.key;if("array"!==Cr(Et))return[new Ie(Vt,Et,"array expected, "+Cr(Et)+" found")];if(2!==Et.length)return[new Ie(Vt,Et,"array length 2 expected, length "+Et.length+" found")];if(ie){if("object"!==Cr(Et[0]))return[new Ie(Vt,Et,"object expected, "+Cr(Et[0])+" found")];if(void 0===Et[0].zoom)return[new Ie(Vt,Et,"object stop key must have zoom")];if(void 0===Et[0].value)return[new Ie(Vt,Et,"object stop key must have value")];if(p&&p>mt(Et[0].zoom))return[new Ie(Vt,Et[0].zoom,"stop zoom values must appear in ascending order")];mt(Et[0].zoom)!==p&&(p=mt(Et[0].zoom),u=void 0,C={}),yt=yt.concat(Eo({key:Vt+"[0]",value:Et[0],valueSpec:{zoom:{}},style:Ye.style,styleSpec:Ye.styleSpec,objectElementValidators:{zoom:Au,value:Be}}))}else yt=yt.concat(Be({key:Vt+"[0]",value:Et[0],valueSpec:{},style:Ye.style,styleSpec:Ye.styleSpec},Et));return ju(Tt(Et[1]))?yt.concat([new Ie(Vt+"[1]",Et[1],"expressions are not allowed in function stops.")]):yt.concat(P({key:Vt+"[1]",value:Et[1],valueSpec:v,style:Ye.style,styleSpec:Ye.styleSpec}))}function Be(Ye,yt){var Et=Cr(Ye.value),Vt=mt(Ye.value),At=null!==Ye.value?Ye.value:yt;if(i){if(Et!==i)return[new Ie(Ye.key,At,Et+" stop domain type must match previous stop domain type "+i)]}else i=Et;if("number"!==Et&&"string"!==Et&&"boolean"!==Et)return[new Ie(Ye.key,At,"stop domain value must be a number, string, or boolean")];if("number"!==Et&&"categorical"!==x){var Wt="number expected, "+Et+" found";return Xo(v)&&void 0===x&&(Wt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ie(Ye.key,At,Wt)]}return"categorical"!==x||"number"!==Et||isFinite(Vt)&&Math.floor(Vt)===Vt?"categorical"!==x&&"number"===Et&&void 0!==u&&Vt<u?[new Ie(Ye.key,At,"stop domain values must appear in ascending order")]:(u=Vt,"categorical"===x&&Vt in C?[new Ie(Ye.key,At,"stop domain values must be unique")]:(C[Vt]=!0,[])):[new Ie(Ye.key,At,"integer expected, found "+Vt)]}}function ia(t){var i=("property"===t.expressionContext?Bs:ya)(Tt(t.value),t.valueSpec);if("error"===i.result)return i.value.map(function(p){return new Ie(""+t.key+p.key,t.value,p.message)});var u=i.value.expression||i.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!u.outputDefined())return[new Ie(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Ho(u))return[new Ie(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Ho(u))return[new Ie(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!ga(u,["zoom","feature-state"]))return[new Ie(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!$s(u))return[new Ie(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hu(t){var i=t.key,u=t.value,p=t.valueSpec,v=[];return Array.isArray(p.values)?-1===p.values.indexOf(mt(u))&&v.push(new Ie(i,u,"expected one of ["+p.values.join(", ")+"], "+JSON.stringify(u)+" found")):-1===Object.keys(p.values).indexOf(mt(u))&&v.push(new Ie(i,u,"expected one of ["+Object.keys(p.values).join(", ")+"], "+JSON.stringify(u)+" found")),v}function _a(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var i=0,u=t.slice(1);i<u.length;i+=1){var p=u[i];if(!_a(p)&&"boolean"!=typeof p)return!1}return!0;default:return!0}}Za.deserialize=function(t){return new Za(t._parameters,t._specification)},Za.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var tl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function va(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};_a(t)||(t=Mu(t));var i=ya(t,tl);if("error"===i.result)throw new Error(i.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,p,v){return i.value.evaluate(u,p,{},v)},needGeometry:function u(p){if(!Array.isArray(p))return!1;if("within"===p[0])return!0;for(var v=1;v<p.length;v++)if(u(p[v]))return!0;return!1}(t)}}function $u(t,i){return t<i?-1:t>i?1:0}function Mu(t){if(!t)return!0;var i,u=t[0];return t.length<=1?"any"!==u:"=="===u?Ms(t[1],t[2],"=="):"!="===u?us(Ms(t[1],t[2],"==")):"<"===u||">"===u||"<="===u||">="===u?Ms(t[1],t[2],u):"any"===u?(i=t.slice(1),["any"].concat(i.map(Mu))):"all"===u?["all"].concat(t.slice(1).map(Mu)):"none"===u?["all"].concat(t.slice(1).map(Mu).map(us)):"in"===u?ba(t[1],t.slice(2)):"!in"===u?us(ba(t[1],t.slice(2))):"has"===u?nl(t[1]):"!has"===u?us(nl(t[1])):"within"!==u||t}function Ms(t,i,u){switch(t){case"$type":return["filter-type-"+u,i];case"$id":return["filter-id-"+u,i];default:return["filter-"+u,t,i]}}function ba(t,i){if(0===i.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(function(u){return typeof u!=typeof i[0]})?["filter-in-large",t,["literal",i.sort($u)]]:["filter-in-small",t,["literal",i]]}}function nl(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function us(t){return["!",t]}function rl(t){return _a(Tt(t.value))?ia(Ve({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function i(u){var p=u.value,v=u.key;if("array"!==Cr(p))return[new Ie(v,p,"array expected, "+Cr(p)+" found")];var x,C=u.styleSpec,O=[];if(p.length<1)return[new Ie(v,p,"filter array must have at least 1 element")];switch(O=O.concat(Hu({key:v+"[0]",value:p[0],valueSpec:C.filter_operator,style:u.style,styleSpec:u.styleSpec})),mt(p[0])){case"<":case"<=":case">":case">=":p.length>=2&&"$type"===mt(p[1])&&O.push(new Ie(v,p,'"$type" cannot be use with operator "'+p[0]+'"'));case"==":case"!=":3!==p.length&&O.push(new Ie(v,p,'filter array for operator "'+p[0]+'" must have 3 elements'));case"in":case"!in":p.length>=2&&"string"!==(x=Cr(p[1]))&&O.push(new Ie(v+"[1]",p[1],"string expected, "+x+" found"));for(var K=2;K<p.length;K++)x=Cr(p[K]),"$type"===mt(p[1])?O=O.concat(Hu({key:v+"["+K+"]",value:p[K],valueSpec:C.geometry_type,style:u.style,styleSpec:u.styleSpec})):"string"!==x&&"number"!==x&&"boolean"!==x&&O.push(new Ie(v+"["+K+"]",p[K],"string, number, or boolean expected, "+x+" found"));break;case"any":case"all":case"none":for(var ie=1;ie<p.length;ie++)O=O.concat(i({key:v+"["+ie+"]",value:p[ie],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":x=Cr(p[1]),2!==p.length?O.push(new Ie(v,p,'filter array for "'+p[0]+'" operator must have 2 elements')):"string"!==x&&O.push(new Ie(v+"[1]",p[1],"string expected, "+x+" found"));break;case"within":x=Cr(p[1]),2!==p.length?O.push(new Ie(v,p,'filter array for "'+p[0]+'" operator must have 2 elements')):"object"!==x&&O.push(new Ie(v+"[1]",p[1],"object expected, "+x+" found"))}return O}(t)}function fl(t,i){var u=t.key,p=t.style,v=t.styleSpec,x=t.value,C=t.objectKey,O=v[i+"_"+t.layerType];if(!O)return[];var K=C.match(/^(.*)-transition$/);if("paint"===i&&K&&O[K[1]]&&O[K[1]].transition)return P({key:u,value:x,valueSpec:v.transition,style:p,styleSpec:v});var ie,pe=t.valueSpec||O[C];if(!pe)return[new Ie(u,x,'unknown property "'+C+'"')];if("string"===Cr(x)&&Xo(pe)&&!pe.tokens&&(ie=/^{([^}]+)}$/.exec(x)))return[new Ie(u,x,'"'+C+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ie[1])+" }`.")];var Ee=[];return"symbol"===t.layerType&&("text-field"===C&&p&&!p.glyphs&&Ee.push(new Ie(u,x,'use of "text-field" requires a style "glyphs" property')),"text-font"===C&&Fa(Tt(x))&&"identity"===mt(x.type)&&Ee.push(new Ie(u,x,'"text-font" does not support identity functions'))),Ee.concat(P({key:t.key,value:x,valueSpec:pe,style:p,styleSpec:v,expressionContext:"property",propertyType:i,propertyKey:C}))}function lu(t){return fl(t,"paint")}function oa(t){return fl(t,"layout")}function kl(t){var i=[],u=t.value,p=t.key,v=t.style,x=t.styleSpec;u.type||u.ref||i.push(new Ie(p,u,'either "type" or "ref" is required'));var C,O=mt(u.type),K=mt(u.ref);if(u.id)for(var ie=mt(u.id),pe=0;pe<t.arrayIndex;pe++){var Ee=v.layers[pe];mt(Ee.id)===ie&&i.push(new Ie(p,u.id,'duplicate layer id "'+u.id+'", previously used at line '+Ee.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(yt){yt in u&&i.push(new Ie(p,u[yt],'"'+yt+'" is prohibited for ref layers'))}),v.layers.forEach(function(yt){mt(yt.id)===K&&(C=yt)}),C?C.ref?i.push(new Ie(p,u.ref,"ref cannot reference another ref layer")):O=mt(C.type):i.push(new Ie(p,u.ref,'ref layer "'+K+'" not found'));else if("background"!==O)if(u.source){var Be=v.sources&&v.sources[u.source],Ye=Be&&mt(Be.type);Be?"vector"===Ye&&"raster"===O?i.push(new Ie(p,u.source,'layer "'+u.id+'" requires a raster source')):"raster"===Ye&&"raster"!==O?i.push(new Ie(p,u.source,'layer "'+u.id+'" requires a vector source')):"vector"!==Ye||u["source-layer"]?"raster-dem"===Ye&&"hillshade"!==O?i.push(new Ie(p,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==O||!u.paint||!u.paint["line-gradient"]||"geojson"===Ye&&Be.lineMetrics||i.push(new Ie(p,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):i.push(new Ie(p,u,'layer "'+u.id+'" must specify a "source-layer"')):i.push(new Ie(p,u.source,'source "'+u.source+'" not found'))}else i.push(new Ie(p,u,'missing required property "source"'));return i=i.concat(Eo({key:p,value:u,valueSpec:x.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return P({key:p+".type",value:u.type,valueSpec:x.layer.type,style:t.style,styleSpec:t.styleSpec,object:u,objectKey:"type"})},filter:rl,layout:function(yt){return Eo({layer:u,key:yt.key,value:yt.value,style:yt.style,styleSpec:yt.styleSpec,objectElementValidators:{"*":function(Et){return oa(Ve({layerType:O},Et))}}})},paint:function(yt){return Eo({layer:u,key:yt.key,value:yt.value,style:yt.style,styleSpec:yt.styleSpec,objectElementValidators:{"*":function(Et){return lu(Ve({layerType:O},Et))}}})}}}))}function To(t){var i=t.value,u=t.key,p=Cr(i);return"string"!==p?[new Ie(u,i,"string expected, "+p+" found")]:[]}var Ai={promoteId:function(t){var i=t.key,u=t.value;if("string"===Cr(u))return To({key:i,value:u});var p=[];for(var v in u)p.push.apply(p,To({key:i+"."+v,value:u[v]}));return p}};function ao(t){var i=t.value,u=t.key,p=t.styleSpec,v=t.style;if(!i.type)return[new Ie(u,i,'"type" is required')];var x,C=mt(i.type);switch(C){case"vector":case"raster":case"raster-dem":return Eo({key:u,value:i,valueSpec:p["source_"+C.replace("-","_")],style:t.style,styleSpec:p,objectElementValidators:Ai});case"geojson":if(x=Eo({key:u,value:i,valueSpec:p.source_geojson,style:v,styleSpec:p,objectElementValidators:Ai}),i.cluster)for(var O in i.clusterProperties){var K=i.clusterProperties[O],ie=K[0],pe="string"==typeof ie?[ie,["accumulated"],["get",O]]:ie;x.push.apply(x,ia({key:u+"."+O+".map",value:K[1],expressionContext:"cluster-map"})),x.push.apply(x,ia({key:u+"."+O+".reduce",value:pe,expressionContext:"cluster-reduce"}))}return x;case"video":return Eo({key:u,value:i,valueSpec:p.source_video,style:v,styleSpec:p});case"image":return Eo({key:u,value:i,valueSpec:p.source_image,style:v,styleSpec:p});case"canvas":return[new Ie(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Hu({key:u+".type",value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:v,styleSpec:p})}}function Ka(t){var i=t.value,u=t.styleSpec,p=u.light,v=t.style,x=[],C=Cr(i);if(void 0===i)return x;if("object"!==C)return x.concat([new Ie("light",i,"object expected, "+C+" found")]);for(var O in i){var K=O.match(/^(.*)-transition$/);x=x.concat(K&&p[K[1]]&&p[K[1]].transition?P({key:O,value:i[O],valueSpec:u.transition,style:v,styleSpec:u}):p[O]?P({key:O,value:i[O],valueSpec:p[O],style:v,styleSpec:u}):[new Ie(O,i[O],'unknown property "'+O+'"')])}return x}var sa={"*":function(){return[]},array:Us,boolean:function(t){var i=t.value,u=t.key,p=Cr(i);return"boolean"!==p?[new Ie(u,i,"boolean expected, "+p+" found")]:[]},number:Au,color:function(t){var i=t.key,u=t.value,p=Cr(u);return"string"!==p?[new Ie(i,u,"color expected, "+p+" found")]:null===Gr(u)?[new Ie(i,u,'color expected, "'+u+'" found')]:[]},constants:ze,enum:Hu,filter:rl,function:Fo,layer:kl,object:Eo,source:ao,light:Ka,string:To,formatted:function(t){return 0===To(t).length?[]:ia(t)},resolvedImage:function(t){return 0===To(t).length?[]:ia(t)}};function P(t){var i=t.value,u=t.valueSpec,p=t.styleSpec;return u.expression&&Fa(mt(i))?Fo(t):u.expression&&ju(Tt(i))?ia(t):u.type&&sa[u.type]?sa[u.type](t):Eo(Ve({},t,{valueSpec:u.type?p[u.type]:u}))}function B(t){var i=t.value,u=t.key,p=To(t);return p.length||(-1===i.indexOf("{fontstack}")&&p.push(new Ie(u,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&p.push(new Ie(u,i,'"glyphs" url must include a "{range}" token'))),p}function $(t,i){void 0===i&&(i=Je);var u=[];return u=u.concat(P({key:"",value:t,valueSpec:i.$root,styleSpec:i,style:t,objectElementValidators:{glyphs:B,"*":function(){return[]}}})),t.constants&&(u=u.concat(ze({key:"constants",value:t.constants,style:t,styleSpec:i}))),de(u)}function de(t){return[].concat(t).sort(function(i,u){return i.line-u.line})}function Ge(t){return function(){for(var i=[],u=arguments.length;u--;)i[u]=arguments[u];return de(t.apply(this,i))}}$.source=Ge(ao),$.light=Ge(Ka),$.layer=Ge(kl),$.filter=Ge(rl),$.paintProperty=Ge(lu),$.layoutProperty=Ge(oa);var Ze=$,Mt=Ze.light,$t=Ze.paintProperty,_n=Ze.layoutProperty;function on(t,i){var u=!1;if(i&&i.length)for(var p=0,v=i;p<v.length;p+=1)t.fire(new Dt(new Error(v[p].message))),u=!0;return u}var or=Gn;function Gn(t,i,u){var p=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var v=new Int32Array(this.arrayBuffer);t=v[0],this.d=(i=v[1])+2*(u=v[2]);for(var x=0;x<this.d*this.d;x++){var C=v[3+x],O=v[3+x+1];p.push(C===O?null:v.subarray(C,O))}var K=v[3+p.length+1];this.keys=v.subarray(v[3+p.length],K),this.bboxes=v.subarray(K),this.insert=this._insertReadonly}else{this.d=i+2*u;for(var ie=0;ie<this.d*this.d;ie++)p.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=t,this.padding=u,this.scale=i/t,this.uid=0;var pe=u/i*t;this.min=-pe,this.max=t+pe}Gn.prototype.insert=function(t,i,u,p,v){this._forEachCell(i,u,p,v,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(v)},Gn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Gn.prototype._insertCell=function(t,i,u,p,v,x){this.cells[v].push(x)},Gn.prototype.query=function(t,i,u,p,v){var x=this.min,C=this.max;if(t<=x&&i<=x&&C<=u&&C<=p&&!v)return Array.prototype.slice.call(this.keys);var O=[];return this._forEachCell(t,i,u,p,this._queryCell,O,{},v),O},Gn.prototype._queryCell=function(t,i,u,p,v,x,C,O){var K=this.cells[v];if(null!==K)for(var ie=this.keys,pe=this.bboxes,Ee=0;Ee<K.length;Ee++){var Be=K[Ee];if(void 0===C[Be]){var Ye=4*Be;(O?O(pe[Ye+0],pe[Ye+1],pe[Ye+2],pe[Ye+3]):t<=pe[Ye+2]&&i<=pe[Ye+3]&&u>=pe[Ye+0]&&p>=pe[Ye+1])?(C[Be]=!0,x.push(ie[Be])):C[Be]=!1}}},Gn.prototype._forEachCell=function(t,i,u,p,v,x,C,O){for(var K=this._convertToCellCoord(t),ie=this._convertToCellCoord(i),pe=this._convertToCellCoord(u),Ee=this._convertToCellCoord(p),Be=K;Be<=pe;Be++)for(var Ye=ie;Ye<=Ee;Ye++){var yt=this.d*Ye+Be;if((!O||O(this._convertFromCellCoord(Be),this._convertFromCellCoord(Ye),this._convertFromCellCoord(Be+1),this._convertFromCellCoord(Ye+1)))&&v.call(this,t,i,u,p,yt,x,C,O))return}},Gn.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Gn.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Gn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,i=3+this.cells.length+1+1,u=0,p=0;p<this.cells.length;p++)u+=this.cells[p].length;var v=new Int32Array(i+u+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var x=i,C=0;C<t.length;C++){var O=t[C];v[3+C]=x,v.set(O,x),x+=O.length}return v[3+t.length]=x,v.set(this.keys,x),v[3+t.length+1]=x+=this.keys.length,v.set(this.bboxes,x),x+=this.bboxes.length,v.buffer};var dr=fe.ImageData,gi=fe.ImageBitmap,Yr={};function tr(t,i,u){void 0===u&&(u={}),Object.defineProperty(i,"_classRegistryKey",{value:t,writeable:!1}),Yr[t]={klass:i,omit:u.omit||[],shallow:u.shallow||[]}}for(var Po in tr("Object",Object),or.serialize=function(t,i){var u=t.toArrayBuffer();return i&&i.push(u),{buffer:u}},or.deserialize=function(t){return new or(t.buffer)},tr("Grid",or),tr("Color",Fr),tr("Error",Error),tr("ResolvedImage",Ao),tr("StylePropertyFunction",Za),tr("StyleExpression",Du,{omit:["_evaluator"]}),tr("ZoomDependentExpression",yo),tr("ZoomConstantExpression",As),tr("CompoundExpression",jo,{omit:["_evaluate"]}),go)go[Po]._classRegistryKey||tr("Expression_"+Po,go[Po]);function gs(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Ya(t){return gi&&t instanceof gi}function wa(t,i){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(gs(t)||Ya(t))return i&&i.push(t),t;if(ArrayBuffer.isView(t)){var u=t;return i&&i.push(u.buffer),u}if(t instanceof dr)return i&&i.push(t.data.buffer),t;if(Array.isArray(t)){for(var p=[],v=0,x=t;v<x.length;v+=1)p.push(wa(x[v],i));return p}if("object"==typeof t){var C=t.constructor,O=C._classRegistryKey;if(!O)throw new Error("can't serialize object of unregistered class");var K=C.serialize?C.serialize(t,i):{};if(!C.serialize){for(var ie in t)if(t.hasOwnProperty(ie)&&!(Yr[O].omit.indexOf(ie)>=0)){var pe=t[ie];K[ie]=Yr[O].shallow.indexOf(ie)>=0?pe:wa(pe,i)}t instanceof Error&&(K.message=t.message)}if(K.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==O&&(K.$name=O),K}throw new Error("can't serialize object of type "+typeof t)}function wi(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||gs(t)||Ya(t)||ArrayBuffer.isView(t)||t instanceof dr)return t;if(Array.isArray(t))return t.map(wi);if("object"==typeof t){var i=t.$name||"Object",u=Yr[i].klass;if(!u)throw new Error("can't deserialize unregistered class "+i);if(u.deserialize)return u.deserialize(t);for(var p=Object.create(u.prototype),v=0,x=Object.keys(t);v<x.length;v+=1){var C=x[v];if("$name"!==C){var O=t[C];p[C]=Yr[i].shallow.indexOf(C)>=0?O:wi(O)}}return p}throw new Error("can't deserialize object of type "+typeof t)}var Ba=function(){this.first=!0};Ba.prototype.update=function(t,i){var u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=i),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))};var rr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Gu(t){for(var i=0,u=t;i<u.length;i+=1)if(cu(u[i].charCodeAt(0)))return!0;return!1}function cu(t){return!(746!==t&&747!==t&&(t<4352||!(rr["Bopomofo Extended"](t)||rr.Bopomofo(t)||rr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||rr["CJK Compatibility Ideographs"](t)||rr["CJK Compatibility"](t)||rr["CJK Radicals Supplement"](t)||rr["CJK Strokes"](t)||!(!rr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||rr["CJK Unified Ideographs Extension A"](t)||rr["CJK Unified Ideographs"](t)||rr["Enclosed CJK Letters and Months"](t)||rr["Hangul Compatibility Jamo"](t)||rr["Hangul Jamo Extended-A"](t)||rr["Hangul Jamo Extended-B"](t)||rr["Hangul Jamo"](t)||rr["Hangul Syllables"](t)||rr.Hiragana(t)||rr["Ideographic Description Characters"](t)||rr.Kanbun(t)||rr["Kangxi Radicals"](t)||rr["Katakana Phonetic Extensions"](t)||rr.Katakana(t)&&12540!==t||!(!rr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!rr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||rr["Unified Canadian Aboriginal Syllabics"](t)||rr["Unified Canadian Aboriginal Syllabics Extended"](t)||rr["Vertical Forms"](t)||rr["Yijing Hexagram Symbols"](t)||rr["Yi Syllables"](t)||rr["Yi Radicals"](t))))}function Ol(t){return!(cu(t)||(i=t,rr["Latin-1 Supplement"](i)&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||rr["General Punctuation"](i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||rr["Letterlike Symbols"](i)||rr["Number Forms"](i)||rr["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||rr["Control Pictures"](i)&&9251!==i||rr["Optical Character Recognition"](i)||rr["Enclosed Alphanumerics"](i)||rr["Geometric Shapes"](i)||rr["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||rr["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||rr["CJK Symbols and Punctuation"](i)||rr.Katakana(i)||rr["Private Use Area"](i)||rr["CJK Compatibility Forms"](i)||rr["Small Form Variants"](i)||rr["Halfwidth and Fullwidth Forms"](i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i}function Ri(t){return t>=1424&&t<=2303||rr["Arabic Presentation Forms-A"](t)||rr["Arabic Presentation Forms-B"](t)}function zs(t,i){return!(!i&&Ri(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||rr.Khmer(t))}function Zs(t){for(var i=0,u=t;i<u.length;i+=1)if(Ri(u[i].charCodeAt(0)))return!0;return!1}var qu=null,Qo="unavailable",So=null,hu=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Qo="error"),qu&&qu(t)};function aa(){bl.fire(new ot("pluginStateChange",{pluginStatus:Qo,pluginURL:So}))}var bl=new Lt,il=function(){return Qo},Zn=function(){if("deferred"!==Qo||!So)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Qo="loading",aa(),So&&dn({url:So},function(t){t?hu(t):(Qo="loaded",aa())})},Mi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Qo||null!=Mi.applyArabicShaping},isLoading:function(){return"loading"===Qo},setState:function(t){Qo=t.pluginStatus,So=t.pluginURL},isParsed:function(){return null!=Mi.applyArabicShaping&&null!=Mi.processBidirectionalText&&null!=Mi.processStyledBidirectionalText},getPluginURL:function(){return So}},V=function(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ba,this.transition={})};V.prototype.isSupportedScript=function(t){return function(i,u){for(var p=0,v=i;p<v.length;p+=1)if(!zs(v[p].charCodeAt(0),u))return!1;return!0}(t,Mi.isLoaded())},V.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},V.prototype.getCrossfadeParameters=function(){var t=this.zoom,i=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*i}};var F=function(t,i){this.property=t,this.value=i,this.expression=function(u,p){if(Fa(u))return new Za(u,p);if(ju(u)){var v=Bs(u,p);if("error"===v.result)throw new Error(v.value.map(function(C){return C.key+": "+C.message}).join(", "));return v.value}var x=u;return"string"==typeof u&&"color"===p.type&&(x=Fr.parse(u)),{kind:"constant",evaluate:function(){return x}}}(void 0===i?t.specification.default:i,t.specification)};F.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},F.prototype.possiblyEvaluate=function(t,i,u){return this.property.possiblyEvaluate(this,t,i,u)};var M=function(t){this.property=t,this.value=new F(t,void 0)};M.prototype.transitioned=function(t,i){return new ye(this.property,this.value,i,bt({},t.transition,this.transition),t.now)},M.prototype.untransitioned=function(){return new ye(this.property,this.value,null,{},0)};var J=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};J.prototype.getValue=function(t){return ge(this._values[t].value.value)},J.prototype.setValue=function(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new M(this._values[t].property)),this._values[t].value=new F(this._values[t].property,null===i?void 0:ge(i))},J.prototype.getTransition=function(t){return ge(this._values[t].transition)},J.prototype.setTransition=function(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new M(this._values[t].property)),this._values[t].transition=ge(i)||void 0},J.prototype.serialize=function(){for(var t={},i=0,u=Object.keys(this._values);i<u.length;i+=1){var p=u[i],v=this.getValue(p);void 0!==v&&(t[p]=v);var x=this.getTransition(p);void 0!==x&&(t[p+"-transition"]=x)}return t},J.prototype.transitioned=function(t,i){for(var u=new De(this._properties),p=0,v=Object.keys(this._values);p<v.length;p+=1){var x=v[p];u._values[x]=this._values[x].transitioned(t,i._values[x])}return u},J.prototype.untransitioned=function(){for(var t=new De(this._properties),i=0,u=Object.keys(this._values);i<u.length;i+=1){var p=u[i];t._values[p]=this._values[p].untransitioned()}return t};var ye=function(t,i,u,p,v){this.property=t,this.value=i,this.begin=v+p.delay||0,this.end=this.begin+p.duration||0,t.specification.transition&&(p.delay||p.duration)&&(this.prior=u)};ye.prototype.possiblyEvaluate=function(t,i,u){var p=t.now||0,v=this.value.possiblyEvaluate(t,i,u),x=this.prior;if(x){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return x.possiblyEvaluate(t,i,u);var C=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(t,i,u),v,function(O){if(O<=0)return 0;if(O>=1)return 1;var K=O*O,ie=K*O;return 4*(O<.5?ie:3*(O-K)+ie-.75)}(C))}return v};var De=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};De.prototype.possiblyEvaluate=function(t,i,u){for(var p=new pn(this._properties),v=0,x=Object.keys(this._values);v<x.length;v+=1){var C=x[v];p._values[C]=this._values[C].possiblyEvaluate(t,i,u)}return p},De.prototype.hasTransition=function(){for(var t=0,i=Object.keys(this._values);t<i.length;t+=1)if(this._values[i[t]].prior)return!0;return!1};var Ne=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Ne.prototype.getValue=function(t){return ge(this._values[t].value)},Ne.prototype.setValue=function(t,i){this._values[t]=new F(this._values[t].property,null===i?void 0:ge(i))},Ne.prototype.serialize=function(){for(var t={},i=0,u=Object.keys(this._values);i<u.length;i+=1){var p=u[i],v=this.getValue(p);void 0!==v&&(t[p]=v)}return t},Ne.prototype.possiblyEvaluate=function(t,i,u){for(var p=new pn(this._properties),v=0,x=Object.keys(this._values);v<x.length;v+=1){var C=x[v];p._values[C]=this._values[C].possiblyEvaluate(t,i,u)}return p};var at=function(t,i,u){this.property=t,this.value=i,this.parameters=u};at.prototype.isConstant=function(){return"constant"===this.value.kind},at.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},at.prototype.evaluate=function(t,i,u,p){return this.property.evaluate(this.value,this.parameters,t,i,u,p)};var pn=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};pn.prototype.get=function(t){return this._values[t]};var wn=function(t){this.specification=t};wn.prototype.possiblyEvaluate=function(t,i){return t.expression.evaluate(i)},wn.prototype.interpolate=function(t,i,u){var p=Uo[this.specification.type];return p?p(t,i,u):t};var Fn=function(t,i){this.specification=t,this.overrides=i};Fn.prototype.possiblyEvaluate=function(t,i,u,p){return new at(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(i,null,{},u,p)}:t.expression,i)},Fn.prototype.interpolate=function(t,i,u){if("constant"!==t.value.kind||"constant"!==i.value.kind)return t;if(void 0===t.value.value||void 0===i.value.value)return new at(this,{kind:"constant",value:void 0},t.parameters);var p=Uo[this.specification.type];return p?new at(this,{kind:"constant",value:p(t.value.value,i.value.value,u)},t.parameters):t},Fn.prototype.evaluate=function(t,i,u,p,v,x){return"constant"===t.kind?t.value:t.evaluate(i,u,p,v,x)};var Pr=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.possiblyEvaluate=function(u,p,v,x){if(void 0===u.value)return new at(this,{kind:"constant",value:void 0},p);if("constant"===u.expression.kind){var C=u.expression.evaluate(p,null,{},v,x),O="resolvedImage"===u.property.specification.type&&"string"!=typeof C?C.name:C,K=this._calculate(O,O,O,p);return new at(this,{kind:"constant",value:K},p)}if("camera"===u.expression.kind){var ie=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new at(this,{kind:"constant",value:ie},p)}return new at(this,u.expression,p)},i.prototype.evaluate=function(u,p,v,x,C,O){if("source"===u.kind){var K=u.evaluate(p,v,x,C,O);return this._calculate(K,K,K,p)}return"composite"===u.kind?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},v,x),u.evaluate({zoom:Math.floor(p.zoom)},v,x),u.evaluate({zoom:Math.floor(p.zoom)+1},v,x),p):u.value},i.prototype._calculate=function(u,p,v,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:v,to:p}},i.prototype.interpolate=function(u){return u},i}(Fn),si=function(t){this.specification=t};si.prototype.possiblyEvaluate=function(t,i,u,p){if(void 0!==t.value){if("constant"===t.expression.kind){var v=t.expression.evaluate(i,null,{},u,p);return this._calculate(v,v,v,i)}return this._calculate(t.expression.evaluate(new V(Math.floor(i.zoom-1),i)),t.expression.evaluate(new V(Math.floor(i.zoom),i)),t.expression.evaluate(new V(Math.floor(i.zoom+1),i)),i)}},si.prototype._calculate=function(t,i,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:u,to:i}},si.prototype.interpolate=function(t){return t};var xi=function(t){this.specification=t};xi.prototype.possiblyEvaluate=function(t,i,u,p){return!!t.expression.evaluate(i,null,{},u,p)},xi.prototype.interpolate=function(){return!1};var Ro=function(t){for(var i in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[i];u.specification.overridable&&this.overridableProperties.push(i);var p=this.defaultPropertyValues[i]=new F(u,void 0),v=this.defaultTransitionablePropertyValues[i]=new M(u);this.defaultTransitioningPropertyValues[i]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=p.possiblyEvaluate({})}};tr("DataDrivenProperty",Fn),tr("DataConstantProperty",wn),tr("CrossFadedDataDrivenProperty",Pr),tr("CrossFadedProperty",si),tr("ColorRampProperty",xi);var Co=function(t){function i(u,p){if(t.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==u.type&&(this.metadata=(u=u).metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,"background"!==u.type&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new Ne(p.layout)),p.paint)){for(var v in this._transitionablePaint=new J(p.paint),u.paint)this.setPaintProperty(v,u.paint[v],{validate:!1});for(var x in u.layout)this.setLayoutProperty(x,u.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pn(p.paint)}}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},i.prototype.getLayoutProperty=function(u){return"visibility"===u?this.visibility:this._unevaluatedLayout.getValue(u)},i.prototype.setLayoutProperty=function(u,p,v){void 0===v&&(v={}),null!=p&&this._validate(_n,"layers."+this.id+".layout."+u,u,p,v)||("visibility"!==u?this._unevaluatedLayout.setValue(u,p):this.visibility=p)},i.prototype.getPaintProperty=function(u){return Ae(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-"-transition".length)):this._transitionablePaint.getValue(u)},i.prototype.setPaintProperty=function(u,p,v){if(void 0===v&&(v={}),null!=p&&this._validate($t,"layers."+this.id+".paint."+u,u,p,v))return!1;if(Ae(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-"-transition".length),p||void 0),!1;var x=this._transitionablePaint._values[u],C="cross-faded-data-driven"===x.property.specification["property-type"],O=x.value.isDataDriven(),K=x.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);var ie=this._transitionablePaint._values[u].value;return ie.isDataDriven()||O||C||this._handleOverridablePaintPropertyUpdate(u,K,ie)},i.prototype._handleSpecialPaintPropertyUpdate=function(u){},i.prototype._handleOverridablePaintPropertyUpdate=function(u,p,v){return!1},i.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||"none"===this.visibility},i.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},i.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},i.prototype.recalculate=function(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)},i.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),W(u,function(p,v){return!(void 0===p||"layout"===v&&!Object.keys(p).length||"paint"===v&&!Object.keys(p).length)})},i.prototype._validate=function(u,p,v,x,C){return void 0===C&&(C={}),(!C||!1!==C.validate)&&on(this,u.call(Ze,{key:p,layerType:this.type,objectKey:v,value:x,styleSpec:Je,style:{glyphs:!0,sprite:!0}}))},i.prototype.is3D=function(){return!1},i.prototype.isTileClipped=function(){return!1},i.prototype.hasOffscreenPass=function(){return!1},i.prototype.resize=function(){},i.prototype.isStateDependent=function(){for(var u in this.paint._values){var p=this.paint.get(u);if(p instanceof at&&Xo(p.property.specification)&&("source"===p.value.kind||"composite"===p.value.kind)&&p.value.isStateDependent)return!0}return!1},i}(Lt),xa={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ea=function(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Wr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Xi(t,i){void 0===i&&(i=1);var u=0,p=0;return{members:t.map(function(v){var x=xa[v.type].BYTES_PER_ELEMENT,C=u=Ks(u,Math.max(i,x)),O=v.components||1;return p=Math.max(p,x),u+=x*O,{name:v.name,type:v.type,components:O,offset:C}}),size:Ks(u,Math.max(p,i)),alignment:i}}function Ks(t,i){return Math.ceil(t/i)*i}Wr.serialize=function(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Wr.deserialize=function(t){var i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i},Wr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Wr.prototype.clear=function(){this.length=0},Wr.prototype.resize=function(t){this.reserve(t),this.length=t},Wr.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}},Wr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Jr=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p){var v=this.length;return this.resize(v+1),this.emplace(v,u,p)},i.prototype.emplace=function(u,p,v){var x=2*u;return this.int16[x+0]=p,this.int16[x+1]=v,u},i}(Wr);Jr.prototype.bytesPerElement=4,tr("StructArrayLayout2i4",Jr);var du=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x){var C=this.length;return this.resize(C+1),this.emplace(C,u,p,v,x)},i.prototype.emplace=function(u,p,v,x,C){var O=4*u;return this.int16[O+0]=p,this.int16[O+1]=v,this.int16[O+2]=x,this.int16[O+3]=C,u},i}(Wr);du.prototype.bytesPerElement=8,tr("StructArrayLayout4i8",du);var Pu=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C,O){var K=this.length;return this.resize(K+1),this.emplace(K,u,p,v,x,C,O)},i.prototype.emplace=function(u,p,v,x,C,O,K){var ie=6*u;return this.int16[ie+0]=p,this.int16[ie+1]=v,this.int16[ie+2]=x,this.int16[ie+3]=C,this.int16[ie+4]=O,this.int16[ie+5]=K,u},i}(Wr);Pu.prototype.bytesPerElement=12,tr("StructArrayLayout2i4i12",Pu);var ji=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C,O){var K=this.length;return this.resize(K+1),this.emplace(K,u,p,v,x,C,O)},i.prototype.emplace=function(u,p,v,x,C,O,K){var ie=4*u,pe=8*u;return this.int16[ie+0]=p,this.int16[ie+1]=v,this.uint8[pe+4]=x,this.uint8[pe+5]=C,this.uint8[pe+6]=O,this.uint8[pe+7]=K,u},i}(Wr);ji.prototype.bytesPerElement=8,tr("StructArrayLayout2i4ub8",ji);var ei=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p){var v=this.length;return this.resize(v+1),this.emplace(v,u,p)},i.prototype.emplace=function(u,p,v){var x=2*u;return this.float32[x+0]=p,this.float32[x+1]=v,u},i}(Wr);ei.prototype.bytesPerElement=8,tr("StructArrayLayout2f8",ei);var Ja=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C,O,K,ie,pe,Ee){var Be=this.length;return this.resize(Be+1),this.emplace(Be,u,p,v,x,C,O,K,ie,pe,Ee)},i.prototype.emplace=function(u,p,v,x,C,O,K,ie,pe,Ee,Be){var Ye=10*u;return this.uint16[Ye+0]=p,this.uint16[Ye+1]=v,this.uint16[Ye+2]=x,this.uint16[Ye+3]=C,this.uint16[Ye+4]=O,this.uint16[Ye+5]=K,this.uint16[Ye+6]=ie,this.uint16[Ye+7]=pe,this.uint16[Ye+8]=Ee,this.uint16[Ye+9]=Be,u},i}(Wr);Ja.prototype.bytesPerElement=20,tr("StructArrayLayout10ui20",Ja);var _o=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye){var yt=this.length;return this.resize(yt+1),this.emplace(yt,u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye)},i.prototype.emplace=function(u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt){var Et=12*u;return this.int16[Et+0]=p,this.int16[Et+1]=v,this.int16[Et+2]=x,this.int16[Et+3]=C,this.uint16[Et+4]=O,this.uint16[Et+5]=K,this.uint16[Et+6]=ie,this.uint16[Et+7]=pe,this.int16[Et+8]=Ee,this.int16[Et+9]=Be,this.int16[Et+10]=Ye,this.int16[Et+11]=yt,u},i}(Wr);_o.prototype.bytesPerElement=24,tr("StructArrayLayout4i4ui4i24",_o);var Ll=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v){var x=this.length;return this.resize(x+1),this.emplace(x,u,p,v)},i.prototype.emplace=function(u,p,v,x){var C=3*u;return this.float32[C+0]=p,this.float32[C+1]=v,this.float32[C+2]=x,u},i}(Wr);Ll.prototype.bytesPerElement=12,tr("StructArrayLayout3f12",Ll);var wl=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u){var p=this.length;return this.resize(p+1),this.emplace(p,u)},i.prototype.emplace=function(u,p){return this.uint32[1*u+0]=p,u},i}(Wr);wl.prototype.bytesPerElement=4,tr("StructArrayLayout1ul4",wl);var uo=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C,O,K,ie,pe){var Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,u,p,v,x,C,O,K,ie,pe)},i.prototype.emplace=function(u,p,v,x,C,O,K,ie,pe,Ee){var Be=10*u,Ye=5*u;return this.int16[Be+0]=p,this.int16[Be+1]=v,this.int16[Be+2]=x,this.int16[Be+3]=C,this.int16[Be+4]=O,this.int16[Be+5]=K,this.uint32[Ye+3]=ie,this.uint16[Be+8]=pe,this.uint16[Be+9]=Ee,u},i}(Wr);uo.prototype.bytesPerElement=20,tr("StructArrayLayout6i1ul2ui20",uo);var Nl=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C,O){var K=this.length;return this.resize(K+1),this.emplace(K,u,p,v,x,C,O)},i.prototype.emplace=function(u,p,v,x,C,O,K){var ie=6*u;return this.int16[ie+0]=p,this.int16[ie+1]=v,this.int16[ie+2]=x,this.int16[ie+3]=C,this.int16[ie+4]=O,this.int16[ie+5]=K,u},i}(Wr);Nl.prototype.bytesPerElement=12,tr("StructArrayLayout2i2i2i12",Nl);var es=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C){var O=this.length;return this.resize(O+1),this.emplace(O,u,p,v,x,C)},i.prototype.emplace=function(u,p,v,x,C,O){var K=4*u,ie=8*u;return this.float32[K+0]=p,this.float32[K+1]=v,this.float32[K+2]=x,this.int16[ie+6]=C,this.int16[ie+7]=O,u},i}(Wr);es.prototype.bytesPerElement=16,tr("StructArrayLayout2f1f2i16",es);var pl=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x){var C=this.length;return this.resize(C+1),this.emplace(C,u,p,v,x)},i.prototype.emplace=function(u,p,v,x,C){var O=12*u,K=3*u;return this.uint8[O+0]=p,this.uint8[O+1]=v,this.float32[K+1]=x,this.float32[K+2]=C,u},i}(Wr);pl.prototype.bytesPerElement=12,tr("StructArrayLayout2ub2f12",pl);var xl=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v){var x=this.length;return this.resize(x+1),this.emplace(x,u,p,v)},i.prototype.emplace=function(u,p,v,x){var C=3*u;return this.uint16[C+0]=p,this.uint16[C+1]=v,this.uint16[C+2]=x,u},i}(Wr);xl.prototype.bytesPerElement=6,tr("StructArrayLayout3ui6",xl);var no=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt,Et,Vt,At,Wt){var rn=this.length;return this.resize(rn+1),this.emplace(rn,u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt,Et,Vt,At,Wt)},i.prototype.emplace=function(u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt,Et,Vt,At,Wt,rn){var fn=24*u,cn=12*u,Tn=48*u;return this.int16[fn+0]=p,this.int16[fn+1]=v,this.uint16[fn+2]=x,this.uint16[fn+3]=C,this.uint32[cn+2]=O,this.uint32[cn+3]=K,this.uint32[cn+4]=ie,this.uint16[fn+10]=pe,this.uint16[fn+11]=Ee,this.uint16[fn+12]=Be,this.float32[cn+7]=Ye,this.float32[cn+8]=yt,this.uint8[Tn+36]=Et,this.uint8[Tn+37]=Vt,this.uint8[Tn+38]=At,this.uint32[cn+10]=Wt,this.int16[fn+22]=rn,u},i}(Wr);no.prototype.bytesPerElement=48,tr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",no);var Lc=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt,Et,Vt,At,Wt,rn,fn,cn,Tn,qn,ir,kr,pr,Ur,mr,ri){var Nr=this.length;return this.resize(Nr+1),this.emplace(Nr,u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt,Et,Vt,At,Wt,rn,fn,cn,Tn,qn,ir,kr,pr,Ur,mr,ri)},i.prototype.emplace=function(u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt,Et,Vt,At,Wt,rn,fn,cn,Tn,qn,ir,kr,pr,Ur,mr,ri,Nr){var xr=34*u,ti=17*u;return this.int16[xr+0]=p,this.int16[xr+1]=v,this.int16[xr+2]=x,this.int16[xr+3]=C,this.int16[xr+4]=O,this.int16[xr+5]=K,this.int16[xr+6]=ie,this.int16[xr+7]=pe,this.uint16[xr+8]=Ee,this.uint16[xr+9]=Be,this.uint16[xr+10]=Ye,this.uint16[xr+11]=yt,this.uint16[xr+12]=Et,this.uint16[xr+13]=Vt,this.uint16[xr+14]=At,this.uint16[xr+15]=Wt,this.uint16[xr+16]=rn,this.uint16[xr+17]=fn,this.uint16[xr+18]=cn,this.uint16[xr+19]=Tn,this.uint16[xr+20]=qn,this.uint16[xr+21]=ir,this.uint16[xr+22]=kr,this.uint32[ti+12]=pr,this.float32[ti+13]=Ur,this.float32[ti+14]=mr,this.float32[ti+15]=ri,this.float32[ti+16]=Nr,u},i}(Wr);Lc.prototype.bytesPerElement=68,tr("StructArrayLayout8i15ui1ul4f68",Lc);var Wi=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u){var p=this.length;return this.resize(p+1),this.emplace(p,u)},i.prototype.emplace=function(u,p){return this.float32[1*u+0]=p,u},i}(Wr);Wi.prototype.bytesPerElement=4,tr("StructArrayLayout1f4",Wi);var to=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v){var x=this.length;return this.resize(x+1),this.emplace(x,u,p,v)},i.prototype.emplace=function(u,p,v,x){var C=3*u;return this.int16[C+0]=p,this.int16[C+1]=v,this.int16[C+2]=x,u},i}(Wr);to.prototype.bytesPerElement=6,tr("StructArrayLayout3i6",to);var Ua=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v){var x=this.length;return this.resize(x+1),this.emplace(x,u,p,v)},i.prototype.emplace=function(u,p,v,x){var C=4*u;return this.uint32[2*u+0]=p,this.uint16[C+2]=v,this.uint16[C+3]=x,u},i}(Wr);Ua.prototype.bytesPerElement=8,tr("StructArrayLayout1ul2ui8",Ua);var Wl=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p){var v=this.length;return this.resize(v+1),this.emplace(v,u,p)},i.prototype.emplace=function(u,p,v){var x=2*u;return this.uint16[x+0]=p,this.uint16[x+1]=v,u},i}(Wr);Wl.prototype.bytesPerElement=4,tr("StructArrayLayout2ui4",Wl);var Fl=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u){var p=this.length;return this.resize(p+1),this.emplace(p,u)},i.prototype.emplace=function(u,p){return this.uint16[1*u+0]=p,u},i}(Wr);Fl.prototype.bytesPerElement=2,tr("StructArrayLayout1ui2",Fl);var ls=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},i.prototype.emplaceBack=function(u,p,v,x){var C=this.length;return this.resize(C+1),this.emplace(C,u,p,v,x)},i.prototype.emplace=function(u,p,v,x,C){var O=4*u;return this.float32[O+0]=p,this.float32[O+1]=v,this.float32[O+2]=x,this.float32[O+3]=C,u},i}(Wr);ls.prototype.bytesPerElement=16,tr("StructArrayLayout4f16",ls);var l=function(t){function i(){t.apply(this,arguments)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new Re(this.anchorPointX,this.anchorPointY)},Object.defineProperties(i.prototype,u),i}(Ea);l.prototype.size=20;var d=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.get=function(u){return new l(this,u)},i}(uo);tr("CollisionBoxArray",d);var h=function(t){function i(){t.apply(this,arguments)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(p){this._structArray.uint8[this._pos1+37]=p},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(p){this._structArray.uint8[this._pos1+38]=p},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(p){this._structArray.uint32[this._pos4+10]=p},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(i.prototype,u),i}(Ea);h.prototype.size=48;var m=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.get=function(u){return new h(this,u)},i}(no);tr("PlacedSymbolArray",m);var E=function(t){function i(){t.apply(this,arguments)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(p){this._structArray.uint32[this._pos4+12]=p},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(i.prototype,u),i}(Ea);E.prototype.size=68;var D=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.get=function(u){return new E(this,u)},i}(Lc);tr("SymbolInstanceArray",D);var k=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.getoffsetX=function(u){return this.float32[1*u+0]},i}(Wi);tr("GlyphOffsetArray",k);var G=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.getx=function(u){return this.int16[3*u+0]},i.prototype.gety=function(u){return this.int16[3*u+1]},i.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},i}(to);tr("SymbolLineVertexArray",G);var le=function(t){function i(){t.apply(this,arguments)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(i.prototype,u),i}(Ea);le.prototype.size=8;var Se=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.get=function(u){return new le(this,u)},i}(Ua);tr("FeatureIndexArray",Se);var Ke=Xi([{name:"a_pos",components:2,type:"Int16"}],4).members,Xe=function(t){void 0===t&&(t=[]),this.segments=t};function it(t,i){return 256*(t=St(Math.floor(t),0,255))+St(Math.floor(i),0,255)}Xe.prototype.prepareSegment=function(t,i,u,p){var v=this.segments[this.segments.length-1];return t>Xe.MAX_VERTEX_ARRAY_LENGTH&&U("Max vertices per segment is "+Xe.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!v||v.vertexLength+t>Xe.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p)&&(v={vertexOffset:i.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==p&&(v.sortKey=p),this.segments.push(v)),v},Xe.prototype.get=function(){return this.segments},Xe.prototype.destroy=function(){for(var t=0,i=this.segments;t<i.length;t+=1){var u=i[t];for(var p in u.vaos)u.vaos[p].destroy()}},Xe.simpleSegment=function(t,i,u,p){return new Xe([{vertexOffset:t,primitiveOffset:i,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])},Xe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,tr("SegmentVector",Xe);var xt=Xi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),wt=nt(function(t){t.exports=function(i,u){var p,v,x,C,O,K,ie,pe;for(v=i.length-(p=3&i.length),x=u,O=3432918353,K=461845907,pe=0;pe<v;)ie=255&i.charCodeAt(pe)|(255&i.charCodeAt(++pe))<<8|(255&i.charCodeAt(++pe))<<16|(255&i.charCodeAt(++pe))<<24,++pe,x=27492+(65535&(C=5*(65535&(x=(x^=ie=(65535&(ie=(ie=(65535&ie)*O+(((ie>>>16)*O&65535)<<16)&4294967295)<<15|ie>>>17))*K+(((ie>>>16)*K&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(ie=0,p){case 3:ie^=(255&i.charCodeAt(pe+2))<<16;case 2:ie^=(255&i.charCodeAt(pe+1))<<8;case 1:x^=ie=(65535&(ie=(ie=(65535&(ie^=255&i.charCodeAt(pe)))*O+(((ie>>>16)*O&65535)<<16)&4294967295)<<15|ie>>>17))*K+(((ie>>>16)*K&65535)<<16)&4294967295}return x^=i.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}}),Pt=nt(function(t){t.exports=function(i,u){for(var p,v=i.length,x=u^v,C=0;v>=4;)p=1540483477*(65535&(p=255&i.charCodeAt(C)|(255&i.charCodeAt(++C))<<8|(255&i.charCodeAt(++C))<<16|(255&i.charCodeAt(++C))<<24))+((1540483477*(p>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),v-=4,++C;switch(v){case 3:x^=(255&i.charCodeAt(C+2))<<16;case 2:x^=(255&i.charCodeAt(C+1))<<8;case 1:x=1540483477*(65535&(x^=255&i.charCodeAt(C)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}}),gt=wt,kt=Pt;gt.murmur3=wt,gt.murmur2=kt;var Bt=function(){this.ids=[],this.positions=[],this.indexed=!1};Bt.prototype.add=function(t,i,u,p){this.ids.push(tn(t)),this.positions.push(i,u,p)},Bt.prototype.getPositions=function(t){for(var i=tn(t),u=0,p=this.ids.length-1;u<p;){var v=u+p>>1;this.ids[v]>=i?p=v:u=v+1}for(var x=[];this.ids[u]===i;)x.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return x},Bt.serialize=function(t,i){var u=new Float64Array(t.ids),p=new Uint32Array(t.positions);return function v(x,C,O,K){for(;O<K;){for(var ie=x[O+K>>1],pe=O-1,Ee=K+1;;){do{pe++}while(x[pe]<ie);do{Ee--}while(x[Ee]>ie);if(pe>=Ee)break;un(x,pe,Ee),un(C,3*pe,3*Ee),un(C,3*pe+1,3*Ee+1),un(C,3*pe+2,3*Ee+2)}Ee-O<K-Ee?(v(x,C,O,Ee),O=Ee+1):(v(x,C,Ee+1,K),K=Ee)}}(u,p,0,u.length-1),i&&i.push(u.buffer,p.buffer),{ids:u,positions:p}},Bt.deserialize=function(t){var i=new Bt;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i};var Jt=Math.pow(2,53)-1;function tn(t){var i=+t;return!isNaN(i)&&i<=Jt?i:gt(String(t))}function un(t,i,u){var p=t[i];t[i]=t[u],t[u]=p}tr("FeaturePositionMap",Bt);var gn=function(t,i){this.gl=t.gl,this.location=i},Rn=function(t){function i(u,p){t.call(this,u,p),this.current=0}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},i}(gn),$n=function(t){function i(u,p){t.call(this,u,p),this.current=0}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},i}(gn),Vn=function(t){function i(u,p){t.call(this,u,p),this.current=[0,0]}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},i}(gn),cr=function(t){function i(u,p){t.call(this,u,p),this.current=[0,0,0]}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},i}(gn),yr=function(t){function i(u,p){t.call(this,u,p),this.current=[0,0,0,0]}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},i}(gn),Z=function(t){function i(u,p){t.call(this,u,p),this.current=Fr.transparent}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},i}(gn),Q=new Float32Array(16),Fe=function(t){function i(u,p){t.call(this,u,p),this.current=Q}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var p=1;p<16;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},i}(gn);function st(t){return[it(255*t.r,255*t.g),it(255*t.b,255*t.a)]}var Ut=function(t,i,u){this.value=t,this.uniformNames=i.map(function(p){return"u_"+p}),this.type=u};Ut.prototype.setUniform=function(t,i,u){t.set(u.constantOr(this.value))},Ut.prototype.getBinding=function(t,i,u){return"color"===this.type?new Z(t,i):new $n(t,i)};var Qt=function(t,i){this.uniformNames=i.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Qt.prototype.setConstantPatternPositions=function(t,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=t.tlbr},Qt.prototype.setUniform=function(t,i,u,p){var v="u_pattern_to"===p?this.patternTo:"u_pattern_from"===p?this.patternFrom:"u_pixel_ratio_to"===p?this.pixelRatioTo:"u_pixel_ratio_from"===p?this.pixelRatioFrom:null;v&&t.set(v)},Qt.prototype.getBinding=function(t,i,u){return"u_pattern"===u.substr(0,9)?new yr(t,i):new $n(t,i)};var mn=function(t,i,u,p){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=i.map(function(v){return{name:"a_"+v,type:"Float32",components:"color"===u?2:1,offset:0}}),this.paintVertexArray=new p};mn.prototype.populatePaintArray=function(t,i,u,p,v){var x=this.paintVertexArray.length,C=this.expression.evaluate(new V(0),i,{},p,[],v);this.paintVertexArray.resize(t),this._setPaintValue(x,t,C)},mn.prototype.updatePaintArray=function(t,i,u,p){var v=this.expression.evaluate({zoom:0},u,p);this._setPaintValue(t,i,v)},mn.prototype._setPaintValue=function(t,i,u){if("color"===this.type)for(var p=st(u),v=t;v<i;v++)this.paintVertexArray.emplace(v,p[0],p[1]);else{for(var x=t;x<i;x++)this.paintVertexArray.emplace(x,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},mn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},mn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var xn=function(t,i,u,p,v,x){this.expression=t,this.uniformNames=i.map(function(C){return"u_"+C+"_t"}),this.type=u,this.useIntegerZoom=p,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=i.map(function(C){return{name:"a_"+C,type:"Float32",components:"color"===u?4:2,offset:0}}),this.paintVertexArray=new x};xn.prototype.populatePaintArray=function(t,i,u,p,v){var x=this.expression.evaluate(new V(this.zoom),i,{},p,[],v),C=this.expression.evaluate(new V(this.zoom+1),i,{},p,[],v),O=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(O,t,x,C)},xn.prototype.updatePaintArray=function(t,i,u,p){var v=this.expression.evaluate({zoom:this.zoom},u,p),x=this.expression.evaluate({zoom:this.zoom+1},u,p);this._setPaintValue(t,i,v,x)},xn.prototype._setPaintValue=function(t,i,u,p){if("color"===this.type)for(var v=st(u),x=st(p),C=t;C<i;C++)this.paintVertexArray.emplace(C,v[0],v[1],x[0],x[1]);else{for(var O=t;O<i;O++)this.paintVertexArray.emplace(O,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}},xn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},xn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},xn.prototype.setUniform=function(t,i){var u=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,p=St(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(p)},xn.prototype.getBinding=function(t,i,u){return new $n(t,i)};var Bn=function(t,i,u,p,v,x){this.expression=t,this.type=i,this.useIntegerZoom=u,this.zoom=p,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v};Bn.prototype.populatePaintArray=function(t,i,u){var p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(p,t,i.patterns&&i.patterns[this.layerId],u)},Bn.prototype.updatePaintArray=function(t,i,u,p,v){this._setPaintValues(t,i,u.patterns&&u.patterns[this.layerId],v)},Bn.prototype._setPaintValues=function(t,i,u,p){if(p&&u){var v=p[u.min],x=p[u.mid],C=p[u.max];if(v&&x&&C)for(var O=t;O<i;O++)this.zoomInPaintVertexArray.emplace(O,x.tl[0],x.tl[1],x.br[0],x.br[1],v.tl[0],v.tl[1],v.br[0],v.br[1],x.pixelRatio,v.pixelRatio),this.zoomOutPaintVertexArray.emplace(O,x.tl[0],x.tl[1],x.br[0],x.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],x.pixelRatio,C.pixelRatio)}},Bn.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,xt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,xt.members,this.expression.isStateDependent))},Bn.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var sr=function(t,i,u){this.binders={},this._buffers=[];var p=[];for(var v in t.paint._values)if(u(v)){var x=t.paint.get(v);if(x instanceof at&&Xo(x.property.specification)){var C=vi(v,t.type),O=x.value,K=x.property.specification.type,ie=x.property.useIntegerZoom,pe=x.property.specification["property-type"],Ee="cross-faded"===pe||"cross-faded-data-driven"===pe;if("constant"===O.kind)this.binders[v]=Ee?new Qt(O.value,C):new Ut(O.value,C,K),p.push("/u_"+v);else if("source"===O.kind||Ee){var Be=ki(v,K,"source");this.binders[v]=Ee?new Bn(O,K,ie,i,Be,t.id):new mn(O,C,K,Be),p.push("/a_"+v)}else{var Ye=ki(v,K,"composite");this.binders[v]=new xn(O,C,K,ie,i,Ye),p.push("/z_"+v)}}}this.cacheKey=p.sort().join("")};sr.prototype.getMaxValue=function(t){var i=this.binders[t];return i instanceof mn||i instanceof xn?i.maxValue:0},sr.prototype.populatePaintArrays=function(t,i,u,p,v){for(var x in this.binders){var C=this.binders[x];(C instanceof mn||C instanceof xn||C instanceof Bn)&&C.populatePaintArray(t,i,u,p,v)}},sr.prototype.setConstantPatternPositions=function(t,i){for(var u in this.binders){var p=this.binders[u];p instanceof Qt&&p.setConstantPatternPositions(t,i)}},sr.prototype.updatePaintArrays=function(t,i,u,p,v){var x=!1;for(var C in t)for(var O=0,K=i.getPositions(C);O<K.length;O+=1){var ie=K[O],pe=u.feature(ie.index);for(var Ee in this.binders){var Be=this.binders[Ee];if((Be instanceof mn||Be instanceof xn||Be instanceof Bn)&&!0===Be.expression.isStateDependent){var Ye=p.paint.get(Ee);Be.expression=Ye.value,Be.updatePaintArray(ie.start,ie.end,pe,t[C],v),x=!0}}}return x},sr.prototype.defines=function(){var t=[];for(var i in this.binders){var u=this.binders[i];(u instanceof Ut||u instanceof Qt)&&t.push.apply(t,u.uniformNames.map(function(p){return"#define HAS_UNIFORM_"+p}))}return t},sr.prototype.getBinderAttributes=function(){var t=[];for(var i in this.binders){var u=this.binders[i];if(u instanceof mn||u instanceof xn)for(var p=0;p<u.paintVertexAttributes.length;p++)t.push(u.paintVertexAttributes[p].name);else if(u instanceof Bn)for(var v=0;v<xt.members.length;v++)t.push(xt.members[v].name)}return t},sr.prototype.getBinderUniforms=function(){var t=[];for(var i in this.binders){var u=this.binders[i];if(u instanceof Ut||u instanceof Qt||u instanceof xn)for(var p=0,v=u.uniformNames;p<v.length;p+=1)t.push(v[p])}return t},sr.prototype.getPaintVertexBuffers=function(){return this._buffers},sr.prototype.getUniforms=function(t,i){var u=[];for(var p in this.binders){var v=this.binders[p];if(v instanceof Ut||v instanceof Qt||v instanceof xn)for(var x=0,C=v.uniformNames;x<C.length;x+=1){var O=C[x];if(i[O]){var K=v.getBinding(t,i[O],O);u.push({name:O,property:p,binding:K})}}}return u},sr.prototype.setUniforms=function(t,i,u,p){for(var v=0,x=i;v<x.length;v+=1){var C=x[v],O=C.name,K=C.property;this.binders[K].setUniform(C.binding,p,u.get(K),O)}},sr.prototype.updatePaintBuffers=function(t){for(var i in this._buffers=[],this.binders){var u=this.binders[i];if(t&&u instanceof Bn){var p=2===t.fromScale?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(u instanceof mn||u instanceof xn)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},sr.prototype.upload=function(t){for(var i in this.binders){var u=this.binders[i];(u instanceof mn||u instanceof xn||u instanceof Bn)&&u.upload(t)}this.updatePaintBuffers()},sr.prototype.destroy=function(){for(var t in this.binders){var i=this.binders[t];(i instanceof mn||i instanceof xn||i instanceof Bn)&&i.destroy()}};var hr=function(t,i,u){void 0===u&&(u=function(){return!0}),this.programConfigurations={};for(var p=0,v=t;p<v.length;p+=1){var x=v[p];this.programConfigurations[x.id]=new sr(x,i,u)}this.needsUpload=!1,this._featureMap=new Bt,this._bufferOffset=0};function vi(t,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(i+"-","").replace(/-/g,"_")]}function ki(t,i,u){var v={"line-pattern":{source:Ja,composite:Ja},"fill-pattern":{source:Ja,composite:Ja},"fill-extrusion-pattern":{source:Ja,composite:Ja}}[t];return v&&v[u]||{color:{source:ei,composite:ls},number:{source:Wi,composite:ei}}[i][u]}hr.prototype.populatePaintArrays=function(t,i,u,p,v,x){for(var C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(t,i,p,v,x);void 0!==i.id&&this._featureMap.add(i.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},hr.prototype.updatePaintArrays=function(t,i,u,p){for(var v=0,x=u;v<x.length;v+=1){var C=x[v];this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(t,this._featureMap,i,C,p)||this.needsUpload}},hr.prototype.get=function(t){return this.programConfigurations[t]},hr.prototype.upload=function(t){if(this.needsUpload){for(var i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}},hr.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},tr("ConstantBinder",Ut),tr("CrossFadedConstantBinder",Qt),tr("SourceExpressionBinder",mn),tr("CrossFadedCompositeBinder",Bn),tr("CompositeExpressionBinder",xn),tr("ProgramConfiguration",sr,{omit:["_buffers"]}),tr("ProgramConfigurationSet",hr);var Hi=Math.pow(2,14)-1,$o=-Hi-1;function Ei(t){for(var i=8192/t.extent,u=t.loadGeometry(),p=0;p<u.length;p++)for(var v=u[p],x=0;x<v.length;x++){var C=v[x],O=Math.round(C.x*i),K=Math.round(C.y*i);C.x=St(O,$o,Hi),C.y=St(K,$o,Hi),(O<C.x||O>C.x+1||K<C.y||K>C.y+1)&&U("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function Qi(t,i){return{type:t.type,id:t.id,properties:t.properties,geometry:i?Ei(t):[]}}function ko(t,i,u,p,v){t.emplaceBack(2*i+(p+1)/2,2*u+(v+1)/2)}var vo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Jr,this.indexArray=new xl,this.segments=new Xe,this.programConfigurations=new hr(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};function Xa(t,i){for(var u=0;u<t.length;u++)if(Wu(i,t[u]))return!0;for(var p=0;p<i.length;p++)if(Wu(t,i[p]))return!0;return!!ol(t,i)}function ua(t,i,u){return!!Wu(t,i)||!!El(i,t,u)}function za(t,i){if(1===t.length)return ml(i,t[0]);for(var u=0;u<i.length;u++)for(var p=i[u],v=0;v<p.length;v++)if(Wu(t,p[v]))return!0;for(var x=0;x<t.length;x++)if(ml(i,t[x]))return!0;for(var C=0;C<i.length;C++)if(ol(t,i[C]))return!0;return!1}function Ys(t,i,u){if(t.length>1){if(ol(t,i))return!0;for(var p=0;p<i.length;p++)if(El(i[p],t,u))return!0}for(var v=0;v<t.length;v++)if(El(t[v],i,u))return!0;return!1}function ol(t,i){if(0===t.length||0===i.length)return!1;for(var u=0;u<t.length-1;u++)for(var p=t[u],v=t[u+1],x=0;x<i.length-1;x++)if(Ia(p,v,i[x],i[x+1]))return!0;return!1}function Ia(t,i,u,p){return Y(t,u,p)!==Y(i,u,p)&&Y(t,i,u)!==Y(t,i,p)}function El(t,i,u){var p=u*u;if(1===i.length)return t.distSqr(i[0])<p;for(var v=1;v<i.length;v++)if(Ta(t,i[v-1],i[v])<p)return!0;return!1}function Ta(t,i,u){var p=i.distSqr(u);if(0===p)return t.distSqr(i);var v=((t.x-i.x)*(u.x-i.x)+(t.y-i.y)*(u.y-i.y))/p;return t.distSqr(v<0?i:v>1?u:u.sub(i)._mult(v)._add(i))}function ml(t,i){for(var u,p,v,x=!1,C=0;C<t.length;C++)for(var O=0,K=(u=t[C]).length-1;O<u.length;K=O++)(p=u[O]).y>i.y!=(v=u[K]).y>i.y&&i.x<(v.x-p.x)*(i.y-p.y)/(v.y-p.y)+p.x&&(x=!x);return x}function Wu(t,i){for(var u=!1,p=0,v=t.length-1;p<t.length;v=p++){var x=t[p],C=t[v];x.y>i.y!=C.y>i.y&&i.x<(C.x-x.x)*(i.y-x.y)/(C.y-x.y)+x.x&&(u=!u)}return u}function Il(t,i,u){var p=u[0],v=u[2];if(t.x<p.x&&i.x<p.x||t.x>v.x&&i.x>v.x||t.y<p.y&&i.y<p.y||t.y>v.y&&i.y>v.y)return!1;var x=Y(t,i,u[0]);return x!==Y(t,i,u[1])||x!==Y(t,i,u[2])||x!==Y(t,i,u[3])}function Zu(t,i,u){var p=i.paint.get(t).value;return"constant"===p.kind?p.value:u.programConfigurations.get(i.id).getMaxValue(t)}function ys(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Tl(t,i,u,p,v){if(!i[0]&&!i[1])return t;var x=Re.convert(i)._mult(v);"viewport"===u&&x._rotate(-p);for(var C=[],O=0;O<t.length;O++)C.push(t[O].sub(x));return C}vo.prototype.populate=function(t,i,u){var p=this.layers[0],v=[],x=null;"circle"===p.type&&(x=p.layout.get("circle-sort-key"));for(var C=0,O=t;C<O.length;C+=1){var K=O[C],ie=K.feature,pe=K.id,Ee=K.index,Be=K.sourceLayerIndex,Ye=this.layers[0]._featureFilter.needGeometry,yt=Qi(ie,Ye);if(this.layers[0]._featureFilter.filter(new V(this.zoom),yt,u)){var Et=x?x.evaluate(yt,{},u):void 0,Vt={id:pe,properties:ie.properties,type:ie.type,sourceLayerIndex:Be,index:Ee,geometry:Ye?yt.geometry:Ei(ie),patterns:{},sortKey:Et};v.push(Vt)}}x&&v.sort(function(ir,kr){return ir.sortKey-kr.sortKey});for(var At=0,Wt=v;At<Wt.length;At+=1){var rn=Wt[At],fn=rn.geometry,cn=rn.index,Tn=rn.sourceLayerIndex,qn=t[cn].feature;this.addFeature(rn,fn,cn,u),i.featureIndex.insert(qn,fn,cn,Tn,this.index)}},vo.prototype.update=function(t,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,u)},vo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},vo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},vo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ke),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},vo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},vo.prototype.addFeature=function(t,i,u,p){for(var v=0,x=i;v<x.length;v+=1)for(var C=0,O=x[v];C<O.length;C+=1){var K=O[C],ie=K.x,pe=K.y;if(!(ie<0||ie>=8192||pe<0||pe>=8192)){var Ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),Be=Ee.vertexLength;ko(this.layoutVertexArray,ie,pe,-1,-1),ko(this.layoutVertexArray,ie,pe,1,-1),ko(this.layoutVertexArray,ie,pe,1,1),ko(this.layoutVertexArray,ie,pe,-1,1),this.indexArray.emplaceBack(Be,Be+1,Be+2),this.indexArray.emplaceBack(Be,Be+3,Be+2),Ee.vertexLength+=4,Ee.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},p)},tr("CircleBucket",vo,{omit:["layers"]});var Sl=new Ro({"circle-sort-key":new Fn(Je.layout_circle["circle-sort-key"])}),Bl={paint:new Ro({"circle-radius":new Fn(Je.paint_circle["circle-radius"]),"circle-color":new Fn(Je.paint_circle["circle-color"]),"circle-blur":new Fn(Je.paint_circle["circle-blur"]),"circle-opacity":new Fn(Je.paint_circle["circle-opacity"]),"circle-translate":new wn(Je.paint_circle["circle-translate"]),"circle-translate-anchor":new wn(Je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wn(Je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wn(Je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Fn(Je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Fn(Je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Fn(Je.paint_circle["circle-stroke-opacity"])}),layout:Sl},Fi="undefined"!=typeof Float32Array?Float32Array:Array;function Va(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Sa(t,i,u){var p=i[0],v=i[1],x=i[2],C=i[3],O=i[4],K=i[5],ie=i[6],pe=i[7],Ee=i[8],Be=i[9],Ye=i[10],yt=i[11],Et=i[12],Vt=i[13],At=i[14],Wt=i[15],rn=u[0],fn=u[1],cn=u[2],Tn=u[3];return t[0]=rn*p+fn*O+cn*Ee+Tn*Et,t[1]=rn*v+fn*K+cn*Be+Tn*Vt,t[2]=rn*x+fn*ie+cn*Ye+Tn*At,t[3]=rn*C+fn*pe+cn*yt+Tn*Wt,t[4]=(rn=u[4])*p+(fn=u[5])*O+(cn=u[6])*Ee+(Tn=u[7])*Et,t[5]=rn*v+fn*K+cn*Be+Tn*Vt,t[6]=rn*x+fn*ie+cn*Ye+Tn*At,t[7]=rn*C+fn*pe+cn*yt+Tn*Wt,t[8]=(rn=u[8])*p+(fn=u[9])*O+(cn=u[10])*Ee+(Tn=u[11])*Et,t[9]=rn*v+fn*K+cn*Be+Tn*Vt,t[10]=rn*x+fn*ie+cn*Ye+Tn*At,t[11]=rn*C+fn*pe+cn*yt+Tn*Wt,t[12]=(rn=u[12])*p+(fn=u[13])*O+(cn=u[14])*Ee+(Tn=u[15])*Et,t[13]=rn*v+fn*K+cn*Be+Tn*Vt,t[14]=rn*x+fn*ie+cn*Ye+Tn*At,t[15]=rn*C+fn*pe+cn*yt+Tn*Wt,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,i=0,u=arguments.length;u--;)i+=t[u]*t[u];return Math.sqrt(i)});var Ru,t,dc=Sa;function Ku(t,i,u){var p=i[0],v=i[1],x=i[2],C=i[3];return t[0]=u[0]*p+u[4]*v+u[8]*x+u[12]*C,t[1]=u[1]*p+u[5]*v+u[9]*x+u[13]*C,t[2]=u[2]*p+u[6]*v+u[10]*x+u[14]*C,t[3]=u[3]*p+u[7]*v+u[11]*x+u[15]*C,t}Ru=new Fi(3),Fi!=Float32Array&&(Ru[0]=0,Ru[1]=0,Ru[2]=0),t=new Fi(4),Fi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0);var Qd=(function(){var t=new Fi(2);Fi!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function i(u){t.call(this,u,Bl)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.createBucket=function(u){return new vo(u)},i.prototype.queryRadius=function(u){var p=u;return Zu("circle-radius",this,p)+Zu("circle-stroke-width",this,p)+ys(this.paint.get("circle-translate"))},i.prototype.queryIntersectsFeature=function(u,p,v,x,C,O,K,ie){for(var pe=Tl(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),O.angle,K),Ee=this.paint.get("circle-radius").evaluate(p,v)+this.paint.get("circle-stroke-width").evaluate(p,v),Be="map"===this.paint.get("circle-pitch-alignment"),Ye=Be?pe:function(qn,ir){return qn.map(function(kr){return fu(kr,ir)})}(pe,ie),yt=Be?Ee*K:Ee,Et=0,Vt=x;Et<Vt.length;Et+=1)for(var At=0,Wt=Vt[Et];At<Wt.length;At+=1){var rn=Wt[At],fn=Be?rn:fu(rn,ie),cn=yt,Tn=Ku([],[rn.x,rn.y,0,1],ie);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?cn*=Tn[3]/O.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(cn*=O.cameraToCenterDistance/Tn[3]),ua(Ye,fn,cn))return!0}return!1},i}(Co));function fu(t,i){var u=Ku([],[t.x,t.y,0,1],i);return new Re(u[0]/u[3],u[1]/u[3])}var Nc=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(vo);function Yu(t,i,u,p){var v=i.width,x=i.height;if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==v*x*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(v*x*u);return t.width=v,t.height=x,t.data=p,t}function fc(t,i,u){var p=i.width,v=i.height;if(p!==t.width||v!==t.height){var x=Yu({},{width:p,height:v},u);uh(t,x,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,p),height:Math.min(t.height,v)},u),t.width=p,t.height=v,t.data=x.data}}function uh(t,i,u,p,v,x){if(0===v.width||0===v.height)return i;if(v.width>t.width||v.height>t.height||u.x>t.width-v.width||u.y>t.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>i.width||v.height>i.height||p.x>i.width-v.width||p.y>i.height-v.height)throw new RangeError("out of range destination coordinates for image copy");for(var C=t.data,O=i.data,K=0;K<v.height;K++)for(var ie=((u.y+K)*t.width+u.x)*x,pe=((p.y+K)*i.width+p.x)*x,Ee=0;Ee<v.width*x;Ee++)O[pe+Ee]=C[ie+Ee];return i}tr("HeatmapBucket",Nc,{omit:["layers"]});var Qa=function(t,i){Yu(this,t,1,i)};Qa.prototype.resize=function(t){fc(this,t,1)},Qa.prototype.clone=function(){return new Qa({width:this.width,height:this.height},new Uint8Array(this.data))},Qa.copy=function(t,i,u,p,v){uh(t,i,u,p,v,1)};var pu=function(t,i){Yu(this,t,4,i)};pu.prototype.resize=function(t){fc(this,t,4)},pu.prototype.replace=function(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},pu.prototype.clone=function(){return new pu({width:this.width,height:this.height},new Uint8Array(this.data))},pu.copy=function(t,i,u,p,v){uh(t,i,u,p,v,4)},tr("AlphaImage",Qa),tr("RGBAImage",pu);var Kp={paint:new Ro({"heatmap-radius":new Fn(Je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Fn(Je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wn(Je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new xi(Je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wn(Je.paint_heatmap["heatmap-opacity"])})};function Js(t){var i={},u=t.resolution||256,p=t.clips?t.clips.length:1,v=t.image||new pu({width:u,height:p}),x=function(yt,Et,Vt){i[t.evaluationKey]=Vt;var At=t.expression.evaluate(i);v.data[yt+Et+0]=Math.floor(255*At.r/At.a),v.data[yt+Et+1]=Math.floor(255*At.g/At.a),v.data[yt+Et+2]=Math.floor(255*At.b/At.a),v.data[yt+Et+3]=Math.floor(255*At.a)};if(t.clips)for(var C=0,O=0;C<p;++C,O+=4*u)for(var K=0,ie=0;K<u;K++,ie+=4){var pe=K/(u-1),Ee=t.clips[C];x(O,ie,Ee.start*(1-pe)+Ee.end*pe)}else for(var Be=0,Ye=0;Be<u;Be++,Ye+=4)x(0,Ye,Be/(u-1));return v}var lh=function(t){function i(u){t.call(this,u,Kp),this._updateColorRamp()}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.createBucket=function(u){return new Nc(u)},i.prototype._handleSpecialPaintPropertyUpdate=function(u){"heatmap-color"===u&&this._updateColorRamp()},i.prototype._updateColorRamp=function(){this.colorRamp=Js({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},i.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},i.prototype.queryRadius=function(){return 0},i.prototype.queryIntersectsFeature=function(){return!1},i.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},i}(Co),fd={paint:new Ro({"hillshade-illumination-direction":new wn(Je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wn(Je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wn(Je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wn(Je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wn(Je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wn(Je.paint_hillshade["hillshade-accent-color"])})},Cl=function(t){function i(u){t.call(this,u,fd)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},i}(Co),pc=Xi([{name:"a_pos",components:2,type:"Int16"}],4).members,Fh=Fc,Gf=Fc;function Fc(t,i,u){u=u||2;var p,v,x,C,O,K,ie,pe=i&&i.length,Ee=pe?i[0]*u:t.length,Be=ch(t,0,Ee,u,!0),Ye=[];if(!Be||Be.next===Be.prev)return Ye;if(pe&&(Be=function(Et,Vt,At,Wt){var rn,fn,cn,Tn=[];for(rn=0,fn=Vt.length;rn<fn;rn++)(cn=ch(Et,Vt[rn]*Wt,rn<fn-1?Vt[rn+1]*Wt:Et.length,Wt,!1))===cn.next&&(cn.steiner=!0),Tn.push(tf(cn));for(Tn.sort(Uc),rn=0;rn<Tn.length;rn++)Ca(Tn[rn],At),At=mu(At,At.next);return At}(t,i,Be,u)),t.length>80*u){p=x=t[0],v=C=t[1];for(var yt=u;yt<Ee;yt+=u)(O=t[yt])<p&&(p=O),(K=t[yt+1])<v&&(v=K),O>x&&(x=O),K>C&&(C=K);ie=0!==(ie=Math.max(x-p,C-v))?1/ie:0}return Bc(Be,Ye,u,p,v,ie),Ye}function ch(t,i,u,p,v){var x,C;if(v===Oo(t,i,u,p)>0)for(x=i;x<u;x+=p)C=gd(x,t[x],t[x+1],C);else for(x=u-p;x>=i;x-=p)C=gd(x,t[x],t[x+1],C);return C&&Go(C,C.next)&&(gc(C),C=C.next),C}function mu(t,i){if(!t)return t;i||(i=t);var u,p=t;do{if(u=!1,p.steiner||!Go(p,p.next)&&0!==$i(p.prev,p,p.next))p=p.next;else{if(gc(p),(p=i=p.prev)===p.next)break;u=!0}}while(u||p!==i);return i}function Bc(t,i,u,p,v,x,C){if(t){!C&&x&&function(pe,Ee,Be,Ye){var yt=pe;do{null===yt.z&&(yt.z=Ul(yt.x,yt.y,Ee,Be,Ye)),yt.prevZ=yt.prev,yt.nextZ=yt.next,yt=yt.next}while(yt!==pe);yt.prevZ.nextZ=null,yt.prevZ=null,function(Et){var Vt,At,Wt,rn,fn,cn,Tn,qn,ir=1;do{for(At=Et,Et=null,fn=null,cn=0;At;){for(cn++,Wt=At,Tn=0,Vt=0;Vt<ir&&(Tn++,Wt=Wt.nextZ);Vt++);for(qn=ir;Tn>0||qn>0&&Wt;)0!==Tn&&(0===qn||!Wt||At.z<=Wt.z)?(rn=At,At=At.nextZ,Tn--):(rn=Wt,Wt=Wt.nextZ,qn--),fn?fn.nextZ=rn:Et=rn,rn.prevZ=fn,fn=rn;At=Wt}fn.nextZ=null,ir*=2}while(cn>1)}(yt)}(t,p,v,x);for(var O,K,ie=t;t.prev!==t.next;)if(O=t.prev,K=t.next,x?qf(t,p,v,x):ef(t))i.push(O.i/u),i.push(t.i/u),i.push(K.i/u),gc(t),t=K.next,ie=K.next;else if((t=K)===ie){C?1===C?Bc(t=Bh(mu(t),i,u),i,u,p,v,x,2):2===C&&Wf(t,i,u,p,v,x):Bc(mu(t),i,u,p,v,x,1);break}}}function ef(t){var i=t.prev,u=t,p=t.next;if($i(i,u,p)>=0)return!1;for(var v=t.next.next;v!==t.prev;){if(lo(i.x,i.y,u.x,u.y,p.x,p.y,v.x,v.y)&&$i(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function qf(t,i,u,p){var v=t.prev,x=t,C=t.next;if($i(v,x,C)>=0)return!1;for(var O=v.x>x.x?v.x>C.x?v.x:C.x:x.x>C.x?x.x:C.x,K=v.y>x.y?v.y>C.y?v.y:C.y:x.y>C.y?x.y:C.y,ie=Ul(v.x<x.x?v.x<C.x?v.x:C.x:x.x<C.x?x.x:C.x,v.y<x.y?v.y<C.y?v.y:C.y:x.y<C.y?x.y:C.y,i,u,p),pe=Ul(O,K,i,u,p),Ee=t.prevZ,Be=t.nextZ;Ee&&Ee.z>=ie&&Be&&Be.z<=pe;){if(Ee!==t.prev&&Ee!==t.next&&lo(v.x,v.y,x.x,x.y,C.x,C.y,Ee.x,Ee.y)&&$i(Ee.prev,Ee,Ee.next)>=0||(Ee=Ee.prevZ,Be!==t.prev&&Be!==t.next&&lo(v.x,v.y,x.x,x.y,C.x,C.y,Be.x,Be.y)&&$i(Be.prev,Be,Be.next)>=0))return!1;Be=Be.nextZ}for(;Ee&&Ee.z>=ie;){if(Ee!==t.prev&&Ee!==t.next&&lo(v.x,v.y,x.x,x.y,C.x,C.y,Ee.x,Ee.y)&&$i(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.prevZ}for(;Be&&Be.z<=pe;){if(Be!==t.prev&&Be!==t.next&&lo(v.x,v.y,x.x,x.y,C.x,C.y,Be.x,Be.y)&&$i(Be.prev,Be,Be.next)>=0)return!1;Be=Be.nextZ}return!0}function Bh(t,i,u){var p=t;do{var v=p.prev,x=p.next.next;!Go(v,x)&&pd(v,p,p.next,x)&&md(v,x)&&md(x,v)&&(i.push(v.i/u),i.push(p.i/u),i.push(x.i/u),gc(p),gc(p.next),p=t=x),p=p.next}while(p!==t);return mu(p)}function Wf(t,i,u,p,v,x){var C=t;do{for(var O=C.next.next;O!==C.prev;){if(C.i!==O.i&&mc(C,O)){var K=hh(C,O);return C=mu(C,C.next),K=mu(K,K.next),Bc(C,i,u,p,v,x),void Bc(K,i,u,p,v,x)}O=O.next}C=C.next}while(C!==t)}function Uc(t,i){return t.x-i.x}function Ca(t,i){if(i=function(p,v){var x,C=v,O=p.x,K=p.y,ie=-1/0;do{if(K<=C.y&&K>=C.next.y&&C.next.y!==C.y){var pe=C.x+(K-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(pe<=O&&pe>ie){if(ie=pe,pe===O){if(K===C.y)return C;if(K===C.next.y)return C.next}x=C.x<C.next.x?C:C.next}}C=C.next}while(C!==v);if(!x)return null;if(O===ie)return x;var Ee,Be=x,Ye=x.x,yt=x.y,Et=1/0;C=x;do{O>=C.x&&C.x>=Ye&&O!==C.x&&lo(K<yt?O:ie,K,Ye,yt,K<yt?ie:O,K,C.x,C.y)&&(Ee=Math.abs(K-C.y)/(O-C.x),md(C,p)&&(Ee<Et||Ee===Et&&(C.x>x.x||C.x===x.x&&bo(x,C)))&&(x=C,Et=Ee)),C=C.next}while(C!==Be);return x}(t,i)){var u=hh(i,t);mu(i,i.next),mu(u,u.next)}}function bo(t,i){return $i(t.prev,t,i.prev)<0&&$i(i.next,t,t.next)<0}function Ul(t,i,u,p,v){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*v)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-p)*v)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function tf(t){var i=t,u=t;do{(i.x<u.x||i.x===u.x&&i.y<u.y)&&(u=i),i=i.next}while(i!==t);return u}function lo(t,i,u,p,v,x,C,O){return(v-C)*(i-O)-(t-C)*(x-O)>=0&&(t-C)*(p-O)-(u-C)*(i-O)>=0&&(u-C)*(x-O)-(v-C)*(p-O)>=0}function mc(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!function(u,p){var v=u;do{if(v.i!==u.i&&v.next.i!==u.i&&v.i!==p.i&&v.next.i!==p.i&&pd(v,v.next,u,p))return!0;v=v.next}while(v!==u);return!1}(t,i)&&(md(t,i)&&md(i,t)&&function(u,p){var v=u,x=!1,C=(u.x+p.x)/2,O=(u.y+p.y)/2;do{v.y>O!=v.next.y>O&&v.next.y!==v.y&&C<(v.next.x-v.x)*(O-v.y)/(v.next.y-v.y)+v.x&&(x=!x),v=v.next}while(v!==u);return x}(t,i)&&($i(t.prev,t,i.prev)||$i(t,i.prev,i))||Go(t,i)&&$i(t.prev,t,t.next)>0&&$i(i.prev,i,i.next)>0)}function $i(t,i,u){return(i.y-t.y)*(u.x-i.x)-(i.x-t.x)*(u.y-i.y)}function Go(t,i){return t.x===i.x&&t.y===i.y}function pd(t,i,u,p){var v=gu($i(t,i,u)),x=gu($i(t,i,p)),C=gu($i(u,p,t)),O=gu($i(u,p,i));return v!==x&&C!==O||!(0!==v||!nf(t,u,i))||!(0!==x||!nf(t,p,i))||!(0!==C||!nf(u,t,p))||!(0!==O||!nf(u,i,p))}function nf(t,i,u){return i.x<=Math.max(t.x,u.x)&&i.x>=Math.min(t.x,u.x)&&i.y<=Math.max(t.y,u.y)&&i.y>=Math.min(t.y,u.y)}function gu(t){return t>0?1:t<0?-1:0}function md(t,i){return $i(t.prev,t,t.next)<0?$i(t,i,t.next)>=0&&$i(t,t.prev,i)>=0:$i(t,i,t.prev)<0||$i(t,t.next,i)<0}function hh(t,i){var u=new Zf(t.i,t.x,t.y),p=new Zf(i.i,i.x,i.y),v=t.next,x=i.prev;return t.next=i,i.prev=t,u.next=v,v.prev=u,p.next=u,u.prev=p,x.next=p,p.prev=x,p}function gd(t,i,u,p){var v=new Zf(t,i,u);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function gc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Zf(t,i,u){this.i=t,this.x=i,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Oo(t,i,u,p){for(var v=0,x=i,C=u-p;x<u;x+=p)v+=(t[C]-t[x])*(t[x+1]+t[C+1]),C=x;return v}function yd(t,i,u,p,v){!function x(C,O,K,ie,pe){for(;ie>K;){if(ie-K>600){var Ee=ie-K+1,Be=O-K+1,Ye=Math.log(Ee),yt=.5*Math.exp(2*Ye/3),Et=.5*Math.sqrt(Ye*yt*(Ee-yt)/Ee)*(Be-Ee/2<0?-1:1);x(C,O,Math.max(K,Math.floor(O-Be*yt/Ee+Et)),Math.min(ie,Math.floor(O+(Ee-Be)*yt/Ee+Et)),pe)}var Vt=C[O],At=K,Wt=ie;for(yc(C,K,O),pe(C[ie],Vt)>0&&yc(C,K,ie);At<Wt;){for(yc(C,At,Wt),At++,Wt--;pe(C[At],Vt)<0;)At++;for(;pe(C[Wt],Vt)>0;)Wt--}0===pe(C[K],Vt)?yc(C,K,Wt):yc(C,++Wt,ie),Wt<=O&&(K=Wt+1),O<=Wt&&(ie=Wt-1)}}(t,i,u||0,p||t.length-1,v||Uh)}function yc(t,i,u){var p=t[i];t[i]=t[u],t[u]=p}function Uh(t,i){return t<i?-1:t>i?1:0}function Zl(t,i){var u=t.length;if(u<=1)return[t];for(var p,v,x=[],C=0;C<u;C++){var O=ee(t[C]);0!==O&&(t[C].area=Math.abs(O),void 0===v&&(v=O<0),v===O<0?(p&&x.push(p),p=[t[C]]):p.push(t[C]))}if(p&&x.push(p),i>1)for(var K=0;K<x.length;K++)x[K].length<=i||(yd(x[K],i,1,x[K].length-1,dh),x[K]=x[K].slice(0,i));return x}function dh(t,i){return i.area-t.area}function zh(t,i,u){for(var p=u.patternDependencies,v=!1,x=0,C=i;x<C.length;x+=1){var O=C[x].paint.get(t+"-pattern");O.isConstant()||(v=!0);var K=O.constantOr(null);K&&(v=!0,p[K.to]=!0,p[K.from]=!0)}return v}function zc(t,i,u,p,v){for(var x=v.patternDependencies,C=0,O=i;C<O.length;C+=1){var K=O[C],ie=K.paint.get(t+"-pattern").value;if("constant"!==ie.kind){var pe=ie.evaluate({zoom:p-1},u,{},v.availableImages),Ee=ie.evaluate({zoom:p},u,{},v.availableImages),Be=ie.evaluate({zoom:p+1},u,{},v.availableImages);Ee=Ee&&Ee.name?Ee.name:Ee,Be=Be&&Be.name?Be.name:Be,x[pe=pe&&pe.name?pe.name:pe]=!0,x[Ee]=!0,x[Be]=!0,u.patterns[K.id]={min:pe,mid:Ee,max:Be}}}return u}Fc.deviation=function(t,i,u,p){var v=i&&i.length,x=Math.abs(Oo(t,0,v?i[0]*u:t.length,u));if(v)for(var C=0,O=i.length;C<O;C++)x-=Math.abs(Oo(t,i[C]*u,C<O-1?i[C+1]*u:t.length,u));var K=0;for(C=0;C<p.length;C+=3){var ie=p[C]*u,pe=p[C+1]*u,Ee=p[C+2]*u;K+=Math.abs((t[ie]-t[Ee])*(t[pe+1]-t[ie+1])-(t[ie]-t[pe])*(t[Ee+1]-t[ie+1]))}return 0===x&&0===K?0:Math.abs((K-x)/x)},Fc.flatten=function(t){for(var i=t[0][0].length,u={vertices:[],holes:[],dimensions:i},p=0,v=0;v<t.length;v++){for(var x=0;x<t[v].length;x++)for(var C=0;C<i;C++)u.vertices.push(t[v][x][C]);v>0&&u.holes.push(p+=t[v-1].length)}return u},Fh.default=Gf;var yu=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Jr,this.indexArray=new xl,this.indexArray2=new Wl,this.programConfigurations=new hr(t.layers,t.zoom),this.segments=new Xe,this.segments2=new Xe,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};yu.prototype.populate=function(t,i,u){this.hasPattern=zh("fill",this.layers,i);for(var p=this.layers[0].layout.get("fill-sort-key"),v=[],x=0,C=t;x<C.length;x+=1){var O=C[x],K=O.feature,ie=O.id,pe=O.index,Ee=O.sourceLayerIndex,Be=this.layers[0]._featureFilter.needGeometry,Ye=Qi(K,Be);if(this.layers[0]._featureFilter.filter(new V(this.zoom),Ye,u)){var yt=p?p.evaluate(Ye,{},u,i.availableImages):void 0,Et={id:ie,properties:K.properties,type:K.type,sourceLayerIndex:Ee,index:pe,geometry:Be?Ye.geometry:Ei(K),patterns:{},sortKey:yt};v.push(Et)}}p&&v.sort(function(qn,ir){return qn.sortKey-ir.sortKey});for(var Vt=0,At=v;Vt<At.length;Vt+=1){var Wt=At[Vt],rn=Wt.geometry,fn=Wt.index,cn=Wt.sourceLayerIndex;if(this.hasPattern){var Tn=zc("fill",this.layers,Wt,this.zoom,i);this.patternFeatures.push(Tn)}else this.addFeature(Wt,rn,fn,u,{});i.featureIndex.insert(t[fn].feature,rn,fn,cn,this.index)}},yu.prototype.update=function(t,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,u)},yu.prototype.addFeatures=function(t,i,u){for(var p=0,v=this.patternFeatures;p<v.length;p+=1){var x=v[p];this.addFeature(x,x.geometry,x.index,i,u)}},yu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},yu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},yu.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,pc),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},yu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},yu.prototype.addFeature=function(t,i,u,p,v){for(var x=0,C=Zl(i,500);x<C.length;x+=1){for(var O=C[x],K=0,ie=0,pe=O;ie<pe.length;ie+=1)K+=pe[ie].length;for(var Ee=this.segments.prepareSegment(K,this.layoutVertexArray,this.indexArray),Be=Ee.vertexLength,Ye=[],yt=[],Et=0,Vt=O;Et<Vt.length;Et+=1){var At=Vt[Et];if(0!==At.length){At!==O[0]&&yt.push(Ye.length/2);var Wt=this.segments2.prepareSegment(At.length,this.layoutVertexArray,this.indexArray2),rn=Wt.vertexLength;this.layoutVertexArray.emplaceBack(At[0].x,At[0].y),this.indexArray2.emplaceBack(rn+At.length-1,rn),Ye.push(At[0].x),Ye.push(At[0].y);for(var fn=1;fn<At.length;fn++)this.layoutVertexArray.emplaceBack(At[fn].x,At[fn].y),this.indexArray2.emplaceBack(rn+fn-1,rn+fn),Ye.push(At[fn].x),Ye.push(At[fn].y);Wt.vertexLength+=At.length,Wt.primitiveLength+=At.length}}for(var cn=Fh(Ye,yt),Tn=0;Tn<cn.length;Tn+=3)this.indexArray.emplaceBack(Be+cn[Tn],Be+cn[Tn+1],Be+cn[Tn+2]);Ee.vertexLength+=K,Ee.primitiveLength+=cn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,v,p)},tr("FillBucket",yu,{omit:["layers","patternFeatures"]});var rf=new Ro({"fill-sort-key":new Fn(Je.layout_fill["fill-sort-key"])}),Kf={paint:new Ro({"fill-antialias":new wn(Je.paint_fill["fill-antialias"]),"fill-opacity":new Fn(Je.paint_fill["fill-opacity"]),"fill-color":new Fn(Je.paint_fill["fill-color"]),"fill-outline-color":new Fn(Je.paint_fill["fill-outline-color"]),"fill-translate":new wn(Je.paint_fill["fill-translate"]),"fill-translate-anchor":new wn(Je.paint_fill["fill-translate-anchor"]),"fill-pattern":new Pr(Je.paint_fill["fill-pattern"])}),layout:rf},Vs=function(t){function i(u){t.call(this,u,Kf)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.recalculate=function(u,p){t.prototype.recalculate.call(this,u,p);var v=this.paint._values["fill-outline-color"];"constant"===v.value.kind&&void 0===v.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},i.prototype.createBucket=function(u){return new yu(u)},i.prototype.queryRadius=function(){return ys(this.paint.get("fill-translate"))},i.prototype.queryIntersectsFeature=function(u,p,v,x,C,O,K){return za(Tl(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),O.angle,K),x)},i.prototype.isTileClipped=function(){return!0},i}(Co),of=Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Yf=_c;function _c(t,i,u,p,v){this.properties={},this.extent=u,this.type=0,this._pbf=t,this._geometry=-1,this._keys=p,this._values=v,t.readFields(fh,this,i)}function fh(t,i,u){1==t?i.id=u.readVarint():2==t?function(p,v){for(var x=p.readVarint()+p.pos;p.pos<x;){var C=v._keys[p.readVarint()],O=v._values[p.readVarint()];v.properties[C]=O}}(u,i):3==t?i.type=u.readVarint():4==t&&(i._geometry=u.pos)}function Jf(t){for(var i,u,p=0,v=0,x=t.length,C=x-1;v<x;C=v++)p+=((u=t[C]).x-(i=t[v]).x)*(i.y+u.y);return p}_c.types=["Unknown","Point","LineString","Polygon"],_c.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var i,u=t.readVarint()+t.pos,p=1,v=0,x=0,C=0,O=[];t.pos<u;){if(v<=0){var K=t.readVarint();p=7&K,v=K>>3}if(v--,1===p||2===p)x+=t.readSVarint(),C+=t.readSVarint(),1===p&&(i&&O.push(i),i=[]),i.push(new Re(x,C));else{if(7!==p)throw new Error("unknown command "+p);i&&i.push(i[0].clone())}}return i&&O.push(i),O},_c.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var i=t.readVarint()+t.pos,u=1,p=0,v=0,x=0,C=1/0,O=-1/0,K=1/0,ie=-1/0;t.pos<i;){if(p<=0){var pe=t.readVarint();u=7&pe,p=pe>>3}if(p--,1===u||2===u)(v+=t.readSVarint())<C&&(C=v),v>O&&(O=v),(x+=t.readSVarint())<K&&(K=x),x>ie&&(ie=x);else if(7!==u)throw new Error("unknown command "+u)}return[C,K,O,ie]},_c.prototype.toGeoJSON=function(t,i,u){var p,v,x=this.extent*Math.pow(2,u),C=this.extent*t,O=this.extent*i,K=this.loadGeometry(),ie=_c.types[this.type];function pe(Ye){for(var yt=0;yt<Ye.length;yt++){var Et=Ye[yt];Ye[yt]=[360*(Et.x+C)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(Et.y+O)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var Ee=[];for(p=0;p<K.length;p++)Ee[p]=K[p][0];pe(K=Ee);break;case 2:for(p=0;p<K.length;p++)pe(K[p]);break;case 3:for(K=function(Ye){var yt=Ye.length;if(yt<=1)return[Ye];for(var Et,Vt,At=[],Wt=0;Wt<yt;Wt++){var rn=Jf(Ye[Wt]);0!==rn&&(void 0===Vt&&(Vt=rn<0),Vt===rn<0?(Et&&At.push(Et),Et=[Ye[Wt]]):Et.push(Ye[Wt]))}return Et&&At.push(Et),At}(K),p=0;p<K.length;p++)for(v=0;v<K[p].length;v++)pe(K[p][v])}1===K.length?K=K[0]:ie="Multi"+ie;var Be={type:"Feature",geometry:{type:ie,coordinates:K},properties:this.properties};return"id"in this&&(Be.id=this.id),Be};var Vh=Da;function Da(t,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(_d,this,i),this.length=this._features.length}function _d(t,i,u){15===t?i.version=u.readVarint():1===t?i.name=u.readString():5===t?i.extent=u.readVarint():2===t?i._features.push(u.pos):3===t?i._keys.push(u.readString()):4===t&&i._values.push(function(p){for(var v=null,x=p.readVarint()+p.pos;p.pos<x;){var C=p.readVarint()>>3;v=1===C?p.readString():2===C?p.readFloat():3===C?p.readDouble():4===C?p.readVarint64():5===C?p.readVarint():6===C?p.readSVarint():7===C?p.readBoolean():null}return v}(u))}function Xf(t,i,u){if(3===t){var p=new Vh(u,u.readVarint()+u.pos);p.length&&(i[p.name]=p)}}Da.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var i=this._pbf.readVarint()+this._pbf.pos;return new Yf(this._pbf,i,this.extent,this._keys,this._values)};var Kl={VectorTile:function(t,i){this.layers=t.readFields(Xf,{},i)},VectorTileFeature:Yf,VectorTileLayer:Vh},Yl=Kl.VectorTileFeature.types,Jl=Math.pow(2,13);function Xs(t,i,u,p,v,x,C,O){t.emplaceBack(i,u,2*Math.floor(p*Jl)+C,v*Jl*2,x*Jl*2,Math.round(O))}var Aa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Pu,this.indexArray=new xl,this.programConfigurations=new hr(t.layers,t.zoom),this.segments=new Xe,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};function jh(t,i){return t.x===i.x&&(t.x<0||t.x>8192)||t.y===i.y&&(t.y<0||t.y>8192)}Aa.prototype.populate=function(t,i,u){this.features=[],this.hasPattern=zh("fill-extrusion",this.layers,i);for(var p=0,v=t;p<v.length;p+=1){var x=v[p],C=x.feature,O=x.id,K=x.index,ie=x.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,Ee=Qi(C,pe);if(this.layers[0]._featureFilter.filter(new V(this.zoom),Ee,u)){var Be={id:O,sourceLayerIndex:ie,index:K,geometry:pe?Ee.geometry:Ei(C),properties:C.properties,type:C.type,patterns:{}};this.hasPattern?this.features.push(zc("fill-extrusion",this.layers,Be,this.zoom,i)):this.addFeature(Be,Be.geometry,K,u,{}),i.featureIndex.insert(C,Be.geometry,K,ie,this.index,!0)}}},Aa.prototype.addFeatures=function(t,i,u){for(var p=0,v=this.features;p<v.length;p+=1){var x=v[p];this.addFeature(x,x.geometry,x.index,i,u)}},Aa.prototype.update=function(t,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,u)},Aa.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Aa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Aa.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,of),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Aa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Aa.prototype.addFeature=function(t,i,u,p,v){for(var x=0,C=Zl(i,500);x<C.length;x+=1){for(var O=C[x],K=0,ie=0,pe=O;ie<pe.length;ie+=1)K+=pe[ie].length;for(var Ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Be=0,Ye=O;Be<Ye.length;Be+=1){var yt=Ye[Be];if(0!==yt.length&&!((ti=yt).every(function(Kr){return Kr.x<0})||ti.every(function(Kr){return Kr.x>8192})||ti.every(function(Kr){return Kr.y<0})||ti.every(function(Kr){return Kr.y>8192})))for(var Et=0,Vt=0;Vt<yt.length;Vt++){var At=yt[Vt];if(Vt>=1){var Wt=yt[Vt-1];if(!jh(At,Wt)){Ee.vertexLength+4>Xe.MAX_VERTEX_ARRAY_LENGTH&&(Ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var rn=At.sub(Wt)._perp()._unit(),fn=Wt.dist(At);Et+fn>32768&&(Et=0),Xs(this.layoutVertexArray,At.x,At.y,rn.x,rn.y,0,0,Et),Xs(this.layoutVertexArray,At.x,At.y,rn.x,rn.y,0,1,Et),Xs(this.layoutVertexArray,Wt.x,Wt.y,rn.x,rn.y,0,0,Et+=fn),Xs(this.layoutVertexArray,Wt.x,Wt.y,rn.x,rn.y,0,1,Et);var cn=Ee.vertexLength;this.indexArray.emplaceBack(cn,cn+2,cn+1),this.indexArray.emplaceBack(cn+1,cn+2,cn+3),Ee.vertexLength+=4,Ee.primitiveLength+=2}}}}if(Ee.vertexLength+K>Xe.MAX_VERTEX_ARRAY_LENGTH&&(Ee=this.segments.prepareSegment(K,this.layoutVertexArray,this.indexArray)),"Polygon"===Yl[t.type]){for(var Tn=[],qn=[],ir=Ee.vertexLength,kr=0,pr=O;kr<pr.length;kr+=1){var Ur=pr[kr];if(0!==Ur.length){Ur!==O[0]&&qn.push(Tn.length/2);for(var mr=0;mr<Ur.length;mr++){var ri=Ur[mr];Xs(this.layoutVertexArray,ri.x,ri.y,0,0,1,1,0),Tn.push(ri.x),Tn.push(ri.y)}}}for(var Nr=Fh(Tn,qn),xr=0;xr<Nr.length;xr+=3)this.indexArray.emplaceBack(ir+Nr[xr],ir+Nr[xr+2],ir+Nr[xr+1]);Ee.primitiveLength+=Nr.length/3,Ee.vertexLength+=K}}var ti;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,v,p)},tr("FillExtrusionBucket",Aa,{omit:["layers","features"]});var vd={paint:new Ro({"fill-extrusion-opacity":new wn(Je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Fn(Je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wn(Je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wn(Je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Pr(Je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Fn(Je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Fn(Je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wn(Je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},eu=function(t){function i(u){t.call(this,u,vd)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.createBucket=function(u){return new Aa(u)},i.prototype.queryRadius=function(){return ys(this.paint.get("fill-extrusion-translate"))},i.prototype.is3D=function(){return!0},i.prototype.queryIntersectsFeature=function(u,p,v,x,C,O,K,ie){var pe=Tl(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),O.angle,K),Ee=this.paint.get("fill-extrusion-height").evaluate(p,v),Be=this.paint.get("fill-extrusion-base").evaluate(p,v),Ye=function(Et,Vt,At,Wt){for(var rn=[],fn=0,cn=Et;fn<cn.length;fn+=1){var Tn=cn[fn],qn=[Tn.x,Tn.y,0,1];Ku(qn,qn,Vt),rn.push(new Re(qn[0]/qn[3],qn[1]/qn[3]))}return rn}(pe,ie),yt=function(Et,Vt,At,Wt){for(var rn=[],fn=[],cn=Wt[8]*Vt,Tn=Wt[9]*Vt,qn=Wt[10]*Vt,ir=Wt[11]*Vt,kr=Wt[8]*At,pr=Wt[9]*At,Ur=Wt[10]*At,mr=Wt[11]*At,ri=0,Nr=Et;ri<Nr.length;ri+=1){for(var xr=[],ti=[],Kr=0,yi=Nr[ri];Kr<yi.length;Kr+=1){var Or=yi[Kr],Gi=Or.x,zo=Or.y,Wo=Wt[0]*Gi+Wt[4]*zo+Wt[12],Vo=Wt[1]*Gi+Wt[5]*zo+Wt[13],co=Wt[2]*Gi+Wt[6]*zo+Wt[14],Zo=Wt[3]*Gi+Wt[7]*zo+Wt[15],ha=co+qn,ks=Zo+ir,Ou=Wo+kr,js=Vo+pr,iu=co+Ur,_s=Zo+mr,Os=new Re((Wo+cn)/ks,(Vo+Tn)/ks);Os.z=ha/ks,xr.push(Os);var Ti=new Re(Ou/_s,js/_s);Ti.z=iu/_s,ti.push(Ti)}rn.push(xr),fn.push(ti)}return[rn,fn]}(x,Be,Ee,ie);return function(Et,Vt,At){var Wt=1/0;za(At,Vt)&&(Wt=_u(At,Vt[0]));for(var rn=0;rn<Vt.length;rn++)for(var fn=Vt[rn],cn=Et[rn],Tn=0;Tn<fn.length-1;Tn++){var qn=fn[Tn],ir=[qn,fn[Tn+1],cn[Tn+1],cn[Tn],qn];Xa(At,ir)&&(Wt=Math.min(Wt,_u(At,ir)))}return Wt!==1/0&&Wt}(yt[0],yt[1],Ye)},i}(Co);function Dl(t,i){return t.x*i.x+t.y*i.y}function _u(t,i){if(1===t.length){for(var u,p=0,v=i[p++];!u||v.equals(u);)if(!(u=i[p++]))return 1/0;for(;p<i.length;p++){var x=i[p],C=t[0],O=u.sub(v),K=x.sub(v),ie=C.sub(v),pe=Dl(O,O),Ee=Dl(O,K),Be=Dl(K,K),Ye=Dl(ie,O),yt=Dl(ie,K),Et=pe*Be-Ee*Ee,Vt=(Be*Ye-Ee*yt)/Et,At=(pe*yt-Ee*Ye)/Et,Wt=v.z*(1-Vt-At)+u.z*Vt+x.z*At;if(isFinite(Wt))return Wt}return 1/0}for(var rn=1/0,fn=0,cn=i;fn<cn.length;fn+=1)rn=Math.min(rn,cn[fn].z);return rn}var vc=Xi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,sf=Xi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Qf=Kl.VectorTileFeature.types,bd=Math.cos(Math.PI/180*37.5),ph=Math.pow(2,14)/.5,ja=function(t){var i=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){i.gradients[u.id]={}}),this.layoutVertexArray=new ji,this.layoutVertexArray2=new ei,this.indexArray=new xl,this.programConfigurations=new hr(t.layers,t.zoom),this.segments=new Xe,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};ja.prototype.populate=function(t,i,u){this.hasPattern=zh("line",this.layers,i);for(var p=this.layers[0].layout.get("line-sort-key"),v=[],x=0,C=t;x<C.length;x+=1){var O=C[x],K=O.feature,ie=O.id,pe=O.index,Ee=O.sourceLayerIndex,Be=this.layers[0]._featureFilter.needGeometry,Ye=Qi(K,Be);if(this.layers[0]._featureFilter.filter(new V(this.zoom),Ye,u)){var yt=p?p.evaluate(Ye,{},u):void 0,Et={id:ie,properties:K.properties,type:K.type,sourceLayerIndex:Ee,index:pe,geometry:Be?Ye.geometry:Ei(K),patterns:{},sortKey:yt};v.push(Et)}}p&&v.sort(function(qn,ir){return qn.sortKey-ir.sortKey});for(var Vt=0,At=v;Vt<At.length;Vt+=1){var Wt=At[Vt],rn=Wt.geometry,fn=Wt.index,cn=Wt.sourceLayerIndex;if(this.hasPattern){var Tn=zc("line",this.layers,Wt,this.zoom,i);this.patternFeatures.push(Tn)}else this.addFeature(Wt,rn,fn,u,{});i.featureIndex.insert(t[fn].feature,rn,fn,cn,this.index)}},ja.prototype.update=function(t,i,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,u)},ja.prototype.addFeatures=function(t,i,u){for(var p=0,v=this.patternFeatures;p<v.length;p+=1){var x=v[p];this.addFeature(x,x.geometry,x.index,i,u)}},ja.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ja.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ja.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,sf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ja.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ja.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},ja.prototype.addFeature=function(t,i,u,p,v){var x=this.layers[0].layout,C=x.get("line-join").evaluate(t,{}),O=x.get("line-cap"),K=x.get("line-miter-limit"),ie=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var pe=0,Ee=i;pe<Ee.length;pe+=1)this.addLine(Ee[pe],t,C,O,K,ie);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,v,p)},ja.prototype.addLine=function(t,i,u,p,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var C=0;C<t.length-1;C++)this.totalDistance+=t[C].dist(t[C+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var O="Polygon"===Qf[i.type],K=t.length;K>=2&&t[K-1].equals(t[K-2]);)K--;for(var ie=0;ie<K-1&&t[ie].equals(t[ie+1]);)ie++;if(!(K<(O?3:2))){"bevel"===u&&(v=1.05);var pe,Ee=this.overscaling<=16?122880/(512*this.overscaling):0,Be=this.segments.prepareSegment(10*K,this.layoutVertexArray,this.indexArray),Ye=void 0,yt=void 0,Et=void 0,Vt=void 0;this.e1=this.e2=-1,O&&(Vt=t[ie].sub(pe=t[K-2])._unit()._perp());for(var At=ie;At<K;At++)if(!(yt=At===K-1?O?t[ie+1]:void 0:t[At+1])||!t[At].equals(yt)){Vt&&(Et=Vt),pe&&(Ye=pe),pe=t[At],Vt=yt?yt.sub(pe)._unit()._perp():Et;var Wt=(Et=Et||Vt).add(Vt);0===Wt.x&&0===Wt.y||Wt._unit();var rn=Et.x*Vt.x+Et.y*Vt.y,fn=Wt.x*Vt.x+Wt.y*Vt.y,cn=0!==fn?1/fn:1/0,Tn=2*Math.sqrt(2-2*fn),qn=fn<bd&&Ye&&yt,ir=Et.x*Vt.y-Et.y*Vt.x>0;if(qn&&At>ie){var kr=pe.dist(Ye);if(kr>2*Ee){var pr=pe.sub(pe.sub(Ye)._mult(Ee/kr)._round());this.updateDistance(Ye,pr),this.addCurrentVertex(pr,Et,0,0,Be),Ye=pr}}var Ur=Ye&&yt,mr=Ur?u:O?"butt":p;if(Ur&&"round"===mr&&(cn<x?mr="miter":cn<=2&&(mr="fakeround")),"miter"===mr&&cn>v&&(mr="bevel"),"bevel"===mr&&(cn>2&&(mr="flipbevel"),cn<v&&(mr="miter")),Ye&&this.updateDistance(Ye,pe),"miter"===mr)Wt._mult(cn),this.addCurrentVertex(pe,Wt,0,0,Be);else if("flipbevel"===mr){if(cn>100)Wt=Vt.mult(-1);else{var ri=cn*Et.add(Vt).mag()/Et.sub(Vt).mag();Wt._perp()._mult(ri*(ir?-1:1))}this.addCurrentVertex(pe,Wt,0,0,Be),this.addCurrentVertex(pe,Wt.mult(-1),0,0,Be)}else if("bevel"===mr||"fakeround"===mr){var Nr=-Math.sqrt(cn*cn-1),xr=ir?Nr:0,ti=ir?0:Nr;if(Ye&&this.addCurrentVertex(pe,Et,xr,ti,Be),"fakeround"===mr)for(var Kr=Math.round(180*Tn/Math.PI/20),yi=1;yi<Kr;yi++){var Or=yi/Kr;if(.5!==Or){var Gi=Or-.5;Or+=Or*Gi*(Or-1)*((1.0904+rn*(rn*(3.55645-1.43519*rn)-3.2452))*Gi*Gi+(.848013+rn*(.215638*rn-1.06021)))}var zo=Vt.sub(Et)._mult(Or)._add(Et)._unit()._mult(ir?-1:1);this.addHalfVertex(pe,zo.x,zo.y,!1,ir,0,Be)}yt&&this.addCurrentVertex(pe,Vt,-xr,-ti,Be)}else if("butt"===mr)this.addCurrentVertex(pe,Wt,0,0,Be);else if("square"===mr){var Wo=Ye?1:-1;this.addCurrentVertex(pe,Wt,Wo,Wo,Be)}else"round"===mr&&(Ye&&(this.addCurrentVertex(pe,Et,0,0,Be),this.addCurrentVertex(pe,Et,1,1,Be,!0)),yt&&(this.addCurrentVertex(pe,Vt,-1,-1,Be,!0),this.addCurrentVertex(pe,Vt,0,0,Be)));if(qn&&At<K-1){var Vo=pe.dist(yt);if(Vo>2*Ee){var co=pe.add(yt.sub(pe)._mult(Ee/Vo)._round());this.updateDistance(pe,co),this.addCurrentVertex(co,Vt,0,0,Be),pe=co}}}}},ja.prototype.addCurrentVertex=function(t,i,u,p,v,x){void 0===x&&(x=!1);var C=i.y*p-i.x,O=-i.y-i.x*p;this.addHalfVertex(t,i.x+i.y*u,i.y-i.x*u,x,!1,u,v),this.addHalfVertex(t,C,O,x,!0,-p,v),this.distance>ph/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,i,u,p,v,x))},ja.prototype.addHalfVertex=function(t,i,u,p,v,x,C){var O=.5*(this.lineClips?this.scaledDistance*(ph-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(p?1:0),(t.y<<1)+(v?1:0),Math.round(63*i)+128,Math.round(63*u)+128,1+(0===x?0:x<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var K=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,K),C.primitiveLength++),v?this.e2=K:this.e1=K},ja.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ja.prototype.updateDistance=function(t,i){this.distance+=t.dist(i),this.updateScaledDistance()},tr("LineBucket",ja,{omit:["layers","patternFeatures"]});var af=new Ro({"line-cap":new wn(Je.layout_line["line-cap"]),"line-join":new Fn(Je.layout_line["line-join"]),"line-miter-limit":new wn(Je.layout_line["line-miter-limit"]),"line-round-limit":new wn(Je.layout_line["line-round-limit"]),"line-sort-key":new Fn(Je.layout_line["line-sort-key"])}),uf={paint:new Ro({"line-opacity":new Fn(Je.paint_line["line-opacity"]),"line-color":new Fn(Je.paint_line["line-color"]),"line-translate":new wn(Je.paint_line["line-translate"]),"line-translate-anchor":new wn(Je.paint_line["line-translate-anchor"]),"line-width":new Fn(Je.paint_line["line-width"]),"line-gap-width":new Fn(Je.paint_line["line-gap-width"]),"line-offset":new Fn(Je.paint_line["line-offset"]),"line-blur":new Fn(Je.paint_line["line-blur"]),"line-dasharray":new si(Je.paint_line["line-dasharray"]),"line-pattern":new Pr(Je.paint_line["line-pattern"]),"line-gradient":new xi(Je.paint_line["line-gradient"])}),layout:af},zl=new(function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.possiblyEvaluate=function(u,p){return p=new V(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),t.prototype.possiblyEvaluate.call(this,u,p)},i.prototype.evaluate=function(u,p,v,x){return p=bt({},p,{zoom:Math.floor(p.zoom)}),t.prototype.evaluate.call(this,u,p,v,x)},i}(Fn))(uf.paint.properties["line-width"].specification);zl.useIntegerZoom=!0;var Hh=function(t){function i(u){t.call(this,u,uf),this.gradientVersion=0}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype._handleSpecialPaintPropertyUpdate=function(u){"line-gradient"===u&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof po,this.gradientVersion=(this.gradientVersion+1)%se)},i.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},i.prototype.recalculate=function(u,p){t.prototype.recalculate.call(this,u,p),this.paint._values["line-floorwidth"]=zl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},i.prototype.createBucket=function(u){return new ja(u)},i.prototype.queryRadius=function(u){var p=u,v=ep(Zu("line-width",this,p),Zu("line-gap-width",this,p)),x=Zu("line-offset",this,p);return v/2+Math.abs(x)+ys(this.paint.get("line-translate"))},i.prototype.queryIntersectsFeature=function(u,p,v,x,C,O,K){var ie=Tl(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),O.angle,K),pe=K/2*ep(this.paint.get("line-width").evaluate(p,v),this.paint.get("line-gap-width").evaluate(p,v)),Ee=this.paint.get("line-offset").evaluate(p,v);return Ee&&(x=function(Be,Ye){for(var yt=[],Et=new Re(0,0),Vt=0;Vt<Be.length;Vt++){for(var At=Be[Vt],Wt=[],rn=0;rn<At.length;rn++){var fn=At[rn],cn=At[rn+1],Tn=0===rn?Et:fn.sub(At[rn-1])._unit()._perp(),qn=rn===At.length-1?Et:cn.sub(fn)._unit()._perp(),ir=Tn._add(qn)._unit();ir._mult(1/(ir.x*qn.x+ir.y*qn.y)),Wt.push(ir._mult(Ye)._add(fn))}yt.push(Wt)}return yt}(x,Ee*K)),function(Be,Ye,yt){for(var Et=0;Et<Ye.length;Et++){var Vt=Ye[Et];if(Be.length>=3)for(var At=0;At<Vt.length;At++)if(Wu(Be,Vt[At]))return!0;if(Ys(Be,Vt,yt))return!0}return!1}(ie,x,pe)},i.prototype.isTileClipped=function(){return!0},i}(Co);function ep(t,i){return i>0?i+2*t:t}var Yp=Xi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),bc=Xi([{name:"a_projected_pos",components:3,type:"Float32"}],4),Vc=(Xi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Xi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ku=(Xi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),jc=Xi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function lf(t,i,u){return t.sections.forEach(function(p){var v,C,O;p.text=(v=p.text,C=u,"uppercase"===(O=i.layout.get("text-transform").evaluate(C,{}))?v=v.toLocaleUpperCase():"lowercase"===O&&(v=v.toLocaleLowerCase()),Mi.applyArabicShaping&&(v=Mi.applyArabicShaping(v)),v)}),t}Xi([{name:"triangle",components:3,type:"Uint16"}]),Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xi([{type:"Float32",name:"offsetX"}]),Xi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var mh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},la=function(t,i,u,p,v){var x,C,O=8*v-p-1,K=(1<<O)-1,ie=K>>1,pe=-7,Ee=u?v-1:0,Be=u?-1:1,Ye=t[i+Ee];for(Ee+=Be,x=Ye&(1<<-pe)-1,Ye>>=-pe,pe+=O;pe>0;x=256*x+t[i+Ee],Ee+=Be,pe-=8);for(C=x&(1<<-pe)-1,x>>=-pe,pe+=p;pe>0;C=256*C+t[i+Ee],Ee+=Be,pe-=8);if(0===x)x=1-ie;else{if(x===K)return C?NaN:1/0*(Ye?-1:1);C+=Math.pow(2,p),x-=ie}return(Ye?-1:1)*C*Math.pow(2,x-p)},gh=function(t,i,u,p,v,x){var C,O,K,ie=8*x-v-1,pe=(1<<ie)-1,Ee=pe>>1,Be=23===v?Math.pow(2,-24)-Math.pow(2,-77):0,Ye=p?0:x-1,yt=p?1:-1,Et=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(O=isNaN(i)?1:0,C=pe):(C=Math.floor(Math.log(i)/Math.LN2),i*(K=Math.pow(2,-C))<1&&(C--,K*=2),(i+=C+Ee>=1?Be/K:Be*Math.pow(2,1-Ee))*K>=2&&(C++,K/=2),C+Ee>=pe?(O=0,C=pe):C+Ee>=1?(O=(i*K-1)*Math.pow(2,v),C+=Ee):(O=i*Math.pow(2,Ee-1)*Math.pow(2,v),C=0));v>=8;t[u+Ye]=255&O,Ye+=yt,O/=256,v-=8);for(C=C<<v|O,ie+=v;ie>0;t[u+Ye]=255&C,Ye+=yt,C/=256,ie-=8);t[u+Ye-yt]|=128*Et},yh=Bi;function Bi(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Bi.Varint=0,Bi.Fixed64=1,Bi.Bytes=2,Bi.Fixed32=5;var tp="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ps(t){return t.type===Bi.Bytes?t.readVarint()+t.pos:t.pos+1}function cs(t,i,u){var p=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));u.realloc(p);for(var v=u.pos-1;v>=t;v--)u.buf[v+p]=u.buf[v]}function tu(t,i){for(var u=0;u<t.length;u++)i.writeVarint(t[u])}function np(t,i){for(var u=0;u<t.length;u++)i.writeSVarint(t[u])}function A(t,i){for(var u=0;u<t.length;u++)i.writeFloat(t[u])}function b(t,i){for(var u=0;u<t.length;u++)i.writeDouble(t[u])}function I(t,i){for(var u=0;u<t.length;u++)i.writeBoolean(t[u])}function N(t,i){for(var u=0;u<t.length;u++)i.writeFixed32(t[u])}function we(t,i){for(var u=0;u<t.length;u++)i.writeSFixed32(t[u])}function lt(t,i){for(var u=0;u<t.length;u++)i.writeFixed64(t[u])}function Yt(t,i){for(var u=0;u<t.length;u++)i.writeSFixed64(t[u])}function In(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+16777216*t[i+3]}function ar(t,i,u){t[u]=i,t[u+1]=i>>>8,t[u+2]=i>>>16,t[u+3]=i>>>24}function Lr(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+(t[i+3]<<24)}function ai(t,i,u){1===t&&u.readMessage(Xr,i)}function Xr(t,i,u){if(3===t){var p=u.readMessage(Qs,{}),v=p.width,x=p.height,C=p.left,O=p.top,K=p.advance;i.push({id:p.id,bitmap:new Qa({width:v+6,height:x+6},p.bitmap),metrics:{width:v,height:x,left:C,top:O,advance:K}})}}function Qs(t,i,u){1===t?i.id=u.readVarint():2===t?i.bitmap=u.readBytes():3===t?i.width=u.readVarint():4===t?i.height=u.readVarint():5===t?i.left=u.readSVarint():6===t?i.top=u.readSVarint():7===t&&(i.advance=u.readVarint())}function Un(t){for(var i=0,u=0,p=0,v=t;p<v.length;p+=1){var x=v[p];i+=x.w*x.h,u=Math.max(u,x.w)}t.sort(function(Et,Vt){return Vt.h-Et.h});for(var C=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),u),h:1/0}],O=0,K=0,ie=0,pe=t;ie<pe.length;ie+=1)for(var Ee=pe[ie],Be=C.length-1;Be>=0;Be--){var Ye=C[Be];if(!(Ee.w>Ye.w||Ee.h>Ye.h)){if(Ee.x=Ye.x,Ee.y=Ye.y,K=Math.max(K,Ee.y+Ee.h),O=Math.max(O,Ee.x+Ee.w),Ee.w===Ye.w&&Ee.h===Ye.h){var yt=C.pop();Be<C.length&&(C[Be]=yt)}else Ee.h===Ye.h?(Ye.x+=Ee.w,Ye.w-=Ee.w):Ee.w===Ye.w?(Ye.y+=Ee.h,Ye.h-=Ee.h):(C.push({x:Ye.x+Ee.w,y:Ye.y,w:Ye.w-Ee.w,h:Ee.h}),Ye.y+=Ee.h,Ye.h-=Ee.h);break}}return{w:O,h:K,fill:i/(O*K)||0}}Bi.prototype={destroy:function(){this.buf=null},readFields:function(t,i,u){for(u=u||this.length;this.pos<u;){var p=this.readVarint(),v=p>>3,x=this.pos;this.type=7&p,t(v,i,this),this.pos===x&&this.skip(p)}return i},readMessage:function(t,i){return this.readFields(t,i,this.readVarint()+this.pos)},readFixed32:function(){var t=In(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Lr(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=In(this.buf,this.pos)+4294967296*In(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=In(this.buf,this.pos)+4294967296*Lr(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=la(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=la(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var i,u,p=this.buf;return i=127&(u=p[this.pos++]),u<128?i:(i|=(127&(u=p[this.pos++]))<<7,u<128?i:(i|=(127&(u=p[this.pos++]))<<14,u<128?i:(i|=(127&(u=p[this.pos++]))<<21,u<128?i:function(v,x,C){var O,K,ie=C.buf;if(O=(112&(K=ie[C.pos++]))>>4,K<128||(O|=(127&(K=ie[C.pos++]))<<3,K<128)||(O|=(127&(K=ie[C.pos++]))<<10,K<128)||(O|=(127&(K=ie[C.pos++]))<<17,K<128)||(O|=(127&(K=ie[C.pos++]))<<24,K<128)||(O|=(1&(K=ie[C.pos++]))<<31,K<128))return function sl(t,i,u){return u?4294967296*i+(t>>>0):4294967296*(i>>>0)+(t>>>0)}(v,O,x);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(u=p[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,i=this.pos;return this.pos=t,t-i>=12&&tp?tp.decode(this.buf.subarray(i,t)):function(u,p,v){for(var x="",C=p;C<v;){var O,K,ie,pe=u[C],Ee=null,Be=pe>239?4:pe>223?3:pe>191?2:1;if(C+Be>v)break;1===Be?pe<128&&(Ee=pe):2===Be?128==(192&(O=u[C+1]))&&(Ee=(31&pe)<<6|63&O)<=127&&(Ee=null):3===Be?(K=u[C+2],128==(192&(O=u[C+1]))&&128==(192&K)&&((Ee=(15&pe)<<12|(63&O)<<6|63&K)<=2047||Ee>=55296&&Ee<=57343)&&(Ee=null)):4===Be&&(K=u[C+2],ie=u[C+3],128==(192&(O=u[C+1]))&&128==(192&K)&&128==(192&ie)&&((Ee=(15&pe)<<18|(63&O)<<12|(63&K)<<6|63&ie)<=65535||Ee>=1114112)&&(Ee=null)),null===Ee?(Ee=65533,Be=1):Ee>65535&&(Ee-=65536,x+=String.fromCharCode(Ee>>>10&1023|55296),Ee=56320|1023&Ee),x+=String.fromCharCode(Ee),C+=Be}return x}(this.buf,i,t)},readBytes:function(){var t=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,t);return this.pos=t,i},readPackedVarint:function(t,i){if(this.type!==Bi.Bytes)return t.push(this.readVarint(i));var u=Ps(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(i));return t},readPackedSVarint:function(t){if(this.type!==Bi.Bytes)return t.push(this.readSVarint());var i=Ps(this);for(t=t||[];this.pos<i;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Bi.Bytes)return t.push(this.readBoolean());var i=Ps(this);for(t=t||[];this.pos<i;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Bi.Bytes)return t.push(this.readFloat());var i=Ps(this);for(t=t||[];this.pos<i;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Bi.Bytes)return t.push(this.readDouble());var i=Ps(this);for(t=t||[];this.pos<i;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Bi.Bytes)return t.push(this.readFixed32());var i=Ps(this);for(t=t||[];this.pos<i;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Bi.Bytes)return t.push(this.readSFixed32());var i=Ps(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Bi.Bytes)return t.push(this.readFixed64());var i=Ps(this);for(t=t||[];this.pos<i;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Bi.Bytes)return t.push(this.readSFixed64());var i=Ps(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed64());return t},skip:function(t){var i=7&t;if(i===Bi.Varint)for(;this.buf[this.pos++]>127;);else if(i===Bi.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Bi.Fixed32)this.pos+=4;else{if(i!==Bi.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(t,i){this.writeVarint(t<<3|i)},realloc:function(t){for(var i=this.length||16;i<this.pos+t;)i*=2;if(i!==this.length){var u=new Uint8Array(i);u.set(this.buf),this.buf=u,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),ar(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),ar(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),ar(this.buf,-1&t,this.pos),ar(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),ar(this.buf,-1&t,this.pos),ar(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(i,u){var p,v,x,O;if(i>=0?(p=i%4294967296|0,v=i/4294967296|0):(v=~(-i/4294967296),4294967295^(p=~(-i%4294967296))?p=p+1|0:(p=0,v=v+1|0)),i>=0x10000000000000000||i<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),x=p,(O=u).buf[O.pos++]=127&x|128,x>>>=7,O.buf[O.pos++]=127&x|128,x>>>=7,O.buf[O.pos++]=127&x|128,x>>>=7,O.buf[O.pos++]=127&x|128,O.buf[O.pos]=127&(x>>>=7),function(x,C){var O=(7&x)<<4;C.buf[C.pos++]|=O|((x>>>=3)?128:0),x&&(C.buf[C.pos++]=127&x|((x>>>=7)?128:0),x&&(C.buf[C.pos++]=127&x|((x>>>=7)?128:0),x&&(C.buf[C.pos++]=127&x|((x>>>=7)?128:0),x&&(C.buf[C.pos++]=127&x|((x>>>=7)?128:0),x&&(C.buf[C.pos++]=127&x)))))}(v,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var i=this.pos;this.pos=function(p,v,x){for(var C,O,K=0;K<v.length;K++){if((C=v.charCodeAt(K))>55295&&C<57344){if(!O){C>56319||K+1===v.length?(p[x++]=239,p[x++]=191,p[x++]=189):O=C;continue}if(C<56320){p[x++]=239,p[x++]=191,p[x++]=189,O=C;continue}C=O-55296<<10|C-56320|65536,O=null}else O&&(p[x++]=239,p[x++]=191,p[x++]=189,O=null);C<128?p[x++]=C:(C<2048?p[x++]=C>>6|192:(C<65536?p[x++]=C>>12|224:(p[x++]=C>>18|240,p[x++]=C>>12&63|128),p[x++]=C>>6&63|128),p[x++]=63&C|128)}return x}(this.buf,t,this.pos);var u=this.pos-i;u>=128&&cs(i,u,this),this.pos=i-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),gh(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),gh(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var i=t.length;this.writeVarint(i),this.realloc(i);for(var u=0;u<i;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,i){this.pos++;var u=this.pos;t(i,this);var p=this.pos-u;p>=128&&cs(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeMessage:function(t,i,u){this.writeTag(t,Bi.Bytes),this.writeRawMessage(i,u)},writePackedVarint:function(t,i){i.length&&this.writeMessage(t,tu,i)},writePackedSVarint:function(t,i){i.length&&this.writeMessage(t,np,i)},writePackedBoolean:function(t,i){i.length&&this.writeMessage(t,I,i)},writePackedFloat:function(t,i){i.length&&this.writeMessage(t,A,i)},writePackedDouble:function(t,i){i.length&&this.writeMessage(t,b,i)},writePackedFixed32:function(t,i){i.length&&this.writeMessage(t,N,i)},writePackedSFixed32:function(t,i){i.length&&this.writeMessage(t,we,i)},writePackedFixed64:function(t,i){i.length&&this.writeMessage(t,lt,i)},writePackedSFixed64:function(t,i){i.length&&this.writeMessage(t,Yt,i)},writeBytesField:function(t,i){this.writeTag(t,Bi.Bytes),this.writeBytes(i)},writeFixed32Field:function(t,i){this.writeTag(t,Bi.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(t,i){this.writeTag(t,Bi.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(t,i){this.writeTag(t,Bi.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(t,i){this.writeTag(t,Bi.Fixed64),this.writeSFixed64(i)},writeVarintField:function(t,i){this.writeTag(t,Bi.Varint),this.writeVarint(i)},writeSVarintField:function(t,i){this.writeTag(t,Bi.Varint),this.writeSVarint(i)},writeStringField:function(t,i){this.writeTag(t,Bi.Bytes),this.writeString(i)},writeFloatField:function(t,i){this.writeTag(t,Bi.Fixed32),this.writeFloat(i)},writeDoubleField:function(t,i){this.writeTag(t,Bi.Fixed64),this.writeDouble(i)},writeBooleanField:function(t,i){this.writeVarintField(t,Boolean(i))}};var Al=function(t,i){var u=i.pixelRatio,p=i.version,v=i.stretchX,x=i.stretchY,C=i.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=v,this.stretchY=x,this.content=C,this.version=p},nu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};nu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},nu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},nu.tlbr.get=function(){return this.tl.concat(this.br)},nu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Al.prototype,nu);var Xl=function(t,i){var u={},p={};this.haveRenderCallbacks=[];var v=[];this.addImages(t,u,v),this.addImages(i,p,v);var x=Un(v),C=new pu({width:x.w||1,height:x.h||1});for(var O in t){var K=t[O],ie=u[O].paddedRect;pu.copy(K.data,C,{x:0,y:0},{x:ie.x+1,y:ie.y+1},K.data)}for(var pe in i){var Ee=i[pe],Be=p[pe].paddedRect,Ye=Be.x+1,yt=Be.y+1,Et=Ee.data.width,Vt=Ee.data.height;pu.copy(Ee.data,C,{x:0,y:0},{x:Ye,y:yt},Ee.data),pu.copy(Ee.data,C,{x:0,y:Vt-1},{x:Ye,y:yt-1},{width:Et,height:1}),pu.copy(Ee.data,C,{x:0,y:0},{x:Ye,y:yt+Vt},{width:Et,height:1}),pu.copy(Ee.data,C,{x:Et-1,y:0},{x:Ye-1,y:yt},{width:1,height:Vt}),pu.copy(Ee.data,C,{x:0,y:0},{x:Ye+Et,y:yt},{width:1,height:Vt})}this.image=C,this.iconPositions=u,this.patternPositions=p};Xl.prototype.addImages=function(t,i,u){for(var p in t){var v=t[p],x={x:0,y:0,w:v.data.width+2,h:v.data.height+2};u.push(x),i[p]=new Al(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(p)}},Xl.prototype.patchUpdatedImages=function(t,i){for(var u in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),i),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),i)},Xl.prototype.patchUpdatedImage=function(t,i,u){if(t&&i&&t.version!==i.version){t.version=i.version;var p=t.tl;u.update(i.data,void 0,{x:p[0],y:p[1]})}},tr("ImagePosition",Al),tr("ImageAtlas",Xl);var ea={horizontal:1,vertical:2,horizontalOnly:3},Ju=function(){this.scale=1,this.fontStack="",this.imageName=null};Ju.forText=function(t,i){var u=new Ju;return u.scale=t||1,u.fontStack=i,u},Ju.forImage=function(t){var i=new Ju;return i.imageName=t,i};var Ma=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function vu(t,i,u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt,Et){var Vt,At=Ma.fromFeature(t,v);Ee===ea.vertical&&At.verticalizePunctuation();var Wt=Mi.processBidirectionalText,rn=Mi.processStyledBidirectionalText;if(Wt&&1===At.sections.length){Vt=[];for(var fn=0,cn=Wt(At.toString(),xc(At,ie,x,i,p,Ye,yt));fn<cn.length;fn+=1){var Tn=cn[fn],qn=new Ma;qn.text=Tn,qn.sections=At.sections;for(var ir=0;ir<Tn.length;ir++)qn.sectionIndex.push(0);Vt.push(qn)}}else if(rn){Vt=[];for(var kr=0,pr=rn(At.text,At.sectionIndex,xc(At,ie,x,i,p,Ye,yt));kr<pr.length;kr+=1){var Ur=pr[kr],mr=new Ma;mr.text=Ur[0],mr.sectionIndex=Ur[1],mr.sections=At.sections,Vt.push(mr)}}else Vt=function(xr,ti){for(var Kr=[],yi=xr.text,Or=0,Gi=0,zo=ti;Gi<zo.length;Gi+=1){var Wo=zo[Gi];Kr.push(xr.substring(Or,Wo)),Or=Wo}return Or<yi.length&&Kr.push(xr.substring(Or,yi.length)),Kr}(At,xc(At,ie,x,i,p,Ye,yt));var ri=[],Nr={positionedLines:ri,text:At.toString(),top:pe[1],bottom:pe[1],left:pe[0],right:pe[0],writingMode:Ee,iconsInText:!1,verticalizable:!1};return function(xr,ti,Kr,yi,Or,Gi,zo,Wo,Vo,co,Zo,ha){for(var ks=0,Ou=-17,js=0,iu=0,_s="right"===Wo?1:"left"===Wo?0:.5,Os=0,Ti=0,Do=Or;Ti<Do.length;Ti+=1){var ui=Do[Ti];ui.trim();var Ui=ui.getMaxScale(),Lu=24*(Ui-1),wu={positionedGlyphs:[],lineOffset:0};xr.positionedLines[Os]=wu;var Ko=wu.positionedGlyphs,Is=0;if(ui.length()){for(var xu=0;xu<ui.length();xu++){var Zi=ui.getSection(xu),Hl=ui.getSectionIndex(xu),Nu=ui.getCharCode(xu),Cc=0,vs=null,Dc=null,al=null,Ih=24,Ac=!(Vo===ea.horizontal||!Zo&&!cu(Nu)||Zo&&(wc[Nu]||(Kc=Nu,rr.Arabic(Kc)||rr["Arabic Supplement"](Kc)||rr["Arabic Extended-A"](Kc)||rr["Arabic Presentation Forms-A"](Kc)||rr["Arabic Presentation Forms-B"](Kc))));if(Zi.imageName){var ec=yi[Zi.imageName];if(!ec)continue;al=Zi.imageName,xr.iconsInText=xr.iconsInText||!0,Dc=ec.paddedRect;var Qu=ec.displaySize;Zi.scale=24*Zi.scale/ha,Cc=Lu+(24-Qu[1]*Zi.scale),Ih=(vs={width:Qu[0],height:Qu[1],left:1,top:-3,advance:Ac?Qu[1]:Qu[0]}).advance;var Zc=Ac?Qu[0]*Zi.scale-24*Ui:Qu[1]*Zi.scale-24*Ui;Zc>0&&Zc>Is&&(Is=Zc)}else{var Mc=Kr[Zi.fontStack],tc=Mc&&Mc[Nu];if(tc&&tc.rect)Dc=tc.rect,vs=tc.metrics;else{var ul=ti[Zi.fontStack],nc=ul&&ul[Nu];if(!nc)continue;vs=nc.metrics}Cc=24*(Ui-Zi.scale)}Ac?(xr.verticalizable=!0,Ko.push({glyph:Nu,imageName:al,x:ks,y:Ou+Cc,vertical:Ac,scale:Zi.scale,fontStack:Zi.fontStack,sectionIndex:Hl,metrics:vs,rect:Dc}),ks+=Ih*Zi.scale+co):(Ko.push({glyph:Nu,imageName:al,x:ks,y:Ou+Cc,vertical:Ac,scale:Zi.scale,fontStack:Zi.fontStack,sectionIndex:Hl,metrics:vs,rect:Dc}),ks+=vs.advance*Zi.scale+co)}0!==Ko.length&&(js=Math.max(ks-co,js),Jp(Ko,0,Ko.length-1,_s,Is)),ks=0;var mp=Gi*Ui+Is;wu.lineOffset=Math.max(Is,Lu),Ou+=mp,iu=Math.max(mp,iu),++Os}else Ou+=Gi,++Os}var Kc,kd=Ou- -17,Yc=rp(zo),Pc=Yc.horizontalAlign,Th=Yc.verticalAlign;(function(gp,Od,ed,td,nd,Sh,vf,Ch,rd){var Dh,bf=(Od-ed)*nd;Dh=Sh!==vf?-Ch*td- -17:(-td*rd+.5)*vf;for(var Ld=0,id=gp;Ld<id.length;Ld+=1)for(var Nd=0,wf=id[Ld].positionedGlyphs;Nd<wf.length;Nd+=1){var Jc=wf[Nd];Jc.x+=bf,Jc.y+=Dh}})(xr.positionedLines,_s,Pc,Th,js,iu,Gi,kd,Or.length),xr.top+=-Th*kd,xr.bottom=xr.top+kd,xr.left+=-Pc*js,xr.right=xr.left+js}(Nr,i,u,p,Vt,C,O,K,Ee,ie,Be,Et),!function(xr){for(var ti=0,Kr=xr;ti<Kr.length;ti+=1)if(0!==Kr[ti].positionedGlyphs.length)return!1;return!0}(ri)&&Nr}Ma.fromFeature=function(t,i){for(var u=new Ma,p=0;p<t.sections.length;p++){var v=t.sections[p];v.image?u.addImageSection(v):u.addTextSection(v,i)}return u},Ma.prototype.length=function(){return this.text.length},Ma.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Ma.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},Ma.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Ma.prototype.verticalizePunctuation=function(){this.text=function(t){for(var i="",u=0;u<t.length;u++){var p=t.charCodeAt(u+1)||null,v=t.charCodeAt(u-1)||null;i+=p&&Ol(p)&&!mh[t[u+1]]||v&&Ol(v)&&!mh[t[u-1]]||!mh[t[u]]?t[u]:mh[t[u]]}return i}(this.text)},Ma.prototype.trim=function(){for(var t=0,i=0;i<this.text.length&&wc[this.text.charCodeAt(i)];i++)t++;for(var u=this.text.length,p=this.text.length-1;p>=0&&p>=t&&wc[this.text.charCodeAt(p)];p--)u--;this.text=this.text.substring(t,u),this.sectionIndex=this.sectionIndex.slice(t,u)},Ma.prototype.substring=function(t,i){var u=new Ma;return u.text=this.text.substring(t,i),u.sectionIndex=this.sectionIndex.slice(t,i),u.sections=this.sections,u},Ma.prototype.toString=function(){return this.text},Ma.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(i,u){return Math.max(i,t.sections[u].scale)},0)},Ma.prototype.addTextSection=function(t,i){this.text+=t.text,this.sections.push(Ju.forText(t.scale,t.fontStack||i));for(var u=this.sections.length-1,p=0;p<t.text.length;++p)this.sectionIndex.push(u)},Ma.prototype.addImageSection=function(t){var i=t.image?t.image.name:"";if(0!==i.length){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Ju.forImage(i)),this.sectionIndex.push(this.sections.length-1)):U("Reached maximum number of images 6401")}else U("Can't add FormattedSection with an empty image.")},Ma.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var wc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ca={};function wd(t,i,u,p,v,x){if(i.imageName){var C=p[i.imageName];return C?C.displaySize[0]*i.scale*24/x+v:0}var O=u[i.fontStack],K=O&&O[t];return K?K.metrics.advance*i.scale+v:0}function ru(t,i,u,p){var v=Math.pow(t-i,2);return p?t<i?v/2:2*v:v+Math.abs(u)*u}function $h(t,i,u){var p=0;return 10===t&&(p-=1e4),u&&(p+=150),40!==t&&65288!==t||(p+=50),41!==i&&65289!==i||(p+=50),p}function xd(t,i,u,p,v,x){for(var C=null,O=ru(i,u,v,x),K=0,ie=p;K<ie.length;K+=1){var pe=ie[K],Ee=ru(i-pe.x,u,v,x)+pe.badness;Ee<=O&&(C=pe,O=Ee)}return{index:t,x:i,priorBreak:C,badness:O}}function xc(t,i,u,p,v,x,C){if("point"!==x)return[];if(!t)return[];for(var O,K=[],ie=function(Vt,At,Wt,rn,fn,cn){for(var Tn=0,qn=0;qn<Vt.length();qn++){var ir=Vt.getSection(qn);Tn+=wd(Vt.getCharCode(qn),ir,rn,fn,At,cn)}return Tn/Math.max(1,Math.ceil(Tn/Wt))}(t,i,u,p,v,C),pe=t.text.indexOf("\u200b")>=0,Ee=0,Be=0;Be<t.length();Be++){var Ye=t.getSection(Be),yt=t.getCharCode(Be);if(wc[yt]||(Ee+=wd(yt,Ye,p,v,i,C)),Be<t.length()-1){var Et=!((O=yt)<11904||!(rr["Bopomofo Extended"](O)||rr.Bopomofo(O)||rr["CJK Compatibility Forms"](O)||rr["CJK Compatibility Ideographs"](O)||rr["CJK Compatibility"](O)||rr["CJK Radicals Supplement"](O)||rr["CJK Strokes"](O)||rr["CJK Symbols and Punctuation"](O)||rr["CJK Unified Ideographs Extension A"](O)||rr["CJK Unified Ideographs"](O)||rr["Enclosed CJK Letters and Months"](O)||rr["Halfwidth and Fullwidth Forms"](O)||rr.Hiragana(O)||rr["Ideographic Description Characters"](O)||rr["Kangxi Radicals"](O)||rr["Katakana Phonetic Extensions"](O)||rr.Katakana(O)||rr["Vertical Forms"](O)||rr["Yi Radicals"](O)||rr["Yi Syllables"](O)));(ca[yt]||Et||Ye.imageName)&&K.push(xd(Be+1,Ee,ie,K,$h(yt,t.getCharCode(Be+1),Et&&pe),!1))}}return function Vt(At){return At?Vt(At.priorBreak).concat(At.index):[]}(xd(t.length(),Ee,ie,K,0,!0))}function rp(t){var i=.5,u=.5;switch(t){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:i,verticalAlign:u}}function Jp(t,i,u,p,v){if(p||v)for(var x=t[u],C=(t[u].x+x.metrics.advance*x.scale)*p,O=i;O<=u;O++)t[O].x-=C,t[O].y+=v}function Xp(t,i,u,p,v,x){var C,O=t.image;if(O.content){var K=O.content,ie=O.pixelRatio||1;C=[K[0]/ie,K[1]/ie,O.displaySize[0]-K[2]/ie,O.displaySize[1]-K[3]/ie]}var pe,Ee,Be,Ye,yt=i.left*x,Et=i.right*x;"width"===u||"both"===u?(Ye=v[0]+yt-p[3],Ee=v[0]+Et+p[1]):Ee=(Ye=v[0]+(yt+Et-O.displaySize[0])/2)+O.displaySize[0];var Vt=i.top*x,At=i.bottom*x;return"height"===u||"both"===u?(pe=v[1]+Vt-p[0],Be=v[1]+At+p[2]):Be=(pe=v[1]+(Vt+At-O.displaySize[1])/2)+O.displaySize[1],{image:O,top:pe,right:Ee,bottom:Be,left:Ye,collisionPadding:C}}ca[10]=!0,ca[32]=!0,ca[38]=!0,ca[40]=!0,ca[41]=!0,ca[43]=!0,ca[45]=!0,ca[47]=!0,ca[173]=!0,ca[183]=!0,ca[8203]=!0,ca[8208]=!0,ca[8211]=!0,ca[8231]=!0;var Hc=function(t){function i(u,p,v,x){t.call(this,u,p),this.angle=v,void 0!==x&&(this.segment=x)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.clone=function(){return new i(this.x,this.y,this.angle,this.segment)},i}(Re);function Ed(t,i){var u=i.expression;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new V(t+1))};if("source"===u.kind)return{kind:"source"};for(var p=u.zoomStops,v=u.interpolationType,x=0;x<p.length&&p[x]<=t;)x++;for(var C=x=Math.max(0,x-1);C<p.length&&p[C]<t+1;)C++;C=Math.min(p.length-1,C);var O=p[x],K=p[C];return"composite"===u.kind?{kind:"composite",minZoom:O,maxZoom:K,interpolationType:v}:{kind:"camera",minZoom:O,maxZoom:K,minSize:u.evaluate(new V(O)),maxSize:u.evaluate(new V(K)),interpolationType:v}}function _h(t,i,u){var p=i.uSize,v=u.lowerSize;return"source"===t.kind?v/128:"composite"===t.kind?Ni(v/128,u.upperSize/128,i.uSizeT):p}function $c(t,i){var u=0,p=0;if("constant"===t.kind)p=t.layoutSize;else if("source"!==t.kind){var v=t.interpolationType,x=v?St(eo.interpolationFactor(v,i,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?p=Ni(t.minSize,t.maxSize,x):u=x}return{uSizeT:u,uSize:p}}tr("Anchor",Hc);var Id=Object.freeze({__proto__:null,getSizeData:Ed,evaluateSizeForFeature:_h,evaluateSizeForZoom:$c,SIZE_PACK_FACTOR:128});function Td(t,i,u,p,v){if(void 0===i.segment)return!0;for(var x=i,C=i.segment+1,O=0;O>-u/2;){if(--C<0)return!1;O-=t[C].dist(x),x=t[C]}O+=t[C].dist(t[C+1]),C++;for(var K=[],ie=0;O<u/2;){var pe=t[C],Ee=t[C+1];if(!Ee)return!1;var Be=t[C-1].angleTo(pe)-pe.angleTo(Ee);for(Be=Math.abs((Be+3*Math.PI)%(2*Math.PI)-Math.PI),K.push({distance:O,angleDelta:Be}),ie+=Be;O-K[0].distance>p;)ie-=K.shift().angleDelta;if(ie>v)return!1;C++,O+=pe.dist(Ee)}return!0}function ip(t){for(var i=0,u=0;u<t.length-1;u++)i+=t[u].dist(t[u+1]);return i}function cf(t,i,u){return t?.6*i*u:0}function vh(t,i){return Math.max(t?t.right-t.left:0,i?i.right-i.left:0)}function Qp(t,i,u,p,v,x){for(var C=cf(u,v,x),O=vh(u,p)*x,K=0,ie=ip(t)/2,pe=0;pe<t.length-1;pe++){var Ee=t[pe],Be=t[pe+1],Ye=Ee.dist(Be);if(K+Ye>ie){var yt=(ie-K)/Ye,Et=Ni(Ee.x,Be.x,yt),Vt=Ni(Ee.y,Be.y,yt),At=new Hc(Et,Vt,Be.angleTo(Ee),pe);return At._round(),!C||Td(t,At,O,C,i)?At:void 0}K+=Ye}}function em(t,i,u,p,v,x,C,O,K){var ie=cf(p,x,C),pe=vh(p,v),Ee=pe*C,Be=0===t[0].x||t[0].x===K||0===t[0].y||t[0].y===K;return i-Ee<i/4&&(i=Ee+i/4),function Ye(yt,Et,Vt,At,Wt,rn,fn,cn,Tn){for(var qn=rn/2,ir=ip(yt),kr=0,pr=Et-Vt,Ur=[],mr=0;mr<yt.length-1;mr++){for(var ri=yt[mr],Nr=yt[mr+1],xr=ri.dist(Nr),ti=Nr.angleTo(ri);pr+Vt<kr+xr;){var Kr=((pr+=Vt)-kr)/xr,yi=Ni(ri.x,Nr.x,Kr),Or=Ni(ri.y,Nr.y,Kr);if(yi>=0&&yi<Tn&&Or>=0&&Or<Tn&&pr-qn>=0&&pr+qn<=ir){var Gi=new Hc(yi,Or,ti,mr);Gi._round(),At&&!Td(yt,Gi,rn,At,Wt)||Ur.push(Gi)}}kr+=xr}return cn||Ur.length||fn||(Ur=Ye(yt,kr/2,Vt,At,Wt,rn,fn,!0,Tn)),Ur}(t,Be?i/2*O%i:(pe/2+2*x)*C*O%i,i,ie,u,Ee,Be,!1,K)}function Om(t,i,u,p,v){for(var x=[],C=0;C<t.length;C++)for(var O=t[C],K=void 0,ie=0;ie<O.length-1;ie++){var pe=O[ie],Ee=O[ie+1];pe.x<i&&Ee.x<i||(pe.x<i?pe=new Re(i,pe.y+(i-pe.x)/(Ee.x-pe.x)*(Ee.y-pe.y))._round():Ee.x<i&&(Ee=new Re(i,pe.y+(i-pe.x)/(Ee.x-pe.x)*(Ee.y-pe.y))._round()),pe.y<u&&Ee.y<u||(pe.y<u?pe=new Re(pe.x+(u-pe.y)/(Ee.y-pe.y)*(Ee.x-pe.x),u)._round():Ee.y<u&&(Ee=new Re(pe.x+(u-pe.y)/(Ee.y-pe.y)*(Ee.x-pe.x),u)._round()),pe.x>=p&&Ee.x>=p||(pe.x>=p?pe=new Re(p,pe.y+(p-pe.x)/(Ee.x-pe.x)*(Ee.y-pe.y))._round():Ee.x>=p&&(Ee=new Re(p,pe.y+(p-pe.x)/(Ee.x-pe.x)*(Ee.y-pe.y))._round()),pe.y>=v&&Ee.y>=v||(pe.y>=v?pe=new Re(pe.x+(v-pe.y)/(Ee.y-pe.y)*(Ee.x-pe.x),v)._round():Ee.y>=v&&(Ee=new Re(pe.x+(v-pe.y)/(Ee.y-pe.y)*(Ee.x-pe.x),v)._round()),K&&pe.equals(K[K.length-1])||x.push(K=[pe]),K.push(Ee)))))}return x}function Gh(t,i,u,p){var v=[],x=t.image,C=x.pixelRatio,O=x.paddedRect.w-2,K=x.paddedRect.h-2,ie=t.right-t.left,pe=t.bottom-t.top,Ee=x.stretchX||[[0,O]],Be=x.stretchY||[[0,K]],Ye=function(yi,Or){return yi+Or[1]-Or[0]},yt=Ee.reduce(Ye,0),Et=Be.reduce(Ye,0),Vt=O-yt,At=K-Et,Wt=0,rn=yt,fn=0,cn=Et,Tn=0,qn=Vt,ir=0,kr=At;if(x.content&&p){var pr=x.content;Wt=op(Ee,0,pr[0]),fn=op(Be,0,pr[1]),rn=op(Ee,pr[0],pr[2]),cn=op(Be,pr[1],pr[3]),Tn=pr[0]-Wt,ir=pr[1]-fn,qn=pr[2]-pr[0]-rn,kr=pr[3]-pr[1]-cn}var Ur=function(yi,Or,Gi,zo){var Wo=Sd(yi.stretch-Wt,rn,ie,t.left),Vo=bu(yi.fixed-Tn,qn,yi.stretch,yt),co=Sd(Or.stretch-fn,cn,pe,t.top),Zo=bu(Or.fixed-ir,kr,Or.stretch,Et),ha=Sd(Gi.stretch-Wt,rn,ie,t.left),ks=bu(Gi.fixed-Tn,qn,Gi.stretch,yt),Ou=Sd(zo.stretch-fn,cn,pe,t.top),js=bu(zo.fixed-ir,kr,zo.stretch,Et),iu=new Re(Wo,co),_s=new Re(ha,co),Os=new Re(ha,Ou),Ti=new Re(Wo,Ou),Do=new Re(Vo/C,Zo/C),ui=new Re(ks/C,js/C),Ui=i*Math.PI/180;if(Ui){var Lu=Math.sin(Ui),wu=Math.cos(Ui),Ko=[wu,-Lu,Lu,wu];iu._matMult(Ko),_s._matMult(Ko),Ti._matMult(Ko),Os._matMult(Ko)}var Is=yi.stretch+yi.fixed,xu=Or.stretch+Or.fixed;return{tl:iu,tr:_s,bl:Ti,br:Os,tex:{x:x.paddedRect.x+1+Is,y:x.paddedRect.y+1+xu,w:Gi.stretch+Gi.fixed-Is,h:zo.stretch+zo.fixed-xu},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Do,pixelOffsetBR:ui,minFontScaleX:qn/C/ie,minFontScaleY:kr/C/pe,isSDF:u}};if(p&&(x.stretchX||x.stretchY))for(var mr=sp(Ee,Vt,yt),ri=sp(Be,At,Et),Nr=0;Nr<mr.length-1;Nr++)for(var xr=mr[Nr],ti=mr[Nr+1],Kr=0;Kr<ri.length-1;Kr++)v.push(Ur(xr,ri[Kr],ti,ri[Kr+1]));else v.push(Ur({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:O+1},{fixed:0,stretch:K+1}));return v}function op(t,i,u){for(var p=0,v=0,x=t;v<x.length;v+=1){var C=x[v];p+=Math.max(i,Math.min(u,C[1]))-Math.max(i,Math.min(u,C[0]))}return p}function sp(t,i,u){for(var p=[{fixed:-1,stretch:0}],v=0,x=t;v<x.length;v+=1){var C=x[v],O=C[0],K=C[1],ie=p[p.length-1];p.push({fixed:O-ie.stretch,stretch:ie.stretch}),p.push({fixed:O-ie.stretch,stretch:ie.stretch+(K-O)})}return p.push({fixed:i+1,stretch:u}),p}function Sd(t,i,u,p){return t/i*u+p}function bu(t,i,u,p){return t-i*u/p}var qh=function(t,i,u,p,v,x,C,O,K,ie){if(this.boxStartIndex=t.length,K){var pe=x.top,Ee=x.bottom,Be=x.collisionPadding;Be&&(pe-=Be[1],Ee+=Be[3]);var Ye=Ee-pe;Ye>0&&(Ye=Math.max(10,Ye),this.circleDiameter=Ye)}else{var yt=x.top*C-O,Et=x.bottom*C+O,Vt=x.left*C-O,At=x.right*C+O,Wt=x.collisionPadding;if(Wt&&(Vt-=Wt[0]*C,yt-=Wt[1]*C,At+=Wt[2]*C,Et+=Wt[3]*C),ie){var rn=new Re(Vt,yt),fn=new Re(At,yt),cn=new Re(Vt,Et),Tn=new Re(At,Et),qn=ie*Math.PI/180;rn._rotate(qn),fn._rotate(qn),cn._rotate(qn),Tn._rotate(qn),Vt=Math.min(rn.x,fn.x,cn.x,Tn.x),At=Math.max(rn.x,fn.x,cn.x,Tn.x),yt=Math.min(rn.y,fn.y,cn.y,Tn.y),Et=Math.max(rn.y,fn.y,cn.y,Tn.y)}t.emplaceBack(i.x,i.y,Vt,yt,At,Et,u,p,v)}this.boxEndIndex=t.length},Ec=function(t,i){if(void 0===t&&(t=[]),void 0===i&&(i=Cd),this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function Cd(t,i){return t<i?-1:t>i?1:0}function hf(t,i,u){void 0===i&&(i=1),void 0===u&&(u=!1);for(var p=1/0,v=1/0,x=-1/0,C=-1/0,O=t[0],K=0;K<O.length;K++){var ie=O[K];(!K||ie.x<p)&&(p=ie.x),(!K||ie.y<v)&&(v=ie.y),(!K||ie.x>x)&&(x=ie.x),(!K||ie.y>C)&&(C=ie.y)}var pe=Math.min(x-p,C-v),Ee=pe/2,Be=new Ec([],Gc);if(0===pe)return new Re(p,v);for(var Ye=p;Ye<x;Ye+=pe)for(var yt=v;yt<C;yt+=pe)Be.push(new Ml(Ye+Ee,yt+Ee,Ee,t));for(var Et=function(Wt){for(var rn=0,fn=0,cn=0,Tn=Wt[0],qn=0,ir=Tn.length,kr=ir-1;qn<ir;kr=qn++){var pr=Tn[qn],Ur=Tn[kr],mr=pr.x*Ur.y-Ur.x*pr.y;fn+=(pr.x+Ur.x)*mr,cn+=(pr.y+Ur.y)*mr,rn+=3*mr}return new Ml(fn/rn,cn/rn,0,Wt)}(t),Vt=Be.length;Be.length;){var At=Be.pop();(At.d>Et.d||!Et.d)&&(Et=At,u&&console.log("found best %d after %d probes",Math.round(1e4*At.d)/1e4,Vt)),At.max-Et.d<=i||(Be.push(new Ml(At.p.x-(Ee=At.h/2),At.p.y-Ee,Ee,t)),Be.push(new Ml(At.p.x+Ee,At.p.y-Ee,Ee,t)),Be.push(new Ml(At.p.x-Ee,At.p.y+Ee,Ee,t)),Be.push(new Ml(At.p.x+Ee,At.p.y+Ee,Ee,t)),Vt+=4)}return u&&(console.log("num probes: "+Vt),console.log("best distance: "+Et.d)),Et.p}function Gc(t,i){return i.max-t.max}function Ml(t,i,u,p){this.p=new Re(t,i),this.h=u,this.d=function(v,x){for(var C=!1,O=1/0,K=0;K<x.length;K++)for(var ie=x[K],pe=0,Ee=ie.length,Be=Ee-1;pe<Ee;Be=pe++){var Ye=ie[pe],yt=ie[Be];Ye.y>v.y!=yt.y>v.y&&v.x<(yt.x-Ye.x)*(v.y-Ye.y)/(yt.y-Ye.y)+Ye.x&&(C=!C),O=Math.min(O,Ta(v,Ye,yt))}return(C?1:-1)*Math.sqrt(O)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}Ec.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Ec.prototype.pop=function(){if(0!==this.length){var t=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),t}},Ec.prototype.peek=function(){return this.data[0]},Ec.prototype._up=function(t){for(var i=this.data,u=this.compare,p=i[t];t>0;){var v=t-1>>1,x=i[v];if(u(p,x)>=0)break;i[t]=x,t=v}i[t]=p},Ec.prototype._down=function(t){for(var i=this.data,u=this.compare,p=this.length>>1,v=i[t];t<p;){var x=1+(t<<1),C=i[x],O=x+1;if(O<this.length&&u(i[O],C)<0&&(x=O,C=i[O]),u(C,v)>=0)break;i[t]=C,t=x}i[t]=v};var df=Number.POSITIVE_INFINITY;function Ic(t,i){return i[1]!==df?function(u,p,v){var x=0,C=0;switch(p=Math.abs(p),v=Math.abs(v),u){case"top-right":case"top-left":case"top":C=v-7;break;case"bottom-right":case"bottom-left":case"bottom":C=7-v}switch(u){case"top-right":case"bottom-right":case"right":x=-p;break;case"top-left":case"bottom-left":case"left":x=p}return[x,C]}(t,i[0],i[1]):function(u,p){var v=0,x=0;p<0&&(p=0);var C=p/Math.sqrt(2);switch(u){case"top-right":case"top-left":x=C-7;break;case"bottom-right":case"bottom-left":x=7-C;break;case"bottom":x=7-p;break;case"top":x=p-7}switch(u){case"top-right":case"bottom-right":v=-C;break;case"top-left":case"bottom-left":v=C;break;case"left":v=p;break;case"right":v=-p}return[v,x]}(t,i[0])}function Wh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Zh(t,i,u,p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt){var Et=function(fn,cn,Tn,qn,ir,kr,pr,Ur){for(var mr=qn.layout.get("text-rotate").evaluate(kr,{})*Math.PI/180,ri=[],Nr=0,xr=cn.positionedLines;Nr<xr.length;Nr+=1)for(var ti=xr[Nr],Kr=0,yi=ti.positionedGlyphs;Kr<yi.length;Kr+=1){var Or=yi[Kr];if(Or.rect){var Gi=Or.rect||{},zo=4,Wo=!0,Vo=1,co=0,Zo=(ir||Ur)&&Or.vertical,ha=Or.metrics.advance*Or.scale/2;if(Ur&&cn.verticalizable&&(co=ti.lineOffset/2-(Or.imageName?-(24-Or.metrics.width*Or.scale)/2:24*(Or.scale-1))),Or.imageName){var ks=pr[Or.imageName];Wo=ks.sdf,zo=1/(Vo=ks.pixelRatio)}var Ou=ir?[Or.x+ha,Or.y]:[0,0],js=ir?[0,0]:[Or.x+ha+Tn[0],Or.y+Tn[1]-co],iu=[0,0];Zo&&(iu=js,js=[0,0]);var _s=(Or.metrics.left-zo)*Or.scale-ha+js[0],Os=(-Or.metrics.top-zo)*Or.scale+js[1],Ti=_s+Gi.w*Or.scale/Vo,Do=Os+Gi.h*Or.scale/Vo,ui=new Re(_s,Os),Ui=new Re(Ti,Os),Lu=new Re(_s,Do),wu=new Re(Ti,Do);if(Zo){var Ko=new Re(-ha,ha- -17),Is=-Math.PI/2,xu=12-ha,Zi=new Re(22-xu,-(Or.imageName?xu:0)),Hl=new(Function.prototype.bind.apply(Re,[null].concat(iu)));ui._rotateAround(Is,Ko)._add(Zi)._add(Hl),Ui._rotateAround(Is,Ko)._add(Zi)._add(Hl),Lu._rotateAround(Is,Ko)._add(Zi)._add(Hl),wu._rotateAround(Is,Ko)._add(Zi)._add(Hl)}if(mr){var Nu=Math.sin(mr),Cc=Math.cos(mr),vs=[Cc,-Nu,Nu,Cc];ui._matMult(vs),Ui._matMult(vs),Lu._matMult(vs),wu._matMult(vs)}var Dc=new Re(0,0),al=new Re(0,0);ri.push({tl:ui,tr:Ui,bl:Lu,br:wu,tex:Gi,writingMode:cn.writingMode,glyphOffset:Ou,sectionIndex:Or.sectionIndex,isSDF:Wo,pixelOffsetTL:Dc,pixelOffsetBR:al,minFontScaleX:0,minFontScaleY:0})}}return ri}(0,u,O,v,x,C,p,t.allowVerticalPlacement),Vt=t.textSizeData,At=null;"source"===Vt.kind?(At=[128*v.layout.get("text-size").evaluate(C,{})])[0]>32640&&U(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Vt.kind&&((At=[128*Ye.compositeTextSizes[0].evaluate(C,{},yt),128*Ye.compositeTextSizes[1].evaluate(C,{},yt)])[0]>32640||At[1]>32640)&&U(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,Et,At,O,x,C,ie,i,K.lineStartIndex,K.lineLength,Be,yt);for(var Wt=0,rn=pe;Wt<rn.length;Wt+=1)Ee[rn[Wt]]=t.text.placedSymbolArray.length-1;return 4*Et.length}function ap(t){for(var i in t)return t[i];return null}function bh(t,i,u,p){var v=t.compareText;if(i in v){for(var x=v[i],C=x.length-1;C>=0;C--)if(p.dist(x[C])<u)return!0}else v[i]=[];return v[i].push(p),!1}var Kh=Kl.VectorTileFeature.types,up=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yh(t,i,u,p,v,x,C,O,K,ie,pe,Ee,Be){var Ye=O?Math.min(32640,Math.round(O[0])):0,yt=O?Math.min(32640,Math.round(O[1])):0;t.emplaceBack(i,u,Math.round(32*p),Math.round(32*v),x,C,(Ye<<1)+(K?1:0),yt,16*ie,16*pe,256*Ee,256*Be)}function lp(t,i,u){t.emplaceBack(i.x,i.y,u),t.emplaceBack(i.x,i.y,u),t.emplaceBack(i.x,i.y,u),t.emplaceBack(i.x,i.y,u)}function Fy(t){for(var i=0,u=t.sections;i<u.length;i+=1)if(Zs(u[i].text))return!0;return!1}var Jh=function(t){this.layoutVertexArray=new _o,this.indexArray=new xl,this.programConfigurations=t,this.segments=new Xe,this.dynamicLayoutVertexArray=new Ll,this.opacityVertexArray=new wl,this.placedSymbolArray=new m};Jh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Jh.prototype.upload=function(t,i,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yp.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,bc.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,up,!0),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(t))},Jh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},tr("SymbolBuffers",Jh);var ff=function(t,i,u){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new u,this.segments=new Xe,this.collisionVertexArray=new pl};ff.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Vc.members,!0)},ff.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},tr("CollisionBuffers",ff);var ro=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(x){return x.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Va([]),this.placementViewportMatrix=Va([]);var i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ed(this.zoom,i["text-size"]),this.iconSizeData=Ed(this.zoom,i["icon-size"]);var u=this.layers[0].layout,p=u.get("symbol-sort-key"),v=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==v&&void 0!==p.constantOr(1),this.sortFeaturesByY=("viewport-y"===v||"auto"===v&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===u.get("symbol-placement")&&(this.writingModes=u.get("text-writing-mode").map(function(x){return ea[x]})),this.stateDependentLayerIds=this.layers.filter(function(x){return x.isStateDependent()}).map(function(x){return x.id}),this.sourceID=t.sourceID};ro.prototype.createArrays=function(){this.text=new Jh(new hr(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Jh(new hr(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new k,this.lineVertexArray=new G,this.symbolInstances=new D},ro.prototype.calculateGlyphDependencies=function(t,i,u,p,v){for(var x=0;x<t.length;x++)if(i[t.charCodeAt(x)]=!0,(u||p)&&v){var C=mh[t.charAt(x)];C&&(i[C.charCodeAt(0)]=!0)}},ro.prototype.populate=function(t,i,u){var p=this.layers[0],v=p.layout,x=v.get("text-font"),C=v.get("text-field"),O=v.get("icon-image"),K=("constant"!==C.value.kind||C.value.value instanceof Yi&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==x.value.kind||x.value.value.length>0),ie="constant"!==O.value.kind||!!O.value.value||Object.keys(O.parameters).length>0,pe=v.get("symbol-sort-key");if(this.features=[],K||ie){for(var Ee=i.iconDependencies,Be=i.glyphDependencies,Ye=i.availableImages,yt=new V(this.zoom),Et=0,Vt=t;Et<Vt.length;Et+=1){var At=Vt[Et],Wt=At.feature,rn=At.id,fn=At.index,cn=At.sourceLayerIndex,Tn=p._featureFilter.needGeometry,qn=Qi(Wt,Tn);if(p._featureFilter.filter(yt,qn,u)){Tn||(qn.geometry=Ei(Wt));var ir=void 0;if(K){var kr=p.getValueAndResolveTokens("text-field",qn,u,Ye),pr=Yi.factory(kr);Fy(pr)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===il()||this.hasRTLText&&Mi.isParsed())&&(ir=lf(pr,p,qn))}var Ur=void 0;if(ie){var mr=p.getValueAndResolveTokens("icon-image",qn,u,Ye);Ur=mr instanceof Ao?mr:Ao.fromString(mr)}if(ir||Ur){var ri=this.sortFeaturesByKey?pe.evaluate(qn,{},u):void 0;if(this.features.push({id:rn,text:ir,icon:Ur,index:fn,sourceLayerIndex:cn,geometry:qn.geometry,properties:Wt.properties,type:Kh[Wt.type],sortKey:ri}),Ur&&(Ee[Ur.name]=!0),ir){var Nr=x.evaluate(qn,{},u).join(","),xr="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ea.vertical)>=0;for(var ti=0,Kr=ir.sections;ti<Kr.length;ti+=1){var yi=Kr[ti];if(yi.image)Ee[yi.image.name]=!0;else{var Or=Gu(ir.toString()),Gi=yi.fontStack||Nr,zo=Be[Gi]=Be[Gi]||{};this.calculateGlyphDependencies(yi.text,zo,xr,this.allowVerticalPlacement,Or)}}}}}}"line"===v.get("symbol-placement")&&(this.features=function(Wo){var Vo={},co={},Zo=[],ha=0;function ks(Ko){Zo.push(Wo[Ko]),ha++}function Ou(Ko,Is,xu){var Zi=co[Ko];return delete co[Ko],co[Is]=Zi,Zo[Zi].geometry[0].pop(),Zo[Zi].geometry[0]=Zo[Zi].geometry[0].concat(xu[0]),Zi}function js(Ko,Is,xu){var Zi=Vo[Is];return delete Vo[Is],Vo[Ko]=Zi,Zo[Zi].geometry[0].shift(),Zo[Zi].geometry[0]=xu[0].concat(Zo[Zi].geometry[0]),Zi}function iu(Ko,Is,xu){var Zi=xu?Is[0][Is[0].length-1]:Is[0][0];return Ko+":"+Zi.x+":"+Zi.y}for(var _s=0;_s<Wo.length;_s++){var Os=Wo[_s],Ti=Os.geometry,Do=Os.text?Os.text.toString():null;if(Do){var ui=iu(Do,Ti),Ui=iu(Do,Ti,!0);if(ui in co&&Ui in Vo&&co[ui]!==Vo[Ui]){var Lu=js(ui,Ui,Ti),wu=Ou(ui,Ui,Zo[Lu].geometry);delete Vo[ui],delete co[Ui],co[iu(Do,Zo[wu].geometry,!0)]=wu,Zo[Lu].geometry=null}else ui in co?Ou(ui,Ui,Ti):Ui in Vo?js(ui,Ui,Ti):(ks(_s),Vo[ui]=ha-1,co[Ui]=ha-1)}else ks(_s)}return Zo.filter(function(Ko){return Ko.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Wo,Vo){return Wo.sortKey-Vo.sortKey})}},ro.prototype.update=function(t,i,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,u))},ro.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},ro.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ro.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ro.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ro.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ro.prototype.addToLineVertexArray=function(t,i){var u=this.lineVertexArray.length;if(void 0!==t.segment){for(var p=t.dist(i[t.segment+1]),v=t.dist(i[t.segment]),x={},C=t.segment+1;C<i.length;C++)x[C]={x:i[C].x,y:i[C].y,tileUnitDistanceFromAnchor:p},C<i.length-1&&(p+=i[C+1].dist(i[C]));for(var O=t.segment||0;O>=0;O--)x[O]={x:i[O].x,y:i[O].y,tileUnitDistanceFromAnchor:v},O>0&&(v+=i[O-1].dist(i[O]));for(var K=0;K<i.length;K++){var ie=x[K];this.lineVertexArray.emplaceBack(ie.x,ie.y,ie.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},ro.prototype.addSymbols=function(t,i,u,p,v,x,C,O,K,ie,pe,Ee){for(var Be=t.indexArray,Ye=t.layoutVertexArray,yt=t.segments.prepareSegment(4*i.length,Ye,Be,this.canOverlap?x.sortKey:void 0),Et=this.glyphOffsetArray.length,Vt=yt.vertexLength,At=this.allowVerticalPlacement&&C===ea.vertical?Math.PI/2:0,Wt=x.text&&x.text.sections,rn=0;rn<i.length;rn++){var fn=i[rn],cn=fn.tl,Tn=fn.tr,qn=fn.bl,ir=fn.br,kr=fn.tex,pr=fn.pixelOffsetTL,Ur=fn.pixelOffsetBR,mr=fn.minFontScaleX,ri=fn.minFontScaleY,Nr=fn.glyphOffset,xr=fn.isSDF,ti=fn.sectionIndex,Kr=yt.vertexLength,yi=Nr[1];Yh(Ye,O.x,O.y,cn.x,yi+cn.y,kr.x,kr.y,u,xr,pr.x,pr.y,mr,ri),Yh(Ye,O.x,O.y,Tn.x,yi+Tn.y,kr.x+kr.w,kr.y,u,xr,Ur.x,pr.y,mr,ri),Yh(Ye,O.x,O.y,qn.x,yi+qn.y,kr.x,kr.y+kr.h,u,xr,pr.x,Ur.y,mr,ri),Yh(Ye,O.x,O.y,ir.x,yi+ir.y,kr.x+kr.w,kr.y+kr.h,u,xr,Ur.x,Ur.y,mr,ri),lp(t.dynamicLayoutVertexArray,O,At),Be.emplaceBack(Kr,Kr+1,Kr+2),Be.emplaceBack(Kr+1,Kr+2,Kr+3),yt.vertexLength+=4,yt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Nr[0]),rn!==i.length-1&&ti===i[rn+1].sectionIndex||t.programConfigurations.populatePaintArrays(Ye.length,x,x.index,{},Ee,Wt&&Wt[ti])}t.placedSymbolArray.emplaceBack(O.x,O.y,Et,this.glyphOffsetArray.length-Et,Vt,K,ie,O.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],C,0,!1,0,pe)},ro.prototype._addCollisionDebugVertex=function(t,i,u,p,v,x){return i.emplaceBack(0,0),t.emplaceBack(u.x,u.y,p,v,Math.round(x.x),Math.round(x.y))},ro.prototype.addCollisionDebugVertices=function(t,i,u,p,v,x,C){var O=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),K=O.vertexLength,ie=v.layoutVertexArray,pe=v.collisionVertexArray,Ee=C.anchorX,Be=C.anchorY;this._addCollisionDebugVertex(ie,pe,x,Ee,Be,new Re(t,i)),this._addCollisionDebugVertex(ie,pe,x,Ee,Be,new Re(u,i)),this._addCollisionDebugVertex(ie,pe,x,Ee,Be,new Re(u,p)),this._addCollisionDebugVertex(ie,pe,x,Ee,Be,new Re(t,p)),O.vertexLength+=4;var Ye=v.indexArray;Ye.emplaceBack(K,K+1),Ye.emplaceBack(K+1,K+2),Ye.emplaceBack(K+2,K+3),Ye.emplaceBack(K+3,K),O.primitiveLength+=4},ro.prototype.addDebugCollisionBoxes=function(t,i,u,p){for(var v=t;v<i;v++){var x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,p?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,u)}},ro.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ff(Nl,ku.members,Wl),this.iconCollisionBox=new ff(Nl,ku.members,Wl);for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}},ro.prototype._deserializeCollisionBoxesForSymbol=function(t,i,u,p,v,x,C,O,K){for(var ie={},pe=i;pe<u;pe++){var Ee=t.get(pe);ie.textBox={x1:Ee.x1,y1:Ee.y1,x2:Ee.x2,y2:Ee.y2,anchorPointX:Ee.anchorPointX,anchorPointY:Ee.anchorPointY},ie.textFeatureIndex=Ee.featureIndex;break}for(var Be=p;Be<v;Be++){var Ye=t.get(Be);ie.verticalTextBox={x1:Ye.x1,y1:Ye.y1,x2:Ye.x2,y2:Ye.y2,anchorPointX:Ye.anchorPointX,anchorPointY:Ye.anchorPointY},ie.verticalTextFeatureIndex=Ye.featureIndex;break}for(var yt=x;yt<C;yt++){var Et=t.get(yt);ie.iconBox={x1:Et.x1,y1:Et.y1,x2:Et.x2,y2:Et.y2,anchorPointX:Et.anchorPointX,anchorPointY:Et.anchorPointY},ie.iconFeatureIndex=Et.featureIndex;break}for(var Vt=O;Vt<K;Vt++){var At=t.get(Vt);ie.verticalIconBox={x1:At.x1,y1:At.y1,x2:At.x2,y2:At.y2,anchorPointX:At.anchorPointX,anchorPointY:At.anchorPointY},ie.verticalIconFeatureIndex=At.featureIndex;break}return ie},ro.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var i=0;i<this.symbolInstances.length;i++){var u=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},ro.prototype.hasTextData=function(){return this.text.segments.get().length>0},ro.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ro.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ro.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ro.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ro.prototype.addIndicesForPlacedSymbol=function(t,i){for(var u=t.placedSymbolArray.get(i),p=u.vertexStartIndex+4*u.numGlyphs,v=u.vertexStartIndex;v<p;v+=4)t.indexArray.emplaceBack(v,v+1,v+2),t.indexArray.emplaceBack(v+1,v+2,v+3)},ro.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var i=Math.sin(t),u=Math.cos(t),p=[],v=[],x=[],C=0;C<this.symbolInstances.length;++C){x.push(C);var O=this.symbolInstances.get(C);p.push(0|Math.round(i*O.anchorX+u*O.anchorY)),v.push(O.featureIndex)}return x.sort(function(K,ie){return p[K]-p[ie]||v[ie]-v[K]}),x},ro.prototype.addToSortKeyRanges=function(t,i){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===i?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})},ro.prototype.sortFeatures=function(t){var i=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,p=this.symbolInstanceIndexes;u<p.length;u+=1){var v=this.symbolInstances.get(p[u]);this.featureSortOrder.push(v.featureIndex),[v.rightJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.leftJustifiedTextSymbolIndex].forEach(function(x,C,O){x>=0&&O.indexOf(x)===C&&i.addIndicesForPlacedSymbol(i.text,x)}),v.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,v.verticalPlacedTextSymbolIndex),v.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.placedIconSymbolIndex),v.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},tr("SymbolBucket",ro,{omit:["layers","collisionBoxArray","features","compareText"]}),ro.MAX_GLYPHS=65535,ro.addDynamicAttributes=lp;var Dd=new Ro({"symbol-placement":new wn(Je.layout_symbol["symbol-placement"]),"symbol-spacing":new wn(Je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wn(Je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Fn(Je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wn(Je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wn(Je.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new wn(Je.layout_symbol["icon-ignore-placement"]),"icon-optional":new wn(Je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wn(Je.layout_symbol["icon-rotation-alignment"]),"icon-size":new Fn(Je.layout_symbol["icon-size"]),"icon-text-fit":new wn(Je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wn(Je.layout_symbol["icon-text-fit-padding"]),"icon-image":new Fn(Je.layout_symbol["icon-image"]),"icon-rotate":new Fn(Je.layout_symbol["icon-rotate"]),"icon-padding":new wn(Je.layout_symbol["icon-padding"]),"icon-keep-upright":new wn(Je.layout_symbol["icon-keep-upright"]),"icon-offset":new Fn(Je.layout_symbol["icon-offset"]),"icon-anchor":new Fn(Je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wn(Je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wn(Je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wn(Je.layout_symbol["text-rotation-alignment"]),"text-field":new Fn(Je.layout_symbol["text-field"]),"text-font":new Fn(Je.layout_symbol["text-font"]),"text-size":new Fn(Je.layout_symbol["text-size"]),"text-max-width":new Fn(Je.layout_symbol["text-max-width"]),"text-line-height":new wn(Je.layout_symbol["text-line-height"]),"text-letter-spacing":new Fn(Je.layout_symbol["text-letter-spacing"]),"text-justify":new Fn(Je.layout_symbol["text-justify"]),"text-radial-offset":new Fn(Je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wn(Je.layout_symbol["text-variable-anchor"]),"text-anchor":new Fn(Je.layout_symbol["text-anchor"]),"text-max-angle":new wn(Je.layout_symbol["text-max-angle"]),"text-writing-mode":new wn(Je.layout_symbol["text-writing-mode"]),"text-rotate":new Fn(Je.layout_symbol["text-rotate"]),"text-padding":new wn(Je.layout_symbol["text-padding"]),"text-keep-upright":new wn(Je.layout_symbol["text-keep-upright"]),"text-transform":new Fn(Je.layout_symbol["text-transform"]),"text-offset":new Fn(Je.layout_symbol["text-offset"]),"text-allow-overlap":new wn(Je.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new wn(Je.layout_symbol["text-ignore-placement"]),"text-optional":new wn(Je.layout_symbol["text-optional"])}),cp={paint:new Ro({"icon-opacity":new Fn(Je.paint_symbol["icon-opacity"]),"icon-color":new Fn(Je.paint_symbol["icon-color"]),"icon-halo-color":new Fn(Je.paint_symbol["icon-halo-color"]),"icon-halo-width":new Fn(Je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Fn(Je.paint_symbol["icon-halo-blur"]),"icon-translate":new wn(Je.paint_symbol["icon-translate"]),"icon-translate-anchor":new wn(Je.paint_symbol["icon-translate-anchor"]),"text-opacity":new Fn(Je.paint_symbol["text-opacity"]),"text-color":new Fn(Je.paint_symbol["text-color"],{runtimeType:Hn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Fn(Je.paint_symbol["text-halo-color"]),"text-halo-width":new Fn(Je.paint_symbol["text-halo-width"]),"text-halo-blur":new Fn(Je.paint_symbol["text-halo-blur"]),"text-translate":new wn(Je.paint_symbol["text-translate"]),"text-translate-anchor":new wn(Je.paint_symbol["text-translate-anchor"])}),layout:Dd},Xu=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:zn,this.defaultValue=t};Xu.prototype.evaluate=function(t){if(t.formattedSection){var i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Xu.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Xu.prototype.outputDefined=function(){return!1},Xu.prototype.serialize=function(){return null},tr("FormatSectionOverride",Xu,{omit:["defaultValue"]});var wg=function(t){function i(u){t.call(this,u,cp)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.recalculate=function(u,p){if(t.prototype.recalculate.call(this,u,p),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var v=this.layout.get("text-writing-mode");if(v){for(var x=[],C=0,O=v;C<O.length;C+=1){var K=O[C];x.indexOf(K)<0&&x.push(K)}this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},i.prototype.getValueAndResolveTokens=function(u,p,v,x){var K,C=this.layout.get(u).evaluate(p,{},v,x),O=this._unevaluatedLayout._values[u];return O.isDataDriven()||ju(O.value)||!C?C:(K=p.properties,C.replace(/{([^{}]+)}/g,function(pe,Ee){return Ee in K?String(K[Ee]):""}))},i.prototype.createBucket=function(u){return new ro(u)},i.prototype.queryRadius=function(){return 0},i.prototype.queryIntersectsFeature=function(){return!1},i.prototype._setPaintOverrides=function(){for(var u=0,p=cp.paint.overridableProperties;u<p.length;u+=1){var v=p[u];if(i.hasPaintOverride(this.layout,v)){var x,C=this.paint.get(v),O=new Xu(C),K=new Du(O,C.property.specification);x="constant"===C.value.kind||"source"===C.value.kind?new As("source",K):new yo("composite",K,C.value.zoomStops,C.value._interpolationType),this.paint._values[v]=new at(C.property,x,C.parameters)}}},i.prototype._handleOverridablePaintPropertyUpdate=function(u,p,v){return!(!this.layout||p.isDataDriven()||v.isDataDriven())&&i.hasPaintOverride(this.layout,u)},i.hasPaintOverride=function(u,p){var v=u.get("text-field"),x=cp.paint.properties[p],C=!1,O=function(pe){for(var Ee=0,Be=pe;Ee<Be.length;Ee+=1)if(x.overrides&&x.overrides.hasOverride(Be[Ee]))return void(C=!0)};if("constant"===v.value.kind&&v.value.value instanceof Yi)O(v.value.value.sections);else if("source"===v.value.kind){var K=function(pe){C||(pe instanceof zi&&Si(pe.value)===yn?O(pe.value.sections):pe instanceof fo?O(pe.sections):pe.eachChild(K))},ie=v.value;ie._styleExpression&&K(ie._styleExpression.expression)}return C},i}(Co),tm={paint:new Ro({"background-color":new wn(Je.paint_background["background-color"]),"background-pattern":new si(Je.paint_background["background-pattern"]),"background-opacity":new wn(Je.paint_background["background-opacity"])})},wh=function(t){function i(u){t.call(this,u,tm)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(Co),hp={paint:new Ro({"raster-opacity":new wn(Je.paint_raster["raster-opacity"]),"raster-hue-rotate":new wn(Je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wn(Je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wn(Je.paint_raster["raster-brightness-max"]),"raster-saturation":new wn(Je.paint_raster["raster-saturation"]),"raster-contrast":new wn(Je.paint_raster["raster-contrast"]),"raster-resampling":new wn(Je.paint_raster["raster-resampling"]),"raster-fade-duration":new wn(Je.paint_raster["raster-fade-duration"])})},xg=function(t){function i(u){t.call(this,u,hp)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i}(Co),Lm=function(t){function i(u){t.call(this,u,{}),this.implementation=u}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},i.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},i.prototype.recalculate=function(){},i.prototype.updateTransitions=function(){},i.prototype.hasTransition=function(){},i.prototype.serialize=function(){},i.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},i.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},i}(Co),dp={circle:Qd,heatmap:lh,hillshade:Cl,fill:Vs,"fill-extrusion":eu,line:Hh,symbol:wg,background:wh,raster:xg},fp=fe.HTMLImageElement,Ad=fe.HTMLCanvasElement,pf=fe.HTMLVideoElement,Ii=fe.ImageData,mf=fe.ImageBitmap,qc=function(t,i,u,p){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(i,p)};qc.prototype.update=function(t,i,u){var p=t.width,v=t.height,x=!(this.size&&this.size[0]===p&&this.size[1]===v||u),C=this.context,O=C.gl;if(this.useMipmap=Boolean(i&&i.useMipmap),O.bindTexture(O.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===O.RGBA&&(!i||!1!==i.premultiply)),x)this.size=[p,v],t instanceof fp||t instanceof Ad||t instanceof pf||t instanceof Ii||mf&&t instanceof mf?O.texImage2D(O.TEXTURE_2D,0,this.format,this.format,O.UNSIGNED_BYTE,t):O.texImage2D(O.TEXTURE_2D,0,this.format,p,v,0,this.format,O.UNSIGNED_BYTE,t.data);else{var K=u||{x:0,y:0},ie=K.x,pe=K.y;t instanceof fp||t instanceof Ad||t instanceof pf||t instanceof Ii||mf&&t instanceof mf?O.texSubImage2D(O.TEXTURE_2D,0,ie,pe,O.RGBA,O.UNSIGNED_BYTE,t):O.texSubImage2D(O.TEXTURE_2D,0,ie,pe,p,v,O.RGBA,O.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&O.generateMipmap(O.TEXTURE_2D)},qc.prototype.bind=function(t,i,u){var p=this.context.gl;p.bindTexture(p.TEXTURE_2D,this.texture),u!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=p.LINEAR),t!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,t),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,u||t),this.filter=t),i!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,i),this.wrap=i)},qc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},qc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Md=function(t){var i=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){i._triggered=!1,i._callback()})};Md.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Md.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Tc=function(t,i,u){this.target=t,this.parent=i,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},je(["receive","process"],this),this.invoker=new Md(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Pe()?t:fe};function Vl(t,i,u){var p=2*Math.PI*6378137/256/Math.pow(2,u);return[t*p-2*Math.PI*6378137/2,i*p-2*Math.PI*6378137/2]}Tc.prototype.send=function(t,i,u,p,v){var x=this;void 0===v&&(v=!1);var C=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[C]=u);var O=rt(this.globalScope)?void 0:[];return this.target.postMessage({id:C,type:t,hasCallback:!!u,targetMapId:p,mustQueue:v,sourceMapId:this.mapId,data:wa(i,O)},O),{cancel:function(){u&&delete x.callbacks[C],x.target.postMessage({id:C,type:"<cancel>",targetMapId:p,sourceMapId:x.mapId})}}},Tc.prototype.receive=function(t){var i=t.data,u=i.id;if(u&&(!i.targetMapId||this.mapId===i.targetMapId))if("<cancel>"===i.type){delete this.tasks[u];var p=this.cancelCallbacks[u];delete this.cancelCallbacks[u],p&&p()}else Pe()||i.mustQueue?(this.tasks[u]=i,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,i)},Tc.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),i=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),i&&this.processTask(t,i)}},Tc.prototype.processTask=function(t,i){var u=this;if("<response>"===i.type){var p=this.callbacks[t];delete this.callbacks[t],p&&(i.error?p(wi(i.error)):p(null,wi(i.data)))}else{var v=!1,x=rt(this.globalScope)?void 0:[],C=i.hasCallback?function(pe,Ee){v=!0,delete u.cancelCallbacks[t],u.target.postMessage({id:t,type:"<response>",sourceMapId:u.mapId,error:pe?wa(pe):null,data:wa(Ee,x)},x)}:function(pe){v=!0},O=null,K=wi(i.data);if(this.parent[i.type])O=this.parent[i.type](i.sourceMapId,K,C);else if(this.parent.getWorkerSource){var ie=i.type.split(".");O=this.parent.getWorkerSource(i.sourceMapId,ie[0],K.source)[ie[1]](K,C)}else C(new Error("Could not find function "+i.type));!v&&O&&O.cancel&&(this.cancelCallbacks[t]=O.cancel)}},Tc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Rs=function(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Rs.prototype.setNorthEast=function(t){return this._ne=t instanceof qo?new qo(t.lng,t.lat):qo.convert(t),this},Rs.prototype.setSouthWest=function(t){return this._sw=t instanceof qo?new qo(t.lng,t.lat):qo.convert(t),this},Rs.prototype.extend=function(t){var i,u,p=this._sw,v=this._ne;if(t instanceof qo)i=t,u=t;else{if(!(t instanceof Rs))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Rs.convert(t)):this.extend(qo.convert(t)):this;if(u=t._ne,!(i=t._sw)||!u)return this}return p||v?(p.lng=Math.min(i.lng,p.lng),p.lat=Math.min(i.lat,p.lat),v.lng=Math.max(u.lng,v.lng),v.lat=Math.max(u.lat,v.lat)):(this._sw=new qo(i.lng,i.lat),this._ne=new qo(u.lng,u.lat)),this},Rs.prototype.getCenter=function(){return new qo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Rs.prototype.getSouthWest=function(){return this._sw},Rs.prototype.getNorthEast=function(){return this._ne},Rs.prototype.getNorthWest=function(){return new qo(this.getWest(),this.getNorth())},Rs.prototype.getSouthEast=function(){return new qo(this.getEast(),this.getSouth())},Rs.prototype.getWest=function(){return this._sw.lng},Rs.prototype.getSouth=function(){return this._sw.lat},Rs.prototype.getEast=function(){return this._ne.lng},Rs.prototype.getNorth=function(){return this._ne.lat},Rs.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Rs.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Rs.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Rs.prototype.contains=function(t){var i=qo.convert(t),u=i.lng,p=i.lat,v=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v},Rs.convert=function(t){return!t||t instanceof Rs?t:new Rs(t)};var qo=function(t,i){if(isNaN(t)||isNaN(i))throw new Error("Invalid LngLat object: ("+t+", "+i+")");if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};qo.prototype.wrap=function(){return new qo(pt(this.lng,-180,180),this.lat)},qo.prototype.toArray=function(){return[this.lng,this.lat]},qo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},qo.prototype.distanceTo=function(t){var i=Math.PI/180,u=this.lat*i,p=t.lat*i,v=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((t.lng-this.lng)*i);return 6371008.8*Math.acos(Math.min(v,1))},qo.prototype.toBounds=function(t){void 0===t&&(t=0);var i=360*t/40075017,u=i/Math.cos(Math.PI/180*this.lat);return new Rs(new qo(this.lng-u,this.lat-i),new qo(this.lng+u,this.lat+i))},qo.convert=function(t){if(t instanceof qo)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new qo(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new qo(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Pd=2*Math.PI*6371008.8;function Sc(t){return Pd*Math.cos(t*Math.PI/180)}function gf(t){return(180+t)/360}function nm(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function yf(t,i){return t/Sc(i)}function Nm(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var Pl=function(t,i,u){void 0===u&&(u=0),this.x=+t,this.y=+i,this.z=+u};Pl.fromLngLat=function(t,i){void 0===i&&(i=0);var u=qo.convert(t);return new Pl(gf(u.lng),nm(u.lat),yf(i,u.lat))},Pl.prototype.toLngLat=function(){return new qo(360*this.x-180,Nm(this.y))},Pl.prototype.toAltitude=function(){return this.z*Sc(Nm(this.y))},Pl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Pd*(t=Nm(this.y),1/Math.cos(t*Math.PI/180));var t};var Ql=function(t,i,u){this.z=t,this.x=i,this.y=u,this.key=xh(0,t,t,i,u)};Ql.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Ql.prototype.url=function(t,i){var u,p,v,x,C,O=(p=this.y,v=this.z,x=Vl(256*(u=this.x),256*(p=Math.pow(2,v)-p-1),v),C=Vl(256*(u+1),256*(p+1),v),x[0]+","+x[1]+","+C[0]+","+C[1]),K=function(ie,pe,Ee){for(var Be,Ye="",yt=ie;yt>0;yt--)Ye+=(pe&(Be=1<<yt-1)?1:0)+(Ee&Be?2:0);return Ye}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",K).replace("{bbox-epsg-3857}",O)},Ql.prototype.getTilePoint=function(t){var i=Math.pow(2,this.z);return new Re(8192*(t.x*i-this.x),8192*(t.y*i-this.y))},Ql.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Xh=function(t,i){this.wrap=t,this.canonical=i,this.key=xh(t,i.z,i.z,i.x,i.y)},ts=function(t,i,u,p,v){this.overscaledZ=t,this.wrap=i,this.canonical=new Ql(u,+p,+v),this.key=xh(i,t,u,p,v)};function xh(t,i,u,p,v){(t*=2)<0&&(t=-1*t-1);var x=1<<u;return(x*x*t+x*v+p).toString(36)+u.toString(36)+i.toString(36)}ts.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},ts.prototype.scaledTo=function(t){var i=this.canonical.z-t;return t>this.canonical.z?new ts(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ts(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)},ts.prototype.calculateScaledKey=function(t,i){var u=this.canonical.z-t;return t>this.canonical.z?xh(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y):xh(this.wrap*+i,t,t,this.canonical.x>>u,this.canonical.y>>u)},ts.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var i=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i},ts.prototype.children=function(t){if(this.overscaledZ>=t)return[new ts(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var i=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new ts(i,this.wrap,i,u,p),new ts(i,this.wrap,i,u+1,p),new ts(i,this.wrap,i,u,p+1),new ts(i,this.wrap,i,u+1,p+1)]},ts.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},ts.prototype.wrapped=function(){return new ts(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ts.prototype.unwrapTo=function(t){return new ts(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},ts.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ts.prototype.toUnwrapped=function(){return new Xh(this.wrap,this.canonical)},ts.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ts.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Pl(t.x-this.wrap,t.y))},tr("CanonicalTileID",Ql),tr("OverscaledTileID",ts,{omit:["posMatrix"]});var jl=function(t,i,u){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return U('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=i.height;var p=this.dim=i.height-2;this.data=new Uint32Array(i.data.buffer),this.encoding=u||"mapbox";for(var v=0;v<p;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(p,v)]=this.data[this._idx(p-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,p)]=this.data[this._idx(v,p-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(p,-1)]=this.data[this._idx(p-1,0)],this.data[this._idx(-1,p)]=this.data[this._idx(0,p-1)],this.data[this._idx(p,p)]=this.data[this._idx(p-1,p-1)]};jl.prototype.get=function(t,i){var u=new Uint8Array(this.data.buffer),p=4*this._idx(t,i);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(u[p],u[p+1],u[p+2])},jl.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},jl.prototype._idx=function(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)},jl.prototype._unpackMapbox=function(t,i,u){return(256*t*256+256*i+u)/10-1e4},jl.prototype._unpackTerrarium=function(t,i,u){return 256*t+i+u/256-32768},jl.prototype.getPixels=function(){return new pu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},jl.prototype.backfillBorder=function(t,i,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var p=i*this.dim,v=i*this.dim+this.dim,x=u*this.dim,C=u*this.dim+this.dim;switch(i){case-1:p=v-1;break;case 1:v=p+1}switch(u){case-1:x=C-1;break;case 1:C=x+1}for(var O=-i*this.dim,K=-u*this.dim,ie=x;ie<C;ie++)for(var pe=p;pe<v;pe++)this.data[this._idx(pe,ie)]=t.data[this._idx(pe+O,ie+K)]},tr("DEMData",jl);var Rd=function(t){this._stringToNumber={},this._numberToString=[];for(var i=0;i<t.length;i++){var u=t[i];this._stringToNumber[u]=i,this._numberToString[i]=u}};Rd.prototype.encode=function(t){return this._stringToNumber[t]},Rd.prototype.decode=function(t){return this._numberToString[t]};var _f=function(t,i,u,p,v){this.type="Feature",this._vectorTileFeature=t,t._z=i,t._x=u,t._y=p,this.properties=t.properties,this.id=v},rm={geometry:{configurable:!0}};rm.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},rm.geometry.set=function(t){this._geometry=t},_f.prototype.toJSON=function(){var t={geometry:this.geometry};for(var i in this)"_geometry"!==i&&"_vectorTileFeature"!==i&&(t[i]=this[i]);return t},Object.defineProperties(_f.prototype,rm);var Eh=function(){this.state={},this.stateChanges={},this.deletedStates={}};Eh.prototype.updateState=function(t,i,u){var p=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][p]=this.stateChanges[t][p]||{},bt(this.stateChanges[t][p],u),null===this.deletedStates[t])for(var v in this.deletedStates[t]={},this.state[t])v!==p&&(this.deletedStates[t][v]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][p])for(var x in this.deletedStates[t][p]={},this.state[t][p])u[x]||(this.deletedStates[t][p][x]=null);else for(var C in u)this.deletedStates[t]&&this.deletedStates[t][p]&&null===this.deletedStates[t][p][C]&&delete this.deletedStates[t][p][C]},Eh.prototype.removeFeatureState=function(t,i,u){if(null!==this.deletedStates[t]){var p=String(i);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&void 0!==i)null!==this.deletedStates[t][p]&&(this.deletedStates[t][p]=this.deletedStates[t][p]||{},this.deletedStates[t][p][u]=null);else if(void 0!==i)if(this.stateChanges[t]&&this.stateChanges[t][p])for(u in this.deletedStates[t][p]={},this.stateChanges[t][p])this.deletedStates[t][p][u]=null;else this.deletedStates[t][p]=null;else this.deletedStates[t]=null}},Eh.prototype.getState=function(t,i){var u=String(i),p=bt({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var v=this.deletedStates[t][i];if(null===v)return{};for(var x in v)delete p[x]}return p},Eh.prototype.initializeTileState=function(t,i){t.setFeatureState(this.state,i)},Eh.prototype.coalesceChanges=function(t,i){var u={};for(var p in this.stateChanges){this.state[p]=this.state[p]||{};var v={};for(var x in this.stateChanges[p])this.state[p][x]||(this.state[p][x]={}),bt(this.state[p][x],this.stateChanges[p][x]),v[x]=this.state[p][x];u[p]=v}for(var C in this.deletedStates){this.state[C]=this.state[C]||{};var O={};if(null===this.deletedStates[C])for(var K in this.state[C])O[K]={},this.state[C][K]={};else for(var ie in this.deletedStates[C]){if(null===this.deletedStates[C][ie])this.state[C][ie]={};else for(var pe=0,Ee=Object.keys(this.deletedStates[C][ie]);pe<Ee.length;pe+=1)delete this.state[C][ie][Ee[pe]];O[ie]=this.state[C][ie]}u[C]=u[C]||{},bt(u[C],O)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(var Be in t)t[Be].setFeatureState(u,i)};var Wc=function(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new or(8192,16,0),this.grid3D=new or(8192,16,0),this.featureIndexArray=new Se,this.promoteId=i};function pp(t,i,u,p,v){return j(t,function(x,C){var O=i instanceof pn?i.get(C):null;return O&&O.evaluate?O.evaluate(u,p,v):O})}function im(t){for(var i=1/0,u=1/0,p=-1/0,v=-1/0,x=0,C=t;x<C.length;x+=1){var O=C[x];i=Math.min(i,O.x),u=Math.min(u,O.y),p=Math.max(p,O.x),v=Math.max(v,O.y)}return{minX:i,minY:u,maxX:p,maxY:v}}function Fm(t,i){return i-t}Wc.prototype.insert=function(t,i,u,p,v,x){var C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,v);for(var O=x?this.grid3D:this.grid,K=0;K<i.length;K++){for(var ie=i[K],pe=[1/0,1/0,-1/0,-1/0],Ee=0;Ee<ie.length;Ee++){var Be=ie[Ee];pe[0]=Math.min(pe[0],Be.x),pe[1]=Math.min(pe[1],Be.y),pe[2]=Math.max(pe[2],Be.x),pe[3]=Math.max(pe[3],Be.y)}pe[0]<8192&&pe[1]<8192&&pe[2]>=0&&pe[3]>=0&&O.insert(C,pe[0],pe[1],pe[2],pe[3])}},Wc.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Kl.VectorTile(new yh(this.rawTileData)).layers,this.sourceLayerCoder=new Rd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Wc.prototype.query=function(t,i,u,p){var v=this;this.loadVTLayers();for(var x=t.params||{},C=8192/t.tileSize/t.scale,O=va(x.filter),K=t.queryGeometry,ie=t.queryPadding*C,pe=im(K),Ee=this.grid.query(pe.minX-ie,pe.minY-ie,pe.maxX+ie,pe.maxY+ie),Be=im(t.cameraQueryGeometry),yt=0,Et=this.grid3D.query(Be.minX-ie,Be.minY-ie,Be.maxX+ie,Be.maxY+ie,function(fn,cn,Tn,qn){return function(ir,kr,pr,Ur,mr){for(var ri=0,Nr=ir;ri<Nr.length;ri+=1){var xr=Nr[ri];if(kr<=xr.x&&pr<=xr.y&&Ur>=xr.x&&mr>=xr.y)return!0}var ti=[new Re(kr,pr),new Re(kr,mr),new Re(Ur,mr),new Re(Ur,pr)];if(ir.length>2)for(var Kr=0,yi=ti;Kr<yi.length;Kr+=1)if(Wu(ir,yi[Kr]))return!0;for(var Or=0;Or<ir.length-1;Or++)if(Il(ir[Or],ir[Or+1],ti))return!0;return!1}(t.cameraQueryGeometry,fn-ie,cn-ie,Tn+ie,qn+ie)});yt<Et.length;yt+=1)Ee.push(Et[yt]);Ee.sort(Fm);for(var Vt,At={},Wt=function(fn){var cn=Ee[fn];if(cn!==Vt){Vt=cn;var Tn=v.featureIndexArray.get(cn),qn=null;v.loadMatchingFeature(At,Tn.bucketIndex,Tn.sourceLayerIndex,Tn.featureIndex,O,x.layers,x.availableImages,i,u,p,function(ir,kr,pr){return qn||(qn=Ei(ir)),kr.queryIntersectsFeature(K,ir,pr,qn,v.z,t.transform,C,t.pixelPosMatrix)})}},rn=0;rn<Ee.length;rn++)Wt(rn);return At},Wc.prototype.loadMatchingFeature=function(t,i,u,p,v,x,C,O,K,ie,pe){var Ee=this.bucketLayerIDs[i];if(!x||function(ir,kr){for(var pr=0;pr<ir.length;pr++)if(kr.indexOf(ir[pr])>=0)return!0;return!1}(x,Ee)){var Be=this.sourceLayerCoder.decode(u),Ye=this.vtLayers[Be].feature(p);if(v.needGeometry){var yt=Qi(Ye,!0);if(!v.filter(new V(this.tileID.overscaledZ),yt,this.tileID.canonical))return}else if(!v.filter(new V(this.tileID.overscaledZ),Ye))return;for(var Et=this.getId(Ye,Be),Vt=0;Vt<Ee.length;Vt++){var At=Ee[Vt];if(!(x&&x.indexOf(At)<0)){var Wt=O[At];if(Wt){var rn={};void 0!==Et&&ie&&(rn=ie.getState(Wt.sourceLayer||"_geojsonTileLayer",Et));var fn=bt({},K[At]);fn.paint=pp(fn.paint,Wt.paint,Ye,rn,C),fn.layout=pp(fn.layout,Wt.layout,Ye,rn,C);var cn=!pe||pe(Ye,Wt,rn);if(cn){var Tn=new _f(Ye,this.z,this.x,this.y,Et);Tn.layer=fn;var qn=t[At];void 0===qn&&(qn=t[At]=[]),qn.push({featureIndex:p,feature:Tn,intersectionZ:cn})}}}}}},Wc.prototype.lookupSymbolFeatures=function(t,i,u,p,v,x,C,O){var K={};this.loadVTLayers();for(var ie=va(v),pe=0,Ee=t;pe<Ee.length;pe+=1)this.loadMatchingFeature(K,u,p,Ee[pe],ie,x,C,O,i);return K},Wc.prototype.hasLayer=function(t){for(var i=0,u=this.bucketLayerIDs;i<u.length;i+=1)for(var p=0,v=u[i];p<v.length;p+=1)if(t===v[p])return!0;return!1},Wc.prototype.getId=function(t,i){var u=t.id;return this.promoteId&&"boolean"==typeof(u=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[i]])&&(u=Number(u)),u},tr("FeatureIndex",Wc,{omit:["rawTileData","sourceLayerCoder"]});var io=function(t,i){this.tileID=t,this.uid=ct(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};io.prototype.registerFadeDuration=function(t){var i=t+this.timeAdded;i<gr.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)},io.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},io.prototype.loadVectorData=function(t,i,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var p in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(ie,pe){var Ee={};if(!pe)return Ee;for(var Be=function(){var Et=yt[Ye],Vt=Et.layerIds.map(function(rn){return pe.getLayer(rn)}).filter(Boolean);if(0!==Vt.length){Et.layers=Vt,Et.stateDependentLayerIds&&(Et.stateDependentLayers=Et.stateDependentLayerIds.map(function(rn){return Vt.filter(function(fn){return fn.id===rn})[0]}));for(var At=0,Wt=Vt;At<Wt.length;At+=1)Ee[Wt[At].id]=Et}},Ye=0,yt=ie;Ye<yt.length;Ye+=1)Be();return Ee}(t.buckets,i.style),this.hasSymbolBuckets=!1,this.buckets){var v=this.buckets[p];if(v instanceof ro){if(this.hasSymbolBuckets=!0,!u)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var x in this.buckets){var C=this.buckets[x];if(C instanceof ro&&C.hasRTLText){this.hasRTLText=!0,Mi.isLoading()||Mi.isLoaded()||"deferred"!==il()||Zn();break}}for(var O in this.queryPadding=0,this.buckets){var K=this.buckets[O];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(O).queryRadius(K))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new d},io.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},io.prototype.getBucket=function(t){return this.buckets[t.id]},io.prototype.upload=function(t){for(var i in this.buckets){var u=this.buckets[i];u.uploadPending()&&u.upload(t)}var p=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new qc(t,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new qc(t,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)},io.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},io.prototype.queryRenderedFeatures=function(t,i,u,p,v,x,C,O,K,ie){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:v,scale:x,tileSize:this.tileSize,pixelPosMatrix:ie,transform:O,params:C,queryPadding:this.queryPadding*K},t,i,u):{}},io.prototype.querySourceFeatures=function(t,i){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var p=u.loadVTLayers(),v=i?i.sourceLayer:"",x=p._geojsonTileLayer||p[v];if(x)for(var C=va(i&&i.filter),O=this.tileID.canonical,K=O.z,ie=O.x,pe=O.y,Ee={z:K,x:ie,y:pe},Be=0;Be<x.length;Be++){var Ye=x.feature(Be);if(C.needGeometry){var yt=Qi(Ye,!0);if(!C.filter(new V(this.tileID.overscaledZ),yt,this.tileID.canonical))continue}else if(!C.filter(new V(this.tileID.overscaledZ),Ye))continue;var Et=u.getId(Ye,v),Vt=new _f(Ye,K,ie,pe,Et);Vt.tile=Ee,t.push(Vt)}}},io.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},io.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},io.prototype.setExpiryData=function(t){var i=this.expirationTime;if(t.cacheControl){var u=_e(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var p=Date.now(),v=!1;if(this.expirationTime>p)v=!1;else if(i)if(this.expirationTime<i)v=!0;else{var x=this.expirationTime-i;x?this.expirationTime=p+Math.max(x,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},io.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},io.prototype.setFeatureState=function(t,i){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var u=this.latestFeatureIndex.loadVTLayers();for(var p in this.buckets)if(i.style.hasLayer(p)){var v=this.buckets[p],x=v.layers[0].sourceLayer||"_geojsonTileLayer",C=u[x],O=t[x];if(C&&O&&0!==Object.keys(O).length){v.update(O,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});var K=i&&i.style&&i.style.getLayer(p);K&&(this.queryPadding=Math.max(this.queryPadding,K.queryRadius(v)))}}}},io.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},io.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<gr.now()},io.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},io.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=gr.now()+t},io.prototype.setDependencies=function(t,i){for(var u={},p=0,v=i;p<v.length;p+=1)u[v[p]]=!0;this.dependencies[t]=u},io.prototype.hasDependency=function(t,i){for(var u=0,p=t;u<p.length;u+=1){var v=this.dependencies[p[u]];if(v)for(var x=0,C=i;x<C.length;x+=1)if(v[C[x]])return!0}return!1};var Qh=fe.performance,om=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Qh.mark(this._marks.start)};om.prototype.finish=function(){Qh.mark(this._marks.end);var t=Qh.getEntriesByName(this._marks.measure);return 0===t.length&&(Qh.measure(this._marks.measure,this._marks.start,this._marks.end),t=Qh.getEntriesByName(this._marks.measure),Qh.clearMarks(this._marks.start),Qh.clearMarks(this._marks.end),Qh.clearMeasures(this._marks.measure)),t},g.Actor=Tc,g.AlphaImage=Qa,g.CanonicalTileID=Ql,g.CollisionBoxArray=d,g.Color=Fr,g.DEMData=jl,g.DataConstantProperty=wn,g.DictionaryCoder=Rd,g.EXTENT=8192,g.ErrorEvent=Dt,g.EvaluationParameters=V,g.Event=ot,g.Evented=Lt,g.FeatureIndex=Wc,g.FillBucket=yu,g.FillExtrusionBucket=Aa,g.ImageAtlas=Xl,g.ImagePosition=Al,g.LineBucket=ja,g.LngLat=qo,g.LngLatBounds=Rs,g.MercatorCoordinate=Pl,g.ONE_EM=24,g.OverscaledTileID=ts,g.Point=Re,g.Point$1=Re,g.Properties=Ro,g.Protobuf=yh,g.RGBAImage=pu,g.RequestManager=ii,g.RequestPerformance=om,g.ResourceType=Ht,g.SegmentVector=Xe,g.SourceFeatureState=Eh,g.StructArrayLayout1ui2=Fl,g.StructArrayLayout2f1f2i16=es,g.StructArrayLayout2i4=Jr,g.StructArrayLayout3ui6=xl,g.StructArrayLayout4i8=du,g.SymbolBucket=ro,g.Texture=qc,g.Tile=io,g.Transitionable=J,g.Uniform1f=$n,g.Uniform1i=Rn,g.Uniform2f=Vn,g.Uniform3f=cr,g.Uniform4f=yr,g.UniformColor=Z,g.UniformMatrix4f=Fe,g.UnwrappedTileID=Xh,g.ValidationError=Ie,g.WritingMode=ea,g.ZoomHistory=Ba,g.add=function(t,i,u){return t[0]=i[0]+u[0],t[1]=i[1]+u[1],t[2]=i[2]+u[2],t},g.addDynamicAttributes=lp,g.asyncAll=function(t,i,u){if(!t.length)return u(null,[]);var p=t.length,v=new Array(t.length),x=null;t.forEach(function(C,O){i(C,function(K,ie){K&&(x=K),v[O]=ie,0==--p&&u(x,v)})})},g.bezier=ae,g.bindAll=je,g.browser=gr,g.cacheEntryPossiblyAdded=function(t){++Ki>Mn&&(t.getActor().send("enforceCacheSizeLimit",sn),Ki=0)},g.clamp=St,g.clearTileCache=function(t){var i=fe.caches.delete("mapbox-tiles");t&&i.catch(t).then(function(){return t()})},g.clipLine=Om,g.clone=function(t){var i=new Fi(16);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},g.clone$1=ge,g.clone$2=function(t){var i=new Fi(3);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i},g.collisionCircleLayout=jc,g.config=lr,g.create=function(){var t=new Fi(16);return Fi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},g.create$1=function(){var t=new Fi(9);return Fi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},g.create$2=function(){var t=new Fi(4);return Fi!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},g.createCommonjsModule=nt,g.createExpression=ya,g.createLayout=Xi,g.createStyleLayer=function(t){return"custom"===t.type?new Lm(t):new dp[t.type](t)},g.cross=function(t,i,u){var p=i[0],v=i[1],x=i[2],C=u[0],O=u[1],K=u[2];return t[0]=v*K-x*O,t[1]=x*C-p*K,t[2]=p*O-v*C,t},g.deepEqual=function t(i,u){if(Array.isArray(i)){if(!Array.isArray(u)||i.length!==u.length)return!1;for(var p=0;p<i.length;p++)if(!t(i[p],u[p]))return!1;return!0}if("object"==typeof i&&null!==i&&null!==u){if("object"!=typeof u||Object.keys(i).length!==Object.keys(u).length)return!1;for(var v in i)if(!t(i[v],u[v]))return!1;return!0}return i===u},g.dot=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]},g.dot$1=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]+t[3]*i[3]},g.ease=$e,g.emitValidationErrors=on,g.endsWith=Ae,g.enforceCacheSizeLimit=function(t){Jn(),Wn&&Wn.then(function(i){i.keys().then(function(u){for(var p=0;p<u.length-t;p++)i.delete(u[p])})})},g.evaluateSizeForFeature=_h,g.evaluateSizeForZoom=$c,g.evaluateVariableOffset=Ic,g.evented=bl,g.extend=bt,g.featureFilter=va,g.filterObject=W,g.fromRotation=function(t,i){var u=Math.sin(i),p=Math.cos(i);return t[0]=p,t[1]=u,t[2]=0,t[3]=-u,t[4]=p,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},g.getAnchorAlignment=rp,g.getAnchorJustification=Wh,g.getArrayBuffer=dn,g.getImage=be,g.getJSON=function(t,i){return vt(bt(t,{type:"json"}),i)},g.getRTLTextPluginStatus=il,g.getReferrer=ke,g.getVideo=function(t,i){var u,p,v=fe.document.createElement("video");v.muted=!0,v.onloadstart=function(){i(null,v)};for(var x=0;x<t.length;x++){var C=fe.document.createElement("source");u=t[x],p=void 0,(p=fe.document.createElement("a")).href=u,(p.protocol!==fe.document.location.protocol||p.host!==fe.document.location.host)&&(v.crossOrigin="Anonymous"),C.src=t[x],v.appendChild(C)}return{cancel:function(){}}},g.identity=Va,g.invert=function(t,i){var u=i[0],p=i[1],v=i[2],x=i[3],C=i[4],O=i[5],K=i[6],ie=i[7],pe=i[8],Ee=i[9],Be=i[10],Ye=i[11],yt=i[12],Et=i[13],Vt=i[14],At=i[15],Wt=u*O-p*C,rn=u*K-v*C,fn=u*ie-x*C,cn=p*K-v*O,Tn=p*ie-x*O,qn=v*ie-x*K,ir=pe*Et-Ee*yt,kr=pe*Vt-Be*yt,pr=pe*At-Ye*yt,Ur=Ee*Vt-Be*Et,mr=Ee*At-Ye*Et,ri=Be*At-Ye*Vt,Nr=Wt*ri-rn*mr+fn*Ur+cn*pr-Tn*kr+qn*ir;return Nr?(t[0]=(O*ri-K*mr+ie*Ur)*(Nr=1/Nr),t[1]=(v*mr-p*ri-x*Ur)*Nr,t[2]=(Et*qn-Vt*Tn+At*cn)*Nr,t[3]=(Be*Tn-Ee*qn-Ye*cn)*Nr,t[4]=(K*pr-C*ri-ie*kr)*Nr,t[5]=(u*ri-v*pr+x*kr)*Nr,t[6]=(Vt*fn-yt*qn-At*rn)*Nr,t[7]=(pe*qn-Be*fn+Ye*rn)*Nr,t[8]=(C*mr-O*pr+ie*ir)*Nr,t[9]=(p*pr-u*mr-x*ir)*Nr,t[10]=(yt*Tn-Et*fn+At*Wt)*Nr,t[11]=(Ee*fn-pe*Tn-Ye*Wt)*Nr,t[12]=(O*kr-C*Ur-K*ir)*Nr,t[13]=(u*Ur-p*kr+v*ir)*Nr,t[14]=(Et*rn-yt*cn-Vt*Wt)*Nr,t[15]=(pe*cn-Ee*rn+Be*Wt)*Nr,t):null},g.isChar=rr,g.isMapboxURL=fi,g.keysDifference=function(t,i){var u=[];for(var p in t)p in i||u.push(p);return u},g.makeRequest=vt,g.mapObject=j,g.mercatorXfromLng=gf,g.mercatorYfromLat=nm,g.mercatorZfromAltitude=yf,g.mul=dc,g.multiply=Sa,g.mvt=Kl,g.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},g.normalize=function(t,i){var u=i[0],p=i[1],v=i[2],x=u*u+p*p+v*v;return x>0&&(x=1/Math.sqrt(x)),t[0]=i[0]*x,t[1]=i[1]*x,t[2]=i[2]*x,t},g.number=Ni,g.offscreenCanvasSupported=Li,g.ortho=function(t,i,u,p,v,x,C){var O=1/(i-u),K=1/(p-v),ie=1/(x-C);return t[0]=-2*O,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*K,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*ie,t[11]=0,t[12]=(i+u)*O,t[13]=(v+p)*K,t[14]=(C+x)*ie,t[15]=1,t},g.parseGlyphPBF=function(t){return new yh(t).readFields(ai,[])},g.pbf=yh,g.performSymbolLayout=function(t,i,u,p,v,x,C){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var O=t.layers[0].layout,K=t.layers[0]._unevaluatedLayout._values,ie={};if("composite"===t.textSizeData.kind){var pe=t.textSizeData,Ee=pe.maxZoom;ie.compositeTextSizes=[K["text-size"].possiblyEvaluate(new V(pe.minZoom),C),K["text-size"].possiblyEvaluate(new V(Ee),C)]}if("composite"===t.iconSizeData.kind){var Be=t.iconSizeData,Ye=Be.maxZoom;ie.compositeIconSizes=[K["icon-size"].possiblyEvaluate(new V(Be.minZoom),C),K["icon-size"].possiblyEvaluate(new V(Ye),C)]}ie.layoutTextSize=K["text-size"].possiblyEvaluate(new V(t.zoom+1),C),ie.layoutIconSize=K["icon-size"].possiblyEvaluate(new V(t.zoom+1),C),ie.textMaxSize=K["text-size"].possiblyEvaluate(new V(18));for(var yt=24*O.get("text-line-height"),Et="map"===O.get("text-rotation-alignment")&&"point"!==O.get("symbol-placement"),Vt=O.get("text-keep-upright"),At=O.get("text-size"),Wt=function(){var cn=fn[rn],Tn=O.get("text-font").evaluate(cn,{},C).join(","),qn=At.evaluate(cn,{},C),ir=ie.layoutTextSize.evaluate(cn,{},C),kr=ie.layoutIconSize.evaluate(cn,{},C),pr={horizontal:{},vertical:void 0},Ur=cn.text,mr=[0,0];if(Ur){var ri=Ur.toString(),Nr=24*O.get("text-letter-spacing").evaluate(cn,{},C),xr=function(Ti){for(var Do=0,ui=Ti;Do<ui.length;Do+=1)if(Ui=ui[Do].charCodeAt(0),rr.Arabic(Ui)||rr["Arabic Supplement"](Ui)||rr["Arabic Extended-A"](Ui)||rr["Arabic Presentation Forms-A"](Ui)||rr["Arabic Presentation Forms-B"](Ui))return!1;var Ui;return!0}(ri)?Nr:0,ti=O.get("text-anchor").evaluate(cn,{},C),Kr=O.get("text-variable-anchor");if(!Kr){var yi=O.get("text-radial-offset").evaluate(cn,{},C);mr=yi?Ic(ti,[24*yi,df]):O.get("text-offset").evaluate(cn,{},C).map(function(Ti){return 24*Ti})}var Or=Et?"center":O.get("text-justify").evaluate(cn,{},C),Gi=O.get("symbol-placement"),zo="point"===Gi?24*O.get("text-max-width").evaluate(cn,{},C):0,Wo=function(){t.allowVerticalPlacement&&Gu(ri)&&(pr.vertical=vu(Ur,i,u,v,Tn,zo,yt,ti,"left",xr,mr,ea.vertical,!0,Gi,ir,qn))};if(!Et&&Kr){for(var Vo="auto"===Or?Kr.map(function(Ti){return Wh(Ti)}):[Or],co=!1,Zo=0;Zo<Vo.length;Zo++){var ha=Vo[Zo];if(!pr.horizontal[ha])if(co)pr.horizontal[ha]=pr.horizontal[0];else{var ks=vu(Ur,i,u,v,Tn,zo,yt,"center",ha,xr,mr,ea.horizontal,!1,Gi,ir,qn);ks&&(pr.horizontal[ha]=ks,co=1===ks.positionedLines.length)}}Wo()}else{"auto"===Or&&(Or=Wh(ti));var Ou=vu(Ur,i,u,v,Tn,zo,yt,ti,Or,xr,mr,ea.horizontal,!1,Gi,ir,qn);Ou&&(pr.horizontal[Or]=Ou),Wo(),Gu(ri)&&Et&&Vt&&(pr.vertical=vu(Ur,i,u,v,Tn,zo,yt,ti,Or,xr,mr,ea.vertical,!1,Gi,ir,qn))}}var Ti,Do,Ui,Lu,wu,js=void 0,iu=!1;if(cn.icon&&cn.icon.name){var _s=p[cn.icon.name];_s&&(Ti=v[cn.icon.name],Do=O.get("icon-offset").evaluate(cn,{},C),Ui=rp(O.get("icon-anchor").evaluate(cn,{},C)),js={image:Ti,top:wu=Do[1]-Ti.displaySize[1]*Ui.verticalAlign,bottom:wu+Ti.displaySize[1],left:Lu=Do[0]-Ti.displaySize[0]*Ui.horizontalAlign,right:Lu+Ti.displaySize[0]},iu=_s.sdf,void 0===t.sdfIcons?t.sdfIcons=_s.sdf:t.sdfIcons!==_s.sdf&&U("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_s.pixelRatio!==t.pixelRatio||0!==O.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var Os=ap(pr.horizontal)||pr.vertical;t.iconsInText=!!Os&&Os.iconsInText,(Os||js)&&function(Ti,Do,ui,Ui,Lu,wu,Ko,Is,xu,Zi,Hl){var Nu=wu.textMaxSize.evaluate(Do,{});void 0===Nu&&(Nu=Ko);var Cc,vs=Ti.layers[0].layout,Dc=vs.get("icon-offset").evaluate(Do,{},Hl),al=ap(ui.horizontal),Ih=Ko/24,Ac=Ti.tilePixelRatio*Ih,ec=Ti.tilePixelRatio*Nu/24,Qu=Ti.tilePixelRatio*Is,Zc=Ti.tilePixelRatio*vs.get("symbol-spacing"),Mc=vs.get("text-padding")*Ti.tilePixelRatio,tc=vs.get("icon-padding")*Ti.tilePixelRatio,ul=vs.get("text-max-angle")/180*Math.PI,nc="map"===vs.get("text-rotation-alignment")&&"point"!==vs.get("symbol-placement"),mp="map"===vs.get("icon-rotation-alignment")&&"point"!==vs.get("symbol-placement"),Kc=vs.get("symbol-placement"),kd=Zc/2,Yc=vs.get("icon-text-fit");Ui&&"none"!==Yc&&(Ti.allowVerticalPlacement&&ui.vertical&&(Cc=Xp(Ui,ui.vertical,Yc,vs.get("icon-text-fit-padding"),Dc,Ih)),al&&(Ui=Xp(Ui,al,Yc,vs.get("icon-text-fit-padding"),Dc,Ih)));var Pc=function(Bd,Ud){Ud.x<0||Ud.x>=8192||Ud.y<0||Ud.y>=8192||function(bs,ic,sm,oc,If,Ah,_p,gl,Tf,Mh,od,zd,Rc,am,sd,um,Xc,sc,vp,Bm,Pa,bp,Um,$l,Eg){var ll,Qc,eh,ad,th,Ph=bs.addToLineVertexArray(ic,sm),wp=0,lm=0,zm=0,Vm=0,Vd=-1,jm=-1,Gl={},xp=gt(""),Sf=0,Hm=0;if(void 0===gl._unevaluatedLayout.getValue("text-radial-offset")?(Sf=(ll=gl.layout.get("text-offset").evaluate(Pa,{},$l).map(function(kc){return 24*kc}))[0],Hm=ll[1]):(Sf=24*gl.layout.get("text-radial-offset").evaluate(Pa,{},$l),Hm=df),bs.allowVerticalPlacement&&oc.vertical){var $m=gl.layout.get("text-rotate").evaluate(Pa,{},$l)+90;ad=new qh(Tf,ic,Mh,od,zd,oc.vertical,Rc,am,sd,$m),_p&&(th=new qh(Tf,ic,Mh,od,zd,_p,Xc,sc,sd,$m))}if(If){var jd=gl.layout.get("icon-rotate").evaluate(Pa,{}),Gm="none"!==gl.layout.get("icon-text-fit"),Cf=Gh(If,jd,Um,Gm),Df=_p?Gh(_p,jd,Um,Gm):void 0;eh=new qh(Tf,ic,Mh,od,zd,If,Xc,sc,!1,jd),wp=4*Cf.length;var Ep=bs.iconSizeData,cl=null;"source"===Ep.kind?(cl=[128*gl.layout.get("icon-size").evaluate(Pa,{})])[0]>32640&&U(bs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Ep.kind&&((cl=[128*bp.compositeIconSizes[0].evaluate(Pa,{},$l),128*bp.compositeIconSizes[1].evaluate(Pa,{},$l)])[0]>32640||cl[1]>32640)&&U(bs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),bs.addSymbols(bs.icon,Cf,cl,Bm,vp,Pa,!1,ic,Ph.lineStartIndex,Ph.lineLength,-1,$l),Vd=bs.icon.placedSymbolArray.length-1,Df&&(lm=4*Df.length,bs.addSymbols(bs.icon,Df,cl,Bm,vp,Pa,ea.vertical,ic,Ph.lineStartIndex,Ph.lineLength,-1,$l),jm=bs.icon.placedSymbolArray.length-1)}for(var Ig in oc.horizontal){var cm=oc.horizontal[Ig];if(!Qc){xp=gt(cm.text);var qm=gl.layout.get("text-rotate").evaluate(Pa,{},$l);Qc=new qh(Tf,ic,Mh,od,zd,cm,Rc,am,sd,qm)}var Ip=1===cm.positionedLines.length;if(zm+=Zh(bs,ic,cm,Ah,gl,sd,Pa,um,Ph,oc.vertical?ea.horizontal:ea.horizontalOnly,Ip?Object.keys(oc.horizontal):[Ig],Gl,Vd,bp,$l),Ip)break}oc.vertical&&(Vm+=Zh(bs,ic,oc.vertical,Ah,gl,sd,Pa,um,Ph,ea.vertical,["vertical"],Gl,jm,bp,$l));var Tp=Qc?Qc.boxStartIndex:bs.collisionBoxArray.length,Wm=Qc?Qc.boxEndIndex:bs.collisionBoxArray.length,Zm=ad?ad.boxStartIndex:bs.collisionBoxArray.length,Sp=ad?ad.boxEndIndex:bs.collisionBoxArray.length,Cp=eh?eh.boxStartIndex:bs.collisionBoxArray.length,Dp=eh?eh.boxEndIndex:bs.collisionBoxArray.length,Af=th?th.boxStartIndex:bs.collisionBoxArray.length,Km=th?th.boxEndIndex:bs.collisionBoxArray.length,ql=-1,Mf=function(kc,Mp){return kc&&kc.circleDiameter?Math.max(kc.circleDiameter,Mp):Mp};ql=Mf(Qc,ql),ql=Mf(ad,ql),ql=Mf(eh,ql);var Ap=(ql=Mf(th,ql))>-1?1:0;Ap&&(ql*=Eg/24),bs.glyphOffsetArray.length>=ro.MAX_GLYPHS&&U("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Pa.sortKey&&bs.addToSortKeyRanges(bs.symbolInstances.length,Pa.sortKey),bs.symbolInstances.emplaceBack(ic.x,ic.y,Gl.right>=0?Gl.right:-1,Gl.center>=0?Gl.center:-1,Gl.left>=0?Gl.left:-1,Gl.vertical||-1,Vd,jm,xp,Tp,Wm,Zm,Sp,Cp,Dp,Af,Km,Mh,zm,Vm,wp,lm,Ap,0,Rc,Sf,Hm,ql)}(Ti,Ud,Bd,ui,Ui,Lu,Cc,Ti.layers[0],Ti.collisionBoxArray,Do.index,Do.sourceLayerIndex,Ti.index,Ac,Mc,nc,xu,Qu,tc,mp,Dc,Do,wu,Zi,Hl,Ko)};if("line"===Kc)for(var Th=0,gp=Om(Do.geometry,0,0,8192,8192);Th<gp.length;Th+=1)for(var Od=gp[Th],ed=0,td=em(Od,Zc,ul,ui.vertical||al,Ui,24,ec,Ti.overscaling,8192);ed<td.length;ed+=1){var nd=td[ed];al&&bh(Ti,al.text,kd,nd)||Pc(Od,nd)}else if("line-center"===Kc)for(var Sh=0,vf=Do.geometry;Sh<vf.length;Sh+=1){var Ch=vf[Sh];if(Ch.length>1){var rd=Qp(Ch,ul,ui.vertical||al,Ui,24,ec);rd&&Pc(Ch,rd)}}else if("Polygon"===Do.type)for(var Dh=0,bf=Zl(Do.geometry,0);Dh<bf.length;Dh+=1){var Ld=bf[Dh],id=hf(Ld,16);Pc(Ld[0],new Hc(id.x,id.y,0))}else if("LineString"===Do.type)for(var Nd=0,wf=Do.geometry;Nd<wf.length;Nd+=1){var Jc=wf[Nd];Pc(Jc,new Hc(Jc[0].x,Jc[0].y,0))}else if("Point"===Do.type)for(var Fd=0,xf=Do.geometry;Fd<xf.length;Fd+=1)for(var yp=0,Ef=xf[Fd];yp<Ef.length;yp+=1){var rc=Ef[yp];Pc([rc],new Hc(rc.x,rc.y,0))}}(t,cn,pr,js,p,ie,ir,kr,mr,iu,C)},rn=0,fn=t.features;rn<fn.length;rn+=1)Wt();x&&t.generateCollisionDebugBuffers()},g.perspective=function(t,i,u,p,v){var x,C=1/Math.tan(i/2);return t[0]=C/u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=C,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=v&&v!==1/0?(t[10]=(v+p)*(x=1/(p-v)),t[14]=2*v*p*x):(t[10]=-1,t[14]=-2*p),t},g.pick=function(t,i){for(var u={},p=0;p<i.length;p++){var v=i[p];v in t&&(u[v]=t[v])}return u},g.plugin=Mi,g.polygonIntersectsPolygon=Xa,g.postMapLoadEvent=zt,g.postTurnstileEvent=re,g.potpack=Un,g.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],g.register=tr,g.registerForPluginStateChange=function(t){return t({pluginStatus:Qo,pluginURL:So}),bl.on("pluginStateChange",t),t},g.renderColorRamp=Js,g.rotate=function(t,i,u){var p=i[0],v=i[1],x=i[2],C=i[3],O=Math.sin(u),K=Math.cos(u);return t[0]=p*K+x*O,t[1]=v*K+C*O,t[2]=p*-O+x*K,t[3]=v*-O+C*K,t},g.rotateX=function(t,i,u){var p=Math.sin(u),v=Math.cos(u),x=i[4],C=i[5],O=i[6],K=i[7],ie=i[8],pe=i[9],Ee=i[10],Be=i[11];return i!==t&&(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[4]=x*v+ie*p,t[5]=C*v+pe*p,t[6]=O*v+Ee*p,t[7]=K*v+Be*p,t[8]=ie*v-x*p,t[9]=pe*v-C*p,t[10]=Ee*v-O*p,t[11]=Be*v-K*p,t},g.rotateZ=function(t,i,u){var p=Math.sin(u),v=Math.cos(u),x=i[0],C=i[1],O=i[2],K=i[3],ie=i[4],pe=i[5],Ee=i[6],Be=i[7];return i!==t&&(t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[0]=x*v+ie*p,t[1]=C*v+pe*p,t[2]=O*v+Ee*p,t[3]=K*v+Be*p,t[4]=ie*v-x*p,t[5]=pe*v-C*p,t[6]=Ee*v-O*p,t[7]=Be*v-K*p,t},g.scale=function(t,i,u){var p=u[0],v=u[1],x=u[2];return t[0]=i[0]*p,t[1]=i[1]*p,t[2]=i[2]*p,t[3]=i[3]*p,t[4]=i[4]*v,t[5]=i[5]*v,t[6]=i[6]*v,t[7]=i[7]*v,t[8]=i[8]*x,t[9]=i[9]*x,t[10]=i[10]*x,t[11]=i[11]*x,t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},g.scale$1=function(t,i,u){return t[0]=i[0]*u,t[1]=i[1]*u,t[2]=i[2]*u,t[3]=i[3]*u,t},g.scale$2=function(t,i,u){return t[0]=i[0]*u,t[1]=i[1]*u,t[2]=i[2]*u,t},g.setCacheLimits=function(t,i){sn=t,Mn=i},g.setRTLTextPlugin=function(t,i,u){if(void 0===u&&(u=!1),"deferred"===Qo||"loading"===Qo||"loaded"===Qo)throw new Error("setRTLTextPlugin cannot be called multiple times.");So=gr.resolveURL(t),Qo="deferred",qu=i,aa(),u||Zn()},g.sphericalToCartesian=function(t){var i=t[0],u=t[1],p=t[2];return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:i*Math.cos(u)*Math.sin(p),y:i*Math.sin(u)*Math.sin(p),z:i*Math.cos(p)}},g.sqrLen=function(t){var i=t[0],u=t[1];return i*i+u*u},g.styleSpec=Je,g.sub=function(t,i,u){return t[0]=i[0]-u[0],t[1]=i[1]-u[1],t[2]=i[2]-u[2],t},g.symbolSize=Id,g.transformMat3=function(t,i,u){var p=i[0],v=i[1],x=i[2];return t[0]=p*u[0]+v*u[3]+x*u[6],t[1]=p*u[1]+v*u[4]+x*u[7],t[2]=p*u[2]+v*u[5]+x*u[8],t},g.transformMat4=Ku,g.translate=function(t,i,u){var p,v,x,C,O,K,ie,pe,Ee,Be,Ye,yt,Et=u[0],Vt=u[1],At=u[2];return i===t?(t[12]=i[0]*Et+i[4]*Vt+i[8]*At+i[12],t[13]=i[1]*Et+i[5]*Vt+i[9]*At+i[13],t[14]=i[2]*Et+i[6]*Vt+i[10]*At+i[14],t[15]=i[3]*Et+i[7]*Vt+i[11]*At+i[15]):(v=i[1],x=i[2],C=i[3],O=i[4],K=i[5],ie=i[6],pe=i[7],Ee=i[8],Be=i[9],Ye=i[10],yt=i[11],t[0]=p=i[0],t[1]=v,t[2]=x,t[3]=C,t[4]=O,t[5]=K,t[6]=ie,t[7]=pe,t[8]=Ee,t[9]=Be,t[10]=Ye,t[11]=yt,t[12]=p*Et+O*Vt+Ee*At+i[12],t[13]=v*Et+K*Vt+Be*At+i[13],t[14]=x*Et+ie*Vt+Ye*At+i[14],t[15]=C*Et+pe*Vt+yt*At+i[15]),t},g.triggerPluginCompletionEvent=hu,g.uniqueId=ct,g.validateCustomStyleLayer=function(t){var i=[],u=t.id;return void 0===u&&i.push({message:"layers."+u+': missing required property "id"'}),void 0===t.render&&i.push({message:"layers."+u+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&i.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),i},g.validateLight=Mt,g.validateStyle=Ze,g.values=function(t){var i=[];for(var u in t)i.push(t[u]);return i},g.vectorTile=Kl,g.version="1.13.0",g.warnOnce=U,g.webpSupported=Er,g.window=fe,g.wrap=pt}),ue(0,function(g){function nt(ce){var be=typeof ce;if("number"===be||"boolean"===be||"string"===be||null==ce)return JSON.stringify(ce);if(Array.isArray(ce)){for(var Oe="[",Qe=0,ot=ce;Qe<ot.length;Qe+=1)Oe+=nt(ot[Qe])+",";return Oe+"]"}for(var Dt=Object.keys(ce).sort(),Lt="{",Je=0;Je<Dt.length;Je++)Lt+=JSON.stringify(Dt[Je])+":"+nt(ce[Dt[Je]])+",";return Lt+"}"}function xe(ce){for(var be="",Oe=0,Qe=g.refProperties;Oe<Qe.length;Oe+=1)be+="/"+nt(ce[Qe[Oe]]);return be}var Le=function(ce){this.keyCache={},ce&&this.replace(ce)};Le.prototype.replace=function(ce){this._layerConfigs={},this._layers={},this.update(ce,[])},Le.prototype.update=function(ce,be){for(var Oe=this,Qe=0,ot=ce;Qe<ot.length;Qe+=1){var Dt=ot[Qe];this._layerConfigs[Dt.id]=Dt;var Lt=this._layers[Dt.id]=g.createStyleLayer(Dt);Lt._featureFilter=g.featureFilter(Lt.filter),this.keyCache[Dt.id]&&delete this.keyCache[Dt.id]}for(var Je=0,Ie=be;Je<Ie.length;Je+=1){var ze=Ie[Je];delete this.keyCache[ze],delete this._layerConfigs[ze],delete this._layers[ze]}this.familiesBySource={};for(var Ve=0,mt=function(Yn,Hn){for(var Ir={},Xn=0;Xn<Yn.length;Xn++){var br=Hn&&Hn[Yn[Xn].id]||xe(Yn[Xn]);Hn&&(Hn[Yn[Xn].id]=br);var yn=Ir[br];yn||(yn=Ir[br]=[]),yn.push(Yn[Xn])}var ur=[];for(var Dr in Ir)ur.push(Ir[Dr]);return ur}(g.values(this._layerConfigs),this.keyCache);Ve<mt.length;Ve+=1){var Tt=mt[Ve].map(function(Yn){return Oe._layers[Yn.id]}),en=Tt[0];if("none"!==en.visibility){var Dn=en.source||"",zn=this.familiesBySource[Dn];zn||(zn=this.familiesBySource[Dn]={});var an=en.sourceLayer||"_geojsonTileLayer",Kn=zn[an];Kn||(Kn=zn[an]=[]),Kn.push(Tt)}}};var Re=function(ce){var be={},Oe=[];for(var Qe in ce){var ot=ce[Qe],Dt=be[Qe]={};for(var Lt in ot){var Je=ot[+Lt];if(Je&&0!==Je.bitmap.width&&0!==Je.bitmap.height){var Ie={x:0,y:0,w:Je.bitmap.width+2,h:Je.bitmap.height+2};Oe.push(Ie),Dt[Lt]={rect:Ie,metrics:Je.metrics}}}}var ze=g.potpack(Oe),Ve=new g.AlphaImage({width:ze.w||1,height:ze.h||1});for(var mt in ce){var Tt=ce[mt];for(var en in Tt){var Dn=Tt[+en];if(Dn&&0!==Dn.bitmap.width&&0!==Dn.bitmap.height){var zn=be[mt][en].rect;g.AlphaImage.copy(Dn.bitmap,Ve,{x:0,y:0},{x:zn.x+1,y:zn.y+1},Dn.bitmap)}}}this.image=Ve,this.positions=be};g.register("GlyphAtlas",Re);var Ue=function(ce){this.tileID=new g.OverscaledTileID(ce.tileID.overscaledZ,ce.tileID.wrap,ce.tileID.canonical.z,ce.tileID.canonical.x,ce.tileID.canonical.y),this.uid=ce.uid,this.zoom=ce.zoom,this.pixelRatio=ce.pixelRatio,this.tileSize=ce.tileSize,this.source=ce.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ce.showCollisionBoxes,this.collectResourceTiming=!!ce.collectResourceTiming,this.returnDependencies=!!ce.returnDependencies,this.promoteId=ce.promoteId};function fe(ce,be,Oe){for(var Qe=new g.EvaluationParameters(be),ot=0,Dt=ce;ot<Dt.length;ot+=1)Dt[ot].recalculate(Qe,Oe)}function se(ce,be){var Oe=g.getArrayBuffer(ce.request,function(Qe,ot,Dt,Lt){Qe?be(Qe):ot&&be(null,{vectorTile:new g.vectorTile.VectorTile(new g.pbf(ot)),rawData:ot,cacheControl:Dt,expires:Lt})});return function(){Oe.cancel(),be()}}Ue.prototype.parse=function(ce,be,Oe,Qe,ot){var Dt=this;this.status="parsing",this.data=ce,this.collisionBoxArray=new g.CollisionBoxArray;var Lt=new g.DictionaryCoder(Object.keys(ce.layers).sort()),Je=new g.FeatureIndex(this.tileID,this.promoteId);Je.bucketLayerIDs=[];var Ie,ze,Ve,mt,Tt={},en={featureIndex:Je,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Oe},Dn=be.familiesBySource[this.source];for(var zn in Dn){var an=ce.layers[zn];if(an){1===an.version&&g.warnOnce('Vector tile source "'+this.source+'" layer "'+zn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Kn=Lt.encode(zn),Yn=[],Hn=0;Hn<an.length;Hn++){var Ir=an.feature(Hn),Xn=Je.getId(Ir,zn);Yn.push({feature:Ir,id:Xn,index:Hn,sourceLayerIndex:Kn})}for(var br=0,yn=Dn[zn];br<yn.length;br+=1){var ur=yn[br],Dr=ur[0];Dr.minzoom&&this.zoom<Math.floor(Dr.minzoom)||Dr.maxzoom&&this.zoom>=Dr.maxzoom||"none"!==Dr.visibility&&(fe(ur,this.zoom,Oe),(Tt[Dr.id]=Dr.createBucket({index:Je.bucketLayerIDs.length,layers:ur,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kn,sourceID:this.source})).populate(Yn,en,this.tileID.canonical),Je.bucketLayerIDs.push(ur.map(function(Mr){return Mr.id})))}}}var jr=g.mapObject(en.glyphDependencies,function(Mr){return Object.keys(Mr).map(Number)});Object.keys(jr).length?Qe.send("getGlyphs",{uid:this.uid,stacks:jr},function(Mr,Gr){Ie||(Ie=Mr,ze=Gr,Ci.call(Dt))}):ze={};var oo=Object.keys(en.iconDependencies);oo.length?Qe.send("getImages",{icons:oo,source:this.source,tileID:this.tileID,type:"icons"},function(Mr,Gr){Ie||(Ie=Mr,Ve=Gr,Ci.call(Dt))}):Ve={};var zr=Object.keys(en.patternDependencies);function Ci(){if(Ie)return ot(Ie);if(ze&&Ve&&mt){var Mr=new Re(ze),Gr=new g.ImageAtlas(Ve,mt);for(var Fr in Tt){var Vr=Tt[Fr];Vr instanceof g.SymbolBucket?(fe(Vr.layers,this.zoom,Oe),g.performSymbolLayout(Vr,ze,Mr.positions,Ve,Gr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Vr.hasPattern&&(Vr instanceof g.LineBucket||Vr instanceof g.FillBucket||Vr instanceof g.FillExtrusionBucket)&&(fe(Vr.layers,this.zoom,Oe),Vr.addFeatures(en,this.tileID.canonical,Gr.patternPositions))}this.status="done",ot(null,{buckets:g.values(Tt).filter(function(hs){return!hs.isEmpty()}),featureIndex:Je,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Mr.image,imageAtlas:Gr,glyphMap:this.returnDependencies?ze:null,iconMap:this.returnDependencies?Ve:null,glyphPositions:this.returnDependencies?Mr.positions:null})}}zr.length?Qe.send("getImages",{icons:zr,source:this.source,tileID:this.tileID,type:"patterns"},function(Mr,Gr){Ie||(Ie=Mr,mt=Gr,Ci.call(Dt))}):mt={},Ci.call(this)};var ae=function(ce,be,Oe,Qe){this.actor=ce,this.layerIndex=be,this.availableImages=Oe,this.loadVectorData=Qe||se,this.loading={},this.loaded={}};ae.prototype.loadTile=function(ce,be){var Oe=this,Qe=ce.uid;this.loading||(this.loading={});var ot=!!(ce&&ce.request&&ce.request.collectResourceTiming)&&new g.RequestPerformance(ce.request),Dt=this.loading[Qe]=new Ue(ce);Dt.abort=this.loadVectorData(ce,function(Lt,Je){if(delete Oe.loading[Qe],Lt||!Je)return Dt.status="done",Oe.loaded[Qe]=Dt,be(Lt);var Ie=Je.rawData,ze={};Je.expires&&(ze.expires=Je.expires),Je.cacheControl&&(ze.cacheControl=Je.cacheControl);var Ve={};if(ot){var mt=ot.finish();mt&&(Ve.resourceTiming=JSON.parse(JSON.stringify(mt)))}Dt.vectorTile=Je.vectorTile,Dt.parse(Je.vectorTile,Oe.layerIndex,Oe.availableImages,Oe.actor,function(Tt,en){if(Tt||!en)return be(Tt);be(null,g.extend({rawTileData:Ie.slice(0)},en,ze,Ve))}),Oe.loaded=Oe.loaded||{},Oe.loaded[Qe]=Dt})},ae.prototype.reloadTile=function(ce,be){var Oe=this,Qe=this.loaded,ot=ce.uid,Dt=this;if(Qe&&Qe[ot]){var Lt=Qe[ot];Lt.showCollisionBoxes=ce.showCollisionBoxes;var Je=function(Ie,ze){var Ve=Lt.reloadCallback;Ve&&(delete Lt.reloadCallback,Lt.parse(Lt.vectorTile,Dt.layerIndex,Oe.availableImages,Dt.actor,Ve)),be(Ie,ze)};"parsing"===Lt.status?Lt.reloadCallback=Je:"done"===Lt.status&&(Lt.vectorTile?Lt.parse(Lt.vectorTile,this.layerIndex,this.availableImages,this.actor,Je):Je())}},ae.prototype.abortTile=function(ce,be){var Oe=this.loading,Qe=ce.uid;Oe&&Oe[Qe]&&Oe[Qe].abort&&(Oe[Qe].abort(),delete Oe[Qe]),be()},ae.prototype.removeTile=function(ce,be){var Oe=this.loaded,Qe=ce.uid;Oe&&Oe[Qe]&&delete Oe[Qe],be()};var $e=g.window.ImageBitmap,St=function(){this.loaded={}};function pt(ce,be){if(0!==ce.length){bt(ce[0],be);for(var Oe=1;Oe<ce.length;Oe++)bt(ce[Oe],!be)}}function bt(ce,be){for(var Oe=0,Qe=0,ot=ce.length,Dt=ot-1;Qe<ot;Dt=Qe++)Oe+=(ce[Qe][0]-ce[Dt][0])*(ce[Dt][1]+ce[Qe][1]);Oe>=0!=!!be&&ce.reverse()}St.prototype.loadTile=function(ce,be){var Oe=ce.uid,Qe=ce.encoding,ot=ce.rawImageData,Dt=$e&&ot instanceof $e?this.getImageData(ot):ot,Lt=new g.DEMData(Oe,Dt,Qe);this.loaded=this.loaded||{},this.loaded[Oe]=Lt,be(null,Lt)},St.prototype.getImageData=function(ce){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ce.width,ce.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=ce.width,this.offscreenCanvas.height=ce.height,this.offscreenCanvasContext.drawImage(ce,0,0,ce.width,ce.height);var be=this.offscreenCanvasContext.getImageData(-1,-1,ce.width+2,ce.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new g.RGBAImage({width:be.width,height:be.height},be.data)},St.prototype.removeTile=function(ce){var be=this.loaded,Oe=ce.uid;be&&be[Oe]&&delete be[Oe]};var Ct=g.vectorTile.VectorTileFeature.prototype.toGeoJSON,ct=function(ce){this._feature=ce,this.extent=g.EXTENT,this.type=ce.type,this.properties=ce.tags,"id"in ce&&!isNaN(ce.id)&&(this.id=parseInt(ce.id,10))};ct.prototype.loadGeometry=function(){if(1===this._feature.type){for(var ce=[],be=0,Oe=this._feature.geometry;be<Oe.length;be+=1){var Qe=Oe[be];ce.push([new g.Point$1(Qe[0],Qe[1])])}return ce}for(var ot=[],Dt=0,Lt=this._feature.geometry;Dt<Lt.length;Dt+=1){for(var Je=[],Ie=0,ze=Lt[Dt];Ie<ze.length;Ie+=1){var Ve=ze[Ie];Je.push(new g.Point$1(Ve[0],Ve[1]))}ot.push(Je)}return ot},ct.prototype.toGeoJSON=function(ce,be,Oe){return Ct.call(this,ce,be,Oe)};var ut=function(ce){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=g.EXTENT,this.length=ce.length,this._features=ce};ut.prototype.feature=function(ce){return new ct(this._features[ce])};var he=g.vectorTile.VectorTileFeature,je=Ae;function Ae(ce,be){this.options=be||{},this.features=ce,this.length=ce.length}function j(ce,be){this.id="number"==typeof ce.id?ce.id:void 0,this.type=ce.type,this.rawGeometry=1===ce.type?[ce.geometry]:ce.geometry,this.properties=ce.tags,this.extent=be||4096}Ae.prototype.feature=function(ce){return new j(this.features[ce],this.options.extent)},j.prototype.loadGeometry=function(){var ce=this.rawGeometry;this.geometry=[];for(var be=0;be<ce.length;be++){for(var Oe=ce[be],Qe=[],ot=0;ot<Oe.length;ot++)Qe.push(new g.Point$1(Oe[ot][0],Oe[ot][1]));this.geometry.push(Qe)}return this.geometry},j.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ce=this.geometry,be=1/0,Oe=-1/0,Qe=1/0,ot=-1/0,Dt=0;Dt<ce.length;Dt++)for(var Lt=ce[Dt],Je=0;Je<Lt.length;Je++){var Ie=Lt[Je];be=Math.min(be,Ie.x),Oe=Math.max(Oe,Ie.x),Qe=Math.min(Qe,Ie.y),ot=Math.max(ot,Ie.y)}return[be,Qe,Oe,ot]},j.prototype.toGeoJSON=he.prototype.toGeoJSON;var W=q,ge=je;function q(ce){var be=new g.pbf;return function(Oe,Qe){for(var ot in Oe.layers)Qe.writeMessage(3,U,Oe.layers[ot])}(ce,be),be.finish()}function U(ce,be){var Oe;be.writeVarintField(15,ce.version||1),be.writeStringField(1,ce.name||""),be.writeVarintField(5,ce.extent||4096);var Qe={keys:[],values:[],keycache:{},valuecache:{}};for(Oe=0;Oe<ce.length;Oe++)Qe.feature=ce.feature(Oe),be.writeMessage(2,Y,Qe);var ot=Qe.keys;for(Oe=0;Oe<ot.length;Oe++)be.writeStringField(3,ot[Oe]);var Dt=Qe.values;for(Oe=0;Oe<Dt.length;Oe++)be.writeMessage(4,rt,Dt[Oe])}function Y(ce,be){var Oe=ce.feature;void 0!==Oe.id&&be.writeVarintField(1,Oe.id),be.writeMessage(2,ee,ce),be.writeVarintField(3,Oe.type),be.writeMessage(4,We,Oe)}function ee(ce,be){var Oe=ce.feature,Qe=ce.keys,ot=ce.values,Dt=ce.keycache,Lt=ce.valuecache;for(var Je in Oe.properties){var Ie=Dt[Je];void 0===Ie&&(Qe.push(Je),Dt[Je]=Ie=Qe.length-1),be.writeVarint(Ie);var ze=Oe.properties[Je],Ve=typeof ze;"string"!==Ve&&"boolean"!==Ve&&"number"!==Ve&&(ze=JSON.stringify(ze));var mt=Ve+":"+ze,Tt=Lt[mt];void 0===Tt&&(ot.push(ze),Lt[mt]=Tt=ot.length-1),be.writeVarint(Tt)}}function Pe(ce,be){return(be<<3)+(7&ce)}function _e(ce){return ce<<1^ce>>31}function We(ce,be){for(var Oe=ce.loadGeometry(),Qe=ce.type,ot=0,Dt=0,Lt=Oe.length,Je=0;Je<Lt;Je++){var Ie=Oe[Je],ze=1;1===Qe&&(ze=Ie.length),be.writeVarint(Pe(1,ze));for(var Ve=3===Qe?Ie.length-1:Ie.length,mt=0;mt<Ve;mt++){1===mt&&1!==Qe&&be.writeVarint(Pe(2,Ve-1));var Tt=Ie[mt].x-ot,en=Ie[mt].y-Dt;be.writeVarint(_e(Tt)),be.writeVarint(_e(en)),ot+=Tt,Dt+=en}3===Qe&&be.writeVarint(Pe(7,1))}}function rt(ce,be){var Oe=typeof ce;"string"===Oe?be.writeStringField(1,ce):"boolean"===Oe?be.writeBooleanField(7,ce):"number"===Oe&&(ce%1!=0?be.writeDoubleField(3,ce):ce<0?be.writeSVarintField(6,ce):be.writeVarintField(5,ce))}function _t(ce,be,Oe,Qe){ft(ce,Oe,Qe),ft(be,2*Oe,2*Qe),ft(be,2*Oe+1,2*Qe+1)}function ft(ce,be,Oe){var Qe=ce[be];ce[be]=ce[Oe],ce[Oe]=Qe}function Zt(ce,be,Oe,Qe){var ot=ce-Oe,Dt=be-Qe;return ot*ot+Dt*Dt}W.fromVectorTileJs=q,W.fromGeojsonVt=function(ce,be){be=be||{};var Oe={};for(var Qe in ce)Oe[Qe]=new je(ce[Qe].features,be),Oe[Qe].name=Qe,Oe[Qe].version=be.version,Oe[Qe].extent=be.extent;return q({layers:Oe})},W.GeoJSONWrapper=ge;var nn=function(ce){return ce[0]},qt=function(ce){return ce[1]},An=function(ce,be,Oe,Qe,ot){void 0===be&&(be=nn),void 0===Oe&&(Oe=qt),void 0===Qe&&(Qe=64),void 0===ot&&(ot=Float64Array),this.nodeSize=Qe,this.points=ce;for(var Dt=ce.length<65536?Uint16Array:Uint32Array,Lt=this.ids=new Dt(ce.length),Je=this.coords=new ot(2*ce.length),Ie=0;Ie<ce.length;Ie++)Lt[Ie]=Ie,Je[2*Ie]=be(ce[Ie]),Je[2*Ie+1]=Oe(ce[Ie]);!function ze(Ve,mt,Tt,en,Dn,zn){if(!(Dn-en<=Tt)){var an=en+Dn>>1;(function Kn(Yn,Hn,Ir,Xn,br,yn){for(;br>Xn;){if(br-Xn>600){var ur=br-Xn+1,Dr=Ir-Xn+1,jr=Math.log(ur),oo=.5*Math.exp(2*jr/3),zr=.5*Math.sqrt(jr*oo*(ur-oo)/ur)*(Dr-ur/2<0?-1:1);Kn(Yn,Hn,Ir,Math.max(Xn,Math.floor(Ir-Dr*oo/ur+zr)),Math.min(br,Math.floor(Ir+(ur-Dr)*oo/ur+zr)),yn)}var Ci=Hn[2*Ir+yn],Mr=Xn,Gr=br;for(_t(Yn,Hn,Xn,Ir),Hn[2*br+yn]>Ci&&_t(Yn,Hn,Xn,br);Mr<Gr;){for(_t(Yn,Hn,Mr,Gr),Mr++,Gr--;Hn[2*Mr+yn]<Ci;)Mr++;for(;Hn[2*Gr+yn]>Ci;)Gr--}Hn[2*Xn+yn]===Ci?_t(Yn,Hn,Xn,Gr):_t(Yn,Hn,++Gr,br),Gr<=Ir&&(Xn=Gr+1),Ir<=Gr&&(br=Gr-1)}})(Ve,mt,an,en,Dn,zn%2),ze(Ve,mt,Tt,en,an-1,zn+1),ze(Ve,mt,Tt,an+1,Dn,zn+1)}}(Lt,Je,Qe,0,Lt.length-1,0)};An.prototype.range=function(ce,be,Oe,Qe){return function(ot,Dt,Lt,Je,Ie,ze,Ve){for(var mt,Tt,en=[0,ot.length-1,0],Dn=[];en.length;){var zn=en.pop(),an=en.pop(),Kn=en.pop();if(an-Kn<=Ve)for(var Yn=Kn;Yn<=an;Yn++)Tt=Dt[2*Yn+1],(mt=Dt[2*Yn])>=Lt&&mt<=Ie&&Tt>=Je&&Tt<=ze&&Dn.push(ot[Yn]);else{var Hn=Math.floor((Kn+an)/2);Tt=Dt[2*Hn+1],(mt=Dt[2*Hn])>=Lt&&mt<=Ie&&Tt>=Je&&Tt<=ze&&Dn.push(ot[Hn]);var Ir=(zn+1)%2;(0===zn?Lt<=mt:Je<=Tt)&&(en.push(Kn),en.push(Hn-1),en.push(Ir)),(0===zn?Ie>=mt:ze>=Tt)&&(en.push(Hn+1),en.push(an),en.push(Ir))}}return Dn}(this.ids,this.coords,ce,be,Oe,Qe,this.nodeSize)},An.prototype.within=function(ce,be,Oe){return function(Qe,ot,Dt,Lt,Je,Ie){for(var ze=[0,Qe.length-1,0],Ve=[],mt=Je*Je;ze.length;){var Tt=ze.pop(),en=ze.pop(),Dn=ze.pop();if(en-Dn<=Ie)for(var zn=Dn;zn<=en;zn++)Zt(ot[2*zn],ot[2*zn+1],Dt,Lt)<=mt&&Ve.push(Qe[zn]);else{var an=Math.floor((Dn+en)/2),Kn=ot[2*an],Yn=ot[2*an+1];Zt(Kn,Yn,Dt,Lt)<=mt&&Ve.push(Qe[an]);var Hn=(Tt+1)%2;(0===Tt?Dt-Je<=Kn:Lt-Je<=Yn)&&(ze.push(Dn),ze.push(an-1),ze.push(Hn)),(0===Tt?Dt+Je>=Kn:Lt+Je>=Yn)&&(ze.push(an+1),ze.push(en),ze.push(Hn))}}return Ve}(this.ids,this.coords,ce,be,Oe,this.nodeSize)};var kn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ce){return ce}},jn=function(ce){this.options=qi(Object.create(kn),ce),this.trees=new Array(this.options.maxZoom+1)};function gr(ce,be,Oe,Qe,ot){return{x:ce,y:be,zoom:1/0,id:Oe,parentId:-1,numPoints:Qe,properties:ot}}function lr(ce,be){var Oe=ce.geometry.coordinates,Qe=Oe[1];return{x:di(Oe[0]),y:vr(Qe),zoom:1/0,index:be,parentId:-1}}function Er(ce){return{type:"Feature",id:ce.id,properties:Sr(ce),geometry:{type:"Point",coordinates:[(Qe=ce.x,360*(Qe-.5)),(be=ce.y,Oe=(180-360*be)*Math.PI/180,360*Math.atan(Math.exp(Oe))/Math.PI-90)]}};var be,Oe,Qe}function Sr(ce){var be=ce.numPoints,Oe=be>=1e4?Math.round(be/1e3)+"k":be>=1e3?Math.round(be/100)/10+"k":be;return qi(qi({},ce.properties),{cluster:!0,cluster_id:ce.id,point_count:be,point_count_abbreviated:Oe})}function di(ce){return ce/360+.5}function vr(ce){var be=Math.sin(ce*Math.PI/180),Oe=.5-.25*Math.log((1+be)/(1-be))/Math.PI;return Oe<0?0:Oe>1?1:Oe}function qi(ce,be){for(var Oe in be)ce[Oe]=be[Oe];return ce}function ii(ce){return ce.x}function fi(ce){return ce.y}function bi(ce,be,Oe,Qe,ot,Dt){var Lt=ot-Oe,Je=Dt-Qe;if(0!==Lt||0!==Je){var Ie=((ce-Oe)*Lt+(be-Qe)*Je)/(Lt*Lt+Je*Je);Ie>1?(Oe=ot,Qe=Dt):Ie>0&&(Oe+=Lt*Ie,Qe+=Je*Ie)}return(Lt=ce-Oe)*Lt+(Je=be-Qe)*Je}function pi(ce,be,Oe,Qe){var ot={id:void 0===ce?null:ce,type:be,geometry:Oe,tags:Qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Dt){var Lt=Dt.geometry,Je=Dt.type;if("Point"===Je||"MultiPoint"===Je||"LineString"===Je)oi(Dt,Lt);else if("Polygon"===Je||"MultiLineString"===Je)for(var Ie=0;Ie<Lt.length;Ie++)oi(Dt,Lt[Ie]);else if("MultiPolygon"===Je)for(Ie=0;Ie<Lt.length;Ie++)for(var ze=0;ze<Lt[Ie].length;ze++)oi(Dt,Lt[Ie][ze])}(ot),ot}function oi(ce,be){for(var Oe=0;Oe<be.length;Oe+=3)ce.minX=Math.min(ce.minX,be[Oe]),ce.minY=Math.min(ce.minY,be[Oe+1]),ce.maxX=Math.max(ce.maxX,be[Oe]),ce.maxY=Math.max(ce.maxY,be[Oe+1])}function Xt(ce,be,Oe,Qe){if(be.geometry){var ot=be.geometry.coordinates,Dt=be.geometry.type,Lt=Math.pow(Oe.tolerance/((1<<Oe.maxZoom)*Oe.extent),2),Je=[],Ie=be.id;if(Oe.promoteId?Ie=be.properties[Oe.promoteId]:Oe.generateId&&(Ie=Qe||0),"Point"===Dt)ln(ot,Je);else if("MultiPoint"===Dt)for(var ze=0;ze<ot.length;ze++)ln(ot[ze],Je);else if("LineString"===Dt)En(ot,Je,Lt,!1);else if("MultiLineString"===Dt){if(Oe.lineMetrics){for(ze=0;ze<ot.length;ze++)En(ot[ze],Je=[],Lt,!1),ce.push(pi(Ie,"LineString",Je,be.properties));return}bn(ot,Je,Lt,!1)}else if("Polygon"===Dt)bn(ot,Je,Lt,!0);else{if("MultiPolygon"!==Dt){if("GeometryCollection"===Dt){for(ze=0;ze<be.geometry.geometries.length;ze++)Xt(ce,{id:Ie,geometry:be.geometry.geometries[ze],properties:be.properties},Oe,Qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ze=0;ze<ot.length;ze++){var Ve=[];bn(ot[ze],Ve,Lt,!0),Je.push(Ve)}}ce.push(pi(Ie,Dt,Je,be.properties))}}function ln(ce,be){be.push(Wn(ce[0])),be.push(jt(ce[1])),be.push(0)}function En(ce,be,Oe,Qe){for(var ot,Dt,Lt=0,Je=0;Je<ce.length;Je++){var Ie=Wn(ce[Je][0]),ze=jt(ce[Je][1]);be.push(Ie),be.push(ze),be.push(0),Je>0&&(Lt+=Qe?(ot*ze-Ie*Dt)/2:Math.sqrt(Math.pow(Ie-ot,2)+Math.pow(ze-Dt,2))),ot=Ie,Dt=ze}var Ve=be.length-3;be[2]=1,function mt(Tt,en,Dn,zn){for(var an,Kn=zn,Yn=Dn-en>>1,Hn=Dn-en,Ir=Tt[en],Xn=Tt[en+1],br=Tt[Dn],yn=Tt[Dn+1],ur=en+3;ur<Dn;ur+=3){var Dr=bi(Tt[ur],Tt[ur+1],Ir,Xn,br,yn);if(Dr>Kn)an=ur,Kn=Dr;else if(Dr===Kn){var jr=Math.abs(ur-Yn);jr<Hn&&(an=ur,Hn=jr)}}Kn>zn&&(an-en>3&&mt(Tt,en,an,zn),Tt[an+2]=Kn,Dn-an>3&&mt(Tt,an,Dn,zn))}(be,0,Ve,Oe),be[Ve+2]=1,be.size=Math.abs(Lt),be.start=0,be.end=be.size}function bn(ce,be,Oe,Qe){for(var ot=0;ot<ce.length;ot++){var Dt=[];En(ce[ot],Dt,Oe,Qe),be.push(Dt)}}function Wn(ce){return ce/360+.5}function jt(ce){var be=Math.sin(ce*Math.PI/180),Oe=.5-.25*Math.log((1+be)/(1-be))/Math.PI;return Oe<0?0:Oe>1?1:Oe}function ve(ce,be,Oe,Qe,ot,Dt,Lt,Je){if(Qe/=be,Dt>=(Oe/=be)&&Lt<Qe)return ce;if(Lt<Oe||Dt>=Qe)return null;for(var Ie=[],ze=0;ze<ce.length;ze++){var Ve=ce[ze],mt=Ve.geometry,Tt=Ve.type,en=0===ot?Ve.minX:Ve.minY,Dn=0===ot?Ve.maxX:Ve.maxY;if(en>=Oe&&Dn<Qe)Ie.push(Ve);else if(!(Dn<Oe||en>=Qe)){var zn=[];if("Point"===Tt||"MultiPoint"===Tt)me(mt,zn,Oe,Qe,ot);else if("LineString"===Tt)re(mt,zn,Oe,Qe,ot,!1,Je.lineMetrics);else if("MultiLineString"===Tt)zt(mt,zn,Oe,Qe,ot,!1);else if("Polygon"===Tt)zt(mt,zn,Oe,Qe,ot,!0);else if("MultiPolygon"===Tt)for(var an=0;an<mt.length;an++){var Kn=[];zt(mt[an],Kn,Oe,Qe,ot,!0),Kn.length&&zn.push(Kn)}if(zn.length){if(Je.lineMetrics&&"LineString"===Tt){for(an=0;an<zn.length;an++)Ie.push(pi(Ve.id,Tt,zn[an],Ve.tags));continue}"LineString"!==Tt&&"MultiLineString"!==Tt||(1===zn.length?(Tt="LineString",zn=zn[0]):Tt="MultiLineString"),"Point"!==Tt&&"MultiPoint"!==Tt||(Tt=3===zn.length?"Point":"MultiPoint"),Ie.push(pi(Ve.id,Tt,zn,Ve.tags))}}}return Ie.length?Ie:null}function me(ce,be,Oe,Qe,ot){for(var Dt=0;Dt<ce.length;Dt+=3){var Lt=ce[Dt+ot];Lt>=Oe&&Lt<=Qe&&(be.push(ce[Dt]),be.push(ce[Dt+1]),be.push(ce[Dt+2]))}}function re(ce,be,Oe,Qe,ot,Dt,Lt){for(var Je,Ie,ze=ht(ce),Ve=0===ot?Mn:Jn,mt=ce.start,Tt=0;Tt<ce.length-3;Tt+=3){var en=ce[Tt],Dn=ce[Tt+1],zn=ce[Tt+2],an=ce[Tt+3],Kn=ce[Tt+4],Yn=0===ot?en:Dn,Hn=0===ot?an:Kn,Ir=!1;Lt&&(Je=Math.sqrt(Math.pow(en-an,2)+Math.pow(Dn-Kn,2))),Yn<Oe?Hn>Oe&&(Ie=Ve(ze,en,Dn,an,Kn,Oe),Lt&&(ze.start=mt+Je*Ie)):Yn>Qe?Hn<Qe&&(Ie=Ve(ze,en,Dn,an,Kn,Qe),Lt&&(ze.start=mt+Je*Ie)):sn(ze,en,Dn,zn),Hn<Oe&&Yn>=Oe&&(Ie=Ve(ze,en,Dn,an,Kn,Oe),Ir=!0),Hn>Qe&&Yn<=Qe&&(Ie=Ve(ze,en,Dn,an,Kn,Qe),Ir=!0),!Dt&&Ir&&(Lt&&(ze.end=mt+Je*Ie),be.push(ze),ze=ht(ce)),Lt&&(mt+=Je)}var Xn=ce.length-3;en=ce[Xn],Dn=ce[Xn+1],zn=ce[Xn+2],(Yn=0===ot?en:Dn)>=Oe&&Yn<=Qe&&sn(ze,en,Dn,zn),Xn=ze.length-3,Dt&&Xn>=3&&(ze[Xn]!==ze[0]||ze[Xn+1]!==ze[1])&&sn(ze,ze[0],ze[1],ze[2]),ze.length&&be.push(ze)}function ht(ce){var be=[];return be.size=ce.size,be.start=ce.start,be.end=ce.end,be}function zt(ce,be,Oe,Qe,ot,Dt){for(var Lt=0;Lt<ce.length;Lt++)re(ce[Lt],be,Oe,Qe,ot,Dt,!1)}function sn(ce,be,Oe,Qe){ce.push(be),ce.push(Oe),ce.push(Qe)}function Mn(ce,be,Oe,Qe,ot,Dt){var Lt=(Dt-be)/(Qe-be);return ce.push(Dt),ce.push(Oe+(ot-Oe)*Lt),ce.push(1),Lt}function Jn(ce,be,Oe,Qe,ot,Dt){var Lt=(Dt-Oe)/(ot-Oe);return ce.push(be+(Qe-be)*Lt),ce.push(Dt),ce.push(1),Lt}function Tr(ce,be){for(var Oe=[],Qe=0;Qe<ce.length;Qe++){var ot,Dt=ce[Qe],Lt=Dt.type;if("Point"===Lt||"MultiPoint"===Lt||"LineString"===Lt)ot=wr(Dt.geometry,be);else if("MultiLineString"===Lt||"Polygon"===Lt){ot=[];for(var Je=0;Je<Dt.geometry.length;Je++)ot.push(wr(Dt.geometry[Je],be))}else if("MultiPolygon"===Lt)for(ot=[],Je=0;Je<Dt.geometry.length;Je++){for(var Ie=[],ze=0;ze<Dt.geometry[Je].length;ze++)Ie.push(wr(Dt.geometry[Je][ze],be));ot.push(Ie)}Oe.push(pi(Dt.id,Lt,ot,Dt.tags))}return Oe}function wr(ce,be){var Oe=[];Oe.size=ce.size,void 0!==ce.start&&(Oe.start=ce.start,Oe.end=ce.end);for(var Qe=0;Qe<ce.length;Qe+=3)Oe.push(ce[Qe]+be,ce[Qe+1],ce[Qe+2]);return Oe}function Ki(ce,be){if(ce.transformed)return ce;var Oe,Qe,ot,Dt=1<<ce.z,Lt=ce.x,Je=ce.y;for(Oe=0;Oe<ce.features.length;Oe++){var Ie=ce.features[Oe],ze=Ie.geometry,Ve=Ie.type;if(Ie.geometry=[],1===Ve)for(Qe=0;Qe<ze.length;Qe+=2)Ie.geometry.push(Li(ze[Qe],ze[Qe+1],be,Dt,Lt,Je));else for(Qe=0;Qe<ze.length;Qe++){var mt=[];for(ot=0;ot<ze[Qe].length;ot+=2)mt.push(Li(ze[Qe][ot],ze[Qe][ot+1],be,Dt,Lt,Je));Ie.geometry.push(mt)}}return ce.transformed=!0,ce}function Li(ce,be,Oe,Qe,ot,Dt){return[Math.round(Oe*(ce*Qe-ot)),Math.round(Oe*(be*Qe-Dt))]}function Ht(ce,be,Oe,Qe,ot){for(var Dt=be===ot.maxZoom?0:ot.tolerance/((1<<be)*ot.extent),Lt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Oe,y:Qe,z:be,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Je=0;Je<ce.length;Je++){Lt.numFeatures++,Te(Lt,ce[Je],Dt,ot);var Ie=ce[Je].minX,ze=ce[Je].minY,Ve=ce[Je].maxX,mt=ce[Je].maxY;Ie<Lt.minX&&(Lt.minX=Ie),ze<Lt.minY&&(Lt.minY=ze),Ve>Lt.maxX&&(Lt.maxX=Ve),mt>Lt.maxY&&(Lt.maxY=mt)}return Lt}function Te(ce,be,Oe,Qe){var ot=be.geometry,Dt=be.type,Lt=[];if("Point"===Dt||"MultiPoint"===Dt)for(var Je=0;Je<ot.length;Je+=3)Lt.push(ot[Je]),Lt.push(ot[Je+1]),ce.numPoints++,ce.numSimplified++;else if("LineString"===Dt)ke(Lt,ot,ce,Oe,!1,!1);else if("MultiLineString"===Dt||"Polygon"===Dt)for(Je=0;Je<ot.length;Je++)ke(Lt,ot[Je],ce,Oe,"Polygon"===Dt,0===Je);else if("MultiPolygon"===Dt)for(var Ie=0;Ie<ot.length;Ie++){var ze=ot[Ie];for(Je=0;Je<ze.length;Je++)ke(Lt,ze[Je],ce,Oe,!0,0===Je)}if(Lt.length){var Ve=be.tags||null;if("LineString"===Dt&&Qe.lineMetrics){for(var mt in Ve={},be.tags)Ve[mt]=be.tags[mt];Ve.mapbox_clip_start=ot.start/ot.size,Ve.mapbox_clip_end=ot.end/ot.size}var Tt={geometry:Lt,type:"Polygon"===Dt||"MultiPolygon"===Dt?3:"LineString"===Dt||"MultiLineString"===Dt?2:1,tags:Ve};null!==be.id&&(Tt.id=be.id),ce.features.push(Tt)}}function ke(ce,be,Oe,Qe,ot,Dt){var Lt=Qe*Qe;if(Qe>0&&be.size<(ot?Lt:Qe))Oe.numPoints+=be.length/3;else{for(var Je=[],Ie=0;Ie<be.length;Ie+=3)(0===Qe||be[Ie+2]>Lt)&&(Oe.numSimplified++,Je.push(be[Ie]),Je.push(be[Ie+1])),Oe.numPoints++;ot&&function(ze,Ve){for(var mt=0,Tt=0,en=ze.length,Dn=en-2;Tt<en;Dn=Tt,Tt+=2)mt+=(ze[Tt]-ze[Dn])*(ze[Tt+1]+ze[Dn+1]);if(mt>0===Ve)for(Tt=0,en=ze.length;Tt<en/2;Tt+=2){var zn=ze[Tt],an=ze[Tt+1];ze[Tt]=ze[en-2-Tt],ze[Tt+1]=ze[en-1-Tt],ze[en-2-Tt]=zn,ze[en-1-Tt]=an}}(Je,Dt),ce.push(Je)}}function tt(ce,be){var Oe=(be=this.options=function(ot,Dt){for(var Lt in Dt)ot[Lt]=Dt[Lt];return ot}(Object.create(this.options),be)).debug;if(Oe&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");var ot,Dt,Lt,Je,Ie,ze,Qe=function(ot,Dt){var Lt=[];if("FeatureCollection"===ot.type)for(var Je=0;Je<ot.features.length;Je++)Xt(Lt,ot.features[Je],Dt,Je);else Xt(Lt,"Feature"===ot.type?ot:{geometry:ot},Dt);return Lt}(ce,be);this.tiles={},this.tileCoords=[],Oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ot=Qe,Dt=be,Lt=Dt.buffer/Dt.extent,Je=ot,Ie=ve(ot,1,-1-Lt,Lt,0,-1,2,Dt),ze=ve(ot,1,1-Lt,2+Lt,0,-1,2,Dt),(Ie||ze)&&(Je=ve(ot,1,-Lt,1+Lt,0,-1,2,Dt)||[],Ie&&(Je=Tr(Ie,1).concat(Je)),ze&&(Je=Je.concat(Tr(ze,-1)))),Qe=Je).length&&this.splitTile(Qe,0,0,0),Oe&&(Qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ft(ce,be,Oe){return 32*((1<<ce)*Oe+be)+ce}function vt(ce,be){var Oe=ce.tileID.canonical;if(!this._geoJSONIndex)return be(null,null);var Qe=this._geoJSONIndex.getTile(Oe.z,Oe.x,Oe.y);if(!Qe)return be(null,null);var ot=new ut(Qe.features),Dt=W(ot);0===Dt.byteOffset&&Dt.byteLength===Dt.buffer.byteLength||(Dt=new Uint8Array(Dt)),be(null,{vectorTile:ot,rawData:Dt.buffer})}jn.prototype.load=function(ce){var be=this.options,Oe=be.log,Qe=be.minZoom,ot=be.maxZoom,Dt=be.nodeSize;Oe&&console.time("total time");var Lt="prepare "+ce.length+" points";Oe&&console.time(Lt),this.points=ce;for(var Je=[],Ie=0;Ie<ce.length;Ie++)ce[Ie].geometry&&Je.push(lr(ce[Ie],Ie));this.trees[ot+1]=new An(Je,ii,fi,Dt,Float32Array),Oe&&console.timeEnd(Lt);for(var ze=ot;ze>=Qe;ze--){var Ve=+Date.now();Je=this._cluster(Je,ze),this.trees[ze]=new An(Je,ii,fi,Dt,Float32Array),Oe&&console.log("z%d: %d clusters in %dms",ze,Je.length,+Date.now()-Ve)}return Oe&&console.timeEnd("total time"),this},jn.prototype.getClusters=function(ce,be){var Oe=((ce[0]+180)%360+360)%360-180,Qe=Math.max(-90,Math.min(90,ce[1])),ot=180===ce[2]?180:((ce[2]+180)%360+360)%360-180,Dt=Math.max(-90,Math.min(90,ce[3]));if(ce[2]-ce[0]>=360)Oe=-180,ot=180;else if(Oe>ot){var Lt=this.getClusters([Oe,Qe,180,Dt],be),Je=this.getClusters([-180,Qe,ot,Dt],be);return Lt.concat(Je)}for(var Ie=this.trees[this._limitZoom(be)],ze=[],Ve=0,mt=Ie.range(di(Oe),vr(Dt),di(ot),vr(Qe));Ve<mt.length;Ve+=1){var Tt=Ie.points[mt[Ve]];ze.push(Tt.numPoints?Er(Tt):this.points[Tt.index])}return ze},jn.prototype.getChildren=function(ce){var be=this._getOriginId(ce),Oe=this._getOriginZoom(ce),Qe="No cluster with the specified id.",ot=this.trees[Oe];if(!ot)throw new Error(Qe);var Dt=ot.points[be];if(!Dt)throw new Error(Qe);for(var Lt=this.options.radius/(this.options.extent*Math.pow(2,Oe-1)),Je=[],Ie=0,ze=ot.within(Dt.x,Dt.y,Lt);Ie<ze.length;Ie+=1){var Ve=ot.points[ze[Ie]];Ve.parentId===ce&&Je.push(Ve.numPoints?Er(Ve):this.points[Ve.index])}if(0===Je.length)throw new Error(Qe);return Je},jn.prototype.getLeaves=function(ce,be,Oe){var Qe=[];return this._appendLeaves(Qe,ce,be=be||10,Oe=Oe||0,0),Qe},jn.prototype.getTile=function(ce,be,Oe){var Qe=this.trees[this._limitZoom(ce)],ot=Math.pow(2,ce),Dt=this.options,Lt=Dt.radius/Dt.extent,Je=(Oe-Lt)/ot,Ie=(Oe+1+Lt)/ot,ze={features:[]};return this._addTileFeatures(Qe.range((be-Lt)/ot,Je,(be+1+Lt)/ot,Ie),Qe.points,be,Oe,ot,ze),0===be&&this._addTileFeatures(Qe.range(1-Lt/ot,Je,1,Ie),Qe.points,ot,Oe,ot,ze),be===ot-1&&this._addTileFeatures(Qe.range(0,Je,Lt/ot,Ie),Qe.points,-1,Oe,ot,ze),ze.features.length?ze:null},jn.prototype.getClusterExpansionZoom=function(ce){for(var be=this._getOriginZoom(ce)-1;be<=this.options.maxZoom;){var Oe=this.getChildren(ce);if(be++,1!==Oe.length)break;ce=Oe[0].properties.cluster_id}return be},jn.prototype._appendLeaves=function(ce,be,Oe,Qe,ot){for(var Dt=0,Lt=this.getChildren(be);Dt<Lt.length;Dt+=1){var Je=Lt[Dt],Ie=Je.properties;if(Ie&&Ie.cluster?ot+Ie.point_count<=Qe?ot+=Ie.point_count:ot=this._appendLeaves(ce,Ie.cluster_id,Oe,Qe,ot):ot<Qe?ot++:ce.push(Je),ce.length===Oe)break}return ot},jn.prototype._addTileFeatures=function(ce,be,Oe,Qe,ot,Dt){for(var Lt=0,Je=ce;Lt<Je.length;Lt+=1){var Ie=be[Je[Lt]],ze=Ie.numPoints,Ve={type:1,geometry:[[Math.round(this.options.extent*(Ie.x*ot-Oe)),Math.round(this.options.extent*(Ie.y*ot-Qe))]],tags:ze?Sr(Ie):this.points[Ie.index].properties},mt=void 0;ze?mt=Ie.id:this.options.generateId?mt=Ie.index:this.points[Ie.index].id&&(mt=this.points[Ie.index].id),void 0!==mt&&(Ve.id=mt),Dt.features.push(Ve)}},jn.prototype._limitZoom=function(ce){return Math.max(this.options.minZoom,Math.min(+ce,this.options.maxZoom+1))},jn.prototype._cluster=function(ce,be){for(var Oe=[],Qe=this.options,ot=Qe.reduce,Dt=Qe.minPoints,Lt=Qe.radius/(Qe.extent*Math.pow(2,be)),Je=0;Je<ce.length;Je++){var Ie=ce[Je];if(!(Ie.zoom<=be)){Ie.zoom=be;for(var ze=this.trees[be+1],Ve=ze.within(Ie.x,Ie.y,Lt),mt=Ie.numPoints||1,Tt=mt,en=0,Dn=Ve;en<Dn.length;en+=1){var zn=ze.points[Dn[en]];zn.zoom>be&&(Tt+=zn.numPoints||1)}if(Tt>=Dt){for(var an=Ie.x*mt,Kn=Ie.y*mt,Yn=ot&&mt>1?this._map(Ie,!0):null,Hn=(Je<<5)+(be+1)+this.points.length,Ir=0,Xn=Ve;Ir<Xn.length;Ir+=1){var br=ze.points[Xn[Ir]];if(!(br.zoom<=be)){br.zoom=be;var yn=br.numPoints||1;an+=br.x*yn,Kn+=br.y*yn,br.parentId=Hn,ot&&(Yn||(Yn=this._map(Ie,!0)),ot(Yn,this._map(br)))}}Ie.parentId=Hn,Oe.push(gr(an/Tt,Kn/Tt,Hn,Tt,Yn))}else if(Oe.push(Ie),Tt>1)for(var ur=0,Dr=Ve;ur<Dr.length;ur+=1){var jr=ze.points[Dr[ur]];jr.zoom<=be||(jr.zoom=be,Oe.push(jr))}}}return Oe},jn.prototype._getOriginId=function(ce){return ce-this.points.length>>5},jn.prototype._getOriginZoom=function(ce){return(ce-this.points.length)%32},jn.prototype._map=function(ce,be){if(ce.numPoints)return be?qi({},ce.properties):ce.properties;var Oe=this.points[ce.index].properties,Qe=this.options.map(Oe);return be&&Qe===Oe?qi({},Qe):Qe},tt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tt.prototype.splitTile=function(ce,be,Oe,Qe,ot,Dt,Lt){for(var Je=[ce,be,Oe,Qe],Ie=this.options,ze=Ie.debug;Je.length;){Qe=Je.pop(),Oe=Je.pop(),be=Je.pop(),ce=Je.pop();var Ve=1<<be,mt=Ft(be,Oe,Qe),Tt=this.tiles[mt];if(!Tt&&(ze>1&&console.time("creation"),Tt=this.tiles[mt]=Ht(ce,be,Oe,Qe,Ie),this.tileCoords.push({z:be,x:Oe,y:Qe}),ze)){ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,Oe,Qe,Tt.numFeatures,Tt.numPoints,Tt.numSimplified),console.timeEnd("creation"));var en="z"+be;this.stats[en]=(this.stats[en]||0)+1,this.total++}if(Tt.source=ce,ot){if(be===Ie.maxZoom||be===ot)continue;var Dn=1<<ot-be;if(Oe!==Math.floor(Dt/Dn)||Qe!==Math.floor(Lt/Dn))continue}else if(be===Ie.indexMaxZoom||Tt.numPoints<=Ie.indexMaxPoints)continue;if(Tt.source=null,0!==ce.length){ze>1&&console.time("clipping");var zn,an,Kn,Yn,Hn,Ir,Xn=.5*Ie.buffer/Ie.extent,br=.5-Xn,yn=.5+Xn,ur=1+Xn;zn=an=Kn=Yn=null,Hn=ve(ce,Ve,Oe-Xn,Oe+yn,0,Tt.minX,Tt.maxX,Ie),Ir=ve(ce,Ve,Oe+br,Oe+ur,0,Tt.minX,Tt.maxX,Ie),ce=null,Hn&&(zn=ve(Hn,Ve,Qe-Xn,Qe+yn,1,Tt.minY,Tt.maxY,Ie),an=ve(Hn,Ve,Qe+br,Qe+ur,1,Tt.minY,Tt.maxY,Ie),Hn=null),Ir&&(Kn=ve(Ir,Ve,Qe-Xn,Qe+yn,1,Tt.minY,Tt.maxY,Ie),Yn=ve(Ir,Ve,Qe+br,Qe+ur,1,Tt.minY,Tt.maxY,Ie),Ir=null),ze>1&&console.timeEnd("clipping"),Je.push(zn||[],be+1,2*Oe,2*Qe),Je.push(an||[],be+1,2*Oe,2*Qe+1),Je.push(Kn||[],be+1,2*Oe+1,2*Qe),Je.push(Yn||[],be+1,2*Oe+1,2*Qe+1)}}},tt.prototype.getTile=function(ce,be,Oe){var Qe=this.options,ot=Qe.extent,Dt=Qe.debug;if(ce<0||ce>24)return null;var Lt=1<<ce,Je=Ft(ce,be=(be%Lt+Lt)%Lt,Oe);if(this.tiles[Je])return Ki(this.tiles[Je],ot);Dt>1&&console.log("drilling down to z%d-%d-%d",ce,be,Oe);for(var Ie,ze=ce,Ve=be,mt=Oe;!Ie&&ze>0;)ze--,Ve=Math.floor(Ve/2),mt=Math.floor(mt/2),Ie=this.tiles[Ft(ze,Ve,mt)];return Ie&&Ie.source?(Dt>1&&console.log("found parent tile z%d-%d-%d",ze,Ve,mt),Dt>1&&console.time("drilling down"),this.splitTile(Ie.source,ze,Ve,mt,ce,be,Oe),Dt>1&&console.timeEnd("drilling down"),this.tiles[Je]?Ki(this.tiles[Je],ot):null):null};var dn=function(ce){function be(Oe,Qe,ot,Dt){ce.call(this,Oe,Qe,ot,vt),Dt&&(this.loadGeoJSON=Dt)}return ce&&(be.__proto__=ce),(be.prototype=Object.create(ce&&ce.prototype)).constructor=be,be.prototype.loadData=function(Oe,Qe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Qe,this._pendingLoadDataParams=Oe,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},be.prototype._loadData=function(){var Oe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Qe=this._pendingCallback,ot=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Dt=!!(ot&&ot.request&&ot.request.collectResourceTiming)&&new g.RequestPerformance(ot.request);this.loadGeoJSON(ot,function(Lt,Je){if(Lt||!Je)return Qe(Lt);if("object"!=typeof Je)return Qe(new Error("Input data given to '"+ot.source+"' is not a valid GeoJSON object."));!function Tt(en,Dn){var zn,an=en&&en.type;if("FeatureCollection"===an)for(zn=0;zn<en.features.length;zn++)Tt(en.features[zn],Dn);else if("GeometryCollection"===an)for(zn=0;zn<en.geometries.length;zn++)Tt(en.geometries[zn],Dn);else if("Feature"===an)Tt(en.geometry,Dn);else if("Polygon"===an)pt(en.coordinates,Dn);else if("MultiPolygon"===an)for(zn=0;zn<en.coordinates.length;zn++)pt(en.coordinates[zn],Dn);return en}(Je,!0);try{if(ot.filter){var Ie=g.createExpression(ot.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ie.result)throw new Error(Ie.value.map(function(Tt){return Tt.key+": "+Tt.message}).join(", "));var ze=Je.features.filter(function(Tt){return Ie.value.evaluate({zoom:0},Tt)});Je={type:"FeatureCollection",features:ze}}Oe._geoJSONIndex=ot.cluster?new jn(function(Tt){var en=Tt.superclusterOptions,Dn=Tt.clusterProperties;if(!Dn||!en)return en;for(var zn={},an={},Kn={accumulated:null,zoom:0},Yn={properties:null},Hn=Object.keys(Dn),Ir=0,Xn=Hn;Ir<Xn.length;Ir+=1){var br=Xn[Ir],yn=Dn[br],ur=yn[0],Dr=g.createExpression(yn[1]),jr=g.createExpression("string"==typeof ur?[ur,["accumulated"],["get",br]]:ur);zn[br]=Dr.value,an[br]=jr.value}return en.map=function(oo){Yn.properties=oo;for(var zr={},Ci=0,Mr=Hn;Ci<Mr.length;Ci+=1){var Gr=Mr[Ci];zr[Gr]=zn[Gr].evaluate(Kn,Yn)}return zr},en.reduce=function(oo,zr){Yn.properties=zr;for(var Ci=0,Mr=Hn;Ci<Mr.length;Ci+=1){var Gr=Mr[Ci];Kn.accumulated=oo[Gr],oo[Gr]=an[Gr].evaluate(Kn,Yn)}},en}(ot)).load(Je.features):new tt(Tt=Je,ot.geojsonVtOptions)}catch(Tt){return Qe(Tt)}var Tt;Oe.loaded={};var Ve={};if(Dt){var mt=Dt.finish();mt&&(Ve.resourceTiming={},Ve.resourceTiming[ot.source]=JSON.parse(JSON.stringify(mt)))}Qe(null,Ve)})}},be.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},be.prototype.reloadTile=function(Oe,Qe){var ot=this.loaded;return ot&&ot[Oe.uid]?ce.prototype.reloadTile.call(this,Oe,Qe):this.loadTile(Oe,Qe)},be.prototype.loadGeoJSON=function(Oe,Qe){if(Oe.request)g.getJSON(Oe.request,Qe);else{if("string"!=typeof Oe.data)return Qe(new Error("Input data given to '"+Oe.source+"' is not a valid GeoJSON object."));try{return Qe(null,JSON.parse(Oe.data))}catch(ot){return Qe(new Error("Input data given to '"+Oe.source+"' is not a valid GeoJSON object."))}}},be.prototype.removeSource=function(Oe,Qe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Qe()},be.prototype.getClusterExpansionZoom=function(Oe,Qe){try{Qe(null,this._geoJSONIndex.getClusterExpansionZoom(Oe.clusterId))}catch(ot){Qe(ot)}},be.prototype.getClusterChildren=function(Oe,Qe){try{Qe(null,this._geoJSONIndex.getChildren(Oe.clusterId))}catch(ot){Qe(ot)}},be.prototype.getClusterLeaves=function(Oe,Qe){try{Qe(null,this._geoJSONIndex.getLeaves(Oe.clusterId,Oe.limit,Oe.offset))}catch(ot){Qe(ot)}},be}(ae),Pn=function(ce){var be=this;this.self=ce,this.actor=new g.Actor(ce,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ae,geojson:dn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Oe,Qe){if(be.workerSourceTypes[Oe])throw new Error('Worker source with name "'+Oe+'" already registered.');be.workerSourceTypes[Oe]=Qe},this.self.registerRTLTextPlugin=function(Oe){if(g.plugin.isParsed())throw new Error("RTL text plugin already registered.");g.plugin.applyArabicShaping=Oe.applyArabicShaping,g.plugin.processBidirectionalText=Oe.processBidirectionalText,g.plugin.processStyledBidirectionalText=Oe.processStyledBidirectionalText}};return Pn.prototype.setReferrer=function(ce,be){this.referrer=be},Pn.prototype.setImages=function(ce,be,Oe){for(var Qe in this.availableImages[ce]=be,this.workerSources[ce]){var ot=this.workerSources[ce][Qe];for(var Dt in ot)ot[Dt].availableImages=be}Oe()},Pn.prototype.setLayers=function(ce,be,Oe){this.getLayerIndex(ce).replace(be),Oe()},Pn.prototype.updateLayers=function(ce,be,Oe){this.getLayerIndex(ce).update(be.layers,be.removedIds),Oe()},Pn.prototype.loadTile=function(ce,be,Oe){this.getWorkerSource(ce,be.type,be.source).loadTile(be,Oe)},Pn.prototype.loadDEMTile=function(ce,be,Oe){this.getDEMWorkerSource(ce,be.source).loadTile(be,Oe)},Pn.prototype.reloadTile=function(ce,be,Oe){this.getWorkerSource(ce,be.type,be.source).reloadTile(be,Oe)},Pn.prototype.abortTile=function(ce,be,Oe){this.getWorkerSource(ce,be.type,be.source).abortTile(be,Oe)},Pn.prototype.removeTile=function(ce,be,Oe){this.getWorkerSource(ce,be.type,be.source).removeTile(be,Oe)},Pn.prototype.removeDEMTile=function(ce,be){this.getDEMWorkerSource(ce,be.source).removeTile(be)},Pn.prototype.removeSource=function(ce,be,Oe){if(this.workerSources[ce]&&this.workerSources[ce][be.type]&&this.workerSources[ce][be.type][be.source]){var Qe=this.workerSources[ce][be.type][be.source];delete this.workerSources[ce][be.type][be.source],void 0!==Qe.removeSource?Qe.removeSource(be,Oe):Oe()}},Pn.prototype.loadWorkerSource=function(ce,be,Oe){try{this.self.importScripts(be.url),Oe()}catch(Qe){Oe(Qe.toString())}},Pn.prototype.syncRTLPluginState=function(ce,be,Oe){try{g.plugin.setState(be);var Qe=g.plugin.getPluginURL();if(g.plugin.isLoaded()&&!g.plugin.isParsed()&&null!=Qe){this.self.importScripts(Qe);var ot=g.plugin.isParsed();Oe(ot?void 0:new Error("RTL Text Plugin failed to import scripts from "+Qe),ot)}}catch(Dt){Oe(Dt.toString())}},Pn.prototype.getAvailableImages=function(ce){var be=this.availableImages[ce];return be||(be=[]),be},Pn.prototype.getLayerIndex=function(ce){var be=this.layerIndexes[ce];return be||(be=this.layerIndexes[ce]=new Le),be},Pn.prototype.getWorkerSource=function(ce,be,Oe){var Qe=this;return this.workerSources[ce]||(this.workerSources[ce]={}),this.workerSources[ce][be]||(this.workerSources[ce][be]={}),this.workerSources[ce][be][Oe]||(this.workerSources[ce][be][Oe]=new this.workerSourceTypes[be]({send:function(ot,Dt,Lt){Qe.actor.send(ot,Dt,Lt,ce)}},this.getLayerIndex(ce),this.getAvailableImages(ce))),this.workerSources[ce][be][Oe]},Pn.prototype.getDEMWorkerSource=function(ce,be){return this.demWorkerSources[ce]||(this.demWorkerSources[ce]={}),this.demWorkerSources[ce][be]||(this.demWorkerSources[ce][be]=new St),this.demWorkerSources[ce][be]},Pn.prototype.enforceCacheSizeLimit=function(ce,be){g.enforceCacheSizeLimit(be)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Pn(self)),Pn}),ue(0,function(g){var nt=g.createCommonjsModule(function(l){function d(E){return!h(E)}function h(E){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var k,G,le=new Blob([""],{type:"text/javascript"}),Se=URL.createObjectURL(le);try{G=new Worker(Se),k=!0}catch(Ke){k=!1}return G&&G.terminate(),URL.revokeObjectURL(Se),k}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var k=document.createElement("canvas");k.width=k.height=1;var G=k.getContext("2d");if(!G)return!1;var le=G.getImageData(0,0,1,1);return le&&le.width===k.width}()?(void 0===m[D=E&&E.failIfMajorPerformanceCaveat]&&(m[D]=function(k){var Se,Ke,Xe,G=(Se=k,Ke=document.createElement("canvas"),(Xe=Object.create(d.webGLContextAttributes)).failIfMajorPerformanceCaveat=Se,Ke.probablySupportsContext?Ke.probablySupportsContext("webgl",Xe)||Ke.probablySupportsContext("experimental-webgl",Xe):Ke.supportsContext?Ke.supportsContext("webgl",Xe)||Ke.supportsContext("experimental-webgl",Xe):Ke.getContext("webgl",Xe)||Ke.getContext("experimental-webgl",Xe));if(!G)return!1;var le=G.createShader(G.VERTEX_SHADER);return!(!le||G.isContextLost())&&(G.shaderSource(le,"void main() {}"),G.compileShader(le),!0===G.getShaderParameter(le,G.COMPILE_STATUS))}(D)),m[D]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var D}l.exports?l.exports=d:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=d,window.mapboxgl.notSupportedReason=h);var m={};d.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),xe={create:function(l,d,h){var m=g.window.document.createElement(l);return void 0!==d&&(m.className=d),h&&h.appendChild(m),m},createNS:function(l,d){return g.window.document.createElementNS(l,d)}},Le=g.window.document&&g.window.document.documentElement.style;function Re(l){if(!Le)return l[0];for(var d=0;d<l.length;d++)if(l[d]in Le)return l[d];return l[0]}var Ue,fe=Re(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);xe.disableDrag=function(){Le&&fe&&(Ue=Le[fe],Le[fe]="none")},xe.enableDrag=function(){Le&&fe&&(Le[fe]=Ue)};var se=Re(["transform","WebkitTransform"]);xe.setTransform=function(l,d){l.style[se]=d};var ae=!1;try{var $e=Object.defineProperty({},"passive",{get:function(){ae=!0}});g.window.addEventListener("test",$e,$e),g.window.removeEventListener("test",$e,$e)}catch(l){ae=!1}xe.addEventListener=function(l,d,h,m){void 0===m&&(m={}),l.addEventListener(d,h,"passive"in m&&ae?m:m.capture)},xe.removeEventListener=function(l,d,h,m){void 0===m&&(m={}),l.removeEventListener(d,h,"passive"in m&&ae?m:m.capture)};var St=function(l){l.preventDefault(),l.stopPropagation(),g.window.removeEventListener("click",St,!0)};function pt(l){var d=l.userImage;return!!(d&&d.render&&d.render())&&(l.data.replace(new Uint8Array(d.data.buffer)),!0)}xe.suppressClick=function(){g.window.addEventListener("click",St,!0),g.window.setTimeout(function(){g.window.removeEventListener("click",St,!0)},0)},xe.mousePos=function(l,d){var h=l.getBoundingClientRect();return new g.Point(d.clientX-h.left-l.clientLeft,d.clientY-h.top-l.clientTop)},xe.touchPos=function(l,d){for(var h=l.getBoundingClientRect(),m=[],E=0;E<d.length;E++)m.push(new g.Point(d[E].clientX-h.left-l.clientLeft,d[E].clientY-h.top-l.clientTop));return m},xe.mouseButton=function(l){return void 0!==g.window.InstallTrigger&&2===l.button&&l.ctrlKey&&g.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button},xe.remove=function(l){l.parentNode&&l.parentNode.removeChild(l)};var bt=function(l){function d(){l.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new g.RGBAImage({width:1,height:1}),this.dirty=!0}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.isLoaded=function(){return this.loaded},d.prototype.setLoaded=function(h){if(this.loaded!==h&&(this.loaded=h,h)){for(var m=0,E=this.requestors;m<E.length;m+=1){var D=E[m];this._notify(D.ids,D.callback)}this.requestors=[]}},d.prototype.getImage=function(h){return this.images[h]},d.prototype.addImage=function(h,m){this._validate(h,m)&&(this.images[h]=m)},d.prototype._validate=function(h,m){var E=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new g.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchX" value'))),E=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new g.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchY" value'))),E=!1),this._validateContent(m.content,m)||(this.fire(new g.ErrorEvent(new Error('Image "'+h+'" has invalid "content" value'))),E=!1),E},d.prototype._validateStretch=function(h,m){if(!h)return!0;for(var E=0,D=0,k=h;D<k.length;D+=1){var G=k[D];if(G[0]<E||G[1]<G[0]||m<G[1])return!1;E=G[1]}return!0},d.prototype._validateContent=function(h,m){return!(h&&(4!==h.length||h[0]<0||m.data.width<h[0]||h[1]<0||m.data.height<h[1]||h[2]<0||m.data.width<h[2]||h[3]<0||m.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))},d.prototype.updateImage=function(h,m){m.version=this.images[h].version+1,this.images[h]=m,this.updatedImages[h]=!0},d.prototype.removeImage=function(h){var m=this.images[h];delete this.images[h],delete this.patterns[h],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()},d.prototype.listImages=function(){return Object.keys(this.images)},d.prototype.getImages=function(h,m){var E=!0;if(!this.isLoaded())for(var D=0,k=h;D<k.length;D+=1)this.images[k[D]]||(E=!1);this.isLoaded()||E?this._notify(h,m):this.requestors.push({ids:h,callback:m})},d.prototype._notify=function(h,m){for(var E={},D=0,k=h;D<k.length;D+=1){var G=k[D];this.images[G]||this.fire(new g.Event("styleimagemissing",{id:G}));var le=this.images[G];le?E[G]={data:le.data.clone(),pixelRatio:le.pixelRatio,sdf:le.sdf,version:le.version,stretchX:le.stretchX,stretchY:le.stretchY,content:le.content,hasRenderCallback:Boolean(le.userImage&&le.userImage.render)}:g.warnOnce('Image "'+G+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}m(null,E)},d.prototype.getPixelSize=function(){var h=this.atlasImage;return{width:h.width,height:h.height}},d.prototype.getPattern=function(h){var m=this.patterns[h],E=this.getImage(h);if(!E)return null;if(m&&m.position.version===E.version)return m.position;if(m)m.position.version=E.version;else{var D={w:E.data.width+2,h:E.data.height+2,x:0,y:0},k=new g.ImagePosition(D,E);this.patterns[h]={bin:D,position:k}}return this._updatePatternAtlas(),this.patterns[h].position},d.prototype.bind=function(h){var m=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new g.Texture(h,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)},d.prototype._updatePatternAtlas=function(){var h=[];for(var m in this.patterns)h.push(this.patterns[m].bin);var E=g.potpack(h),D=E.w,k=E.h,G=this.atlasImage;for(var le in G.resize({width:D||1,height:k||1}),this.patterns){var Se=this.patterns[le].bin,Ke=Se.x+1,Xe=Se.y+1,it=this.images[le].data,xt=it.width,wt=it.height;g.RGBAImage.copy(it,G,{x:0,y:0},{x:Ke,y:Xe},{width:xt,height:wt}),g.RGBAImage.copy(it,G,{x:0,y:wt-1},{x:Ke,y:Xe-1},{width:xt,height:1}),g.RGBAImage.copy(it,G,{x:0,y:0},{x:Ke,y:Xe+wt},{width:xt,height:1}),g.RGBAImage.copy(it,G,{x:xt-1,y:0},{x:Ke-1,y:Xe},{width:1,height:wt}),g.RGBAImage.copy(it,G,{x:0,y:0},{x:Ke+xt,y:Xe},{width:1,height:wt})}this.dirty=!0},d.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},d.prototype.dispatchRenderCallbacks=function(h){for(var m=0,E=h;m<E.length;m+=1){var D=E[m];if(!this.callbackDispatchedThisFrame[D]){this.callbackDispatchedThisFrame[D]=!0;var k=this.images[D];pt(k)&&this.updateImage(D,k)}}},d}(g.Evented),Ct=he,ct=he,ut=1e20;function he(l,d,h,m,E,D){this.fontSize=l||24,this.buffer=void 0===d?3:d,this.cutoff=m||.25,this.fontFamily=E||"sans-serif",this.fontWeight=D||"normal",this.radius=h||8;var k=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=k,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.d=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Int16Array(k),this.middle=Math.round(k/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function je(l,d,h,m,E,D,k){for(var G=0;G<d;G++){for(var le=0;le<h;le++)m[le]=l[le*d+G];for(Ae(m,E,D,k,h),le=0;le<h;le++)l[le*d+G]=E[le]}for(le=0;le<h;le++){for(G=0;G<d;G++)m[G]=l[le*d+G];for(Ae(m,E,D,k,d),G=0;G<d;G++)l[le*d+G]=Math.sqrt(E[G])}}function Ae(l,d,h,m,E){h[0]=0,m[0]=-ut,m[1]=+ut;for(var D=1,k=0;D<E;D++){for(var G=(l[D]+D*D-(l[h[k]]+h[k]*h[k]))/(2*D-2*h[k]);G<=m[k];)k--,G=(l[D]+D*D-(l[h[k]]+h[k]*h[k]))/(2*D-2*h[k]);h[++k]=D,m[k]=G,m[k+1]=+ut}for(D=0,k=0;D<E;D++){for(;m[k+1]<D;)k++;d[D]=(D-h[k])*(D-h[k])+l[h[k]]}}he.prototype.draw=function(l){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(l,this.buffer,this.middle);for(var d=this.ctx.getImageData(0,0,this.size,this.size),h=new Uint8ClampedArray(this.size*this.size),m=0;m<this.size*this.size;m++){var E=d.data[4*m+3]/255;this.gridOuter[m]=1===E?0:0===E?ut:Math.pow(Math.max(0,.5-E),2),this.gridInner[m]=1===E?ut:0===E?0:Math.pow(Math.max(0,E-.5),2)}for(je(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),je(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),m=0;m<this.size*this.size;m++)h[m]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[m]-this.gridInner[m])/this.radius+this.cutoff))));return h},Ct.default=ct;var j=function(l,d){this.requestManager=l,this.localIdeographFontFamily=d,this.entries={}};j.prototype.setURL=function(l){this.url=l},j.prototype.getGlyphs=function(l,d){var h=this,m=[];for(var E in l)for(var D=0,k=l[E];D<k.length;D+=1)m.push({stack:E,id:k[D]});g.asyncAll(m,function(G,le){var Se=G.stack,Ke=G.id,Xe=h.entries[Se];Xe||(Xe=h.entries[Se]={glyphs:{},requests:{},ranges:{}});var it=Xe.glyphs[Ke];if(void 0===it){if(it=h._tinySDF(Xe,Se,Ke))return Xe.glyphs[Ke]=it,void le(null,{stack:Se,id:Ke,glyph:it});var xt=Math.floor(Ke/256);if(256*xt>65535)le(new Error("glyphs > 65535 not supported"));else if(Xe.ranges[xt])le(null,{stack:Se,id:Ke,glyph:it});else{var wt=Xe.requests[xt];wt||(wt=Xe.requests[xt]=[],j.loadGlyphRange(Se,xt,h.url,h.requestManager,function(Pt,gt){if(gt){for(var kt in gt)h._doesCharSupportLocalGlyph(+kt)||(Xe.glyphs[+kt]=gt[+kt]);Xe.ranges[xt]=!0}for(var Bt=0,Jt=wt;Bt<Jt.length;Bt+=1)(0,Jt[Bt])(Pt,gt);delete Xe.requests[xt]})),wt.push(function(Pt,gt){Pt?le(Pt):gt&&le(null,{stack:Se,id:Ke,glyph:gt[Ke]||null})})}}else le(null,{stack:Se,id:Ke,glyph:it})},function(G,le){if(G)d(G);else if(le){for(var Se={},Ke=0,Xe=le;Ke<Xe.length;Ke+=1){var it=Xe[Ke],xt=it.stack,wt=it.id,Pt=it.glyph;(Se[xt]||(Se[xt]={}))[wt]=Pt&&{id:Pt.id,bitmap:Pt.bitmap.clone(),metrics:Pt.metrics}}d(null,Se)}})},j.prototype._doesCharSupportLocalGlyph=function(l){return!!this.localIdeographFontFamily&&(g.isChar["CJK Unified Ideographs"](l)||g.isChar["Hangul Syllables"](l)||g.isChar.Hiragana(l)||g.isChar.Katakana(l))},j.prototype._tinySDF=function(l,d,h){var m=this.localIdeographFontFamily;if(m&&this._doesCharSupportLocalGlyph(h)){var E=l.tinySDF;if(!E){var D="400";/bold/i.test(d)?D="900":/medium/i.test(d)?D="500":/light/i.test(d)&&(D="200"),E=l.tinySDF=new j.TinySDF(24,3,8,.25,m,D)}return{id:h,bitmap:new g.AlphaImage({width:30,height:30},E.draw(String.fromCharCode(h))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},j.loadGlyphRange=function(l,d,h,m,E){var D=256*d,k=D+255,G=m.transformRequest(m.normalizeGlyphsURL(h).replace("{fontstack}",l).replace("{range}",D+"-"+k),g.ResourceType.Glyphs);g.getArrayBuffer(G,function(le,Se){if(le)E(le);else if(Se){for(var Ke={},Xe=0,it=g.parseGlyphPBF(Se);Xe<it.length;Xe+=1){var xt=it[Xe];Ke[xt.id]=xt}E(null,Ke)}})},j.TinySDF=Ct;var W=function(){this.specification=g.styleSpec.light.position};W.prototype.possiblyEvaluate=function(l,d){return g.sphericalToCartesian(l.expression.evaluate(d))},W.prototype.interpolate=function(l,d,h){return{x:g.number(l.x,d.x,h),y:g.number(l.y,d.y,h),z:g.number(l.z,d.z,h)}};var ge=new g.Properties({anchor:new g.DataConstantProperty(g.styleSpec.light.anchor),position:new W,color:new g.DataConstantProperty(g.styleSpec.light.color),intensity:new g.DataConstantProperty(g.styleSpec.light.intensity)}),q=function(l){function d(h){l.call(this),this._transitionable=new g.Transitionable(ge),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getLight=function(){return this._transitionable.serialize()},d.prototype.setLight=function(h,m){if(void 0===m&&(m={}),!this._validate(g.validateLight,h,m))for(var E in h){var D=h[E];g.endsWith(E,"-transition")?this._transitionable.setTransition(E.slice(0,-"-transition".length),D):this._transitionable.setValue(E,D)}},d.prototype.updateTransitions=function(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)},d.prototype.hasTransition=function(){return this._transitioning.hasTransition()},d.prototype.recalculate=function(h){this.properties=this._transitioning.possiblyEvaluate(h)},d.prototype._validate=function(h,m,E){return(!E||!1!==E.validate)&&g.emitValidationErrors(this,h.call(g.validateStyle,g.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:g.styleSpec})))},d}(g.Evented),U=function(l,d){this.width=l,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};U.prototype.getDash=function(l,d){var h=l.join(",")+String(d);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(l,d)),this.dashEntry[h]},U.prototype.getDashRanges=function(l,d,h){var m=[],E=l.length%2==1?-l[l.length-1]*h:0,D=l[0]*h,k=!0;m.push({left:E,right:D,isDash:k,zeroLength:0===l[0]});for(var G=l[0],le=1;le<l.length;le++){var Se=l[le];m.push({left:E=G*h,right:D=(G+=Se)*h,isDash:k=!k,zeroLength:0===Se})}return m},U.prototype.addRoundDash=function(l,d,h){for(var m=d/2,E=-h;E<=h;E++)for(var D=this.width*(this.nextRow+h+E),k=0,G=l[k],le=0;le<this.width;le++){le/G.right>1&&(G=l[++k]);var Se=Math.abs(le-G.left),Ke=Math.abs(le-G.right),Xe=Math.min(Se,Ke),it=void 0,xt=E/h*(m+1);if(G.isDash){var wt=m-Math.abs(xt);it=Math.sqrt(Xe*Xe+wt*wt)}else it=m-Math.sqrt(Xe*Xe+xt*xt);this.data[D+le]=Math.max(0,Math.min(255,it+128))}},U.prototype.addRegularDash=function(l){for(var d=l.length-1;d>=0;--d){var h=l[d],m=l[d+1];h.zeroLength?l.splice(d,1):m&&m.isDash===h.isDash&&(m.left=h.left,l.splice(d,1))}var E=l[0],D=l[l.length-1];E.isDash===D.isDash&&(E.left=D.left-this.width,D.right=E.right+this.width);for(var k=this.width*this.nextRow,G=0,le=l[G],Se=0;Se<this.width;Se++){Se/le.right>1&&(le=l[++G]);var Ke=Math.abs(Se-le.left),Xe=Math.abs(Se-le.right),it=Math.min(Ke,Xe);this.data[k+Se]=Math.max(0,Math.min(255,(le.isDash?it:-it)+128))}},U.prototype.addDash=function(l,d){var h=d?7:0,m=2*h+1;if(this.nextRow+m>this.height)return g.warnOnce("LineAtlas out of space"),null;for(var E=0,D=0;D<l.length;D++)E+=l[D];if(0!==E){var k=this.width/E,G=this.getDashRanges(l,this.width,k);d?this.addRoundDash(G,k,h):this.addRegularDash(G)}var le={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:E};return this.nextRow+=m,this.dirty=!0,le},U.prototype.bind=function(l){var d=l.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))};var Y=function l(d,h){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=g.uniqueId();for(var m=this.workerPool.acquire(this.id),E=0;E<m.length;E++){var D=new l.Actor(m[E],h,this.id);D.name="Worker "+E,this.actors.push(D)}};function ee(l,d,h){var m=function(E,D){if(E)return h(E);if(D){var k=g.pick(g.extend(D,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(k.vectorLayers=D.vector_layers,k.vectorLayerIds=k.vectorLayers.map(function(G){return G.id})),k.tiles=d.canonicalizeTileset(k,l.url),h(null,k)}};return l.url?g.getJSON(d.transformRequest(d.normalizeSourceURL(l.url),g.ResourceType.Source),m):g.browser.frame(function(){return m(null,l)})}Y.prototype.broadcast=function(l,d,h){g.asyncAll(this.actors,function(m,E){m.send(l,d,E)},h=h||function(){})},Y.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Y.prototype.remove=function(){this.actors.forEach(function(l){l.remove()}),this.actors=[],this.workerPool.release(this.id)},Y.Actor=g.Actor;var Pe=function(l,d,h){this.bounds=g.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=h||24};Pe.prototype.validateBounds=function(l){return Array.isArray(l)&&4===l.length?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]},Pe.prototype.contains=function(l){var d=Math.pow(2,l.z),h=Math.floor(g.mercatorXfromLng(this.bounds.getWest())*d),m=Math.floor(g.mercatorYfromLat(this.bounds.getNorth())*d),E=Math.ceil(g.mercatorXfromLng(this.bounds.getEast())*d),D=Math.ceil(g.mercatorYfromLat(this.bounds.getSouth())*d);return l.x>=h&&l.x<E&&l.y>=m&&l.y<D};var _e=function(l){function d(h,m,E,D){if(l.call(this),this.id=h,this.dispatcher=E,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,g.extend(this,g.pick(m,["url","scheme","tileSize","promoteId"])),this._options=g.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(D)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ee(this._options,this.map._requestManager,function(m,E){h._tileJSONRequest=null,h._loaded=!0,m?h.fire(new g.ErrorEvent(m)):E&&(g.extend(h,E),E.bounds&&(h.tileBounds=new Pe(E.bounds,h.minzoom,h.maxzoom)),g.postTurnstileEvent(E.tiles,h.map._requestManager._customAccessToken),g.postMapLoadEvent(E.tiles,h.map._getMapId(),h.map._requestManager._skuToken,h.map._requestManager._customAccessToken),h.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})))})},d.prototype.loaded=function(){return this._loaded},d.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},d.prototype.onAdd=function(h){this.map=h,this.load()},d.prototype.setSourceProperty=function(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},d.prototype.setTiles=function(h){var m=this;return this.setSourceProperty(function(){m._options.tiles=h}),this},d.prototype.setUrl=function(h){var m=this;return this.setSourceProperty(function(){m.url=h,m._options.url=h}),this},d.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},d.prototype.serialize=function(){return g.extend({},this._options)},d.prototype.loadTile=function(h,m){var E=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),D={request:this.map._requestManager.transformRequest(E,g.ResourceType.Tile),uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:g.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function k(G,le){return delete h.request,h.aborted?m(null):G&&404!==G.status?m(G):(le&&le.resourceTiming&&(h.resourceTiming=le.resourceTiming),this.map._refreshExpiredTiles&&le&&h.setExpiryData(le),h.loadVectorData(le,this.map.painter),g.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}D.request.collectResourceTiming=this._collectResourceTiming,h.actor&&"expired"!==h.state?"loading"===h.state?h.reloadCallback=m:h.request=h.actor.send("reloadTile",D,k.bind(this)):(h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",D,k.bind(this)))},d.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id},void 0)},d.prototype.unloadTile=function(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id},void 0)},d.prototype.hasTransition=function(){return!1},d}(g.Evented),We=function(l){function d(h,m,E,D){l.call(this),this.id=h,this.dispatcher=E,this.setEventedParent(D),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=g.extend({type:"raster"},m),g.extend(this,g.pick(m,["url","scheme","tileSize"]))}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ee(this._options,this.map._requestManager,function(m,E){h._tileJSONRequest=null,h._loaded=!0,m?h.fire(new g.ErrorEvent(m)):E&&(g.extend(h,E),E.bounds&&(h.tileBounds=new Pe(E.bounds,h.minzoom,h.maxzoom)),g.postTurnstileEvent(E.tiles),g.postMapLoadEvent(E.tiles,h.map._getMapId(),h.map._requestManager._skuToken),h.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})))})},d.prototype.loaded=function(){return this._loaded},d.prototype.onAdd=function(h){this.map=h,this.load()},d.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},d.prototype.serialize=function(){return g.extend({},this._options)},d.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},d.prototype.loadTile=function(h,m){var E=this,D=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);h.request=g.getImage(this.map._requestManager.transformRequest(D,g.ResourceType.Tile),function(k,G){if(delete h.request,h.aborted)h.state="unloaded",m(null);else if(k)h.state="errored",m(k);else if(G){E.map._refreshExpiredTiles&&h.setExpiryData(G),delete G.cacheControl,delete G.expires;var le=E.map.painter.context,Se=le.gl;h.texture=E.map.painter.getTileTexture(G.width),h.texture?h.texture.update(G,{useMipmap:!0}):(h.texture=new g.Texture(le,G,Se.RGBA,{useMipmap:!0}),h.texture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),le.extTextureFilterAnisotropic&&Se.texParameterf(Se.TEXTURE_2D,le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,le.extTextureFilterAnisotropicMax)),h.state="loaded",g.cacheEntryPossiblyAdded(E.dispatcher),m(null)}})},d.prototype.abortTile=function(h,m){h.request&&(h.request.cancel(),delete h.request),m()},d.prototype.unloadTile=function(h,m){h.texture&&this.map.painter.saveTileTexture(h.texture),m()},d.prototype.hasTransition=function(){return!1},d}(g.Evented),rt=function(l){function d(h,m,E,D){l.call(this,h,m,E,D),this.type="raster-dem",this.maxzoom=22,this._options=g.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},d.prototype.loadTile=function(h,m){var E=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function D(k,G){k&&(h.state="errored",m(k)),G&&(h.dem=G,h.needsHillshadePrepare=!0,h.state="loaded",m(null))}h.request=g.getImage(this.map._requestManager.transformRequest(E,g.ResourceType.Tile),function(k,G){if(delete h.request,h.aborted)h.state="unloaded",m(null);else if(k)h.state="errored",m(k);else if(G){this.map._refreshExpiredTiles&&h.setExpiryData(G),delete G.cacheControl,delete G.expires;var le=g.window.ImageBitmap&&G instanceof g.window.ImageBitmap&&g.offscreenCanvasSupported()?G:g.browser.getImageData(G,1),Se={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:le,encoding:this.encoding};h.actor&&"expired"!==h.state||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",Se,D.bind(this)))}}.bind(this)),h.neighboringTiles=this._getNeighboringTiles(h.tileID)},d.prototype._getNeighboringTiles=function(h){var m=h.canonical,E=Math.pow(2,m.z),D=(m.x-1+E)%E,k=0===m.x?h.wrap-1:h.wrap,G=(m.x+1+E)%E,le=m.x+1===E?h.wrap+1:h.wrap,Se={};return Se[new g.OverscaledTileID(h.overscaledZ,k,m.z,D,m.y).key]={backfilled:!1},Se[new g.OverscaledTileID(h.overscaledZ,le,m.z,G,m.y).key]={backfilled:!1},m.y>0&&(Se[new g.OverscaledTileID(h.overscaledZ,k,m.z,D,m.y-1).key]={backfilled:!1},Se[new g.OverscaledTileID(h.overscaledZ,h.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},Se[new g.OverscaledTileID(h.overscaledZ,le,m.z,G,m.y-1).key]={backfilled:!1}),m.y+1<E&&(Se[new g.OverscaledTileID(h.overscaledZ,k,m.z,D,m.y+1).key]={backfilled:!1},Se[new g.OverscaledTileID(h.overscaledZ,h.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},Se[new g.OverscaledTileID(h.overscaledZ,le,m.z,G,m.y+1).key]={backfilled:!1}),Se},d.prototype.unloadTile=function(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded",h.actor&&h.actor.send("removeDEMTile",{uid:h.uid,source:this.id})},d}(We),_t=function(l){function d(h,m,E,D){l.call(this),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=E.getActor(),this.setEventedParent(D),this._data=m.data,this._options=g.extend({},m),this._collectResourceTiming=m.collectResourceTiming,this._resourceTiming=[],void 0!==m.maxzoom&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;var k=g.EXTENT/this.tileSize;this.workerOptions=g.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(void 0!==m.buffer?m.buffer:128)*k,tolerance:(void 0!==m.tolerance?m.tolerance:.375)*k,extent:g.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:void 0!==m.clusterMaxZoom?Math.min(m.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:g.EXTENT,radius:(m.clusterRadius||50)*k,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){var h=this;this.fire(new g.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)h.fire(new g.ErrorEvent(m));else{var E={dataType:"source",sourceDataType:"metadata"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(E.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new g.Event("data",E))}})},d.prototype.onAdd=function(h){this.map=h,this.load()},d.prototype.setData=function(h){var m=this;return this._data=h,this.fire(new g.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(E){if(E)m.fire(new g.ErrorEvent(E));else{var D={dataType:"source",sourceDataType:"content"};m._collectResourceTiming&&m._resourceTiming&&m._resourceTiming.length>0&&(D.resourceTiming=m._resourceTiming,m._resourceTiming=[]),m.fire(new g.Event("data",D))}}),this},d.prototype.getClusterExpansionZoom=function(h,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},m),this},d.prototype.getClusterChildren=function(h,m){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},m),this},d.prototype.getClusterLeaves=function(h,m,E,D){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:m,offset:E},D),this},d.prototype._updateWorkerData=function(h){var m=this;this._loaded=!1;var E=g.extend({},this.workerOptions),D=this._data;"string"==typeof D?(E.request=this.map._requestManager.transformRequest(g.browser.resolveURL(D),g.ResourceType.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(D),this.actor.send(this.type+".loadData",E,function(k,G){m._removed||G&&G.abandoned||(m._loaded=!0,G&&G.resourceTiming&&G.resourceTiming[m.id]&&(m._resourceTiming=G.resourceTiming[m.id].slice(0)),m.actor.send(m.type+".coalesce",{source:E.source},null),h(k))})},d.prototype.loaded=function(){return this._loaded},d.prototype.loadTile=function(h,m){var E=this,D=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(D,{type:this.type,uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:g.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(k,G){return delete h.request,h.unloadVectorData(),h.aborted?m(null):k?m(k):(h.loadVectorData(G,E.map.painter,"reloadTile"===D),m(null))})},d.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0},d.prototype.unloadTile=function(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})},d.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},d.prototype.serialize=function(){return g.extend({},this._options,{type:this.type,data:this._data})},d.prototype.hasTransition=function(){return!1},d}(g.Evented),ft=g.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Zt=function(l){function d(h,m,E,D){l.call(this),this.id=h,this.dispatcher=E,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(D),this.options=m}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(h,m){var E=this;this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this.url=this.options.url,g.getImage(this.map._requestManager.transformRequest(this.url,g.ResourceType.Image),function(D,k){E._loaded=!0,D?E.fire(new g.ErrorEvent(D)):k&&(E.image=k,h&&(E.coordinates=h),m&&m(),E._finishLoading())})},d.prototype.loaded=function(){return this._loaded},d.prototype.updateImage=function(h){var m=this;return this.image&&h.url?(this.options.url=h.url,this.load(h.coordinates,function(){m.texture=null}),this):this},d.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})))},d.prototype.onAdd=function(h){this.map=h,this.load()},d.prototype.setCoordinates=function(h){var m=this;this.coordinates=h;var E=h.map(g.MercatorCoordinate.fromLngLat);this.tileID=function(k){for(var G=1/0,le=1/0,Se=-1/0,Ke=-1/0,Xe=0,it=k;Xe<it.length;Xe+=1){var xt=it[Xe];G=Math.min(G,xt.x),le=Math.min(le,xt.y),Se=Math.max(Se,xt.x),Ke=Math.max(Ke,xt.y)}var wt=Math.max(Se-G,Ke-le),Pt=Math.max(0,Math.floor(-Math.log(wt)/Math.LN2)),gt=Math.pow(2,Pt);return new g.CanonicalTileID(Pt,Math.floor((G+Se)/2*gt),Math.floor((le+Ke)/2*gt))}(E),this.minzoom=this.maxzoom=this.tileID.z;var D=E.map(function(k){return m.tileID.getTilePoint(k)._round()});return this._boundsArray=new g.StructArrayLayout4i8,this._boundsArray.emplaceBack(D[0].x,D[0].y,0,0),this._boundsArray.emplaceBack(D[1].x,D[1].y,g.EXTENT,0),this._boundsArray.emplaceBack(D[3].x,D[3].y,0,g.EXTENT),this._boundsArray.emplaceBack(D[2].x,D[2].y,g.EXTENT,g.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})),this},d.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var h=this.map.painter.context,m=h.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,ft.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new g.Texture(h,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var D=this.tiles[E];"loaded"!==D.state&&(D.state="loaded",D.texture=this.texture)}}},d.prototype.loadTile=function(h,m){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},m(null)):(h.state="errored",m(null))},d.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},d.prototype.hasTransition=function(){return!1},d}(g.Evented),nn=function(l){function d(h,m,E,D){l.call(this,h,m,E,D),this.roundZoom=!0,this.type="video",this.options=m}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){var h=this;this._loaded=!1;var m=this.options;this.urls=[];for(var E=0,D=m.urls;E<D.length;E+=1)this.urls.push(this.map._requestManager.transformRequest(D[E],g.ResourceType.Source).url);g.getVideo(this.urls,function(k,G){h._loaded=!0,k?h.fire(new g.ErrorEvent(k)):G&&(h.video=G,h.video.loop=!0,h.video.addEventListener("playing",function(){h.map.triggerRepaint()}),h.map&&h.video.play(),h._finishLoading())})},d.prototype.pause=function(){this.video&&this.video.pause()},d.prototype.play=function(){this.video&&this.video.play()},d.prototype.seek=function(h){if(this.video){var m=this.video.seekable;h<m.start(0)||h>m.end(0)?this.fire(new g.ErrorEvent(new g.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+m.start(0)+" and "+m.end(0)+"-second mark."))):this.video.currentTime=h}},d.prototype.getVideo=function(){return this.video},d.prototype.onAdd=function(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},d.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var h=this.map.painter.context,m=h.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,ft.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new g.Texture(h,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var D=this.tiles[E];"loaded"!==D.state&&(D.state="loaded",D.texture=this.texture)}}},d.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},d.prototype.hasTransition=function(){return this.video&&!this.video.paused},d}(Zt),qt=function(l){function d(h,m,E,D){l.call(this,h,m,E,D),m.coordinates?Array.isArray(m.coordinates)&&4===m.coordinates.length&&!m.coordinates.some(function(k){return!Array.isArray(k)||2!==k.length||k.some(function(G){return"number"!=typeof G})})||this.fire(new g.ErrorEvent(new g.ValidationError("sources."+h,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new g.ErrorEvent(new g.ValidationError("sources."+h,null,'missing required property "coordinates"'))),m.animate&&"boolean"!=typeof m.animate&&this.fire(new g.ErrorEvent(new g.ValidationError("sources."+h,null,'optional "animate" property must be a boolean value'))),m.canvas?"string"==typeof m.canvas||m.canvas instanceof g.window.HTMLCanvasElement||this.fire(new g.ErrorEvent(new g.ValidationError("sources."+h,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new g.ErrorEvent(new g.ValidationError("sources."+h,null,'missing required property "canvas"'))),this.options=m,this.animate=void 0===m.animate||m.animate}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof g.window.HTMLCanvasElement?this.options.canvas:g.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new g.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},d.prototype.getCanvas=function(){return this.canvas},d.prototype.onAdd=function(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()},d.prototype.onRemove=function(){this.pause()},d.prototype.prepare=function(){var h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var m=this.map.painter.context,E=m.gl;for(var D in this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,ft.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new g.Texture(m,this.canvas,E.RGBA,{premultiply:!0}),this.tiles){var k=this.tiles[D];"loaded"!==k.state&&(k.state="loaded",k.texture=this.texture)}}},d.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},d.prototype.hasTransition=function(){return this._playing},d.prototype._hasInvalidDimensions=function(){for(var h=0,m=[this.canvas.width,this.canvas.height];h<m.length;h+=1){var E=m[h];if(isNaN(E)||E<=0)return!0}return!1},d}(Zt),An={vector:_e,raster:We,"raster-dem":rt,geojson:_t,video:nn,image:Zt,canvas:qt};function kn(l,d){var h=g.identity([]);return g.translate(h,h,[1,1,0]),g.scale(h,h,[.5*l.width,.5*l.height,1]),g.multiply(h,h,l.calculatePosMatrix(d.toUnwrapped()))}function jn(l,d,h,m,E,D){var k=function(Pt,gt,kt){if(Pt)for(var Bt=0,Jt=Pt;Bt<Jt.length;Bt+=1){var tn=gt[Jt[Bt]];if(tn&&tn.source===kt&&"fill-extrusion"===tn.type)return!0}else for(var un in gt){var gn=gt[un];if(gn.source===kt&&"fill-extrusion"===gn.type)return!0}return!1}(E&&E.layers,d,l.id),G=D.maxPitchScaleFactor(),le=l.tilesIn(m,G,k);le.sort(gr);for(var Se=[],Ke=0,Xe=le;Ke<Xe.length;Ke+=1){var it=Xe[Ke];Se.push({wrappedTileID:it.tileID.wrapped().key,queryResults:it.tile.queryRenderedFeatures(d,h,l._state,it.queryGeometry,it.cameraQueryGeometry,it.scale,E,D,G,kn(l.transform,it.tileID))})}var xt=function(Pt){for(var gt={},kt={},Bt=0,Jt=Pt;Bt<Jt.length;Bt+=1){var tn=Jt[Bt],un=tn.queryResults,gn=tn.wrappedTileID,Rn=kt[gn]=kt[gn]||{};for(var $n in un)for(var Vn=un[$n],cr=Rn[$n]=Rn[$n]||{},yr=gt[$n]=gt[$n]||[],Z=0,Q=Vn;Z<Q.length;Z+=1){var Fe=Q[Z];cr[Fe.featureIndex]||(cr[Fe.featureIndex]=!0,yr.push(Fe))}}return gt}(Se);for(var wt in xt)xt[wt].forEach(function(Pt){var gt=Pt.feature,kt=l.getFeatureState(gt.layer["source-layer"],gt.id);gt.source=gt.layer.source,gt.layer["source-layer"]&&(gt.sourceLayer=gt.layer["source-layer"]),gt.state=kt});return xt}function gr(l,d){var h=l.tileID,m=d.tileID;return h.overscaledZ-m.overscaledZ||h.canonical.y-m.canonical.y||h.wrap-m.wrap||h.canonical.x-m.canonical.x}var lr=function(l,d){this.max=l,this.onRemove=d,this.reset()};lr.prototype.reset=function(){for(var l in this.data)for(var d=0,h=this.data[l];d<h.length;d+=1){var m=h[d];m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value)}return this.data={},this.order=[],this},lr.prototype.add=function(l,d,h){var m=this,E=l.wrapped().key;void 0===this.data[E]&&(this.data[E]=[]);var D={value:d,timeout:void 0};if(void 0!==h&&(D.timeout=setTimeout(function(){m.remove(l,D)},h)),this.data[E].push(D),this.order.push(E),this.order.length>this.max){var k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this},lr.prototype.has=function(l){return l.wrapped().key in this.data},lr.prototype.getAndRemove=function(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null},lr.prototype._getAndRemoveByKey=function(l){var d=this.data[l].shift();return d.timeout&&clearTimeout(d.timeout),0===this.data[l].length&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),d.value},lr.prototype.getByKey=function(l){var d=this.data[l];return d?d[0].value:null},lr.prototype.get=function(l){return this.has(l)?this.data[l.wrapped().key][0].value:null},lr.prototype.remove=function(l,d){if(!this.has(l))return this;var h=l.wrapped().key,m=void 0===d?0:this.data[h].indexOf(d),E=this.data[h][m];return this.data[h].splice(m,1),E.timeout&&clearTimeout(E.timeout),0===this.data[h].length&&delete this.data[h],this.onRemove(E.value),this.order.splice(this.order.indexOf(h),1),this},lr.prototype.setMaxSize=function(l){for(this.max=l;this.order.length>this.max;){var d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this},lr.prototype.filter=function(l){var d=[];for(var h in this.data)for(var m=0,E=this.data[h];m<E.length;m+=1){var D=E[m];l(D.value)||d.push(D)}for(var k=0,G=d;k<G.length;k+=1){var le=G[k];this.remove(le.value.tileID,le)}};var Er=function(l,d,h){this.context=l;var m=l.gl;this.buffer=m.createBuffer(),this.dynamicDraw=Boolean(h),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer};Er.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Er.prototype.updateData=function(l){var d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)},Er.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Sr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},di=function(l,d,h,m){this.length=d.length,this.attributes=h,this.itemSize=d.bytesPerElement,this.dynamicDraw=m,this.context=l;var E=l.gl;this.buffer=E.createBuffer(),l.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer};di.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},di.prototype.updateData=function(l){var d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)},di.prototype.enableAttributes=function(l,d){for(var h=0;h<this.attributes.length;h++){var m=d.attributes[this.attributes[h].name];void 0!==m&&l.enableVertexAttribArray(m)}},di.prototype.setVertexAttribPointers=function(l,d,h){for(var m=0;m<this.attributes.length;m++){var E=this.attributes[m],D=d.attributes[E.name];void 0!==D&&l.vertexAttribPointer(D,E.components,l[Sr[E.type]],!1,this.itemSize,E.offset+this.itemSize*(h||0))}},di.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var vr=function(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};vr.prototype.get=function(){return this.current},vr.prototype.set=function(l){},vr.prototype.getDefault=function(){return this.default},vr.prototype.setDefault=function(){this.set(this.default)};var qi=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return g.Color.transparent},d.prototype.set=function(h){var m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},d}(vr),ii=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return 1},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)},d}(vr),fi=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return 0},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)},d}(vr),bi=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return[!0,!0,!0,!0]},d.prototype.set=function(h){var m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},d}(vr),pi=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!0},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)},d}(vr),oi=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return 255},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)},d}(vr),Xt=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},d.prototype.set=function(h){var m=this.current;(h.func!==m.func||h.ref!==m.ref||h.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)},d}(vr),ln=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){var h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]},d.prototype.set=function(h){var m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)},d}(vr),En=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;h?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=h,this.dirty=!1}},d}(vr),bn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return[0,1]},d.prototype.set=function(h){var m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)},d}(vr),Wn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;h?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=h,this.dirty=!1}},d}(vr),jt=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.LESS},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)},d}(vr),ve=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;h?m.enable(m.BLEND):m.disable(m.BLEND),this.current=h,this.dirty=!1}},d}(vr),me=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){var h=this.gl;return[h.ONE,h.ZERO]},d.prototype.set=function(h){var m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)},d}(vr),re=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return g.Color.transparent},d.prototype.set=function(h){var m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},d}(vr),ht=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.FUNC_ADD},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)},d}(vr),zt=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;h?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=h,this.dirty=!1}},d}(vr),sn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.BACK},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)},d}(vr),Mn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.CCW},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)},d}(vr),Jn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)},d}(vr),Tr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return this.gl.TEXTURE0},d.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)},d}(vr),wr=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){var h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]},d.prototype.set=function(h){var m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},d}(vr),Ki=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,h),this.current=h,this.dirty=!1}},d}(vr),Li=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,h),this.current=h,this.dirty=!1}},d}(vr),Ht=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;m.bindTexture(m.TEXTURE_2D,h),this.current=h,this.dirty=!1}},d}(vr),Te=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}},d}(vr),ke=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(h){var m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1},d}(vr),tt=function(l){function d(h){l.call(this,h),this.vao=h.extVertexArrayObject}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d.prototype.set=function(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)},d}(vr),Ft=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return 4},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}},d}(vr),vt=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}},d}(vr),dn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return!1},d.prototype.set=function(h){if(h!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}},d}(vr),Pn=function(l){function d(h,m){l.call(this,h),this.context=h,this.parent=m}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDefault=function(){return null},d}(vr),ce=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.setDirty=function(){this.dirty=!0},d.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}},d}(Pn),be=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,h),this.current=h,this.dirty=!1}},d}(Pn),Oe=function(l,d,h,m){this.context=l,this.width=d,this.height=h;var E=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new ce(l,E),m&&(this.depthAttachment=new be(l,E))};Oe.prototype.destroy=function(){var l=this.context.gl,d=this.colorAttachment.get();if(d&&l.deleteTexture(d),this.depthAttachment){var h=this.depthAttachment.get();h&&l.deleteRenderbuffer(h)}l.deleteFramebuffer(this.framebuffer)};var Qe=function(l,d,h){this.func=l,this.mask=d,this.range=h};Qe.ReadOnly=!1,Qe.ReadWrite=!0,Qe.disabled=new Qe(519,Qe.ReadOnly,[0,1]);var ot=function(l,d,h,m,E,D){this.test=l,this.ref=d,this.mask=h,this.fail=m,this.depthFail=E,this.pass=D};ot.disabled=new ot({func:519,mask:0},0,0,7680,7680,7680);var Dt=function(l,d,h){this.blendFunction=l,this.blendColor=d,this.mask=h};Dt.disabled=new Dt(Dt.Replace=[1,0],g.Color.transparent,[!1,!1,!1,!1]),Dt.unblended=new Dt(Dt.Replace,g.Color.transparent,[!0,!0,!0,!0]),Dt.alphaBlended=new Dt([1,771],g.Color.transparent,[!0,!0,!0,!0]);var Lt=function(l,d,h){this.enable=l,this.mode=d,this.frontFace=h};Lt.disabled=new Lt(!1,1029,2305),Lt.backCCW=new Lt(!0,1029,2305);var Je=function(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new qi(this),this.clearDepth=new ii(this),this.clearStencil=new fi(this),this.colorMask=new bi(this),this.depthMask=new pi(this),this.stencilMask=new oi(this),this.stencilFunc=new Xt(this),this.stencilOp=new ln(this),this.stencilTest=new En(this),this.depthRange=new bn(this),this.depthTest=new Wn(this),this.depthFunc=new jt(this),this.blend=new ve(this),this.blendFunc=new me(this),this.blendColor=new re(this),this.blendEquation=new ht(this),this.cullFace=new zt(this),this.cullFaceSide=new sn(this),this.frontFace=new Mn(this),this.program=new Jn(this),this.activeTexture=new Tr(this),this.viewport=new wr(this),this.bindFramebuffer=new Ki(this),this.bindRenderbuffer=new Li(this),this.bindTexture=new Ht(this),this.bindVertexBuffer=new Te(this),this.bindElementBuffer=new ke(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new tt(this),this.pixelStoreUnpack=new Ft(this),this.pixelStoreUnpackPremultiplyAlpha=new vt(this),this.pixelStoreUnpackFlipY=new dn(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)};Je.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Je.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Je.prototype.createIndexBuffer=function(l,d){return new Er(this,l,d)},Je.prototype.createVertexBuffer=function(l,d,h){return new di(this,l,d,h)},Je.prototype.createRenderbuffer=function(l,d,h){var m=this.gl,E=m.createRenderbuffer();return this.bindRenderbuffer.set(E),m.renderbufferStorage(m.RENDERBUFFER,l,d,h),this.bindRenderbuffer.set(null),E},Je.prototype.createFramebuffer=function(l,d,h){return new Oe(this,l,d,h)},Je.prototype.clear=function(l){var d=l.color,h=l.depth,m=this.gl,E=0;d&&(E|=m.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(E|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),m.clear(E)},Je.prototype.setCullFace=function(l){!1===l.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))},Je.prototype.setDepthMode=function(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)},Je.prototype.setStencilMode=function(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)},Je.prototype.setColorMode=function(l){g.deepEqual(l.blendFunction,Dt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)},Je.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ie=function(l){function d(h,m,E){var D=this;l.call(this),this.id=h,this.dispatcher=E,this.on("data",function(k){"source"===k.dataType&&"metadata"===k.sourceDataType&&(D._sourceLoaded=!0),D._sourceLoaded&&!D._paused&&"source"===k.dataType&&"content"===k.sourceDataType&&(D.reload(),D.transform&&D.update(D.transform))}),this.on("error",function(){D._sourceErrored=!0}),this._source=function(k,G,le,Se){var Ke=new An[G.type](k,G,le,Se);if(Ke.id!==k)throw new Error("Expected Source id to be "+k+" instead of "+Ke.id);return g.bindAll(["load","abort","unload","serialize","prepare"],Ke),Ke}(h,m,E,this),this._tiles={},this._cache=new lr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new g.SourceFeatureState}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.onAdd=function(h){this.map=h,this._maxTileCacheSize=h?h._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(h)},d.prototype.onRemove=function(h){this._source&&this._source.onRemove&&this._source.onRemove(h)},d.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var h in this._tiles){var m=this._tiles[h];if("loaded"!==m.state&&"errored"!==m.state)return!1}return!0},d.prototype.getSource=function(){return this._source},d.prototype.pause=function(){this._paused=!0},d.prototype.resume=function(){if(this._paused){var h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}},d.prototype._loadTile=function(h,m){return this._source.loadTile(h,m)},d.prototype._unloadTile=function(h){if(this._source.unloadTile)return this._source.unloadTile(h,function(){})},d.prototype._abortTile=function(h){if(this._source.abortTile)return this._source.abortTile(h,function(){})},d.prototype.serialize=function(){return this._source.serialize()},d.prototype.prepare=function(h){for(var m in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var E=this._tiles[m];E.upload(h),E.prepare(this.map.style.imageManager)}},d.prototype.getIds=function(){return g.values(this._tiles).map(function(h){return h.tileID}).sort(ze).map(function(h){return h.key})},d.prototype.getRenderableIds=function(h){var m=this,E=[];for(var D in this._tiles)this._isIdRenderable(D,h)&&E.push(this._tiles[D]);return h?E.sort(function(k,G){var le=k.tileID,Se=G.tileID,Ke=new g.Point(le.canonical.x,le.canonical.y)._rotate(m.transform.angle),Xe=new g.Point(Se.canonical.x,Se.canonical.y)._rotate(m.transform.angle);return le.overscaledZ-Se.overscaledZ||Xe.y-Ke.y||Xe.x-Ke.x}).map(function(k){return k.tileID.key}):E.map(function(k){return k.tileID}).sort(ze).map(function(k){return k.key})},d.prototype.hasRenderableParent=function(h){var m=this.findLoadedParent(h,0);return!!m&&this._isIdRenderable(m.tileID.key)},d.prototype._isIdRenderable=function(h,m){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(m||!this._tiles[h].holdingForFade())},d.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var h in this._cache.reset(),this._tiles)"errored"!==this._tiles[h].state&&this._reloadTile(h,"reloading")},d.prototype._reloadTile=function(h,m){var E=this._tiles[h];E&&("loading"!==E.state&&(E.state=m),this._loadTile(E,this._tileLoaded.bind(this,E,h,m)))},d.prototype._tileLoaded=function(h,m,E,D){if(D)return h.state="errored",void(404!==D.status?this._source.fire(new g.ErrorEvent(D,{tile:h})):this.update(this.transform));h.timeAdded=g.browser.now(),"expired"===E&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(m,h),"raster-dem"===this.getSource().type&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new g.Event("data",{dataType:"source",tile:h,coord:h.tileID}))},d.prototype._backfillDEM=function(h){for(var m=this.getRenderableIds(),E=0;E<m.length;E++){var D=m[E];if(h.neighboringTiles&&h.neighboringTiles[D]){var k=this.getTileByID(D);G(h,k),G(k,h)}}function G(le,Se){le.needsHillshadePrepare=!0;var Ke=Se.tileID.canonical.x-le.tileID.canonical.x,Xe=Se.tileID.canonical.y-le.tileID.canonical.y,it=Math.pow(2,le.tileID.canonical.z),xt=Se.tileID.key;0===Ke&&0===Xe||Math.abs(Xe)>1||(Math.abs(Ke)>1&&(1===Math.abs(Ke+it)?Ke+=it:1===Math.abs(Ke-it)&&(Ke-=it)),Se.dem&&le.dem&&(le.dem.backfillBorder(Se.dem,Ke,Xe),le.neighboringTiles&&le.neighboringTiles[xt]&&(le.neighboringTiles[xt].backfilled=!0)))}},d.prototype.getTile=function(h){return this.getTileByID(h.key)},d.prototype.getTileByID=function(h){return this._tiles[h]},d.prototype._retainLoadedChildren=function(h,m,E,D){for(var k in this._tiles){var G=this._tiles[k];if(!(D[k]||!G.hasData()||G.tileID.overscaledZ<=m||G.tileID.overscaledZ>E)){for(var le=G.tileID;G&&G.tileID.overscaledZ>m+1;){var Se=G.tileID.scaledTo(G.tileID.overscaledZ-1);(G=this._tiles[Se.key])&&G.hasData()&&(le=Se)}for(var Ke=le;Ke.overscaledZ>m;)if(h[(Ke=Ke.scaledTo(Ke.overscaledZ-1)).key]){D[le.key]=le;break}}}},d.prototype.findLoadedParent=function(h,m){if(h.key in this._loadedParentTiles){var E=this._loadedParentTiles[h.key];return E&&E.tileID.overscaledZ>=m?E:null}for(var D=h.overscaledZ-1;D>=m;D--){var k=h.scaledTo(D),G=this._getLoadedTile(k);if(G)return G}},d.prototype._getLoadedTile=function(h){var m=this._tiles[h.key];return m&&m.hasData()?m:this._cache.getByKey(h.wrapped().key)},d.prototype.updateCacheSize=function(h){var m=Math.ceil(h.width/this._source.tileSize)+1,E=Math.ceil(h.height/this._source.tileSize)+1,D=Math.floor(m*E*5),k="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,D):D;this._cache.setMaxSize(k)},d.prototype.handleWrapJump=function(h){var m=Math.round((h-(void 0===this._prevLng?h:this._prevLng))/360);if(this._prevLng=h,m){var E={};for(var D in this._tiles){var k=this._tiles[D];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+m),E[k.tileID.key]=k}for(var G in this._tiles=E,this._timers)clearTimeout(this._timers[G]),delete this._timers[G];for(var le in this._tiles)this._setTileReloadTimer(le,this._tiles[le])}},d.prototype.update=function(h){var m=this;if(this.transform=h,this._sourceLoaded&&!this._paused){var E;this.updateCacheSize(h),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?E=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Rn){return new g.OverscaledTileID(Rn.canonical.z,Rn.wrap,Rn.canonical.z,Rn.canonical.x,Rn.canonical.y)}):(E=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(E=E.filter(function(Rn){return m._source.hasTile(Rn)}))):E=[];var D=h.coveringZoomLevel(this._source),k=Math.max(D-d.maxOverzooming,this._source.minzoom),G=Math.max(D+d.maxUnderzooming,this._source.minzoom),le=this._updateRetainedTiles(E,D);if(Ve(this._source.type)){for(var Se={},Ke={},Xe=0,it=Object.keys(le);Xe<it.length;Xe+=1){var xt=it[Xe],wt=le[xt],Pt=this._tiles[xt];if(Pt&&!(Pt.fadeEndTime&&Pt.fadeEndTime<=g.browser.now())){var gt=this.findLoadedParent(wt,k);gt&&(this._addTile(gt.tileID),Se[gt.tileID.key]=gt.tileID),Ke[xt]=wt}}for(var kt in this._retainLoadedChildren(Ke,D,G,le),Se)le[kt]||(this._coveredTiles[kt]=!0,le[kt]=Se[kt])}for(var Bt in le)this._tiles[Bt].clearFadeHold();for(var Jt=0,tn=g.keysDifference(this._tiles,le);Jt<tn.length;Jt+=1){var un=tn[Jt],gn=this._tiles[un];gn.hasSymbolBuckets&&!gn.holdingForFade()?gn.setHoldDuration(this.map._fadeDuration):gn.hasSymbolBuckets&&!gn.symbolFadeFinished()||this._removeTile(un)}this._updateLoadedParentTileCache()}},d.prototype.releaseSymbolFadeTiles=function(){for(var h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(h)},d.prototype._updateRetainedTiles=function(h,m){for(var E={},D={},k=Math.max(m-d.maxOverzooming,this._source.minzoom),G=Math.max(m+d.maxUnderzooming,this._source.minzoom),le={},Se=0,Ke=h;Se<Ke.length;Se+=1){var Xe=Ke[Se],it=this._addTile(Xe);E[Xe.key]=Xe,it.hasData()||m<this._source.maxzoom&&(le[Xe.key]=Xe)}this._retainLoadedChildren(le,m,G,E);for(var xt=0,wt=h;xt<wt.length;xt+=1){var Pt=wt[xt],gt=this._tiles[Pt.key];if(!gt.hasData()){if(m+1>this._source.maxzoom){var kt=Pt.children(this._source.maxzoom)[0],Bt=this.getTile(kt);if(Bt&&Bt.hasData()){E[kt.key]=kt;continue}}else{var Jt=Pt.children(this._source.maxzoom);if(E[Jt[0].key]&&E[Jt[1].key]&&E[Jt[2].key]&&E[Jt[3].key])continue}for(var tn=gt.wasRequested(),un=Pt.overscaledZ-1;un>=k;--un){var gn=Pt.scaledTo(un);if(D[gn.key]||(D[gn.key]=!0,!(gt=this.getTile(gn))&&tn&&(gt=this._addTile(gn)),gt&&(E[gn.key]=gn,tn=gt.wasRequested(),gt.hasData())))break}}}return E},d.prototype._updateLoadedParentTileCache=function(){for(var h in this._loadedParentTiles={},this._tiles){for(var m=[],E=void 0,D=this._tiles[h].tileID;D.overscaledZ>0;){if(D.key in this._loadedParentTiles){E=this._loadedParentTiles[D.key];break}m.push(D.key);var k=D.scaledTo(D.overscaledZ-1);if(E=this._getLoadedTile(k))break;D=k}for(var G=0,le=m;G<le.length;G+=1)this._loadedParentTiles[le[G]]=E}},d.prototype._addTile=function(h){var m=this._tiles[h.key];if(m)return m;(m=this._cache.getAndRemove(h))&&(this._setTileReloadTimer(h.key,m),m.tileID=h,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,m)));var E=Boolean(m);return E||(m=new g.Tile(h,this._source.tileSize*h.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,h.key,m.state))),m?(m.uses++,this._tiles[h.key]=m,E||this._source.fire(new g.Event("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m):null},d.prototype._setTileReloadTimer=function(h,m){var E=this;h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);var D=m.getExpiryTimeout();D&&(this._timers[h]=setTimeout(function(){E._reloadTile(h,"expired"),delete E._timers[h]},D))},d.prototype._removeTile=function(h){var m=this._tiles[h];m&&(m.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),m.uses>0||(m.hasData()&&"reloading"!==m.state?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))},d.prototype.clearTiles=function(){for(var h in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(h);this._cache.reset()},d.prototype.tilesIn=function(h,m,E){var D=this,k=[],G=this.transform;if(!G)return k;for(var le=E?G.getCameraQueryGeometry(h):h,Se=h.map(function(un){return G.pointCoordinate(un)}),Ke=le.map(function(un){return G.pointCoordinate(un)}),Xe=this.getIds(),it=1/0,xt=1/0,wt=-1/0,Pt=-1/0,gt=0,kt=Ke;gt<kt.length;gt+=1){var Bt=kt[gt];it=Math.min(it,Bt.x),xt=Math.min(xt,Bt.y),wt=Math.max(wt,Bt.x),Pt=Math.max(Pt,Bt.y)}for(var Jt=function(un){var gn=D._tiles[Xe[un]];if(!gn.holdingForFade()){var Rn=gn.tileID,$n=Math.pow(2,G.zoom-gn.tileID.overscaledZ),Vn=m*gn.queryPadding*g.EXTENT/gn.tileSize/$n,cr=[Rn.getTilePoint(new g.MercatorCoordinate(it,xt)),Rn.getTilePoint(new g.MercatorCoordinate(wt,Pt))];if(cr[0].x-Vn<g.EXTENT&&cr[0].y-Vn<g.EXTENT&&cr[1].x+Vn>=0&&cr[1].y+Vn>=0){var yr=Se.map(function(Q){return Rn.getTilePoint(Q)}),Z=Ke.map(function(Q){return Rn.getTilePoint(Q)});k.push({tile:gn,tileID:Rn,queryGeometry:yr,cameraQueryGeometry:Z,scale:$n})}}},tn=0;tn<Xe.length;tn++)Jt(tn);return k},d.prototype.getVisibleCoordinates=function(h){for(var m=this,E=this.getRenderableIds(h).map(function(le){return m._tiles[le].tileID}),D=0,k=E;D<k.length;D+=1){var G=k[D];G.posMatrix=this.transform.calculatePosMatrix(G.toUnwrapped())}return E},d.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ve(this._source.type))for(var h in this._tiles){var m=this._tiles[h];if(void 0!==m.fadeEndTime&&m.fadeEndTime>=g.browser.now())return!0}return!1},d.prototype.setFeatureState=function(h,m,E){this._state.updateState(h=h||"_geojsonTileLayer",m,E)},d.prototype.removeFeatureState=function(h,m,E){this._state.removeFeatureState(h=h||"_geojsonTileLayer",m,E)},d.prototype.getFeatureState=function(h,m){return this._state.getState(h=h||"_geojsonTileLayer",m)},d.prototype.setDependencies=function(h,m,E){var D=this._tiles[h];D&&D.setDependencies(m,E)},d.prototype.reloadTilesForDependencies=function(h,m){for(var E in this._tiles)this._tiles[E].hasDependency(h,m)&&this._reloadTile(E,"reloading");this._cache.filter(function(D){return!D.hasDependency(h,m)})},d}(g.Evented);function ze(l,d){var h=Math.abs(2*l.wrap)-+(l.wrap<0),m=Math.abs(2*d.wrap)-+(d.wrap<0);return l.overscaledZ-d.overscaledZ||m-h||d.canonical.y-l.canonical.y||d.canonical.x-l.canonical.x}function Ve(l){return"raster"===l||"image"===l||"video"===l}function mt(){return new g.window.Worker(ls.workerUrl)}Ie.maxOverzooming=10,Ie.maxUnderzooming=3;var Tt="mapboxgl_preloaded_worker_pool",en=function(){this.active={}};en.prototype.acquire=function(l){if(!this.workers)for(this.workers=[];this.workers.length<en.workerCount;)this.workers.push(new mt);return this.active[l]=!0,this.workers.slice()},en.prototype.release=function(l){delete this.active[l],0===this.numActive()&&(this.workers.forEach(function(d){d.terminate()}),this.workers=null)},en.prototype.isPreloaded=function(){return!!this.active[Tt]},en.prototype.numActive=function(){return Object.keys(this.active).length};var Dn,zn=Math.floor(g.browser.hardwareConcurrency/2);function an(){return Dn||(Dn=new en),Dn}function Kn(l,d){var h={};for(var m in l)"ref"!==m&&(h[m]=l[m]);return g.refProperties.forEach(function(E){E in d&&(h[E]=d[E])}),h}function Yn(l){l=l.slice();for(var d=Object.create(null),h=0;h<l.length;h++)d[l[h].id]=l[h];for(var m=0;m<l.length;m++)"ref"in l[m]&&(l[m]=Kn(l[m],d[l[m].ref]));return l}en.workerCount=Math.max(Math.min(zn,6),1);var Hn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ir(l,d,h){h.push({command:Hn.addSource,args:[l,d[l]]})}function Xn(l,d,h){d.push({command:Hn.removeSource,args:[l]}),h[l]=!0}function br(l,d,h,m){Xn(l,h,m),Ir(l,d,h)}function yn(l,d,h){var m;for(m in l[h])if(l[h].hasOwnProperty(m)&&"data"!==m&&!g.deepEqual(l[h][m],d[h][m]))return!1;for(m in d[h])if(d[h].hasOwnProperty(m)&&"data"!==m&&!g.deepEqual(l[h][m],d[h][m]))return!1;return!0}function ur(l,d,h,m,E,D){var k;for(k in d=d||{},l=l||{})l.hasOwnProperty(k)&&(g.deepEqual(l[k],d[k])||h.push({command:D,args:[m,k,d[k],E]}));for(k in d)d.hasOwnProperty(k)&&!l.hasOwnProperty(k)&&(g.deepEqual(l[k],d[k])||h.push({command:D,args:[m,k,d[k],E]}))}function Dr(l){return l.id}function jr(l,d){return l[d.id]=d,l}var oo=function(l,d){this.reset(l,d)};oo.prototype.reset=function(l,d){this.points=l||[],this._distances=[0];for(var h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding},oo.prototype.lerp=function(l){if(1===this.points.length)return this.points[0];l=g.clamp(l,0,1);for(var d=1,h=this._distances[d],m=l*this.paddedLength+this.padding;h<m&&d<this._distances.length;)h=this._distances[++d];var E=d-1,D=this._distances[E],k=h-D,G=k>0?(m-D)/k:0;return this.points[E].mult(1-G).add(this.points[d].mult(G))};var zr=function(l,d,h){var m=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(l/h),this.yCellCount=Math.ceil(d/h);for(var D=0;D<this.xCellCount*this.yCellCount;D++)m.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0};function Ci(l,d,h,m,E){var D=g.create();return d?(g.scale(D,D,[1/E,1/E,1]),h||g.rotateZ(D,D,m.angle)):g.multiply(D,m.labelPlaneMatrix,l),D}function Mr(l,d,h,m,E){if(d){var D=g.clone(l);return g.scale(D,D,[E,E,1]),h||g.rotateZ(D,D,-m.angle),D}return m.glCoordMatrix}function Gr(l,d){var h=[l.x,l.y,0,1];Br(h,h,d);var m=h[3];return{point:new g.Point(h[0]/m,h[1]/m),signedDistanceFromCamera:m}}function Fr(l,d){return.5+l/d*.5}function Vr(l,d){var h=l[0]/l[3],m=l[1]/l[3];return h>=-d[0]&&h<=d[0]&&m>=-d[1]&&m<=d[1]}function hs(l,d,h,m,E,D,k,G){var le=m?l.textSizeData:l.iconSizeData,Se=g.evaluateSizeForZoom(le,h.transform.zoom),Ke=[256/h.width*2+1,256/h.height*2+1],Xe=m?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;Xe.clear();for(var it=l.lineVertexArray,xt=m?l.text.placedSymbolArray:l.icon.placedSymbolArray,wt=h.transform.width/h.transform.height,Pt=!1,gt=0;gt<xt.length;gt++){var kt=xt.get(gt);if(kt.hidden||kt.writingMode===g.WritingMode.vertical&&!Pt)zi(kt.numGlyphs,Xe);else{Pt=!1;var Bt=[kt.anchorX,kt.anchorY,0,1];if(g.transformMat4(Bt,Bt,d),Vr(Bt,Ke)){var Jt=Fr(h.transform.cameraToCenterDistance,Bt[3]),tn=g.evaluateSizeForFeature(le,Se,kt),un=k?tn/Jt:tn*Jt,gn=new g.Point(kt.anchorX,kt.anchorY),Rn=Gr(gn,E).point,$n={},Vn=Bo(kt,un,!1,G,d,E,D,l.glyphOffsetArray,it,Xe,Rn,gn,$n,wt);Pt=Vn.useVertical,(Vn.notEnoughRoom||Pt||Vn.needsFlipping&&Bo(kt,un,!0,G,d,E,D,l.glyphOffsetArray,it,Xe,Rn,gn,$n,wt).notEnoughRoom)&&zi(kt.numGlyphs,Xe)}else zi(kt.numGlyphs,Xe)}}m?l.text.dynamicLayoutVertexBuffer.updateData(Xe):l.icon.dynamicLayoutVertexBuffer.updateData(Xe)}function Yi(l,d,h,m,E,D,k,G,le,Se,Ke){var Xe=G.glyphStartIndex+G.numGlyphs,it=G.lineStartIndex,xt=G.lineStartIndex+G.lineLength,wt=d.getoffsetX(G.glyphStartIndex),Pt=d.getoffsetX(Xe-1),gt=Si(l*wt,h,m,E,D,k,G.segment,it,xt,le,Se,Ke);if(!gt)return null;var kt=Si(l*Pt,h,m,E,D,k,G.segment,it,xt,le,Se,Ke);return kt?{first:gt,last:kt}:null}function Ao(l,d,h,m){return l===g.WritingMode.horizontal&&Math.abs(h.y-d.y)>Math.abs(h.x-d.x)*m?{useVertical:!0}:(l===g.WritingMode.vertical?d.y<h.y:d.x>h.x)?{needsFlipping:!0}:null}function Bo(l,d,h,m,E,D,k,G,le,Se,Ke,Xe,it,xt){var wt,Pt=d/24,gt=l.lineOffsetX*Pt,kt=l.lineOffsetY*Pt;if(l.numGlyphs>1){var Bt=l.glyphStartIndex+l.numGlyphs,Jt=l.lineStartIndex,tn=l.lineStartIndex+l.lineLength,un=Yi(Pt,G,gt,kt,h,Ke,Xe,l,le,D,it);if(!un)return{notEnoughRoom:!0};var gn=Gr(un.first.point,k).point,Rn=Gr(un.last.point,k).point;if(m&&!h){var $n=Ao(l.writingMode,gn,Rn,xt);if($n)return $n}wt=[un.first];for(var Vn=l.glyphStartIndex+1;Vn<Bt-1;Vn++)wt.push(Si(Pt*G.getoffsetX(Vn),gt,kt,h,Ke,Xe,l.segment,Jt,tn,le,D,it));wt.push(un.last)}else{if(m&&!h){var cr=Gr(Xe,E).point,yr=l.lineStartIndex+l.segment+1,Z=new g.Point(le.getx(yr),le.gety(yr)),Q=Gr(Z,E),Fe=Q.signedDistanceFromCamera>0?Q.point:Pi(Xe,Z,cr,1,E),st=Ao(l.writingMode,cr,Fe,xt);if(st)return st}var Ut=Si(Pt*G.getoffsetX(l.glyphStartIndex),gt,kt,h,Ke,Xe,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,le,D,it);if(!Ut)return{notEnoughRoom:!0};wt=[Ut]}for(var Qt=0,mn=wt;Qt<mn.length;Qt+=1){var xn=mn[Qt];g.addDynamicAttributes(Se,xn.point,xn.angle)}return{}}function Pi(l,d,h,m,E){var D=Gr(l.add(l.sub(d)._unit()),E).point,k=h.sub(D);return h.add(k._mult(m/k.mag()))}function Si(l,d,h,m,E,D,k,G,le,Se,Ke,Xe){var it=m?l-d:l+d,xt=it>0?1:-1,wt=0;m&&(xt*=-1,wt=Math.PI),xt<0&&(wt+=Math.PI);for(var Pt=xt>0?G+k:G+k+1,gt=E,kt=E,Bt=0,Jt=0,tn=Math.abs(it),un=[];Bt+Jt<=tn;){if((Pt+=xt)<G||Pt>=le)return null;if(kt=gt,un.push(gt),void 0===(gt=Xe[Pt])){var gn=new g.Point(Se.getx(Pt),Se.gety(Pt)),Rn=Gr(gn,Ke);if(Rn.signedDistanceFromCamera>0)gt=Xe[Pt]=Rn.point;else{var $n=Pt-xt;gt=Pi(0===Bt?D:new g.Point(Se.getx($n),Se.gety($n)),gn,kt,tn-Bt+1,Ke)}}Bt+=Jt,Jt=kt.dist(gt)}var Vn=(tn-Bt)/Jt,cr=gt.sub(kt),yr=cr.mult(Vn)._add(kt);yr._add(cr._unit()._perp()._mult(h*xt));var Z=wt+Math.atan2(gt.y-kt.y,gt.x-kt.x);return un.push(yr),{point:yr,angle:Z,path:un}}zr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},zr.prototype.insert=function(l,d,h,m,E){this._forEachCell(d,h,m,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(E)},zr.prototype.insertCircle=function(l,d,h,m){this._forEachCell(d-m,h-m,d+m,h+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(h),this.circles.push(m)},zr.prototype._insertBoxCell=function(l,d,h,m,E,D){this.boxCells[E].push(D)},zr.prototype._insertCircleCell=function(l,d,h,m,E,D){this.circleCells[E].push(D)},zr.prototype._query=function(l,d,h,m,E,D){if(h<0||l>this.width||m<0||d>this.height)return!E&&[];var k=[];if(l<=0&&d<=0&&this.width<=h&&this.height<=m){if(E)return!0;for(var G=0;G<this.boxKeys.length;G++)k.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(var le=0;le<this.circleKeys.length;le++){var Se=this.circles[3*le],Ke=this.circles[3*le+1],Xe=this.circles[3*le+2];k.push({key:this.circleKeys[le],x1:Se-Xe,y1:Ke-Xe,x2:Se+Xe,y2:Ke+Xe})}return D?k.filter(D):k}return this._forEachCell(l,d,h,m,this._queryCell,k,{hitTest:E,seenUids:{box:{},circle:{}}},D),E?k.length>0:k},zr.prototype._queryCircle=function(l,d,h,m,E){var D=l-h,k=l+h,G=d-h,le=d+h;if(k<0||D>this.width||le<0||G>this.height)return!m&&[];var Se=[];return this._forEachCell(D,G,k,le,this._queryCellCircle,Se,{hitTest:m,circle:{x:l,y:d,radius:h},seenUids:{box:{},circle:{}}},E),m?Se.length>0:Se},zr.prototype.query=function(l,d,h,m,E){return this._query(l,d,h,m,!1,E)},zr.prototype.hitTest=function(l,d,h,m,E){return this._query(l,d,h,m,!0,E)},zr.prototype.hitTestCircle=function(l,d,h,m){return this._queryCircle(l,d,h,!0,m)},zr.prototype._queryCell=function(l,d,h,m,E,D,k,G){var le=k.seenUids,Se=this.boxCells[E];if(null!==Se)for(var Ke=this.bboxes,Xe=0,it=Se;Xe<it.length;Xe+=1){var xt=it[Xe];if(!le.box[xt]){le.box[xt]=!0;var wt=4*xt;if(l<=Ke[wt+2]&&d<=Ke[wt+3]&&h>=Ke[wt+0]&&m>=Ke[wt+1]&&(!G||G(this.boxKeys[xt]))){if(k.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[xt],x1:Ke[wt],y1:Ke[wt+1],x2:Ke[wt+2],y2:Ke[wt+3]})}}}var Pt=this.circleCells[E];if(null!==Pt)for(var gt=this.circles,kt=0,Bt=Pt;kt<Bt.length;kt+=1){var Jt=Bt[kt];if(!le.circle[Jt]){le.circle[Jt]=!0;var tn=3*Jt;if(this._circleAndRectCollide(gt[tn],gt[tn+1],gt[tn+2],l,d,h,m)&&(!G||G(this.circleKeys[Jt]))){if(k.hitTest)return D.push(!0),!0;var un=gt[tn],gn=gt[tn+1],Rn=gt[tn+2];D.push({key:this.circleKeys[Jt],x1:un-Rn,y1:gn-Rn,x2:un+Rn,y2:gn+Rn})}}}},zr.prototype._queryCellCircle=function(l,d,h,m,E,D,k,G){var le=k.circle,Se=k.seenUids,Ke=this.boxCells[E];if(null!==Ke)for(var Xe=this.bboxes,it=0,xt=Ke;it<xt.length;it+=1){var wt=xt[it];if(!Se.box[wt]){Se.box[wt]=!0;var Pt=4*wt;if(this._circleAndRectCollide(le.x,le.y,le.radius,Xe[Pt+0],Xe[Pt+1],Xe[Pt+2],Xe[Pt+3])&&(!G||G(this.boxKeys[wt])))return D.push(!0),!0}}var gt=this.circleCells[E];if(null!==gt)for(var kt=this.circles,Bt=0,Jt=gt;Bt<Jt.length;Bt+=1){var tn=Jt[Bt];if(!Se.circle[tn]){Se.circle[tn]=!0;var un=3*tn;if(this._circlesCollide(kt[un],kt[un+1],kt[un+2],le.x,le.y,le.radius)&&(!G||G(this.circleKeys[tn])))return D.push(!0),!0}}},zr.prototype._forEachCell=function(l,d,h,m,E,D,k,G){for(var le=this._convertToXCellCoord(l),Se=this._convertToYCellCoord(d),Ke=this._convertToXCellCoord(h),Xe=this._convertToYCellCoord(m),it=le;it<=Ke;it++)for(var xt=Se;xt<=Xe;xt++)if(E.call(this,l,d,h,m,this.xCellCount*xt+it,D,k,G))return},zr.prototype._convertToXCellCoord=function(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))},zr.prototype._convertToYCellCoord=function(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))},zr.prototype._circlesCollide=function(l,d,h,m,E,D){var k=m-l,G=E-d,le=h+D;return le*le>k*k+G*G},zr.prototype._circleAndRectCollide=function(l,d,h,m,E,D,k){var G=(D-m)/2,le=Math.abs(l-(m+G));if(le>G+h)return!1;var Se=(k-E)/2,Ke=Math.abs(d-(E+Se));if(Ke>Se+h)return!1;if(le<=G||Ke<=Se)return!0;var Xe=le-G,it=Ke-Se;return Xe*Xe+it*it<=h*h};var xs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function zi(l,d){for(var h=0;h<l;h++){var m=d.length;d.resize(m+4),d.float32.set(xs,3*m)}}function Br(l,d,h){var m=d[0],E=d[1];return l[0]=h[0]*m+h[4]*E+h[12],l[1]=h[1]*m+h[5]*E+h[13],l[3]=h[3]*m+h[7]*E+h[15],l}var ds=function(l,d,h){void 0===d&&(d=new zr(l.width+200,l.height+200,25)),void 0===h&&(h=new zr(l.width+200,l.height+200,25)),this.transform=l,this.grid=d,this.ignoredGrid=h,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+100,this.screenBottomBoundary=l.height+100,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200};function _i(l,d,h){return d*(g.EXTENT/(l.tileSize*Math.pow(2,h-l.tileID.overscaledZ)))}ds.prototype.placeCollisionBox=function(l,d,h,m,E){var D=this.projectAndGetPerspectiveRatio(m,l.anchorPointX,l.anchorPointY),k=h*D.perspectiveRatio,G=l.x1*k+D.point.x,le=l.y1*k+D.point.y,Se=l.x2*k+D.point.x,Ke=l.y2*k+D.point.y;return!this.isInsideGrid(G,le,Se,Ke)||!d&&this.grid.hitTest(G,le,Se,Ke,E)?{box:[],offscreen:!1}:{box:[G,le,Se,Ke],offscreen:this.isOffscreen(G,le,Se,Ke)}},ds.prototype.placeCollisionCircles=function(l,d,h,m,E,D,k,G,le,Se,Ke,Xe,it){var xt=[],wt=new g.Point(d.anchorX,d.anchorY),Pt=Gr(wt,D),gt=Fr(this.transform.cameraToCenterDistance,Pt.signedDistanceFromCamera),kt=(Se?E/gt:E*gt)/g.ONE_EM,Bt=Gr(wt,k).point,Jt=Yi(kt,m,d.lineOffsetX*kt,d.lineOffsetY*kt,!1,Bt,wt,d,h,k,{}),tn=!1,un=!1,gn=!0;if(Jt){for(var Rn=.5*Xe*gt+it,$n=new g.Point(-100,-100),Vn=new g.Point(this.screenRightBoundary,this.screenBottomBoundary),cr=new oo,yr=Jt.first,Z=Jt.last,Q=[],Fe=yr.path.length-1;Fe>=1;Fe--)Q.push(yr.path[Fe]);for(var st=1;st<Z.path.length;st++)Q.push(Z.path[st]);var Ut=2.5*Rn;if(G){var Qt=Q.map(function(Ys){return Gr(Ys,G)});Q=Qt.some(function(Ys){return Ys.signedDistanceFromCamera<=0})?[]:Qt.map(function(Ys){return Ys.point})}var mn=[];if(Q.length>0){for(var xn=Q[0].clone(),Bn=Q[0].clone(),sr=1;sr<Q.length;sr++)xn.x=Math.min(xn.x,Q[sr].x),xn.y=Math.min(xn.y,Q[sr].y),Bn.x=Math.max(Bn.x,Q[sr].x),Bn.y=Math.max(Bn.y,Q[sr].y);mn=xn.x>=$n.x&&Bn.x<=Vn.x&&xn.y>=$n.y&&Bn.y<=Vn.y?[Q]:Bn.x<$n.x||xn.x>Vn.x||Bn.y<$n.y||xn.y>Vn.y?[]:g.clipLine([Q],$n.x,$n.y,Vn.x,Vn.y)}for(var hr=0,vi=mn;hr<vi.length;hr+=1){var ki;cr.reset(vi[hr],.25*Rn),ki=cr.length<=.5*Rn?1:Math.ceil(cr.paddedLength/Ut)+1;for(var Hi=0;Hi<ki;Hi++){var $o=Hi/Math.max(ki-1,1),Ei=cr.lerp($o),Qi=Ei.x+100,ko=Ei.y+100;xt.push(Qi,ko,Rn,0);var vo=Qi-Rn,Xa=ko-Rn,ua=Qi+Rn,za=ko+Rn;if(gn=gn&&this.isOffscreen(vo,Xa,ua,za),un=un||this.isInsideGrid(vo,Xa,ua,za),!l&&this.grid.hitTestCircle(Qi,ko,Rn,Ke)&&(tn=!0,!le))return{circles:[],offscreen:!1,collisionDetected:tn}}}}return{circles:!le&&tn||!un?[]:xt,offscreen:gn,collisionDetected:tn}},ds.prototype.queryRenderedSymbols=function(l){if(0===l.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var d=[],h=1/0,m=1/0,E=-1/0,D=-1/0,k=0,G=l;k<G.length;k+=1){var le=G[k],Se=new g.Point(le.x+100,le.y+100);h=Math.min(h,Se.x),m=Math.min(m,Se.y),E=Math.max(E,Se.x),D=Math.max(D,Se.y),d.push(Se)}for(var Ke={},Xe={},it=0,xt=this.grid.query(h,m,E,D).concat(this.ignoredGrid.query(h,m,E,D));it<xt.length;it+=1){var wt=xt[it],Pt=wt.key;if(void 0===Ke[Pt.bucketInstanceId]&&(Ke[Pt.bucketInstanceId]={}),!Ke[Pt.bucketInstanceId][Pt.featureIndex]){var gt=[new g.Point(wt.x1,wt.y1),new g.Point(wt.x2,wt.y1),new g.Point(wt.x2,wt.y2),new g.Point(wt.x1,wt.y2)];g.polygonIntersectsPolygon(d,gt)&&(Ke[Pt.bucketInstanceId][Pt.featureIndex]=!0,void 0===Xe[Pt.bucketInstanceId]&&(Xe[Pt.bucketInstanceId]=[]),Xe[Pt.bucketInstanceId].push(Pt.featureIndex))}}return Xe},ds.prototype.insertCollisionBox=function(l,d,h,m,E){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:E},l[0],l[1],l[2],l[3])},ds.prototype.insertCollisionCircles=function(l,d,h,m,E){for(var D=d?this.ignoredGrid:this.grid,k={bucketInstanceId:h,featureIndex:m,collisionGroupID:E},G=0;G<l.length;G+=4)D.insertCircle(k,l[G],l[G+1],l[G+2])},ds.prototype.projectAndGetPerspectiveRatio=function(l,d,h){var m=[d,h,0,1];return Br(m,m,l),{point:new g.Point((m[0]/m[3]+1)/2*this.transform.width+100,(-m[1]/m[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}},ds.prototype.isOffscreen=function(l,d,h,m){return h<100||l>=this.screenRightBoundary||m<100||d>this.screenBottomBoundary},ds.prototype.isInsideGrid=function(l,d,h,m){return h>=0&&l<this.gridRightBoundary&&m>=0&&d<this.gridBottomBoundary},ds.prototype.getViewportMatrix=function(){var l=g.identity([]);return g.translate(l,l,[-100,-100,0]),l};var fo=function(l,d,h,m){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):m&&h?1:0,this.placed=h};fo.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Ji=function(l,d,h,m,E){this.text=new fo(l?l.text:null,d,h,E),this.icon=new fo(l?l.icon:null,d,m,E)};Ji.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ou=function(l,d,h){this.text=l,this.icon=d,this.skipFade=h},ns=function(){this.invProjMatrix=g.create(),this.viewportMatrix=g.create(),this.circles=[]},fs=function(l,d,h,m,E){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=h,this.bucketIndex=m,this.tileID=E},Io=function(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}};function jo(l,d,h,m,E){var D=g.getAnchorAlignment(l),k=-(D.horizontalAlign-.5)*d,G=-(D.verticalAlign-.5)*h,le=g.evaluateVariableOffset(l,m);return new g.Point(k+le[0]*E,G+le[1]*E)}function Mo(l,d,h,m,E,D){var k=l.x1,G=l.x2,le=l.y1,Se=l.y2,Ke=l.anchorPointX,Xe=l.anchorPointY,it=new g.Point(d,h);return m&&it._rotate(E?D:-D),{x1:k+it.x,y1:le+it.y,x2:G+it.x,y2:Se+it.y,anchorPointX:Ke,anchorPointY:Xe}}Io.prototype.get=function(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){var d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:function(h){return h.collisionGroupID===d}}}return this.collisionGroups[l]};var No=function(l,d,h,m){this.transform=l.clone(),this.collisionIndex=new ds(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Io(h),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}};function mi(l,d,h,m,E){l.emplaceBack(d?1:0,h?1:0,m||0,E||0),l.emplaceBack(d?1:0,h?1:0,m||0,E||0),l.emplaceBack(d?1:0,h?1:0,m||0,E||0),l.emplaceBack(d?1:0,h?1:0,m||0,E||0)}No.prototype.getBucketParts=function(l,d,h,m){var E=h.getBucket(d),D=h.latestFeatureIndex;if(E&&D&&d.id===E.layerIds[0]){var k=h.collisionBoxArray,G=E.layers[0].layout,le=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),Se=h.tileSize/g.EXTENT,Ke=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),Xe="map"===G.get("text-pitch-alignment"),it="map"===G.get("text-rotation-alignment"),xt=_i(h,1,this.transform.zoom),wt=Ci(Ke,Xe,it,this.transform,xt),Pt=null;if(Xe){var gt=Mr(Ke,Xe,it,this.transform,xt);Pt=g.multiply([],this.transform.labelPlaneMatrix,gt)}this.retainedQueryData[E.bucketInstanceId]=new fs(E.bucketInstanceId,D,E.sourceLayerIndex,E.index,h.tileID);var kt={bucket:E,layout:G,posMatrix:Ke,textLabelPlaneMatrix:wt,labelToScreenMatrix:Pt,scale:le,textPixelRatio:Se,holdingForFade:h.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:g.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(m)for(var Bt=0,Jt=E.sortKeyRanges;Bt<Jt.length;Bt+=1){var tn=Jt[Bt];l.push({sortKey:tn.sortKey,symbolInstanceStart:tn.symbolInstanceStart,symbolInstanceEnd:tn.symbolInstanceEnd,parameters:kt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:kt})}},No.prototype.attemptAnchorPlacement=function(l,d,h,m,E,D,k,G,le,Se,Ke,Xe,it,xt,wt){var Pt,gt=[Xe.textOffset0,Xe.textOffset1],kt=jo(l,h,m,gt,E),Bt=this.collisionIndex.placeCollisionBox(Mo(d,kt.x,kt.y,D,k,this.transform.angle),Ke,G,le,Se.predicate);if(!wt||0!==this.collisionIndex.placeCollisionBox(Mo(wt,kt.x,kt.y,D,k,this.transform.angle),Ke,G,le,Se.predicate).box.length)return Bt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Xe.crossTileID]&&this.prevPlacement.placements[Xe.crossTileID]&&this.prevPlacement.placements[Xe.crossTileID].text&&(Pt=this.prevPlacement.variableOffsets[Xe.crossTileID].anchor),this.variableOffsets[Xe.crossTileID]={textOffset:gt,width:h,height:m,anchor:l,textBoxScale:E,prevAnchor:Pt},this.markUsedJustification(it,l,Xe,xt),it.allowVerticalPlacement&&(this.markUsedOrientation(it,xt,Xe),this.placedOrientations[Xe.crossTileID]=xt),{shift:kt,placedGlyphBoxes:Bt}):void 0},No.prototype.placeLayerBucketPart=function(l,d,h){var m=this,E=l.parameters,D=E.bucket,k=E.layout,G=E.posMatrix,le=E.textLabelPlaneMatrix,Se=E.labelToScreenMatrix,Ke=E.textPixelRatio,Xe=E.holdingForFade,it=E.collisionBoxArray,xt=E.partiallyEvaluatedTextSize,wt=E.collisionGroup,Pt=k.get("text-optional"),gt=k.get("icon-optional"),kt=k.get("text-allow-overlap"),Bt=k.get("icon-allow-overlap"),Jt="map"===k.get("text-rotation-alignment"),tn="map"===k.get("text-pitch-alignment"),un="none"!==k.get("icon-text-fit"),gn="viewport-y"===k.get("symbol-z-order"),Rn=kt&&(Bt||!D.hasIconData()||gt),$n=Bt&&(kt||!D.hasTextData()||Pt);!D.collisionArrays&&it&&D.deserializeCollisionBoxes(it);var Vn=function(st,Ut){if(!d[st.crossTileID])if(Xe)m.placements[st.crossTileID]=new ou(!1,!1,!1);else{var Qt,mn=!1,xn=!1,Bn=!0,sr=null,hr={box:null,offscreen:null},vi={box:null,offscreen:null},ki=null,Hi=null,$o=0,Ei=0,Qi=0;Ut.textFeatureIndex?$o=Ut.textFeatureIndex:st.useRuntimeCollisionCircles&&($o=st.featureIndex),Ut.verticalTextFeatureIndex&&(Ei=Ut.verticalTextFeatureIndex);var ko=Ut.textBox;if(ko){var vo=function(Fi){var Va=g.WritingMode.horizontal;if(D.allowVerticalPlacement&&!Fi&&m.prevPlacement){var Sa=m.prevPlacement.placedOrientations[st.crossTileID];Sa&&(m.placedOrientations[st.crossTileID]=Sa,m.markUsedOrientation(D,Va=Sa,st))}return Va},Xa=function(Fi,Va){if(D.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&Ut.verticalTextBox)for(var Sa=0,Ru=D.writingModes;Sa<Ru.length&&(Ru[Sa]===g.WritingMode.vertical?(hr=Va(),vi=hr):hr=Fi(),!(hr&&hr.box&&hr.box.length));Sa+=1);else hr=Fi()};if(k.get("text-variable-anchor")){var ua=k.get("text-variable-anchor");if(m.prevPlacement&&m.prevPlacement.variableOffsets[st.crossTileID]){var za=m.prevPlacement.variableOffsets[st.crossTileID];ua.indexOf(za.anchor)>0&&(ua=ua.filter(function(Fi){return Fi!==za.anchor})).unshift(za.anchor)}var Ys=function(Fi,Va,Sa){for(var Ru=Fi.x2-Fi.x1,dc=Fi.y2-Fi.y1,Ku=st.textBoxScale,Qd=un&&!Bt?Va:null,fu={box:[],offscreen:!1},Nc=kt?2*ua.length:ua.length,Yu=0;Yu<Nc;++Yu){var fc=m.attemptAnchorPlacement(ua[Yu%ua.length],Fi,Ru,dc,Ku,Jt,tn,Ke,G,wt,Yu>=ua.length,st,D,Sa,Qd);if(fc&&(fu=fc.placedGlyphBoxes)&&fu.box&&fu.box.length){mn=!0,sr=fc.shift;break}}return fu};Xa(function(){return Ys(ko,Ut.iconBox,g.WritingMode.horizontal)},function(){var Fi=Ut.verticalTextBox;return D.allowVerticalPlacement&&!(hr&&hr.box&&hr.box.length)&&st.numVerticalGlyphVertices>0&&Fi?Ys(Fi,Ut.verticalIconBox,g.WritingMode.vertical):{box:null,offscreen:null}}),hr&&(mn=hr.box,Bn=hr.offscreen);var ol=vo(hr&&hr.box);if(!mn&&m.prevPlacement){var Ia=m.prevPlacement.variableOffsets[st.crossTileID];Ia&&(m.variableOffsets[st.crossTileID]=Ia,m.markUsedJustification(D,Ia.anchor,st,ol))}}else{var El=function(Fi,Va){var Sa=m.collisionIndex.placeCollisionBox(Fi,kt,Ke,G,wt.predicate);return Sa&&Sa.box&&Sa.box.length&&(m.markUsedOrientation(D,Va,st),m.placedOrientations[st.crossTileID]=Va),Sa};Xa(function(){return El(ko,g.WritingMode.horizontal)},function(){var Fi=Ut.verticalTextBox;return D.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&Fi?El(Fi,g.WritingMode.vertical):{box:null,offscreen:null}}),vo(hr&&hr.box&&hr.box.length)}}if(mn=(Qt=hr)&&Qt.box&&Qt.box.length>0,Bn=Qt&&Qt.offscreen,st.useRuntimeCollisionCircles){var Ta=D.text.placedSymbolArray.get(st.centerJustifiedTextSymbolIndex),ml=g.evaluateSizeForFeature(D.textSizeData,xt,Ta),Wu=k.get("text-padding");ki=m.collisionIndex.placeCollisionCircles(kt,Ta,D.lineVertexArray,D.glyphOffsetArray,ml,G,le,Se,h,tn,wt.predicate,st.collisionCircleDiameter,Wu),mn=kt||ki.circles.length>0&&!ki.collisionDetected,Bn=Bn&&ki.offscreen}if(Ut.iconFeatureIndex&&(Qi=Ut.iconFeatureIndex),Ut.iconBox){var Il=function(Fi){var Va=un&&sr?Mo(Fi,sr.x,sr.y,Jt,tn,m.transform.angle):Fi;return m.collisionIndex.placeCollisionBox(Va,Bt,Ke,G,wt.predicate)};xn=vi&&vi.box&&vi.box.length&&Ut.verticalIconBox?(Hi=Il(Ut.verticalIconBox)).box.length>0:(Hi=Il(Ut.iconBox)).box.length>0,Bn=Bn&&Hi.offscreen}var Zu=Pt||0===st.numHorizontalGlyphVertices&&0===st.numVerticalGlyphVertices,ys=gt||0===st.numIconVertices;if(Zu||ys?ys?Zu||(xn=xn&&mn):mn=xn&&mn:xn=mn=xn&&mn,mn&&Qt&&Qt.box&&m.collisionIndex.insertCollisionBox(Qt.box,k.get("text-ignore-placement"),D.bucketInstanceId,vi&&vi.box&&Ei?Ei:$o,wt.ID),xn&&Hi&&m.collisionIndex.insertCollisionBox(Hi.box,k.get("icon-ignore-placement"),D.bucketInstanceId,Qi,wt.ID),ki&&(mn&&m.collisionIndex.insertCollisionCircles(ki.circles,k.get("text-ignore-placement"),D.bucketInstanceId,$o,wt.ID),h)){var Tl=D.bucketInstanceId,Sl=m.collisionCircleArrays[Tl];void 0===Sl&&(Sl=m.collisionCircleArrays[Tl]=new ns);for(var Bl=0;Bl<ki.circles.length;Bl+=4)Sl.circles.push(ki.circles[Bl+0]),Sl.circles.push(ki.circles[Bl+1]),Sl.circles.push(ki.circles[Bl+2]),Sl.circles.push(ki.collisionDetected?1:0)}m.placements[st.crossTileID]=new ou(mn||Rn,xn||$n,Bn||D.justReloaded),d[st.crossTileID]=!0}};if(gn)for(var cr=D.getSortedSymbolIndexes(this.transform.angle),yr=cr.length-1;yr>=0;--yr){var Z=cr[yr];Vn(D.symbolInstances.get(Z),D.collisionArrays[Z])}else for(var Q=l.symbolInstanceStart;Q<l.symbolInstanceEnd;Q++)Vn(D.symbolInstances.get(Q),D.collisionArrays[Q]);if(h&&D.bucketInstanceId in this.collisionCircleArrays){var Fe=this.collisionCircleArrays[D.bucketInstanceId];g.invert(Fe.invProjMatrix,G),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1},No.prototype.markUsedJustification=function(l,d,h,m){var E;E=m===g.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[g.getAnchorJustification(d)];for(var D=0,k=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];D<k.length;D+=1){var G=k[D];G>=0&&(l.text.placedSymbolArray.get(G).crossTileID=E>=0&&G!==E?0:h.crossTileID)}},No.prototype.markUsedOrientation=function(l,d,h){for(var m=d===g.WritingMode.horizontal||d===g.WritingMode.horizontalOnly?d:0,E=d===g.WritingMode.vertical?d:0,D=0,k=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];D<k.length;D+=1)l.text.placedSymbolArray.get(k[D]).placedOrientation=m;h.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=E)},No.prototype.commit=function(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;var d=this.prevPlacement,h=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;var m=d?d.symbolFadeChange(l):1,E=d?d.opacities:{},D=d?d.variableOffsets:{},k=d?d.placedOrientations:{};for(var G in this.placements){var le=this.placements[G],Se=E[G];Se?(this.opacities[G]=new Ji(Se,m,le.text,le.icon),h=h||le.text!==Se.text.placed||le.icon!==Se.icon.placed):(this.opacities[G]=new Ji(null,m,le.text,le.icon,le.skipFade),h=h||le.text||le.icon)}for(var Ke in E){var Xe=E[Ke];if(!this.opacities[Ke]){var it=new Ji(Xe,m,!1,!1);it.isHidden()||(this.opacities[Ke]=it,h=h||Xe.text.placed||Xe.icon.placed)}}for(var xt in D)this.variableOffsets[xt]||!this.opacities[xt]||this.opacities[xt].isHidden()||(this.variableOffsets[xt]=D[xt]);for(var wt in k)this.placedOrientations[wt]||!this.opacities[wt]||this.opacities[wt].isHidden()||(this.placedOrientations[wt]=k[wt]);h?this.lastPlacementChangeTime=l:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)},No.prototype.updateLayerOpacities=function(l,d){for(var h={},m=0,E=d;m<E.length;m+=1){var D=E[m],k=D.getBucket(l);k&&D.latestFeatureIndex&&l.id===k.layerIds[0]&&this.updateBucketOpacities(k,h,D.collisionBoxArray)}},No.prototype.updateBucketOpacities=function(l,d,h){var m=this;l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();var E=l.layers[0].layout,D=new Ji(null,0,!1,!1,!0),k=E.get("text-allow-overlap"),G=E.get("icon-allow-overlap"),le=E.get("text-variable-anchor"),Se="map"===E.get("text-rotation-alignment"),Ke="map"===E.get("text-pitch-alignment"),Xe="none"!==E.get("icon-text-fit"),it=new Ji(null,0,k&&(G||!l.hasIconData()||E.get("icon-optional")),G&&(k||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&h&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(h);for(var xt=function(kt,Bt,Jt){for(var tn=0;tn<Bt/4;tn++)kt.opacityVertexArray.emplaceBack(Jt)},wt=function(kt){var Bt=l.symbolInstances.get(kt),Jt=Bt.numHorizontalGlyphVertices,tn=Bt.numVerticalGlyphVertices,un=Bt.crossTileID,gn=m.opacities[un];d[un]?gn=D:gn||(m.opacities[un]=gn=it),d[un]=!0;var Rn=Bt.numIconVertices>0,$n=m.placedOrientations[Bt.crossTileID],Vn=$n===g.WritingMode.vertical,cr=$n===g.WritingMode.horizontal||$n===g.WritingMode.horizontalOnly;if(Jt>0||tn>0){var yr=ta(gn.text);xt(l.text,Jt,Vn?pa:yr),xt(l.text,tn,cr?pa:yr);var Z=gn.text.isHidden();[Bt.rightJustifiedTextSymbolIndex,Bt.centerJustifiedTextSymbolIndex,Bt.leftJustifiedTextSymbolIndex].forEach(function(hr){hr>=0&&(l.text.placedSymbolArray.get(hr).hidden=Z||Vn?1:0)}),Bt.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(Bt.verticalPlacedTextSymbolIndex).hidden=Z||cr?1:0);var Q=m.variableOffsets[Bt.crossTileID];Q&&m.markUsedJustification(l,Q.anchor,Bt,$n);var Fe=m.placedOrientations[Bt.crossTileID];Fe&&(m.markUsedJustification(l,"left",Bt,Fe),m.markUsedOrientation(l,Fe,Bt))}if(Rn){var st=ta(gn.icon),Ut=!(Xe&&Bt.verticalPlacedIconSymbolIndex&&Vn);Bt.placedIconSymbolIndex>=0&&(xt(l.icon,Bt.numIconVertices,Ut?st:pa),l.icon.placedSymbolArray.get(Bt.placedIconSymbolIndex).hidden=gn.icon.isHidden()),Bt.verticalPlacedIconSymbolIndex>=0&&(xt(l.icon,Bt.numVerticalIconVertices,Ut?pa:st),l.icon.placedSymbolArray.get(Bt.verticalPlacedIconSymbolIndex).hidden=gn.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){var Qt=l.collisionArrays[kt];if(Qt){var mn=new g.Point(0,0);if(Qt.textBox||Qt.verticalTextBox){var xn=!0;if(le){var Bn=m.variableOffsets[un];Bn?(mn=jo(Bn.anchor,Bn.width,Bn.height,Bn.textOffset,Bn.textBoxScale),Se&&mn._rotate(Ke?m.transform.angle:-m.transform.angle)):xn=!1}Qt.textBox&&mi(l.textCollisionBox.collisionVertexArray,gn.text.placed,!xn||Vn,mn.x,mn.y),Qt.verticalTextBox&&mi(l.textCollisionBox.collisionVertexArray,gn.text.placed,!xn||cr,mn.x,mn.y)}var sr=Boolean(!cr&&Qt.verticalIconBox);Qt.iconBox&&mi(l.iconCollisionBox.collisionVertexArray,gn.icon.placed,sr,Xe?mn.x:0,Xe?mn.y:0),Qt.verticalIconBox&&mi(l.iconCollisionBox.collisionVertexArray,gn.icon.placed,!sr,Xe?mn.x:0,Xe?mn.y:0)}}},Pt=0;Pt<l.symbolInstances.length;Pt++)wt(Pt);if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){var gt=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=gt.invProjMatrix,l.placementViewportMatrix=gt.viewportMatrix,l.collisionCircleArray=gt.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}},No.prototype.symbolFadeChange=function(l){return 0===this.fadeDuration?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},No.prototype.zoomAdjustment=function(l){return Math.max(0,(this.transform.zoom-l)/1.5)},No.prototype.hasTransitions=function(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration},No.prototype.stillRecent=function(l,d){var h=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*h>l},No.prototype.setStale=function(){this.stale=!0};var su=Math.pow(2,25),Oa=Math.pow(2,24),rs=Math.pow(2,17),Yo=Math.pow(2,16),$a=Math.pow(2,9),au=Math.pow(2,8),fa=Math.pow(2,1);function ta(l){if(0===l.opacity&&!l.placed)return 0;if(1===l.opacity&&l.placed)return 4294967295;var d=l.placed?1:0,h=Math.floor(127*l.opacity);return h*su+d*Oa+h*rs+d*Yo+h*$a+d*au+h*fa+d}var pa=0,Tu=function(l){this._sortAcrossTiles="viewport-y"!==l.layout.get("symbol-z-order")&&void 0!==l.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Tu.prototype.continuePlacement=function(l,d,h,m,E){for(var D=this._bucketParts;this._currentTileIndex<l.length;)if(d.getBucketParts(D,m,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort(function(k,G){return k.sortKey-G.sortKey}));this._currentPartIndex<D.length;)if(d.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,E())return!0;return!1};var Uu=function(l,d,h,m,E,D,k){this.placement=new No(l,E,D,k),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1};Uu.prototype.isDone=function(){return this._done},Uu.prototype.continuePlacement=function(l,d,h){for(var m=this,E=g.browser.now(),D=function(){var le=g.browser.now()-E;return!m._forceFullPlacement&&le>2};this._currentPlacementIndex>=0;){var k=d[l[this._currentPlacementIndex]],G=this.placement.collisionIndex.transform.zoom;if("symbol"===k.type&&(!k.minzoom||k.minzoom<=G)&&(!k.maxzoom||k.maxzoom>G)){if(this._inProgressLayer||(this._inProgressLayer=new Tu(k)),this._inProgressLayer.continuePlacement(h[k.source],this.placement,this._showCollisionBoxes,k,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Uu.prototype.commit=function(l){return this.placement.commit(l),this.placement};var ma=512/g.EXTENT/2,Ss=function(l,d,h){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(var m=0;m<d.length;m++){var E=d.get(m),D=E.key;this.indexedSymbolInstances[D]||(this.indexedSymbolInstances[D]=[]),this.indexedSymbolInstances[D].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,l)})}};Ss.prototype.getScaledCoordinates=function(l,d){var h=ma/Math.pow(2,d.canonical.z-this.tileID.canonical.z);return{x:Math.floor((d.canonical.x*g.EXTENT+l.anchorX)*h),y:Math.floor((d.canonical.y*g.EXTENT+l.anchorY)*h)}},Ss.prototype.findMatches=function(l,d,h){for(var m=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),E=0;E<l.length;E++){var D=l.get(E);if(!D.crossTileID){var k=this.indexedSymbolInstances[D.key];if(k)for(var G=this.getScaledCoordinates(D,d),le=0,Se=k;le<Se.length;le+=1){var Ke=Se[le];if(Math.abs(Ke.coord.x-G.x)<=m&&Math.abs(Ke.coord.y-G.y)<=m&&!h[Ke.crossTileID]){h[Ke.crossTileID]=!0,D.crossTileID=Ke.crossTileID;break}}}}};var Ls=function(){this.maxCrossTileID=0};Ls.prototype.generate=function(){return++this.maxCrossTileID};var $s=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};$s.prototype.handleWrapJump=function(l){var d=Math.round((l-this.lng)/360);if(0!==d)for(var h in this.indexes){var m=this.indexes[h],E={};for(var D in m){var k=m[D];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+d),E[k.tileID.key]=k}this.indexes[h]=E}this.lng=l},$s.prototype.addBucket=function(l,d,h){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(var m=0;m<d.symbolInstances.length;m++)d.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});var E=this.usedCrossTileIDs[l.overscaledZ];for(var D in this.indexes){var k=this.indexes[D];if(Number(D)>l.overscaledZ)for(var G in k){var le=k[G];le.tileID.isChildOf(l)&&le.findMatches(d.symbolInstances,l,E)}else{var Se=k[l.scaledTo(Number(D)).key];Se&&Se.findMatches(d.symbolInstances,l,E)}}for(var Ke=0;Ke<d.symbolInstances.length;Ke++){var Xe=d.symbolInstances.get(Ke);Xe.crossTileID||(Xe.crossTileID=h.generate(),E[Xe.crossTileID]=!0)}return void 0===this.indexes[l.overscaledZ]&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Ss(l,d.symbolInstances,d.bucketInstanceId),!0},$s.prototype.removeBucketCrossTileIDs=function(l,d){for(var h in d.indexedSymbolInstances)for(var m=0,E=d.indexedSymbolInstances[h];m<E.length;m+=1)delete this.usedCrossTileIDs[l][E[m].crossTileID]},$s.prototype.removeStaleBuckets=function(l){var d=!1;for(var h in this.indexes){var m=this.indexes[h];for(var E in m)l[m[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,m[E]),delete m[E],d=!0)}return d};var Ho=function(){this.layerIndexes={},this.crossTileIDs=new Ls,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ho.prototype.addLayer=function(l,d,h){var m=this.layerIndexes[l.id];void 0===m&&(m=this.layerIndexes[l.id]=new $s);var E=!1,D={};m.handleWrapJump(h);for(var k=0,G=d;k<G.length;k+=1){var le=G[k],Se=le.getBucket(l);Se&&l.id===Se.layerIds[0]&&(Se.bucketInstanceId||(Se.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(le.tileID,Se,this.crossTileIDs)&&(E=!0),D[Se.bucketInstanceId]=!0)}return m.removeStaleBuckets(D)&&(E=!0),E},Ho.prototype.pruneUnusedLayers=function(l){var d={};for(var h in l.forEach(function(m){d[m]=!0}),this.layerIndexes)d[h]||delete this.layerIndexes[h]};var ga=function(l,d){return g.emitValidationErrors(l,d&&d.filter(function(h){return"source.canvas"!==h.identifier}))},Cs=g.pick(Hn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Es=g.pick(Hn,["setCenter","setZoom","setBearing","setPitch"]),is=function(){var l={},d=g.styleSpec.$version;for(var h in g.styleSpec.$root){var m,E=g.styleSpec.$root[h];E.required&&null!=(m="version"===h?d:"array"===E.type?[]:{})&&(l[h]=m)}return l}(),po=function(l){function d(h,m){var E=this;void 0===m&&(m={}),l.call(this),this.map=h,this.dispatcher=new Y(an(),this),this.imageManager=new bt,this.imageManager.setEventedParent(this),this.glyphManager=new j(h._requestManager,m.localIdeographFontFamily),this.lineAtlas=new U(256,512),this.crossTileSymbolIndex=new Ho,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new g.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",g.getReferrer());var D=this;this._rtlTextPluginCallback=d.registerForPluginStateChange(function(k){D.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:k.pluginStatus,pluginURL:k.pluginURL},function(G,le){if(g.triggerPluginCompletionEvent(G),le&&le.every(function(Ke){return Ke}))for(var Se in D.sourceCaches)D.sourceCaches[Se].reload()})}),this.on("data",function(k){if("source"===k.dataType&&"metadata"===k.sourceDataType){var G=E.sourceCaches[k.sourceId];if(G){var le=G.getSource();if(le&&le.vectorLayerIds)for(var Se in E._layers){var Ke=E._layers[Se];Ke.source===le.id&&E._validateLayer(Ke)}}}})}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.loadURL=function(h,m){var E=this;void 0===m&&(m={}),this.fire(new g.Event("dataloading",{dataType:"style"}));var D="boolean"==typeof m.validate?m.validate:!g.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,m.accessToken);var k=this.map._requestManager.transformRequest(h,g.ResourceType.Style);this._request=g.getJSON(k,function(G,le){E._request=null,G?E.fire(new g.ErrorEvent(G)):le&&E._load(le,D)})},d.prototype.loadJSON=function(h,m){var E=this;void 0===m&&(m={}),this.fire(new g.Event("dataloading",{dataType:"style"})),this._request=g.browser.frame(function(){E._request=null,E._load(h,!1!==m.validate)})},d.prototype.loadEmpty=function(){this.fire(new g.Event("dataloading",{dataType:"style"})),this._load(is,!1)},d.prototype._load=function(h,m){if(!m||!ga(this,g.validateStyle(h))){for(var E in this._loaded=!0,this.stylesheet=h,h.sources)this.addSource(E,h.sources[E],{validate:!1});h.sprite?this._loadSprite(h.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(h.glyphs);var D=Yn(this.stylesheet.layers);this._order=D.map(function(Se){return Se.id}),this._layers={},this._serializedLayers={};for(var k=0,G=D;k<G.length;k+=1){var le=G[k];(le=g.createStyleLayer(le)).setEventedParent(this,{layer:{id:le.id}}),this._layers[le.id]=le,this._serializedLayers[le.id]=le.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new q(this.stylesheet.light),this.fire(new g.Event("data",{dataType:"style"})),this.fire(new g.Event("style.load"))}},d.prototype._loadSprite=function(h){var m=this;this._spriteRequest=function(E,D,k){var G,le,Se,Ke=g.browser.devicePixelRatio>1?"@2x":"",Xe=g.getJSON(D.transformRequest(D.normalizeSpriteURL(E,Ke,".json"),g.ResourceType.SpriteJSON),function(wt,Pt){Xe=null,Se||(Se=wt,G=Pt,xt())}),it=g.getImage(D.transformRequest(D.normalizeSpriteURL(E,Ke,".png"),g.ResourceType.SpriteImage),function(wt,Pt){it=null,Se||(Se=wt,le=Pt,xt())});function xt(){if(Se)k(Se);else if(G&&le){var wt=g.browser.getImageData(le),Pt={};for(var gt in G){var kt=G[gt],Bt=kt.width,Jt=kt.height,tn=kt.x,un=kt.y,gn=kt.sdf,Rn=kt.pixelRatio,$n=kt.stretchX,Vn=kt.stretchY,cr=kt.content,yr=new g.RGBAImage({width:Bt,height:Jt});g.RGBAImage.copy(wt,yr,{x:tn,y:un},{x:0,y:0},{width:Bt,height:Jt}),Pt[gt]={data:yr,pixelRatio:Rn,sdf:gn,stretchX:$n,stretchY:Vn,content:cr}}k(null,Pt)}}return{cancel:function(){Xe&&(Xe.cancel(),Xe=null),it&&(it.cancel(),it=null)}}}(h,this.map._requestManager,function(E,D){if(m._spriteRequest=null,E)m.fire(new g.ErrorEvent(E));else if(D)for(var k in D)m.imageManager.addImage(k,D[k]);m.imageManager.setLoaded(!0),m._availableImages=m.imageManager.listImages(),m.dispatcher.broadcast("setImages",m._availableImages),m.fire(new g.Event("data",{dataType:"style"}))})},d.prototype._validateLayer=function(h){var m=this.sourceCaches[h.source];if(m){var E=h.sourceLayer;if(E){var D=m.getSource();("geojson"===D.type||D.vectorLayerIds&&-1===D.vectorLayerIds.indexOf(E))&&this.fire(new g.ErrorEvent(new Error('Source layer "'+E+'" does not exist on source "'+D.id+'" as specified by style layer "'+h.id+'"')))}}},d.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var h in this.sourceCaches)if(!this.sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()},d.prototype._serializeLayers=function(h){for(var m=[],E=0,D=h;E<D.length;E+=1){var k=this._layers[D[E]];"custom"!==k.type&&m.push(k.serialize())}return m},d.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(var m in this._layers)if(this._layers[m].hasTransition())return!0;return!1},d.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},d.prototype.update=function(h){if(this._loaded){var m=this._changed;if(this._changed){var E=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);for(var k in(E.length||D.length)&&this._updateWorkerLayers(E,D),this._updatedSources){var G=this._updatedSources[k];"reload"===G?this._reloadSource(k):"clear"===G&&this._clearSource(k)}for(var le in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[le].updateTransitions(h);this.light.updateTransitions(h),this._resetUpdates()}var Se={};for(var Ke in this.sourceCaches){var Xe=this.sourceCaches[Ke];Se[Ke]=Xe.used,Xe.used=!1}for(var it=0,xt=this._order;it<xt.length;it+=1){var wt=this._layers[xt[it]];wt.recalculate(h,this._availableImages),!wt.isHidden(h.zoom)&&wt.source&&(this.sourceCaches[wt.source].used=!0)}for(var Pt in Se){var gt=this.sourceCaches[Pt];Se[Pt]!==gt.used&&gt.fire(new g.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Pt}))}this.light.recalculate(h),this.z=h.zoom,m&&this.fire(new g.Event("data",{dataType:"style"}))}},d.prototype._updateTilesForChangedImages=function(){var h=Object.keys(this._changedImages);if(h.length){for(var m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}},d.prototype._updateWorkerLayers=function(h,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:m})},d.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},d.prototype.setState=function(h){var m=this;if(this._checkLoaded(),ga(this,g.validateStyle(h)))return!1;(h=g.clone$1(h)).layers=Yn(h.layers);var E=function(k,G){if(!k)return[{command:Hn.setStyle,args:[G]}];var le=[];try{if(!g.deepEqual(k.version,G.version))return[{command:Hn.setStyle,args:[G]}];g.deepEqual(k.center,G.center)||le.push({command:Hn.setCenter,args:[G.center]}),g.deepEqual(k.zoom,G.zoom)||le.push({command:Hn.setZoom,args:[G.zoom]}),g.deepEqual(k.bearing,G.bearing)||le.push({command:Hn.setBearing,args:[G.bearing]}),g.deepEqual(k.pitch,G.pitch)||le.push({command:Hn.setPitch,args:[G.pitch]}),g.deepEqual(k.sprite,G.sprite)||le.push({command:Hn.setSprite,args:[G.sprite]}),g.deepEqual(k.glyphs,G.glyphs)||le.push({command:Hn.setGlyphs,args:[G.glyphs]}),g.deepEqual(k.transition,G.transition)||le.push({command:Hn.setTransition,args:[G.transition]}),g.deepEqual(k.light,G.light)||le.push({command:Hn.setLight,args:[G.light]});var Se={},Ke=[];!function(it,xt,wt,Pt){var gt;for(gt in xt=xt||{},it=it||{})it.hasOwnProperty(gt)&&(xt.hasOwnProperty(gt)||Xn(gt,wt,Pt));for(gt in xt)xt.hasOwnProperty(gt)&&(it.hasOwnProperty(gt)?g.deepEqual(it[gt],xt[gt])||("geojson"===it[gt].type&&"geojson"===xt[gt].type&&yn(it,xt,gt)?wt.push({command:Hn.setGeoJSONSourceData,args:[gt,xt[gt].data]}):br(gt,xt,wt,Pt)):Ir(gt,xt,wt))}(k.sources,G.sources,Ke,Se);var Xe=[];k.layers&&k.layers.forEach(function(it){Se[it.source]?le.push({command:Hn.removeLayer,args:[it.id]}):Xe.push(it)}),le=le.concat(Ke),function(it,xt,wt){xt=xt||[];var Pt,gt,kt,Bt,Jt,tn,un,gn=(it=it||[]).map(Dr),Rn=xt.map(Dr),$n=it.reduce(jr,{}),Vn=xt.reduce(jr,{}),cr=gn.slice(),yr=Object.create(null);for(Pt=0,gt=0;Pt<gn.length;Pt++)Vn.hasOwnProperty(kt=gn[Pt])?gt++:(wt.push({command:Hn.removeLayer,args:[kt]}),cr.splice(cr.indexOf(kt,gt),1));for(Pt=0,gt=0;Pt<Rn.length;Pt++)cr[cr.length-1-Pt]!==(kt=Rn[Rn.length-1-Pt])&&($n.hasOwnProperty(kt)?(wt.push({command:Hn.removeLayer,args:[kt]}),cr.splice(cr.lastIndexOf(kt,cr.length-gt),1)):gt++,wt.push({command:Hn.addLayer,args:[Vn[kt],tn=cr[cr.length-Pt]]}),cr.splice(cr.length-Pt,0,kt),yr[kt]=!0);for(Pt=0;Pt<Rn.length;Pt++)if(Bt=$n[kt=Rn[Pt]],Jt=Vn[kt],!yr[kt]&&!g.deepEqual(Bt,Jt))if(g.deepEqual(Bt.source,Jt.source)&&g.deepEqual(Bt["source-layer"],Jt["source-layer"])&&g.deepEqual(Bt.type,Jt.type)){for(un in ur(Bt.layout,Jt.layout,wt,kt,null,Hn.setLayoutProperty),ur(Bt.paint,Jt.paint,wt,kt,null,Hn.setPaintProperty),g.deepEqual(Bt.filter,Jt.filter)||wt.push({command:Hn.setFilter,args:[kt,Jt.filter]}),g.deepEqual(Bt.minzoom,Jt.minzoom)&&g.deepEqual(Bt.maxzoom,Jt.maxzoom)||wt.push({command:Hn.setLayerZoomRange,args:[kt,Jt.minzoom,Jt.maxzoom]}),Bt)Bt.hasOwnProperty(un)&&"layout"!==un&&"paint"!==un&&"filter"!==un&&"metadata"!==un&&"minzoom"!==un&&"maxzoom"!==un&&(0===un.indexOf("paint.")?ur(Bt[un],Jt[un],wt,kt,un.slice(6),Hn.setPaintProperty):g.deepEqual(Bt[un],Jt[un])||wt.push({command:Hn.setLayerProperty,args:[kt,un,Jt[un]]}));for(un in Jt)Jt.hasOwnProperty(un)&&!Bt.hasOwnProperty(un)&&"layout"!==un&&"paint"!==un&&"filter"!==un&&"metadata"!==un&&"minzoom"!==un&&"maxzoom"!==un&&(0===un.indexOf("paint.")?ur(Bt[un],Jt[un],wt,kt,un.slice(6),Hn.setPaintProperty):g.deepEqual(Bt[un],Jt[un])||wt.push({command:Hn.setLayerProperty,args:[kt,un,Jt[un]]}))}else wt.push({command:Hn.removeLayer,args:[kt]}),tn=cr[cr.lastIndexOf(kt)+1],wt.push({command:Hn.addLayer,args:[Jt,tn]})}(Xe,G.layers,le)}catch(it){console.warn("Unable to compute style diff:",it),le=[{command:Hn.setStyle,args:[G]}]}return le}(this.serialize(),h).filter(function(k){return!(k.command in Es)});if(0===E.length)return!1;var D=E.filter(function(k){return!(k.command in Cs)});if(D.length>0)throw new Error("Unimplemented: "+D.map(function(k){return k.command}).join(", ")+".");return E.forEach(function(k){"setTransition"!==k.command&&m[k.command].apply(m,k.args)}),this.stylesheet=h,!0},d.prototype.addImage=function(h,m){if(this.getImage(h))return this.fire(new g.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(h,m),this._afterImageUpdated(h)},d.prototype.updateImage=function(h,m){this.imageManager.updateImage(h,m)},d.prototype.getImage=function(h){return this.imageManager.getImage(h)},d.prototype.removeImage=function(h){if(!this.getImage(h))return this.fire(new g.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(h),this._afterImageUpdated(h)},d.prototype._afterImageUpdated=function(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new g.Event("data",{dataType:"style"}))},d.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},d.prototype.addSource=function(h,m,E){var D=this;if(void 0===E&&(E={}),this._checkLoaded(),void 0!==this.sourceCaches[h])throw new Error("There is already a source with this ID");if(!m.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(m).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(g.validateStyle.source,"sources."+h,m,null,E))){this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);var k=this.sourceCaches[h]=new Ie(h,m,this.dispatcher);k.style=this,k.setEventedParent(this,function(){return{isSourceLoaded:D.loaded(),source:k.serialize(),sourceId:h}}),k.onAdd(this.map),this._changed=!0}},d.prototype.removeSource=function(h){if(this._checkLoaded(),void 0===this.sourceCaches[h])throw new Error("There is no source with this ID");for(var m in this._layers)if(this._layers[m].source===h)return this.fire(new g.ErrorEvent(new Error('Source "'+h+'" cannot be removed while layer "'+m+'" is using it.')));var E=this.sourceCaches[h];delete this.sourceCaches[h],delete this._updatedSources[h],E.fire(new g.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:h})),E.setEventedParent(null),E.clearTiles(),E.onRemove&&E.onRemove(this.map),this._changed=!0},d.prototype.setGeoJSONSourceData=function(h,m){this._checkLoaded(),this.sourceCaches[h].getSource().setData(m),this._changed=!0},d.prototype.getSource=function(h){return this.sourceCaches[h]&&this.sourceCaches[h].getSource()},d.prototype.addLayer=function(h,m,E){void 0===E&&(E={}),this._checkLoaded();var D=h.id;if(this.getLayer(D))this.fire(new g.ErrorEvent(new Error('Layer with id "'+D+'" already exists on this map')));else{var k;if("custom"===h.type){if(ga(this,g.validateCustomStyleLayer(h)))return;k=g.createStyleLayer(h)}else{if("object"==typeof h.source&&(this.addSource(D,h.source),h=g.clone$1(h),h=g.extend(h,{source:D})),this._validate(g.validateStyle.layer,"layers."+D,h,{arrayIndex:-1},E))return;k=g.createStyleLayer(h),this._validateLayer(k),k.setEventedParent(this,{layer:{id:D}}),this._serializedLayers[k.id]=k.serialize()}var G=m?this._order.indexOf(m):this._order.length;if(m&&-1===G)this.fire(new g.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.')));else{if(this._order.splice(G,0,D),this._layerOrderChanged=!0,this._layers[D]=k,this._removedLayers[D]&&k.source&&"custom"!==k.type){var le=this._removedLayers[D];delete this._removedLayers[D],le.type!==k.type?this._updatedSources[k.source]="clear":(this._updatedSources[k.source]="reload",this.sourceCaches[k.source].pause())}this._updateLayer(k),k.onAdd&&k.onAdd(this.map)}}},d.prototype.moveLayer=function(h,m){if(this._checkLoaded(),this._changed=!0,this._layers[h]){if(h!==m){var E=this._order.indexOf(h);this._order.splice(E,1);var D=m?this._order.indexOf(m):this._order.length;m&&-1===D?this.fire(new g.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.'))):(this._order.splice(D,0,h),this._layerOrderChanged=!0)}}else this.fire(new g.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be moved.")))},d.prototype.removeLayer=function(h){this._checkLoaded();var m=this._layers[h];if(m){m.setEventedParent(null);var E=this._order.indexOf(h);this._order.splice(E,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=m,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],m.onRemove&&m.onRemove(this.map)}else this.fire(new g.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be removed.")))},d.prototype.getLayer=function(h){return this._layers[h]},d.prototype.hasLayer=function(h){return h in this._layers},d.prototype.setLayerZoomRange=function(h,m,E){this._checkLoaded();var D=this.getLayer(h);D?D.minzoom===m&&D.maxzoom===E||(null!=m&&(D.minzoom=m),null!=E&&(D.maxzoom=E),this._updateLayer(D)):this.fire(new g.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot have zoom extent.")))},d.prototype.setFilter=function(h,m,E){void 0===E&&(E={}),this._checkLoaded();var D=this.getLayer(h);if(D){if(!g.deepEqual(D.filter,m))return null==m?(D.filter=void 0,void this._updateLayer(D)):void(this._validate(g.validateStyle.filter,"layers."+D.id+".filter",m,null,E)||(D.filter=g.clone$1(m),this._updateLayer(D)))}else this.fire(new g.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be filtered.")))},d.prototype.getFilter=function(h){return g.clone$1(this.getLayer(h).filter)},d.prototype.setLayoutProperty=function(h,m,E,D){void 0===D&&(D={}),this._checkLoaded();var k=this.getLayer(h);k?g.deepEqual(k.getLayoutProperty(m),E)||(k.setLayoutProperty(m,E,D),this._updateLayer(k)):this.fire(new g.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},d.prototype.getLayoutProperty=function(h,m){var E=this.getLayer(h);if(E)return E.getLayoutProperty(m);this.fire(new g.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style.")))},d.prototype.setPaintProperty=function(h,m,E,D){void 0===D&&(D={}),this._checkLoaded();var k=this.getLayer(h);k?g.deepEqual(k.getPaintProperty(m),E)||(k.setPaintProperty(m,E,D)&&this._updateLayer(k),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new g.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},d.prototype.getPaintProperty=function(h,m){return this.getLayer(h).getPaintProperty(m)},d.prototype.setFeatureState=function(h,m){this._checkLoaded();var E=h.source,D=h.sourceLayer,k=this.sourceCaches[E];if(void 0!==k){var G=k.getSource().type;"geojson"===G&&D?this.fire(new g.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==G||D?(void 0===h.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided."))),k.setFeatureState(D,h.id,m)):this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new g.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},d.prototype.removeFeatureState=function(h,m){this._checkLoaded();var E=h.source,D=this.sourceCaches[E];if(void 0!==D){var k=D.getSource().type,G="vector"===k?h.sourceLayer:void 0;"vector"!==k||G?m&&"string"!=typeof h.id&&"number"!=typeof h.id?this.fire(new g.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):D.removeFeatureState(G,h.id,m):this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new g.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},d.prototype.getFeatureState=function(h){this._checkLoaded();var m=h.source,E=h.sourceLayer,D=this.sourceCaches[m];if(void 0!==D){if("vector"!==D.getSource().type||E)return void 0===h.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided."))),D.getFeatureState(E,h.id);this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new g.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},d.prototype.getTransition=function(){return g.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},d.prototype.serialize=function(){return g.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:g.mapObject(this.sourceCaches,function(h){return h.serialize()}),layers:this._serializeLayers(this._order)},function(h){return void 0!==h})},d.prototype._updateLayer=function(h){this._updatedLayers[h.id]=!0,h.source&&!this._updatedSources[h.source]&&"raster"!==this.sourceCaches[h.source].getSource().type&&(this._updatedSources[h.source]="reload",this.sourceCaches[h.source].pause()),this._changed=!0},d.prototype._flattenAndSortRenderedFeatures=function(h){for(var m=this,E=function($n){return"fill-extrusion"===m._layers[$n].type},D={},k=[],G=this._order.length-1;G>=0;G--){var le=this._order[G];if(E(le)){D[le]=G;for(var Se=0,Ke=h;Se<Ke.length;Se+=1){var Xe=Ke[Se][le];if(Xe)for(var it=0,xt=Xe;it<xt.length;it+=1)k.push(xt[it])}}}k.sort(function($n,Vn){return Vn.intersectionZ-$n.intersectionZ});for(var wt=[],Pt=this._order.length-1;Pt>=0;Pt--){var gt=this._order[Pt];if(E(gt))for(var kt=k.length-1;kt>=0;kt--){var Bt=k[kt].feature;if(D[Bt.layer.id]<Pt)break;wt.push(Bt),k.pop()}else for(var Jt=0,tn=h;Jt<tn.length;Jt+=1){var un=tn[Jt][gt];if(un)for(var gn=0,Rn=un;gn<Rn.length;gn+=1)wt.push(Rn[gn].feature)}}return wt},d.prototype.queryRenderedFeatures=function(h,m,E){m&&m.filter&&this._validate(g.validateStyle.filter,"queryRenderedFeatures.filter",m.filter,null,m);var D={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new g.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var k=0,G=m.layers;k<G.length;k+=1){var le=G[k],Se=this._layers[le];if(!Se)return this.fire(new g.ErrorEvent(new Error("The layer '"+le+"' does not exist in the map's style and cannot be queried for features."))),[];D[Se.source]=!0}}var Ke=[];for(var Xe in m.availableImages=this._availableImages,this.sourceCaches)m.layers&&!D[Xe]||Ke.push(jn(this.sourceCaches[Xe],this._layers,this._serializedLayers,h,m,E));return this.placement&&Ke.push(function(it,xt,wt,Pt,gt,kt,Bt){for(var Jt={},tn=kt.queryRenderedSymbols(Pt),un=[],gn=0,Rn=Object.keys(tn).map(Number);gn<Rn.length;gn+=1)un.push(Bt[Rn[gn]]);un.sort(gr);for(var $n=function(){var Q=cr[Vn],Fe=Q.featureIndex.lookupSymbolFeatures(tn[Q.bucketInstanceId],xt,Q.bucketIndex,Q.sourceLayerIndex,gt.filter,gt.layers,gt.availableImages,it);for(var st in Fe){var Ut=Jt[st]=Jt[st]||[],Qt=Fe[st];Qt.sort(function(Bn,sr){var hr=Q.featureSortOrder;if(hr){var vi=hr.indexOf(Bn.featureIndex);return hr.indexOf(sr.featureIndex)-vi}return sr.featureIndex-Bn.featureIndex});for(var mn=0,xn=Qt;mn<xn.length;mn+=1)Ut.push(xn[mn])}},Vn=0,cr=un;Vn<cr.length;Vn+=1)$n();var yr=function(Q){Jt[Q].forEach(function(Fe){var st=Fe.feature,Ut=wt[it[Q].source].getFeatureState(st.layer["source-layer"],st.id);st.source=st.layer.source,st.layer["source-layer"]&&(st.sourceLayer=st.layer["source-layer"]),st.state=Ut})};for(var Z in Jt)yr(Z);return Jt}(this._layers,this._serializedLayers,this.sourceCaches,h,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ke)},d.prototype.querySourceFeatures=function(h,m){m&&m.filter&&this._validate(g.validateStyle.filter,"querySourceFeatures.filter",m.filter,null,m);var E=this.sourceCaches[h];return E?function(D,k){for(var G=D.getRenderableIds().map(function(xt){return D.getTileByID(xt)}),le=[],Se={},Ke=0;Ke<G.length;Ke++){var Xe=G[Ke],it=Xe.tileID.canonical.key;Se[it]||(Se[it]=!0,Xe.querySourceFeatures(le,k))}return le}(E,m):[]},d.prototype.addSourceType=function(h,m,E){return d.getSourceType(h)?E(new Error('A source type called "'+h+'" already exists.')):(d.setSourceType(h,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:m.workerSourceURL},E):E(null,null))},d.prototype.getLight=function(){return this.light.getLight()},d.prototype.setLight=function(h,m){void 0===m&&(m={}),this._checkLoaded();var E=this.light.getLight(),D=!1;for(var k in h)if(!g.deepEqual(h[k],E[k])){D=!0;break}if(D){var G={now:g.browser.now(),transition:g.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(h,m),this.light.updateTransitions(G)}},d.prototype._validate=function(h,m,E,D,k){return void 0===k&&(k={}),(!k||!1!==k.validate)&&ga(this,h.call(g.validateStyle,g.extend({key:m,style:this.serialize(),value:E,styleSpec:g.styleSpec},D)))},d.prototype._remove=function(){for(var h in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),g.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[h].setEventedParent(null);for(var m in this.sourceCaches)this.sourceCaches[m].clearTiles(),this.sourceCaches[m].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},d.prototype._clearSource=function(h){this.sourceCaches[h].clearTiles()},d.prototype._reloadSource=function(h){this.sourceCaches[h].resume(),this.sourceCaches[h].reload()},d.prototype._updateSources=function(h){for(var m in this.sourceCaches)this.sourceCaches[m].update(h)},d.prototype._generateCollisionBoxes=function(){for(var h in this.sourceCaches)this._reloadSource(h)},d.prototype._updatePlacement=function(h,m,E,D,k){void 0===k&&(k=!1);for(var G=!1,le=!1,Se={},Ke=0,Xe=this._order;Ke<Xe.length;Ke+=1){var it=this._layers[Xe[Ke]];if("symbol"===it.type){if(!Se[it.source]){var xt=this.sourceCaches[it.source];Se[it.source]=xt.getRenderableIds(!0).map(function(Bt){return xt.getTileByID(Bt)}).sort(function(Bt,Jt){return Jt.tileID.overscaledZ-Bt.tileID.overscaledZ||(Bt.tileID.isLessThan(Jt.tileID)?-1:1)})}var wt=this.crossTileSymbolIndex.addLayer(it,Se[it.source],h.center.lng);G=G||wt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((k=k||this._layerOrderChanged||0===E)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(g.browser.now(),h.zoom))&&(this.pauseablePlacement=new Uu(h,this._order,k,m,E,D,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Se),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(g.browser.now()),le=!0),G&&this.pauseablePlacement.placement.setStale()),le||G)for(var Pt=0,gt=this._order;Pt<gt.length;Pt+=1){var kt=this._layers[gt[Pt]];"symbol"===kt.type&&this.placement.updateLayerOpacities(kt,Se[kt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(g.browser.now())},d.prototype._releaseSymbolFadeTiles=function(){for(var h in this.sourceCaches)this.sourceCaches[h].releaseSymbolFadeTiles()},d.prototype.getImages=function(h,m,E){this.imageManager.getImages(m.icons,E),this._updateTilesForChangedImages();var D=this.sourceCaches[m.source];D&&D.setDependencies(m.tileID.key,m.type,m.icons)},d.prototype.getGlyphs=function(h,m,E){this.glyphManager.getGlyphs(m.stacks,E)},d.prototype.getResource=function(h,m,E){return g.makeRequest(m,E)},d}(g.Evented);po.getSourceType=function(l){return An[l]},po.setSourceType=function(l,d){An[l]=d},po.registerForPluginStateChange=g.registerForPluginStateChange;var Ni=g.createLayout([{name:"a_pos",type:"Int16",components:2}]),Uo=er("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),el=er("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),na=er("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),uu=er("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ga=er("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Gs=er("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),os=er("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),qs=er("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),so=er("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ss=er("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Su=er("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),wo=er("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ds=er("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),qa=er("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),eo=er("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Cu=er("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),ps=er("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Jo=er("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),qr=er("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),oe=er("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),qe=er("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),ne=er("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),et=er("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ot=er("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),vn=er("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),On=er("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function er(l,d){var h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=d.match(/attribute ([\w]+) ([\w]+)/g),E=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),k=D?D.concat(E):E,G={};return{fragmentSource:l=l.replace(h,function(le,Se,Ke,Xe,it){return G[it]=!0,"define"===Se?"\n#ifndef HAS_UNIFORM_u_"+it+"\nvarying "+Ke+" "+Xe+" "+it+";\n#else\nuniform "+Ke+" "+Xe+" u_"+it+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+it+"\n    "+Ke+" "+Xe+" "+it+" = u_"+it+";\n#endif\n"}),vertexSource:d=d.replace(h,function(le,Se,Ke,Xe,it){var xt="float"===Xe?"vec2":"vec4",wt=it.match(/color/)?"color":xt;return G[it]?"define"===Se?"\n#ifndef HAS_UNIFORM_u_"+it+"\nuniform lowp float u_"+it+"_t;\nattribute "+Ke+" "+xt+" a_"+it+";\nvarying "+Ke+" "+Xe+" "+it+";\n#else\nuniform "+Ke+" "+Xe+" u_"+it+";\n#endif\n":"vec4"===wt?"\n#ifndef HAS_UNIFORM_u_"+it+"\n    "+it+" = a_"+it+";\n#else\n    "+Ke+" "+Xe+" "+it+" = u_"+it+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+it+"\n    "+it+" = unpack_mix_"+wt+"(a_"+it+", u_"+it+"_t);\n#else\n    "+Ke+" "+Xe+" "+it+" = u_"+it+";\n#endif\n":"define"===Se?"\n#ifndef HAS_UNIFORM_u_"+it+"\nuniform lowp float u_"+it+"_t;\nattribute "+Ke+" "+xt+" a_"+it+";\n#else\nuniform "+Ke+" "+Xe+" u_"+it+";\n#endif\n":"vec4"===wt?"\n#ifndef HAS_UNIFORM_u_"+it+"\n    "+Ke+" "+Xe+" "+it+" = a_"+it+";\n#else\n    "+Ke+" "+Xe+" "+it+" = u_"+it+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+it+"\n    "+Ke+" "+Xe+" "+it+" = unpack_mix_"+wt+"(a_"+it+", u_"+it+"_t);\n#else\n    "+Ke+" "+Xe+" "+it+" = u_"+it+";\n#endif\n"}),staticAttributes:m,staticUniforms:k}}var Hr=Object.freeze({__proto__:null,prelude:Uo,background:el,backgroundPattern:na,circle:uu,clippingMask:Ga,heatmap:Gs,heatmapTexture:os,collisionBox:qs,collisionCircle:so,debug:ss,fill:Su,fillOutline:wo,fillOutlinePattern:Ds,fillPattern:qa,fillExtrusion:eo,fillExtrusionPattern:Cu,hillshadePrepare:ps,hillshade:Jo,line:qr,lineGradient:oe,linePattern:qe,lineSDF:ne,raster:et,symbolIcon:Ot,symbolSDF:vn,symbolTextAndIcon:On}),li=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function ni(l){for(var d=[],h=0;h<l.length;h++)if(null!==l[h]){var m=l[h].split(" ");d.push(m.pop())}return d}li.prototype.bind=function(l,d,h,m,E,D,k,G){this.context=l;for(var le=this.boundPaintVertexBuffers.length!==m.length,Se=0;!le&&Se<m.length;Se++)this.boundPaintVertexBuffers[Se]!==m[Se]&&(le=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===d&&this.boundLayoutVertexBuffer===h&&!le&&this.boundIndexBuffer===E&&this.boundVertexOffset===D&&this.boundDynamicVertexBuffer===k&&this.boundDynamicVertexBuffer2===G?(l.bindVertexArrayOES.set(this.vao),k&&k.bind(),E&&E.dynamicDraw&&E.bind(),G&&G.bind()):this.freshBind(d,h,m,E,D,k,G)},li.prototype.freshBind=function(l,d,h,m,E,D,k){var G,le=l.numAttributes,Se=this.context,Ke=Se.gl;if(Se.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Se.extVertexArrayObject.createVertexArrayOES(),Se.bindVertexArrayOES.set(this.vao),G=0,this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=m,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=k;else{G=Se.currentNumAttributes||0;for(var Xe=le;Xe<G;Xe++)Ke.disableVertexAttribArray(Xe)}d.enableAttributes(Ke,l);for(var it=0,xt=h;it<xt.length;it+=1)xt[it].enableAttributes(Ke,l);D&&D.enableAttributes(Ke,l),k&&k.enableAttributes(Ke,l),d.bind(),d.setVertexAttribPointers(Ke,l,E);for(var wt=0,Pt=h;wt<Pt.length;wt+=1){var gt=Pt[wt];gt.bind(),gt.setVertexAttribPointers(Ke,l,E)}D&&(D.bind(),D.setVertexAttribPointers(Ke,l,E)),m&&m.bind(),k&&(k.bind(),k.setVertexAttribPointers(Ke,l,E)),Se.currentNumAttributes=le},li.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Qr=function(l,d,h,m,E,D){var k=l.gl;this.program=k.createProgram();for(var G=ni(h.staticAttributes),le=m?m.getBinderAttributes():[],Se=G.concat(le),Ke=h.staticUniforms?ni(h.staticUniforms):[],Xe=m?m.getBinderUniforms():[],it=[],xt=0,wt=Ke.concat(Xe);xt<wt.length;xt+=1){var Pt=wt[xt];it.indexOf(Pt)<0&&it.push(Pt)}var gt=m?m.defines():[];D&&gt.push("#define OVERDRAW_INSPECTOR;");var kt=gt.concat(Uo.fragmentSource,h.fragmentSource).join("\n"),Bt=gt.concat(Uo.vertexSource,h.vertexSource).join("\n"),Jt=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(Jt,kt),k.compileShader(Jt),k.attachShader(this.program,Jt);var tn=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(tn,Bt),k.compileShader(tn),k.attachShader(this.program,tn),this.attributes={};var un={};this.numAttributes=Se.length;for(var gn=0;gn<this.numAttributes;gn++)Se[gn]&&(k.bindAttribLocation(this.program,gn,Se[gn]),this.attributes[Se[gn]]=gn);k.linkProgram(this.program),k.deleteShader(tn),k.deleteShader(Jt);for(var Rn=0;Rn<it.length;Rn++){var $n=it[Rn];if($n&&!un[$n]){var Vn=k.getUniformLocation(this.program,$n);Vn&&(un[$n]=Vn)}}this.fixedUniforms=E(l,un),this.binderUniforms=m?m.getUniforms(l,un):[]}}};function mo(l,d,h){var m=1/_i(h,1,d.transform.tileZoom),E=Math.pow(2,h.tileID.overscaledZ),D=h.tileSize*Math.pow(2,d.transform.tileZoom)/E,k=D*(h.tileID.canonical.x+h.tileID.wrap*E),G=D*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[m,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[k>>16,G>>16],u_pixel_coord_lower:[65535&k,65535&G]}}Qr.prototype.draw=function(l,d,h,m,E,D,k,G,le,Se,Ke,Xe,it,xt,wt,Pt){var gt,kt=l.gl;if(!this.failedToCreate){for(var Bt in l.program.set(this.program),l.setDepthMode(h),l.setStencilMode(m),l.setColorMode(E),l.setCullFace(D),this.fixedUniforms)this.fixedUniforms[Bt].set(k[Bt]);xt&&xt.setUniforms(l,this.binderUniforms,Xe,{zoom:it});for(var Jt=(gt={},gt[kt.LINES]=2,gt[kt.TRIANGLES]=3,gt[kt.LINE_STRIP]=1,gt)[d],tn=0,un=Ke.get();tn<un.length;tn+=1){var gn=un[tn],Rn=gn.vaos||(gn.vaos={});(Rn[G]||(Rn[G]=new li)).bind(l,this,le,xt?xt.getPaintVertexBuffers():[],Se,gn.vertexOffset,wt,Pt),kt.drawElements(d,gn.primitiveLength*Jt,kt.UNSIGNED_SHORT,gn.primitiveOffset*Jt*2)}}};var Vi=function(l,d,h,m){var E=d.style.light,D=E.properties.get("position"),k=[D.x,D.y,D.z],G=g.create$1();"viewport"===E.properties.get("anchor")&&g.fromRotation(G,-d.transform.angle),g.transformMat3(k,k,G);var le=E.properties.get("color");return{u_matrix:l,u_lightpos:k,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+h,u_opacity:m}},Di=function(l,d,h,m,E,D,k){return g.extend(Vi(l,d,h,m),mo(D,d,k),{u_height_factor:-Math.pow(2,E.overscaledZ)/k.tileSize/8})},ms=function(l){return{u_matrix:l}},go=function(l,d,h,m){return g.extend(ms(l),mo(h,d,m))},Rr=function(l,d){return{u_matrix:l,u_world:d}},ra=function(l,d,h,m,E){return g.extend(go(l,d,h,m),{u_world:E})},La=function(l,d,h,m){var E,D,k=l.transform;if("map"===m.paint.get("circle-pitch-alignment")){var G=_i(h,1,k.zoom);E=!0,D=[G,G]}else E=!1,D=k.pixelsToGLUnits;return{u_camera_to_center_distance:k.cameraToCenterDistance,u_scale_with_map:+("map"===m.paint.get("circle-pitch-scale")),u_matrix:l.translatePosMatrix(d.posMatrix,h,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:g.browser.devicePixelRatio,u_extrude_scale:D}},Ns=function(l,d,h){var m=_i(h,1,d.zoom),E=Math.pow(2,d.zoom-h.tileID.overscaledZ),D=h.tileID.overscaleFactor();return{u_matrix:l,u_camera_to_center_distance:d.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[d.pixelsToGLUnits[0]/(m*E),d.pixelsToGLUnits[1]/(m*E)],u_overscale_factor:D}},Fs=function(l,d,h){return{u_matrix:l,u_inv_matrix:d,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}},Na=function(l,d,h){return void 0===h&&(h=1),{u_matrix:l,u_color:d,u_overlay:0,u_overlay_scale:h}},Xo=function(l){return{u_matrix:l}},vl=function(l,d,h,m){return{u_matrix:l,u_extrude_scale:_i(d,1,h),u_intensity:m}},Nn=function(l,d,h){var m=l.transform;return{u_matrix:Wa(l,d,h),u_ratio:1/_i(d,1,m.zoom),u_device_pixel_ratio:g.browser.devicePixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Cr=function(l,d,h,m){return g.extend(Nn(l,d,h),{u_image:0,u_image_height:m})},Fa=function(l,d,h,m){var E=l.transform,D=Ws(d,E);return{u_matrix:Wa(l,d,h),u_texsize:d.imageAtlasTexture.size,u_ratio:1/_i(d,1,E.zoom),u_device_pixel_ratio:g.browser.devicePixelRatio,u_image:0,u_scale:[D,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},xo=function(l,d,h,m,E){var D=l.lineAtlas,k=Ws(d,l.transform),G="round"===h.layout.get("line-cap"),le=D.getDash(m.from,G),Se=D.getDash(m.to,G),Ke=le.width*E.fromScale,Xe=Se.width*E.toScale;return g.extend(Nn(l,d,h),{u_patternscale_a:[k/Ke,-le.height/2],u_patternscale_b:[k/Xe,-Se.height/2],u_sdfgamma:D.width/(256*Math.min(Ke,Xe)*g.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:le.y,u_tex_y_b:Se.y,u_mix:E.t})};function Ws(l,d){return 1/_i(l,1,d.tileZoom)}function Wa(l,d,h){return l.translatePosMatrix(d.tileID.posMatrix,d,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}var as=function(l,d,h,m,E){return{u_matrix:l,u_tl_parent:d,u_scale_parent:h,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(k=E.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(D=E.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:zu(E.paint.get("raster-hue-rotate"))};var D,k};function zu(l){l*=Math.PI/180;var d=Math.sin(l),h=Math.cos(l);return[(2*h+1)/3,(-Math.sqrt(3)*d-h+1)/3,(Math.sqrt(3)*d-h+1)/3]}var Vu,Du=function(l,d,h,m,E,D,k,G,le,Se){var Ke=E.transform;return{u_is_size_zoom_constant:+("constant"===l||"source"===l),u_is_size_feature_constant:+("constant"===l||"camera"===l),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:Ke.cameraToCenterDistance,u_pitch:Ke.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:Ke.width/Ke.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:k,u_coord_matrix:G,u_is_text:+le,u_pitch_with_map:+m,u_texsize:Se,u_texture:0}},ju=function(l,d,h,m,E,D,k,G,le,Se,Ke){var Xe=E.transform;return g.extend(Du(l,d,h,m,E,D,k,G,le,Se),{u_gamma_scale:m?Math.cos(Xe._pitch)*Xe.cameraToCenterDistance:1,u_device_pixel_ratio:g.browser.devicePixelRatio,u_is_halo:+Ke})},ya=function(l,d,h,m,E,D,k,G,le,Se){return g.extend(ju(l,d,h,m,E,D,k,G,!0,le,!0),{u_texsize_icon:Se,u_texture_icon:1})},As=function(l,d,h){return{u_matrix:l,u_opacity:d,u_color:h}},yo=function(l,d,h,m,E,D){return g.extend((G=D,Se=E,Ke=(le=h).imageManager.getPattern((k=m).from.toString()),Xe=le.imageManager.getPattern(k.to.toString()),xt=(it=le.imageManager.getPixelSize()).width,wt=it.height,Pt=Math.pow(2,Se.tileID.overscaledZ),kt=(gt=Se.tileSize*Math.pow(2,le.transform.tileZoom)/Pt)*(Se.tileID.canonical.x+Se.tileID.wrap*Pt),Bt=gt*Se.tileID.canonical.y,{u_image:0,u_pattern_tl_a:Ke.tl,u_pattern_br_a:Ke.br,u_pattern_tl_b:Xe.tl,u_pattern_br_b:Xe.br,u_texsize:[xt,wt],u_mix:G.t,u_pattern_size_a:Ke.displaySize,u_pattern_size_b:Xe.displaySize,u_scale_a:G.fromScale,u_scale_b:G.toScale,u_tile_units_to_pixels:1/_i(Se,1,le.transform.tileZoom),u_pixel_coord_upper:[kt>>16,Bt>>16],u_pixel_coord_lower:[65535&kt,65535&Bt]}),{u_matrix:l,u_opacity:d});var k,G,le,Se,Ke,Xe,it,xt,wt,Pt,gt,kt,Bt},Bs={fillExtrusion:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_lightpos:new g.Uniform3f(l,d.u_lightpos),u_lightintensity:new g.Uniform1f(l,d.u_lightintensity),u_lightcolor:new g.Uniform3f(l,d.u_lightcolor),u_vertical_gradient:new g.Uniform1f(l,d.u_vertical_gradient),u_opacity:new g.Uniform1f(l,d.u_opacity)}},fillExtrusionPattern:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_lightpos:new g.Uniform3f(l,d.u_lightpos),u_lightintensity:new g.Uniform1f(l,d.u_lightintensity),u_lightcolor:new g.Uniform3f(l,d.u_lightcolor),u_vertical_gradient:new g.Uniform1f(l,d.u_vertical_gradient),u_height_factor:new g.Uniform1f(l,d.u_height_factor),u_image:new g.Uniform1i(l,d.u_image),u_texsize:new g.Uniform2f(l,d.u_texsize),u_pixel_coord_upper:new g.Uniform2f(l,d.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(l,d.u_pixel_coord_lower),u_scale:new g.Uniform3f(l,d.u_scale),u_fade:new g.Uniform1f(l,d.u_fade),u_opacity:new g.Uniform1f(l,d.u_opacity)}},fill:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix)}},fillPattern:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_image:new g.Uniform1i(l,d.u_image),u_texsize:new g.Uniform2f(l,d.u_texsize),u_pixel_coord_upper:new g.Uniform2f(l,d.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(l,d.u_pixel_coord_lower),u_scale:new g.Uniform3f(l,d.u_scale),u_fade:new g.Uniform1f(l,d.u_fade)}},fillOutline:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_world:new g.Uniform2f(l,d.u_world)}},fillOutlinePattern:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_world:new g.Uniform2f(l,d.u_world),u_image:new g.Uniform1i(l,d.u_image),u_texsize:new g.Uniform2f(l,d.u_texsize),u_pixel_coord_upper:new g.Uniform2f(l,d.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(l,d.u_pixel_coord_lower),u_scale:new g.Uniform3f(l,d.u_scale),u_fade:new g.Uniform1f(l,d.u_fade)}},circle:function(l,d){return{u_camera_to_center_distance:new g.Uniform1f(l,d.u_camera_to_center_distance),u_scale_with_map:new g.Uniform1i(l,d.u_scale_with_map),u_pitch_with_map:new g.Uniform1i(l,d.u_pitch_with_map),u_extrude_scale:new g.Uniform2f(l,d.u_extrude_scale),u_device_pixel_ratio:new g.Uniform1f(l,d.u_device_pixel_ratio),u_matrix:new g.UniformMatrix4f(l,d.u_matrix)}},collisionBox:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_camera_to_center_distance:new g.Uniform1f(l,d.u_camera_to_center_distance),u_pixels_to_tile_units:new g.Uniform1f(l,d.u_pixels_to_tile_units),u_extrude_scale:new g.Uniform2f(l,d.u_extrude_scale),u_overscale_factor:new g.Uniform1f(l,d.u_overscale_factor)}},collisionCircle:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_inv_matrix:new g.UniformMatrix4f(l,d.u_inv_matrix),u_camera_to_center_distance:new g.Uniform1f(l,d.u_camera_to_center_distance),u_viewport_size:new g.Uniform2f(l,d.u_viewport_size)}},debug:function(l,d){return{u_color:new g.UniformColor(l,d.u_color),u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_overlay:new g.Uniform1i(l,d.u_overlay),u_overlay_scale:new g.Uniform1f(l,d.u_overlay_scale)}},clippingMask:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix)}},heatmap:function(l,d){return{u_extrude_scale:new g.Uniform1f(l,d.u_extrude_scale),u_intensity:new g.Uniform1f(l,d.u_intensity),u_matrix:new g.UniformMatrix4f(l,d.u_matrix)}},heatmapTexture:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_world:new g.Uniform2f(l,d.u_world),u_image:new g.Uniform1i(l,d.u_image),u_color_ramp:new g.Uniform1i(l,d.u_color_ramp),u_opacity:new g.Uniform1f(l,d.u_opacity)}},hillshade:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_image:new g.Uniform1i(l,d.u_image),u_latrange:new g.Uniform2f(l,d.u_latrange),u_light:new g.Uniform2f(l,d.u_light),u_shadow:new g.UniformColor(l,d.u_shadow),u_highlight:new g.UniformColor(l,d.u_highlight),u_accent:new g.UniformColor(l,d.u_accent)}},hillshadePrepare:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_image:new g.Uniform1i(l,d.u_image),u_dimension:new g.Uniform2f(l,d.u_dimension),u_zoom:new g.Uniform1f(l,d.u_zoom),u_unpack:new g.Uniform4f(l,d.u_unpack)}},line:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_ratio:new g.Uniform1f(l,d.u_ratio),u_device_pixel_ratio:new g.Uniform1f(l,d.u_device_pixel_ratio),u_units_to_pixels:new g.Uniform2f(l,d.u_units_to_pixels)}},lineGradient:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_ratio:new g.Uniform1f(l,d.u_ratio),u_device_pixel_ratio:new g.Uniform1f(l,d.u_device_pixel_ratio),u_units_to_pixels:new g.Uniform2f(l,d.u_units_to_pixels),u_image:new g.Uniform1i(l,d.u_image),u_image_height:new g.Uniform1f(l,d.u_image_height)}},linePattern:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_texsize:new g.Uniform2f(l,d.u_texsize),u_ratio:new g.Uniform1f(l,d.u_ratio),u_device_pixel_ratio:new g.Uniform1f(l,d.u_device_pixel_ratio),u_image:new g.Uniform1i(l,d.u_image),u_units_to_pixels:new g.Uniform2f(l,d.u_units_to_pixels),u_scale:new g.Uniform3f(l,d.u_scale),u_fade:new g.Uniform1f(l,d.u_fade)}},lineSDF:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_ratio:new g.Uniform1f(l,d.u_ratio),u_device_pixel_ratio:new g.Uniform1f(l,d.u_device_pixel_ratio),u_units_to_pixels:new g.Uniform2f(l,d.u_units_to_pixels),u_patternscale_a:new g.Uniform2f(l,d.u_patternscale_a),u_patternscale_b:new g.Uniform2f(l,d.u_patternscale_b),u_sdfgamma:new g.Uniform1f(l,d.u_sdfgamma),u_image:new g.Uniform1i(l,d.u_image),u_tex_y_a:new g.Uniform1f(l,d.u_tex_y_a),u_tex_y_b:new g.Uniform1f(l,d.u_tex_y_b),u_mix:new g.Uniform1f(l,d.u_mix)}},raster:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_tl_parent:new g.Uniform2f(l,d.u_tl_parent),u_scale_parent:new g.Uniform1f(l,d.u_scale_parent),u_buffer_scale:new g.Uniform1f(l,d.u_buffer_scale),u_fade_t:new g.Uniform1f(l,d.u_fade_t),u_opacity:new g.Uniform1f(l,d.u_opacity),u_image0:new g.Uniform1i(l,d.u_image0),u_image1:new g.Uniform1i(l,d.u_image1),u_brightness_low:new g.Uniform1f(l,d.u_brightness_low),u_brightness_high:new g.Uniform1f(l,d.u_brightness_high),u_saturation_factor:new g.Uniform1f(l,d.u_saturation_factor),u_contrast_factor:new g.Uniform1f(l,d.u_contrast_factor),u_spin_weights:new g.Uniform3f(l,d.u_spin_weights)}},symbolIcon:function(l,d){return{u_is_size_zoom_constant:new g.Uniform1i(l,d.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(l,d.u_is_size_feature_constant),u_size_t:new g.Uniform1f(l,d.u_size_t),u_size:new g.Uniform1f(l,d.u_size),u_camera_to_center_distance:new g.Uniform1f(l,d.u_camera_to_center_distance),u_pitch:new g.Uniform1f(l,d.u_pitch),u_rotate_symbol:new g.Uniform1i(l,d.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(l,d.u_aspect_ratio),u_fade_change:new g.Uniform1f(l,d.u_fade_change),u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(l,d.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(l,d.u_coord_matrix),u_is_text:new g.Uniform1i(l,d.u_is_text),u_pitch_with_map:new g.Uniform1i(l,d.u_pitch_with_map),u_texsize:new g.Uniform2f(l,d.u_texsize),u_texture:new g.Uniform1i(l,d.u_texture)}},symbolSDF:function(l,d){return{u_is_size_zoom_constant:new g.Uniform1i(l,d.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(l,d.u_is_size_feature_constant),u_size_t:new g.Uniform1f(l,d.u_size_t),u_size:new g.Uniform1f(l,d.u_size),u_camera_to_center_distance:new g.Uniform1f(l,d.u_camera_to_center_distance),u_pitch:new g.Uniform1f(l,d.u_pitch),u_rotate_symbol:new g.Uniform1i(l,d.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(l,d.u_aspect_ratio),u_fade_change:new g.Uniform1f(l,d.u_fade_change),u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(l,d.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(l,d.u_coord_matrix),u_is_text:new g.Uniform1i(l,d.u_is_text),u_pitch_with_map:new g.Uniform1i(l,d.u_pitch_with_map),u_texsize:new g.Uniform2f(l,d.u_texsize),u_texture:new g.Uniform1i(l,d.u_texture),u_gamma_scale:new g.Uniform1f(l,d.u_gamma_scale),u_device_pixel_ratio:new g.Uniform1f(l,d.u_device_pixel_ratio),u_is_halo:new g.Uniform1i(l,d.u_is_halo)}},symbolTextAndIcon:function(l,d){return{u_is_size_zoom_constant:new g.Uniform1i(l,d.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(l,d.u_is_size_feature_constant),u_size_t:new g.Uniform1f(l,d.u_size_t),u_size:new g.Uniform1f(l,d.u_size),u_camera_to_center_distance:new g.Uniform1f(l,d.u_camera_to_center_distance),u_pitch:new g.Uniform1f(l,d.u_pitch),u_rotate_symbol:new g.Uniform1i(l,d.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(l,d.u_aspect_ratio),u_fade_change:new g.Uniform1f(l,d.u_fade_change),u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(l,d.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(l,d.u_coord_matrix),u_is_text:new g.Uniform1i(l,d.u_is_text),u_pitch_with_map:new g.Uniform1i(l,d.u_pitch_with_map),u_texsize:new g.Uniform2f(l,d.u_texsize),u_texsize_icon:new g.Uniform2f(l,d.u_texsize_icon),u_texture:new g.Uniform1i(l,d.u_texture),u_texture_icon:new g.Uniform1i(l,d.u_texture_icon),u_gamma_scale:new g.Uniform1f(l,d.u_gamma_scale),u_device_pixel_ratio:new g.Uniform1f(l,d.u_device_pixel_ratio),u_is_halo:new g.Uniform1i(l,d.u_is_halo)}},background:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_opacity:new g.Uniform1f(l,d.u_opacity),u_color:new g.UniformColor(l,d.u_color)}},backgroundPattern:function(l,d){return{u_matrix:new g.UniformMatrix4f(l,d.u_matrix),u_opacity:new g.Uniform1f(l,d.u_opacity),u_image:new g.Uniform1i(l,d.u_image),u_pattern_tl_a:new g.Uniform2f(l,d.u_pattern_tl_a),u_pattern_br_a:new g.Uniform2f(l,d.u_pattern_br_a),u_pattern_tl_b:new g.Uniform2f(l,d.u_pattern_tl_b),u_pattern_br_b:new g.Uniform2f(l,d.u_pattern_br_b),u_texsize:new g.Uniform2f(l,d.u_texsize),u_mix:new g.Uniform1f(l,d.u_mix),u_pattern_size_a:new g.Uniform2f(l,d.u_pattern_size_a),u_pattern_size_b:new g.Uniform2f(l,d.u_pattern_size_b),u_scale_a:new g.Uniform1f(l,d.u_scale_a),u_scale_b:new g.Uniform1f(l,d.u_scale_b),u_pixel_coord_upper:new g.Uniform2f(l,d.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(l,d.u_pixel_coord_lower),u_tile_units_to_pixels:new g.Uniform1f(l,d.u_tile_units_to_pixels)}}};function Za(l,d,h,m,E,D,k){for(var G=l.context,le=G.gl,Se=l.useProgram("collisionBox"),Ke=[],Xe=0,it=0,xt=0;xt<m.length;xt++){var wt=m[xt],Pt=d.getTile(wt),gt=Pt.getBucket(h);if(gt){var kt=wt.posMatrix;0===E[0]&&0===E[1]||(kt=l.translatePosMatrix(wt.posMatrix,Pt,E,D));var Bt=k?gt.textCollisionBox:gt.iconCollisionBox,Jt=gt.collisionCircleArray;if(Jt.length>0){var tn=g.create(),un=kt;g.mul(tn,gt.placementInvProjMatrix,l.transform.glCoordMatrix),g.mul(tn,tn,gt.placementViewportMatrix),Ke.push({circleArray:Jt,circleOffset:it,transform:un,invTransform:tn}),it=Xe+=Jt.length/4}Bt&&Se.draw(G,le.LINES,Qe.disabled,ot.disabled,l.colorModeForRenderPass(),Lt.disabled,Ns(kt,l.transform,Pt),h.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,null,l.transform.zoom,null,null,Bt.collisionVertexBuffer)}}if(k&&Ke.length){var gn=l.useProgram("collisionCircle"),Rn=new g.StructArrayLayout2f1f2i16;Rn.resize(4*Xe),Rn._trim();for(var $n=0,Vn=0,cr=Ke;Vn<cr.length;Vn+=1)for(var yr=cr[Vn],Z=0;Z<yr.circleArray.length/4;Z++){var Q=4*Z,Fe=yr.circleArray[Q+0],st=yr.circleArray[Q+1],Ut=yr.circleArray[Q+2],Qt=yr.circleArray[Q+3];Rn.emplace($n++,Fe,st,Ut,Qt,0),Rn.emplace($n++,Fe,st,Ut,Qt,1),Rn.emplace($n++,Fe,st,Ut,Qt,2),Rn.emplace($n++,Fe,st,Ut,Qt,3)}(!Vu||Vu.length<2*Xe)&&(Vu=function(ki){var Hi=2*ki,$o=new g.StructArrayLayout3ui6;$o.resize(Hi),$o._trim();for(var Ei=0;Ei<Hi;Ei++){var Qi=6*Ei;$o.uint16[Qi+0]=4*Ei+0,$o.uint16[Qi+1]=4*Ei+1,$o.uint16[Qi+2]=4*Ei+2,$o.uint16[Qi+3]=4*Ei+2,$o.uint16[Qi+4]=4*Ei+3,$o.uint16[Qi+5]=4*Ei+0}return $o}(Xe));for(var mn=G.createIndexBuffer(Vu,!0),xn=G.createVertexBuffer(Rn,g.collisionCircleLayout.members,!0),Bn=0,sr=Ke;Bn<sr.length;Bn+=1){var hr=sr[Bn],vi=Fs(hr.transform,hr.invTransform,l.transform);gn.draw(G,le.TRIANGLES,Qe.disabled,ot.disabled,l.colorModeForRenderPass(),Lt.disabled,vi,h.id,xn,mn,g.SegmentVector.simpleSegment(0,2*hr.circleOffset,hr.circleArray.length,hr.circleArray.length/2),null,l.transform.zoom,null,null,null)}xn.destroy(),mn.destroy()}}var Eo=g.identity(new Float32Array(16));function Us(l,d,h,m,E,D){var k=g.getAnchorAlignment(l),G=-(k.horizontalAlign-.5)*d,le=-(k.verticalAlign-.5)*h,Se=g.evaluateVariableOffset(l,m);return new g.Point((G/E+Se[0])*D,(le/E+Se[1])*D)}function Au(l,d,h,m,E,D,k,G,le,Se,Ke){var Xe=l.text.placedSymbolArray,it=l.text.dynamicLayoutVertexArray,xt=l.icon.dynamicLayoutVertexArray,wt={};it.clear();for(var Pt=0;Pt<Xe.length;Pt++){var gt=Xe.get(Pt),kt=gt.hidden||!gt.crossTileID||l.allowVerticalPlacement&&!gt.placedOrientation?null:m[gt.crossTileID];if(kt){var Bt=new g.Point(gt.anchorX,gt.anchorY),Jt=Gr(Bt,h?G:k),tn=Fr(D.cameraToCenterDistance,Jt.signedDistanceFromCamera),un=E.evaluateSizeForFeature(l.textSizeData,Se,gt)*tn/g.ONE_EM;h&&(un*=l.tilePixelRatio/le);for(var gn=Us(kt.anchor,kt.width,kt.height,kt.textOffset,kt.textBoxScale,un),Rn=h?Gr(Bt.add(gn),k).point:Jt.point.add(d?gn.rotate(-D.angle):gn),$n=l.allowVerticalPlacement&&gt.placedOrientation===g.WritingMode.vertical?Math.PI/2:0,Vn=0;Vn<gt.numGlyphs;Vn++)g.addDynamicAttributes(it,Rn,$n);Ke&&gt.associatedIconIndex>=0&&(wt[gt.associatedIconIndex]={shiftedAnchor:Rn,angle:$n})}else zi(gt.numGlyphs,it)}if(Ke){xt.clear();for(var cr=l.icon.placedSymbolArray,yr=0;yr<cr.length;yr++){var Z=cr.get(yr);if(Z.hidden)zi(Z.numGlyphs,xt);else{var Q=wt[yr];if(Q)for(var Fe=0;Fe<Z.numGlyphs;Fe++)g.addDynamicAttributes(xt,Q.shiftedAnchor,Q.angle);else zi(Z.numGlyphs,xt)}}l.icon.dynamicLayoutVertexBuffer.updateData(xt)}l.text.dynamicLayoutVertexBuffer.updateData(it)}function Fo(l,d,h){return h.iconsInText&&d?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function ia(l,d,h,m,E,D,k,G,le,Se,Ke,Xe){for(var it=l.context,xt=it.gl,wt=l.transform,Pt="map"===G,gt="map"===le,kt=Pt&&"point"!==h.layout.get("symbol-placement"),Bt=Pt&&!gt&&!kt,Jt=void 0!==h.layout.get("symbol-sort-key").constantOr(1),tn=!1,un=l.depthModeForSublayer(0,Qe.ReadOnly),gn=h.layout.get("text-variable-anchor"),Rn=[],$n=0,Vn=m;$n<Vn.length;$n+=1){var cr=Vn[$n],yr=d.getTile(cr),Z=yr.getBucket(h);if(Z){var Q=E?Z.text:Z.icon;if(Q&&Q.segments.get().length){var Fe=Q.programConfigurations.get(h.id),st=E||Z.sdfIcons,Ut=E?Z.textSizeData:Z.iconSizeData,Qt=gt||0!==wt.pitch,mn=l.useProgram(Fo(st,E,Z),Fe),xn=g.evaluateSizeForZoom(Ut,wt.zoom),Bn=void 0,sr=[0,0],hr=void 0,vi=void 0,ki=null,Hi=void 0;if(E)hr=yr.glyphAtlasTexture,vi=xt.LINEAR,Bn=yr.glyphAtlasTexture.size,Z.iconsInText&&(sr=yr.imageAtlasTexture.size,ki=yr.imageAtlasTexture,Hi=Qt||l.options.rotating||l.options.zooming||"composite"===Ut.kind||"camera"===Ut.kind?xt.LINEAR:xt.NEAREST);else{var $o=1!==h.layout.get("icon-size").constantOr(0)||Z.iconsNeedLinear;hr=yr.imageAtlasTexture,vi=st||l.options.rotating||l.options.zooming||$o||Qt?xt.LINEAR:xt.NEAREST,Bn=yr.imageAtlasTexture.size}var Ei=_i(yr,1,l.transform.zoom),Qi=Ci(cr.posMatrix,gt,Pt,l.transform,Ei),ko=Mr(cr.posMatrix,gt,Pt,l.transform,Ei),vo=gn&&Z.hasTextData(),Xa="none"!==h.layout.get("icon-text-fit")&&vo&&Z.hasIconData();kt&&hs(Z,cr.posMatrix,l,E,Qi,ko,gt,Se);var ua=l.translatePosMatrix(cr.posMatrix,yr,D,k),za=kt||E&&gn||Xa?Eo:Qi,Ys=l.translatePosMatrix(ko,yr,D,k,!0),ol=st&&0!==h.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1),Ia={program:mn,buffers:Q,uniformValues:st?Z.iconsInText?ya(Ut.kind,xn,Bt,gt,l,ua,za,Ys,Bn,sr):ju(Ut.kind,xn,Bt,gt,l,ua,za,Ys,E,Bn,!0):Du(Ut.kind,xn,Bt,gt,l,ua,za,Ys,E,Bn),atlasTexture:hr,atlasTextureIcon:ki,atlasInterpolation:vi,atlasInterpolationIcon:Hi,isSDF:st,hasHalo:ol};if(Jt&&Z.canOverlap){tn=!0;for(var El=0,Ta=Q.segments.get();El<Ta.length;El+=1){var ml=Ta[El];Rn.push({segments:new g.SegmentVector([ml]),sortKey:ml.sortKey,state:Ia})}}else Rn.push({segments:Q.segments,sortKey:0,state:Ia})}}}tn&&Rn.sort(function(Sl,Bl){return Sl.sortKey-Bl.sortKey});for(var Wu=0,Il=Rn;Wu<Il.length;Wu+=1){var Zu=Il[Wu],ys=Zu.state;if(it.activeTexture.set(xt.TEXTURE0),ys.atlasTexture.bind(ys.atlasInterpolation,xt.CLAMP_TO_EDGE),ys.atlasTextureIcon&&(it.activeTexture.set(xt.TEXTURE1),ys.atlasTextureIcon&&ys.atlasTextureIcon.bind(ys.atlasInterpolationIcon,xt.CLAMP_TO_EDGE)),ys.isSDF){var Tl=ys.uniformValues;ys.hasHalo&&(Tl.u_is_halo=1,Hu(ys.buffers,Zu.segments,h,l,ys.program,un,Ke,Xe,Tl)),Tl.u_is_halo=0}Hu(ys.buffers,Zu.segments,h,l,ys.program,un,Ke,Xe,ys.uniformValues)}}function Hu(l,d,h,m,E,D,k,G,le){var Se=m.context;E.draw(Se,Se.gl.TRIANGLES,D,k,G,Lt.disabled,le,h.id,l.layoutVertexBuffer,l.indexBuffer,d,h.paint,m.transform.zoom,l.programConfigurations.get(h.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function _a(l,d,h,m,E,D,k){var G,le,Se,Ke,Xe,it=l.context.gl,xt=h.paint.get("fill-pattern"),wt=xt&&xt.constantOr(1),Pt=h.getCrossfadeParameters();k?(le=wt&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",G=it.LINES):(le=wt?"fillPattern":"fill",G=it.TRIANGLES);for(var gt=0,kt=m;gt<kt.length;gt+=1){var Bt=kt[gt],Jt=d.getTile(Bt);if(!wt||Jt.patternsLoaded()){var tn=Jt.getBucket(h);if(tn){var un=tn.programConfigurations.get(h.id),gn=l.useProgram(le,un);wt&&(l.context.activeTexture.set(it.TEXTURE0),Jt.imageAtlasTexture.bind(it.LINEAR,it.CLAMP_TO_EDGE),un.updatePaintBuffers(Pt));var Rn=xt.constantOr(null);if(Rn&&Jt.imageAtlas){var $n=Jt.imageAtlas,Vn=$n.patternPositions[Rn.to.toString()],cr=$n.patternPositions[Rn.from.toString()];Vn&&cr&&un.setConstantPatternPositions(Vn,cr)}var yr=l.translatePosMatrix(Bt.posMatrix,Jt,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(k){Ke=tn.indexBuffer2,Xe=tn.segments2;var Z=[it.drawingBufferWidth,it.drawingBufferHeight];Se="fillOutlinePattern"===le&&wt?ra(yr,l,Pt,Jt,Z):Rr(yr,Z)}else Ke=tn.indexBuffer,Xe=tn.segments,Se=wt?go(yr,l,Pt,Jt):ms(yr);gn.draw(l.context,G,E,l.stencilModeForClipping(Bt),D,Lt.disabled,Se,h.id,tn.layoutVertexBuffer,Ke,Xe,h.paint,l.transform.zoom,un)}}}}function tl(l,d,h,m,E,D,k){for(var G=l.context,le=G.gl,Se=h.paint.get("fill-extrusion-pattern"),Ke=Se.constantOr(1),Xe=h.getCrossfadeParameters(),it=h.paint.get("fill-extrusion-opacity"),xt=0,wt=m;xt<wt.length;xt+=1){var Pt=wt[xt],gt=d.getTile(Pt),kt=gt.getBucket(h);if(kt){var Bt=kt.programConfigurations.get(h.id),Jt=l.useProgram(Ke?"fillExtrusionPattern":"fillExtrusion",Bt);Ke&&(l.context.activeTexture.set(le.TEXTURE0),gt.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),Bt.updatePaintBuffers(Xe));var tn=Se.constantOr(null);if(tn&&gt.imageAtlas){var un=gt.imageAtlas,gn=un.patternPositions[tn.to.toString()],Rn=un.patternPositions[tn.from.toString()];gn&&Rn&&Bt.setConstantPatternPositions(gn,Rn)}var $n=l.translatePosMatrix(Pt.posMatrix,gt,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Vn=h.paint.get("fill-extrusion-vertical-gradient"),cr=Ke?Di($n,l,Vn,it,Pt,Xe,gt):Vi($n,l,Vn,it);Jt.draw(G,G.gl.TRIANGLES,E,D,k,Lt.backCCW,cr,h.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,h.paint,l.transform.zoom,Bt)}}}function va(l,d,h,m,E,D){var k=l.context,G=k.gl,le=d.fbo;if(le){var Se=l.useProgram("hillshade");k.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,le.colorAttachment.get());var Ke=function(Xe,it,xt){var wt=xt.paint.get("hillshade-shadow-color"),Pt=xt.paint.get("hillshade-highlight-color"),gt=xt.paint.get("hillshade-accent-color"),kt=xt.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===xt.paint.get("hillshade-illumination-anchor")&&(kt-=Xe.transform.angle);var Bt,Jt,tn,un=!Xe.options.moving;return{u_matrix:Xe.transform.calculatePosMatrix(it.tileID.toUnwrapped(),un),u_image:0,u_latrange:(Bt=it.tileID,Jt=Math.pow(2,Bt.canonical.z),tn=Bt.canonical.y,[new g.MercatorCoordinate(0,tn/Jt).toLngLat().lat,new g.MercatorCoordinate(0,(tn+1)/Jt).toLngLat().lat]),u_light:[xt.paint.get("hillshade-exaggeration"),kt],u_shadow:wt,u_highlight:Pt,u_accent:gt}}(l,d,h);Se.draw(k,G.TRIANGLES,m,E,D,Lt.disabled,Ke,h.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}}function $u(l,d,h,m,E,D){var Pt,gt,kt,Bt,k=l.context,G=k.gl,le=d.dem;if(le&&le.data){var Se=le.dim,Ke=le.stride,Xe=le.getPixels();if(k.activeTexture.set(G.TEXTURE1),k.pixelStoreUnpackPremultiplyAlpha.set(!1),d.demTexture=d.demTexture||l.getTileTexture(Ke),d.demTexture){var it=d.demTexture;it.update(Xe,{premultiply:!1}),it.bind(G.NEAREST,G.CLAMP_TO_EDGE)}else d.demTexture=new g.Texture(k,Xe,G.RGBA,{premultiply:!1}),d.demTexture.bind(G.NEAREST,G.CLAMP_TO_EDGE);k.activeTexture.set(G.TEXTURE0);var xt=d.fbo;if(!xt){var wt=new g.Texture(k,{width:Se,height:Se,data:null},G.RGBA);wt.bind(G.LINEAR,G.CLAMP_TO_EDGE),(xt=d.fbo=k.createFramebuffer(Se,Se,!0)).colorAttachment.set(wt.texture)}k.bindFramebuffer.set(xt.framebuffer),k.viewport.set([0,0,Se,Se]),l.useProgram("hillshadePrepare").draw(k,G.TRIANGLES,m,E,D,Lt.disabled,(Pt=d.tileID,kt=(gt=le).stride,Bt=g.create(),g.ortho(Bt,0,g.EXTENT,-g.EXTENT,0,0,1),g.translate(Bt,Bt,[0,-g.EXTENT,0]),{u_matrix:Bt,u_image:1,u_dimension:[kt,kt],u_zoom:Pt.overscaledZ,u_unpack:gt.getUnpackVector()}),h.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments),d.needsHillshadePrepare=!1}}function Mu(l,d,h,m,E){var D=m.paint.get("raster-fade-duration");if(D>0){var k=g.browser.now(),G=(k-l.timeAdded)/D,le=d?(k-d.timeAdded)/D:-1,Se=h.getSource(),Ke=E.coveringZoomLevel({tileSize:Se.tileSize,roundZoom:Se.roundZoom}),Xe=!d||Math.abs(d.tileID.overscaledZ-Ke)>Math.abs(l.tileID.overscaledZ-Ke),it=Xe&&l.refreshedUponExpiration?1:g.clamp(Xe?G:1-le,0,1);return l.refreshedUponExpiration&&G>=1&&(l.refreshedUponExpiration=!1),d?{opacity:1,mix:1-it}:{opacity:it,mix:0}}return{opacity:1,mix:0}}var Ms=new g.Color(1,0,0,1),ba=new g.Color(0,1,0,1),nl=new g.Color(0,0,1,1),us=new g.Color(1,0,1,1),rl=new g.Color(0,1,1,1);function fl(l,d,h,m){oa(l,0,d+h/2,l.transform.width,h,m)}function lu(l,d,h,m){oa(l,d-h/2,0,h,l.transform.height,m)}function oa(l,d,h,m,E,D){var k=l.context,G=k.gl;G.enable(G.SCISSOR_TEST),G.scissor(d*g.browser.devicePixelRatio,h*g.browser.devicePixelRatio,m*g.browser.devicePixelRatio,E*g.browser.devicePixelRatio),k.clear({color:D}),G.disable(G.SCISSOR_TEST)}function kl(l,d,h){var m=l.context,E=m.gl,D=h.posMatrix,k=l.useProgram("debug"),G=Qe.disabled,le=ot.disabled,Se=l.colorModeForRenderPass();m.activeTexture.set(E.TEXTURE0),l.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),k.draw(m,E.LINE_STRIP,G,le,Se,Lt.disabled,Na(D,g.Color.red),"$debug",l.debugBuffer,l.tileBorderIndexBuffer,l.debugSegments);var Ke=d.getTileByID(h.key).latestRawTileData,Xe=Math.floor((Ke&&Ke.byteLength||0)/1024),it=d.getTile(h).tileSize,xt=512/Math.min(it,512)*(h.overscaledZ/l.transform.zoom)*.5,wt=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(wt+=" => "+h.overscaledZ),function(Pt,gt){Pt.initDebugOverlayCanvas();var kt=Pt.debugOverlayCanvas,Bt=Pt.context.gl,Jt=Pt.debugOverlayCanvas.getContext("2d");Jt.clearRect(0,0,kt.width,kt.height),Jt.shadowColor="white",Jt.shadowBlur=2,Jt.lineWidth=1.5,Jt.strokeStyle="white",Jt.textBaseline="top",Jt.font="bold 36px Open Sans, sans-serif",Jt.fillText(gt,5,5),Jt.strokeText(gt,5,5),Pt.debugOverlayTexture.update(kt),Pt.debugOverlayTexture.bind(Bt.LINEAR,Bt.CLAMP_TO_EDGE)}(l,wt+" "+Xe+"kb"),k.draw(m,E.TRIANGLES,G,le,Dt.alphaBlended,Lt.disabled,Na(D,g.Color.transparent,xt),"$debug",l.debugBuffer,l.quadTriangleIndexBuffer,l.debugSegments)}var To={symbol:function(l,d,h,m,E){if("translucent"===l.renderPass){var D=ot.disabled,k=l.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(G,le,Se,Ke,Xe,it,xt){for(var wt=le.transform,Pt="map"===Xe,gt="map"===it,kt=0,Bt=G;kt<Bt.length;kt+=1){var Jt=Bt[kt],tn=Ke.getTile(Jt),un=tn.getBucket(Se);if(un&&un.text&&un.text.segments.get().length){var gn=g.evaluateSizeForZoom(un.textSizeData,wt.zoom),Rn=_i(tn,1,le.transform.zoom),$n=Ci(Jt.posMatrix,gt,Pt,le.transform,Rn),Vn="none"!==Se.layout.get("icon-text-fit")&&un.hasIconData();if(gn){var cr=Math.pow(2,wt.zoom-tn.tileID.overscaledZ);Au(un,Pt,gt,xt,g.symbolSize,wt,$n,Jt.posMatrix,cr,gn,Vn)}}}}(m,l,h,d,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),E),0!==h.paint.get("icon-opacity").constantOr(1)&&ia(l,d,h,m,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),D,k),0!==h.paint.get("text-opacity").constantOr(1)&&ia(l,d,h,m,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),D,k),d.map.showCollisionBoxes&&(Za(l,d,h,m,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Za(l,d,h,m,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))}},circle:function(l,d,h,m){if("translucent"===l.renderPass){var E=h.paint.get("circle-opacity"),D=h.paint.get("circle-stroke-width"),k=h.paint.get("circle-stroke-opacity"),G=void 0!==h.layout.get("circle-sort-key").constantOr(1);if(0!==E.constantOr(1)||0!==D.constantOr(1)&&0!==k.constantOr(1)){for(var le=l.context,Se=le.gl,Ke=l.depthModeForSublayer(0,Qe.ReadOnly),Xe=ot.disabled,it=l.colorModeForRenderPass(),xt=[],wt=0;wt<m.length;wt++){var Pt=m[wt],gt=d.getTile(Pt),kt=gt.getBucket(h);if(kt){var Bt=kt.programConfigurations.get(h.id),Jt={programConfiguration:Bt,program:l.useProgram("circle",Bt),layoutVertexBuffer:kt.layoutVertexBuffer,indexBuffer:kt.indexBuffer,uniformValues:La(l,Pt,gt,h)};if(G)for(var tn=0,un=kt.segments.get();tn<un.length;tn+=1){var gn=un[tn];xt.push({segments:new g.SegmentVector([gn]),sortKey:gn.sortKey,state:Jt})}else xt.push({segments:kt.segments,sortKey:0,state:Jt})}}G&&xt.sort(function(yr,Z){return yr.sortKey-Z.sortKey});for(var Rn=0,$n=xt;Rn<$n.length;Rn+=1){var Vn=$n[Rn],cr=Vn.state;cr.program.draw(le,Se.TRIANGLES,Ke,Xe,it,Lt.disabled,cr.uniformValues,h.id,cr.layoutVertexBuffer,cr.indexBuffer,Vn.segments,h.paint,l.transform.zoom,cr.programConfiguration)}}}},heatmap:function(l,d,h,m){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===l.renderPass){var E=l.context,D=E.gl,k=ot.disabled,G=new Dt([D.ONE,D.ONE],g.Color.transparent,[!0,!0,!0,!0]);(function(xt,wt,Pt){var gt=xt.gl;xt.activeTexture.set(gt.TEXTURE1),xt.viewport.set([0,0,wt.width/4,wt.height/4]);var Jt,tn,un,gn,Rn,kt=Pt.heatmapFbo;if(kt)gt.bindTexture(gt.TEXTURE_2D,kt.colorAttachment.get()),xt.bindFramebuffer.set(kt.framebuffer);else{var Bt=gt.createTexture();gt.bindTexture(gt.TEXTURE_2D,Bt),gt.texParameteri(gt.TEXTURE_2D,gt.TEXTURE_WRAP_S,gt.CLAMP_TO_EDGE),gt.texParameteri(gt.TEXTURE_2D,gt.TEXTURE_WRAP_T,gt.CLAMP_TO_EDGE),gt.texParameteri(gt.TEXTURE_2D,gt.TEXTURE_MIN_FILTER,gt.LINEAR),gt.texParameteri(gt.TEXTURE_2D,gt.TEXTURE_MAG_FILTER,gt.LINEAR),un=Bt,gn=kt=Pt.heatmapFbo=xt.createFramebuffer(wt.width/4,wt.height/4,!1),(Rn=(Jt=xt).gl).texImage2D(Rn.TEXTURE_2D,0,Rn.RGBA,(tn=wt).width/4,tn.height/4,0,Rn.RGBA,Jt.extRenderToTextureHalfFloat?Jt.extTextureHalfFloat.HALF_FLOAT_OES:Rn.UNSIGNED_BYTE,null),gn.colorAttachment.set(un)}})(E,l,h),E.clear({color:g.Color.transparent});for(var le=0;le<m.length;le++){var Se=m[le];if(!d.hasRenderableParent(Se)){var Ke=d.getTile(Se),Xe=Ke.getBucket(h);if(Xe){var it=Xe.programConfigurations.get(h.id);l.useProgram("heatmap",it).draw(E,D.TRIANGLES,Qe.disabled,k,G,Lt.disabled,vl(Se.posMatrix,Ke,l.transform.zoom,h.paint.get("heatmap-intensity")),h.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,h.paint,l.transform.zoom,it)}}}E.viewport.set([0,0,l.width,l.height])}else"translucent"===l.renderPass&&(l.context.setColorMode(l.colorModeForRenderPass()),function(xt,wt){var Pt=xt.context,gt=Pt.gl,kt=wt.heatmapFbo;if(kt){Pt.activeTexture.set(gt.TEXTURE0),gt.bindTexture(gt.TEXTURE_2D,kt.colorAttachment.get()),Pt.activeTexture.set(gt.TEXTURE1);var Bt=wt.colorRampTexture;Bt||(Bt=wt.colorRampTexture=new g.Texture(Pt,wt.colorRamp,gt.RGBA)),Bt.bind(gt.LINEAR,gt.CLAMP_TO_EDGE),xt.useProgram("heatmapTexture").draw(Pt,gt.TRIANGLES,Qe.disabled,ot.disabled,xt.colorModeForRenderPass(),Lt.disabled,function(Jt,tn,un,gn){var Rn=g.create();g.ortho(Rn,0,Jt.width,Jt.height,0,0,1);var $n=Jt.context.gl;return{u_matrix:Rn,u_world:[$n.drawingBufferWidth,$n.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:tn.paint.get("heatmap-opacity")}}(xt,wt),wt.id,xt.viewportBuffer,xt.quadTriangleIndexBuffer,xt.viewportSegments,wt.paint,xt.transform.zoom)}}(l,h))},line:function(l,d,h,m){if("translucent"===l.renderPass){var E=h.paint.get("line-opacity"),D=h.paint.get("line-width");if(0!==E.constantOr(1)&&0!==D.constantOr(1))for(var k=l.depthModeForSublayer(0,Qe.ReadOnly),G=l.colorModeForRenderPass(),le=h.paint.get("line-dasharray"),Se=h.paint.get("line-pattern"),Ke=Se.constantOr(1),Xe=h.paint.get("line-gradient"),it=h.getCrossfadeParameters(),xt=Ke?"linePattern":le?"lineSDF":Xe?"lineGradient":"line",wt=l.context,Pt=wt.gl,gt=!0,kt=0,Bt=m;kt<Bt.length;kt+=1){var Jt=Bt[kt],tn=d.getTile(Jt);if(!Ke||tn.patternsLoaded()){var un=tn.getBucket(h);if(un){var gn=un.programConfigurations.get(h.id),Rn=l.context.program.get(),$n=l.useProgram(xt,gn),Vn=gt||$n.program!==Rn,cr=Se.constantOr(null);if(cr&&tn.imageAtlas){var yr=tn.imageAtlas,Z=yr.patternPositions[cr.to.toString()],Q=yr.patternPositions[cr.from.toString()];Z&&Q&&gn.setConstantPatternPositions(Z,Q)}var Fe=Ke?Fa(l,tn,h,it):le?xo(l,tn,h,le,it):Xe?Cr(l,tn,h,un.lineClipsArray.length):Nn(l,tn,h);if(Ke)wt.activeTexture.set(Pt.TEXTURE0),tn.imageAtlasTexture.bind(Pt.LINEAR,Pt.CLAMP_TO_EDGE),gn.updatePaintBuffers(it);else if(le&&(Vn||l.lineAtlas.dirty))wt.activeTexture.set(Pt.TEXTURE0),l.lineAtlas.bind(wt);else if(Xe){var st=un.gradients[h.id],Ut=st.texture;if(h.gradientVersion!==st.version){var Qt=256;if(h.stepInterpolant){var mn=d.getSource().maxzoom,xn=Jt.canonical.z===mn?Math.ceil(1<<l.transform.maxZoom-Jt.canonical.z):1;Qt=g.clamp(g.nextPowerOfTwo(un.maxLineLength/g.EXTENT*1024*xn),256,wt.maxTextureSize)}st.gradient=g.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Qt,image:st.gradient||void 0,clips:un.lineClipsArray}),st.texture?st.texture.update(st.gradient):st.texture=new g.Texture(wt,st.gradient,Pt.RGBA),st.version=h.gradientVersion,Ut=st.texture}wt.activeTexture.set(Pt.TEXTURE0),Ut.bind(h.stepInterpolant?Pt.NEAREST:Pt.LINEAR,Pt.CLAMP_TO_EDGE)}$n.draw(wt,Pt.TRIANGLES,k,l.stencilModeForClipping(Jt),G,Lt.disabled,Fe,h.id,un.layoutVertexBuffer,un.indexBuffer,un.segments,h.paint,l.transform.zoom,gn,un.layoutVertexBuffer2),gt=!1}}}}},fill:function(l,d,h,m){var E=h.paint.get("fill-color"),D=h.paint.get("fill-opacity");if(0!==D.constantOr(1)){var k=l.colorModeForRenderPass(),G=h.paint.get("fill-pattern"),le=l.opaquePassEnabledForLayer()&&!G.constantOr(1)&&1===E.constantOr(g.Color.transparent).a&&1===D.constantOr(0)?"opaque":"translucent";if(l.renderPass===le){var Se=l.depthModeForSublayer(1,"opaque"===l.renderPass?Qe.ReadWrite:Qe.ReadOnly);_a(l,d,h,m,Se,k,!1)}if("translucent"===l.renderPass&&h.paint.get("fill-antialias")){var Ke=l.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,Qe.ReadOnly);_a(l,d,h,m,Ke,k,!0)}}},"fill-extrusion":function(l,d,h,m){var E=h.paint.get("fill-extrusion-opacity");if(0!==E&&"translucent"===l.renderPass){var D=new Qe(l.context.gl.LEQUAL,Qe.ReadWrite,l.depthRangeFor3D);if(1!==E||h.paint.get("fill-extrusion-pattern").constantOr(1))tl(l,d,h,m,D,ot.disabled,Dt.disabled),tl(l,d,h,m,D,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var k=l.colorModeForRenderPass();tl(l,d,h,m,D,ot.disabled,k)}}},hillshade:function(l,d,h,m){if("offscreen"===l.renderPass||"translucent"===l.renderPass){for(var E=l.context,D=l.depthModeForSublayer(0,Qe.ReadOnly),k=l.colorModeForRenderPass(),G="translucent"===l.renderPass?l.stencilConfigForOverlap(m):[{},m],le=G[0],Se=0,Ke=G[1];Se<Ke.length;Se+=1){var Xe=Ke[Se],it=d.getTile(Xe);it.needsHillshadePrepare&&"offscreen"===l.renderPass?$u(l,it,h,D,ot.disabled,k):"translucent"===l.renderPass&&va(l,it,h,D,le[Xe.overscaledZ],k)}E.viewport.set([0,0,l.width,l.height])}},raster:function(l,d,h,m){if("translucent"===l.renderPass&&0!==h.paint.get("raster-opacity")&&m.length)for(var E=l.context,D=E.gl,k=d.getSource(),G=l.useProgram("raster"),le=l.colorModeForRenderPass(),Se=k instanceof Zt?[{},m]:l.stencilConfigForOverlap(m),Ke=Se[0],Xe=Se[1],it=Xe[Xe.length-1].overscaledZ,xt=!l.options.moving,wt=0,Pt=Xe;wt<Pt.length;wt+=1){var gt=Pt[wt],kt=l.depthModeForSublayer(gt.overscaledZ-it,1===h.paint.get("raster-opacity")?Qe.ReadWrite:Qe.ReadOnly,D.LESS),Bt=d.getTile(gt),Jt=l.transform.calculatePosMatrix(gt.toUnwrapped(),xt);Bt.registerFadeDuration(h.paint.get("raster-fade-duration"));var tn=d.findLoadedParent(gt,0),un=Mu(Bt,tn,d,h,l.transform),gn=void 0,Rn=void 0,$n="nearest"===h.paint.get("raster-resampling")?D.NEAREST:D.LINEAR;E.activeTexture.set(D.TEXTURE0),Bt.texture.bind($n,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(D.TEXTURE1),tn?(tn.texture.bind($n,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),gn=Math.pow(2,tn.tileID.overscaledZ-Bt.tileID.overscaledZ),Rn=[Bt.tileID.canonical.x*gn%1,Bt.tileID.canonical.y*gn%1]):Bt.texture.bind($n,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);var Vn=as(Jt,Rn||[0,0],gn||1,un,h);k instanceof Zt?G.draw(E,D.TRIANGLES,kt,ot.disabled,le,Lt.disabled,Vn,h.id,k.boundsBuffer,l.quadTriangleIndexBuffer,k.boundsSegments):G.draw(E,D.TRIANGLES,kt,Ke[gt.overscaledZ],le,Lt.disabled,Vn,h.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}},background:function(l,d,h){var m=h.paint.get("background-color"),E=h.paint.get("background-opacity");if(0!==E){var D=l.context,k=D.gl,G=l.transform,le=G.tileSize,Se=h.paint.get("background-pattern");if(!l.isPatternMissing(Se)){var Ke=!Se&&1===m.a&&1===E&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass===Ke){var Xe=ot.disabled,it=l.depthModeForSublayer(0,"opaque"===Ke?Qe.ReadWrite:Qe.ReadOnly),xt=l.colorModeForRenderPass(),wt=l.useProgram(Se?"backgroundPattern":"background"),Pt=G.coveringTiles({tileSize:le});Se&&(D.activeTexture.set(k.TEXTURE0),l.imageManager.bind(l.context));for(var gt=h.getCrossfadeParameters(),kt=0,Bt=Pt;kt<Bt.length;kt+=1){var Jt=Bt[kt],tn=l.transform.calculatePosMatrix(Jt.toUnwrapped()),un=Se?yo(tn,E,l,Se,{tileID:Jt,tileSize:le},gt):As(tn,E,m);wt.draw(D,k.TRIANGLES,it,Xe,xt,Lt.disabled,un,h.id,l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}}}},debug:function(l,d,h){for(var m=0;m<h.length;m++)kl(l,d,h[m])},custom:function(l,d,h){var m=l.context,E=h.implementation;if("offscreen"===l.renderPass){var D=E.prerender;D&&(l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),D.call(E,m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState())}else if("translucent"===l.renderPass){l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),m.setStencilMode(ot.disabled);var k="3d"===E.renderingMode?new Qe(l.context.gl.LEQUAL,Qe.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,Qe.ReadOnly);m.setDepthMode(k),E.render(m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState(),m.bindFramebuffer.set(null)}}},Ai=function(l,d){this.context=new Je(l),this.transform=d,this._tileTextures={},this.setup(),this.numSublayers=Ie.maxUnderzooming+Ie.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ho,this.gpuTimers={}};Ai.prototype.resize=function(l,d){if(this.width=l*g.browser.devicePixelRatio,this.height=d*g.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var h=0,m=this.style._order;h<m.length;h+=1)this.style._layers[m[h]].resize()},Ai.prototype.setup=function(){var l=this.context,d=new g.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(g.EXTENT,0),d.emplaceBack(0,g.EXTENT),d.emplaceBack(g.EXTENT,g.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(d,Ni.members),this.tileExtentSegments=g.SegmentVector.simpleSegment(0,0,4,2);var h=new g.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(g.EXTENT,0),h.emplaceBack(0,g.EXTENT),h.emplaceBack(g.EXTENT,g.EXTENT),this.debugBuffer=l.createVertexBuffer(h,Ni.members),this.debugSegments=g.SegmentVector.simpleSegment(0,0,4,5);var m=new g.StructArrayLayout4i8;m.emplaceBack(0,0,0,0),m.emplaceBack(g.EXTENT,0,g.EXTENT,0),m.emplaceBack(0,g.EXTENT,0,g.EXTENT),m.emplaceBack(g.EXTENT,g.EXTENT,g.EXTENT,g.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(m,ft.members),this.rasterBoundsSegments=g.SegmentVector.simpleSegment(0,0,4,2);var E=new g.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(E,Ni.members),this.viewportSegments=g.SegmentVector.simpleSegment(0,0,4,2);var D=new g.StructArrayLayout1ui2;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(D);var k=new g.StructArrayLayout3ui6;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(k),this.emptyTexture=new g.Texture(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);var G=this.context.gl;this.stencilClearMode=new ot({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO)},Ai.prototype.clearStencil=function(){var l=this.context,d=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var h=g.create();g.ortho(h,0,this.width,this.height,0,0,1),g.scale(h,h,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,d.TRIANGLES,Qe.disabled,this.stencilClearMode,Dt.disabled,Lt.disabled,Xo(h),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ai.prototype._renderTileClippingMasks=function(l,d){if(this.currentStencilSource!==l.source&&l.isTileClipped()&&d&&d.length){this.currentStencilSource=l.source;var h=this.context,m=h.gl;this.nextStencilID+d.length>256&&this.clearStencil(),h.setColorMode(Dt.disabled),h.setDepthMode(Qe.disabled);var E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var D=0,k=d;D<k.length;D+=1){var G=k[D],le=this._tileClippingMaskIDs[G.key]=this.nextStencilID++;E.draw(h,m.TRIANGLES,Qe.disabled,new ot({func:m.ALWAYS,mask:0},le,255,m.KEEP,m.KEEP,m.REPLACE),Dt.disabled,Lt.disabled,Xo(G.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ai.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var l=this.nextStencilID++,d=this.context.gl;return new ot({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)},Ai.prototype.stencilModeForClipping=function(l){var d=this.context.gl;return new ot({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)},Ai.prototype.stencilConfigForOverlap=function(l){var d,h=this.context.gl,m=l.sort(function(le,Se){return Se.overscaledZ-le.overscaledZ}),E=m[m.length-1].overscaledZ,D=m[0].overscaledZ-E+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();for(var k={},G=0;G<D;G++)k[G+E]=new ot({func:h.GEQUAL,mask:255},G+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=D,[k,m]}return[(d={},d[E]=ot.disabled,d),m]},Ai.prototype.colorModeForRenderPass=function(){var l=this.context.gl;return this._showOverdrawInspector?new Dt([l.CONSTANT_COLOR,l.ONE],new g.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Dt.unblended:Dt.alphaBlended},Ai.prototype.depthModeForSublayer=function(l,d,h){if(!this.opaquePassEnabledForLayer())return Qe.disabled;var m=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Qe(h||this.context.gl.LEQUAL,d,[m,m])},Ai.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ai.prototype.render=function(l,d){var h=this;this.style=l,this.options=d,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(g.browser.now()),this.imageManager.beginFrame();var m=this.style._order,E=this.style.sourceCaches;for(var D in E){var k=E[D];k.used&&k.prepare(this.context)}var G,le,Se={},Ke={},Xe={};for(var it in E){var xt=E[it];Se[it]=xt.getVisibleCoordinates(),Ke[it]=Se[it].slice().reverse(),Xe[it]=xt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var wt=0;wt<m.length;wt++)if(this.style._layers[m[wt]].is3D()){this.opaquePassCutoff=wt;break}this.renderPass="offscreen";for(var Pt=0,gt=m;Pt<gt.length;Pt+=1){var kt=this.style._layers[gt[Pt]];if(kt.hasOffscreenPass()&&!kt.isHidden(this.transform.zoom)){var Bt=Ke[kt.source];("custom"===kt.type||Bt.length)&&this.renderLayer(this,E[kt.source],kt,Bt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?g.Color.black:g.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){var Jt=this.style._layers[m[this.currentLayer]],tn=E[Jt.source],un=Se[Jt.source];this._renderTileClippingMasks(Jt,un),this.renderLayer(this,tn,Jt,un)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){var gn=this.style._layers[m[this.currentLayer]],Rn=E[gn.source],$n=("symbol"===gn.type?Xe:Ke)[gn.source];this._renderTileClippingMasks(gn,Se[gn.source]),this.renderLayer(this,Rn,gn,$n)}this.options.showTileBoundaries&&(g.values(this.style._layers).forEach(function(Vn){Vn.source&&!Vn.isHidden(h.transform.zoom)&&(Vn.source!==(le&&le.id)&&(le=h.style.sourceCaches[Vn.source]),(!G||G.getSource().maxzoom<le.getSource().maxzoom)&&(G=le))}),G&&To.debug(this,G,G.getVisibleCoordinates())),this.options.showPadding&&function(Vn){var cr=Vn.transform.padding;fl(Vn,Vn.transform.height-(cr.top||0),3,Ms),fl(Vn,cr.bottom||0,3,ba),lu(Vn,cr.left||0,3,nl),lu(Vn,Vn.transform.width-(cr.right||0),3,us);var Z,Q,Fe,st,yr=Vn.transform.centerPoint;oa(Z=Vn,(Q=yr.x)-1,(Fe=Vn.transform.height-yr.y)-10,2,20,st=rl),oa(Z,Q-10,Fe-1,20,2,st)}(this),this.context.setDefault()},Ai.prototype.renderLayer=function(l,d,h,m){h.isHidden(this.transform.zoom)||("background"===h.type||"custom"===h.type||m.length)&&(this.id=h.id,this.gpuTimingStart(h),To[h.type](l,d,h,m,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ai.prototype.gpuTimingStart=function(l){if(this.options.gpuTiming){var d=this.context.extTimerQuery,h=this.gpuTimers[l.id];h||(h=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),h.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,h.query)}},Ai.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}},Ai.prototype.collectGpuTimers=function(){var l=this.gpuTimers;return this.gpuTimers={},l},Ai.prototype.queryGpuTimers=function(l){var d={};for(var h in l){var m=l[h],E=this.context.extTimerQuery,D=E.getQueryObjectEXT(m.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(m.query),d[h]=D}return d},Ai.prototype.translatePosMatrix=function(l,d,h,m,E){if(!h[0]&&!h[1])return l;var D=E?"map"===m?this.transform.angle:0:"viewport"===m?-this.transform.angle:0;if(D){var k=Math.sin(D),G=Math.cos(D);h=[h[0]*G-h[1]*k,h[0]*k+h[1]*G]}var le=[E?h[0]:_i(d,h[0],this.transform.zoom),E?h[1]:_i(d,h[1],this.transform.zoom),0],Se=new Float32Array(16);return g.translate(Se,l,le),Se},Ai.prototype.saveTileTexture=function(l){var d=this._tileTextures[l.size[0]];d?d.push(l):this._tileTextures[l.size[0]]=[l]},Ai.prototype.getTileTexture=function(l){var d=this._tileTextures[l];return d&&d.length>0?d.pop():null},Ai.prototype.isPatternMissing=function(l){if(!l)return!1;if(!l.from||!l.to)return!0;var d=this.imageManager.getPattern(l.from.toString()),h=this.imageManager.getPattern(l.to.toString());return!d||!h},Ai.prototype.useProgram=function(l,d){this.cache=this.cache||{};var h=""+l+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[h]||(this.cache[h]=new Qr(this.context,l,Hr[l],d,Bs[l],this._showOverdrawInspector)),this.cache[h]},Ai.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ai.prototype.setBaseState=function(){var l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)},Ai.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=g.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new g.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Ai.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ao=function(l,d){this.points=l,this.planes=d};ao.fromInvProjectionMatrix=function(l,d,h){var m=Math.pow(2,h),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(k){return g.transformMat4([],k,l)}).map(function(k){return g.scale$1([],k,1/k[3]/d*m)}),D=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(k){var G=g.sub([],E[k[0]],E[k[1]]),le=g.sub([],E[k[2]],E[k[1]]),Se=g.normalize([],g.cross([],G,le)),Ke=-g.dot(Se,E[k[1]]);return Se.concat(Ke)});return new ao(E,D)};var Ka=function(l,d){this.min=l,this.max=d,this.center=g.scale$2([],g.add([],this.min,this.max),.5)};Ka.prototype.quadrant=function(l){for(var d=[l%2==0,l<2],h=g.clone$2(this.min),m=g.clone$2(this.max),E=0;E<d.length;E++)h[E]=d[E]?this.min[E]:this.center[E],m[E]=d[E]?this.center[E]:this.max[E];return m[2]=this.max[2],new Ka(h,m)},Ka.prototype.distanceX=function(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]},Ka.prototype.distanceY=function(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]},Ka.prototype.intersects=function(l){for(var d=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],h=!0,m=0;m<l.planes.length;m++){for(var E=l.planes[m],D=0,k=0;k<d.length;k++)D+=g.dot$1(E,d[k])>=0;if(0===D)return 0;D!==d.length&&(h=!1)}if(h)return 2;for(var G=0;G<3;G++){for(var le=Number.MAX_VALUE,Se=-Number.MAX_VALUE,Ke=0;Ke<l.points.length;Ke++){var Xe=l.points[Ke][G]-this.min[G];le=Math.min(le,Xe),Se=Math.max(Se,Xe)}if(Se<0||le>this.max[G]-this.min[G])return 0}return 1};var sa=function(l,d,h,m){if(void 0===l&&(l=0),void 0===d&&(d=0),void 0===h&&(h=0),void 0===m&&(m=0),isNaN(l)||l<0||isNaN(d)||d<0||isNaN(h)||h<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=h,this.right=m};sa.prototype.interpolate=function(l,d,h){return null!=d.top&&null!=l.top&&(this.top=g.number(l.top,d.top,h)),null!=d.bottom&&null!=l.bottom&&(this.bottom=g.number(l.bottom,d.bottom,h)),null!=d.left&&null!=l.left&&(this.left=g.number(l.left,d.left,h)),null!=d.right&&null!=l.right&&(this.right=g.number(l.right,d.right,h)),this},sa.prototype.getCenter=function(l,d){var h=g.clamp((this.left+l-this.right)/2,0,l),m=g.clamp((this.top+d-this.bottom)/2,0,d);return new g.Point(h,m)},sa.prototype.equals=function(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right},sa.prototype.clone=function(){return new sa(this.top,this.bottom,this.left,this.right)},sa.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var P=function(l,d,h,m,E){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===E||E,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=null==h?0:h,this._maxPitch=null==m?60:m,this.setMaxBounds(),this.width=0,this.height=0,this._center=new g.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new sa,this._posMatrixCache={},this._alignedPosMatrixCache={}},B={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};P.prototype.clone=function(){var l=new P(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l},B.minZoom.get=function(){return this._minZoom},B.minZoom.set=function(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))},B.maxZoom.get=function(){return this._maxZoom},B.maxZoom.set=function(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))},B.minPitch.get=function(){return this._minPitch},B.minPitch.set=function(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))},B.maxPitch.get=function(){return this._maxPitch},B.maxPitch.set=function(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))},B.renderWorldCopies.get=function(){return this._renderWorldCopies},B.renderWorldCopies.set=function(l){void 0===l?l=!0:null===l&&(l=!1),this._renderWorldCopies=l},B.worldSize.get=function(){return this.tileSize*this.scale},B.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},B.size.get=function(){return new g.Point(this.width,this.height)},B.bearing.get=function(){return-this.angle/Math.PI*180},B.bearing.set=function(l){var d=-g.wrap(l,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=g.create$2(),g.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},B.pitch.get=function(){return this._pitch/Math.PI*180},B.pitch.set=function(l){var d=g.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())},B.fov.get=function(){return this._fov/Math.PI*180},B.fov.set=function(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())},B.zoom.get=function(){return this._zoom},B.zoom.set=function(l){var d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom,this._constrain(),this._calcMatrices())},B.center.get=function(){return this._center},B.center.set=function(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())},B.padding.get=function(){return this._edgeInsets.toJSON()},B.padding.set=function(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())},B.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},P.prototype.isPaddingEqual=function(l){return this._edgeInsets.equals(l)},P.prototype.interpolatePadding=function(l,d,h){this._unmodified=!1,this._edgeInsets.interpolate(l,d,h),this._constrain(),this._calcMatrices()},P.prototype.coveringZoomLevel=function(l){var d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)},P.prototype.getVisibleUnwrappedCoordinates=function(l){var d=[new g.UnwrappedTileID(0,l)];if(this._renderWorldCopies)for(var h=this.pointCoordinate(new g.Point(0,0)),m=this.pointCoordinate(new g.Point(this.width,0)),E=this.pointCoordinate(new g.Point(this.width,this.height)),D=this.pointCoordinate(new g.Point(0,this.height)),k=Math.floor(Math.min(h.x,m.x,E.x,D.x)),G=Math.floor(Math.max(h.x,m.x,E.x,D.x)),le=k-1;le<=G+1;le++)0!==le&&d.push(new g.UnwrappedTileID(le,l));return d},P.prototype.coveringTiles=function(l){var d=this.coveringZoomLevel(l),h=d;if(void 0!==l.minzoom&&d<l.minzoom)return[];void 0!==l.maxzoom&&d>l.maxzoom&&(d=l.maxzoom);var m=g.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,d),D=[E*m.x,E*m.y,0],k=ao.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d),G=l.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(G=d);var le=function(Vn){return{aabb:new Ka([Vn*E,0,0],[(Vn+1)*E,E,0]),zoom:0,x:0,y:0,wrap:Vn,fullyVisible:!1}},Se=[],Ke=[],Xe=d,it=l.reparseOverscaled?h:d;if(this._renderWorldCopies)for(var xt=1;xt<=3;xt++)Se.push(le(-xt)),Se.push(le(xt));for(Se.push(le(0));Se.length>0;){var wt=Se.pop(),Pt=wt.x,gt=wt.y,kt=wt.fullyVisible;if(!kt){var Bt=wt.aabb.intersects(k);if(0===Bt)continue;kt=2===Bt}var Jt=wt.aabb.distanceX(D),tn=wt.aabb.distanceY(D),un=Math.max(Math.abs(Jt),Math.abs(tn));if(wt.zoom===Xe||un>3+(1<<Xe-wt.zoom)-2&&wt.zoom>=G)Ke.push({tileID:new g.OverscaledTileID(wt.zoom===Xe?it:wt.zoom,wt.wrap,wt.zoom,Pt,gt),distanceSq:g.sqrLen([D[0]-.5-Pt,D[1]-.5-gt])});else for(var gn=0;gn<4;gn++){var Rn=(Pt<<1)+gn%2,$n=(gt<<1)+(gn>>1);Se.push({aabb:wt.aabb.quadrant(gn),zoom:wt.zoom+1,x:Rn,y:$n,wrap:wt.wrap,fullyVisible:kt})}}return Ke.sort(function(Vn,cr){return Vn.distanceSq-cr.distanceSq}).map(function(Vn){return Vn.tileID})},P.prototype.resize=function(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()},B.unmodified.get=function(){return this._unmodified},P.prototype.zoomScale=function(l){return Math.pow(2,l)},P.prototype.scaleZoom=function(l){return Math.log(l)/Math.LN2},P.prototype.project=function(l){var d=g.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new g.Point(g.mercatorXfromLng(l.lng)*this.worldSize,g.mercatorYfromLat(d)*this.worldSize)},P.prototype.unproject=function(l){return new g.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()},B.point.get=function(){return this.project(this.center)},P.prototype.setLocationAtPoint=function(l,d){var h=this.pointCoordinate(d),m=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(l),D=new g.MercatorCoordinate(E.x-(h.x-m.x),E.y-(h.y-m.y));this.center=this.coordinateLocation(D),this._renderWorldCopies&&(this.center=this.center.wrap())},P.prototype.locationPoint=function(l){return this.coordinatePoint(this.locationCoordinate(l))},P.prototype.pointLocation=function(l){return this.coordinateLocation(this.pointCoordinate(l))},P.prototype.locationCoordinate=function(l){return g.MercatorCoordinate.fromLngLat(l)},P.prototype.coordinateLocation=function(l){return l.toLngLat()},P.prototype.pointCoordinate=function(l){var d=[l.x,l.y,0,1],h=[l.x,l.y,1,1];g.transformMat4(d,d,this.pixelMatrixInverse),g.transformMat4(h,h,this.pixelMatrixInverse);var m=d[3],E=h[3],D=d[1]/m,k=h[1]/E,G=d[2]/m,le=h[2]/E,Se=G===le?0:(0-G)/(le-G);return new g.MercatorCoordinate(g.number(d[0]/m,h[0]/E,Se)/this.worldSize,g.number(D,k,Se)/this.worldSize)},P.prototype.coordinatePoint=function(l){var d=[l.x*this.worldSize,l.y*this.worldSize,0,1];return g.transformMat4(d,d,this.pixelMatrix),new g.Point(d[0]/d[3],d[1]/d[3])},P.prototype.getBounds=function(){return(new g.LngLatBounds).extend(this.pointLocation(new g.Point(0,0))).extend(this.pointLocation(new g.Point(this.width,0))).extend(this.pointLocation(new g.Point(this.width,this.height))).extend(this.pointLocation(new g.Point(0,this.height)))},P.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new g.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},P.prototype.setMaxBounds=function(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},P.prototype.calculatePosMatrix=function(l,d){void 0===d&&(d=!1);var h=l.key,m=d?this._alignedPosMatrixCache:this._posMatrixCache;if(m[h])return m[h];var E=l.canonical,D=this.worldSize/this.zoomScale(E.z),k=E.x+Math.pow(2,E.z)*l.wrap,G=g.identity(new Float64Array(16));return g.translate(G,G,[k*D,E.y*D,0]),g.scale(G,G,[D/g.EXTENT,D/g.EXTENT,1]),g.multiply(G,d?this.alignedProjMatrix:this.projMatrix,G),m[h]=new Float32Array(G),m[h]},P.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},P.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var l,d,h,m,E=-90,D=90,k=-180,G=180,le=this.size,Se=this._unmodified;if(this.latRange){var Ke=this.latRange;E=g.mercatorYfromLat(Ke[1])*this.worldSize,l=(D=g.mercatorYfromLat(Ke[0])*this.worldSize)-E<le.y?le.y/(D-E):0}if(this.lngRange){var Xe=this.lngRange;k=g.mercatorXfromLng(Xe[0])*this.worldSize,d=(G=g.mercatorXfromLng(Xe[1])*this.worldSize)-k<le.x?le.x/(G-k):0}var it=this.point,xt=Math.max(d||0,l||0);if(xt)return this.center=this.unproject(new g.Point(d?(G+k)/2:it.x,l?(D+E)/2:it.y)),this.zoom+=this.scaleZoom(xt),this._unmodified=Se,void(this._constraining=!1);if(this.latRange){var wt=it.y,Pt=le.y/2;wt-Pt<E&&(m=E+Pt),wt+Pt>D&&(m=D-Pt)}if(this.lngRange){var gt=it.x,kt=le.x/2;gt-kt<k&&(h=k+kt),gt+kt>G&&(h=G-kt)}void 0===h&&void 0===m||(this.center=this.unproject(new g.Point(void 0!==h?h:it.x,void 0!==m?m:it.y))),this._unmodified=Se,this._constraining=!1}},P.prototype._calcMatrices=function(){if(this.height){var l=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var d=Math.PI/2+this._pitch,h=this._fov*(.5+l.y/this.height),m=Math.sin(h)*this.cameraToCenterDistance/Math.sin(g.clamp(Math.PI-d-h,.01,Math.PI-.01)),E=this.point,D=E.x,k=E.y,G=1.01*(Math.cos(Math.PI/2-this._pitch)*m+this.cameraToCenterDistance),le=this.height/50,Se=new Float64Array(16);g.perspective(Se,this._fov,this.width/this.height,le,G),Se[8]=2*-l.x/this.width,Se[9]=2*l.y/this.height,g.scale(Se,Se,[1,-1,1]),g.translate(Se,Se,[0,0,-this.cameraToCenterDistance]),g.rotateX(Se,Se,this._pitch),g.rotateZ(Se,Se,this.angle),g.translate(Se,Se,[-D,-k,0]),this.mercatorMatrix=g.scale([],Se,[this.worldSize,this.worldSize,this.worldSize]),g.scale(Se,Se,[1,1,g.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Se,this.invProjMatrix=g.invert([],this.projMatrix);var Ke=this.width%2/2,Xe=this.height%2/2,it=Math.cos(this.angle),xt=Math.sin(this.angle),wt=D-Math.round(D)+it*Ke+xt*Xe,Pt=k-Math.round(k)+it*Xe+xt*Ke,gt=new Float64Array(Se);if(g.translate(gt,gt,[wt>.5?wt-1:wt,Pt>.5?Pt-1:Pt,0]),this.alignedProjMatrix=gt,Se=g.create(),g.scale(Se,Se,[this.width/2,-this.height/2,1]),g.translate(Se,Se,[1,-1,0]),this.labelPlaneMatrix=Se,Se=g.create(),g.scale(Se,Se,[1,-1,1]),g.translate(Se,Se,[-1,-1,0]),g.scale(Se,Se,[2/this.width,2/this.height,1]),this.glCoordMatrix=Se,this.pixelMatrix=g.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Se=g.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Se,this._posMatrixCache={},this._alignedPosMatrixCache={}}},P.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var l=this.pointCoordinate(new g.Point(0,0)),d=[l.x*this.worldSize,l.y*this.worldSize,0,1];return g.transformMat4(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance},P.prototype.getCameraPoint=function(){var l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new g.Point(0,l))},P.prototype.getCameraQueryGeometry=function(l){var d=this.getCameraPoint();if(1===l.length)return[l[0],d];for(var h=d.x,m=d.y,E=d.x,D=d.y,k=0,G=l;k<G.length;k+=1){var le=G[k];h=Math.min(h,le.x),m=Math.min(m,le.y),E=Math.max(E,le.x),D=Math.max(D,le.y)}return[new g.Point(h,m),new g.Point(E,m),new g.Point(E,D),new g.Point(h,D),new g.Point(h,m)]},Object.defineProperties(P.prototype,B);var $=function(l){var d,h,m,E;this._hashName=l&&encodeURIComponent(l),g.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(d=this._updateHashUnthrottled.bind(this),h=!1,m=null,E=function(){m=null,h&&(d(),m=setTimeout(E,300),h=!1)},function(){return h=!0,m||E(),m})};$.prototype.addTo=function(l){return this._map=l,g.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},$.prototype.remove=function(){return g.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},$.prototype.getHashString=function(l){var d=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,m=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,m),D=Math.round(d.lng*E)/E,k=Math.round(d.lat*E)/E,G=this._map.getBearing(),le=this._map.getPitch(),Se="";if(Se+=l?"/"+D+"/"+k+"/"+h:h+"/"+k+"/"+D,(G||le)&&(Se+="/"+Math.round(10*G)/10),le&&(Se+="/"+Math.round(le)),this._hashName){var Ke=this._hashName,Xe=!1,it=g.window.location.hash.slice(1).split("&").map(function(xt){var wt=xt.split("=")[0];return wt===Ke?(Xe=!0,wt+"="+Se):xt}).filter(function(xt){return xt});return Xe||it.push(Ke+"="+Se),"#"+it.join("&")}return"#"+Se},$.prototype._getCurrentHash=function(){var l,d=this,h=g.window.location.hash.replace("#","");return this._hashName?(h.split("&").map(function(m){return m.split("=")}).forEach(function(m){m[0]===d._hashName&&(l=m)}),(l&&l[1]||"").split("/")):h.split("/")},$.prototype._onHashChange=function(){var l=this._getCurrentHash();if(l.length>=3&&!l.some(function(h){return isNaN(h)})){var d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:d,pitch:+(l[4]||0)}),!0}return!1},$.prototype._updateHashUnthrottled=function(){var l=g.window.location.href.replace(/(#.+)?$/,this.getHashString());try{g.window.history.replaceState(g.window.history.state,null,l)}catch(d){}};var de={linearity:.3,easing:g.bezier(0,0,.3,1)},Ge=g.extend({deceleration:2500,maxSpeed:1400},de),Ze=g.extend({deceleration:20,maxSpeed:1400},de),Mt=g.extend({deceleration:1e3,maxSpeed:360},de),$t=g.extend({deceleration:1e3,maxSpeed:90},de),_n=function(l){this._map=l,this.clear()};function on(l,d){(!l.duration||l.duration<d.duration)&&(l.duration=d.duration,l.easing=d.easing)}function or(l,d,h){var m=h.maxSpeed,E=h.linearity,D=h.deceleration,k=g.clamp(l*E/(d/1e3),-m,m),G=Math.abs(k)/(D*E);return{easing:h.easing,duration:1e3*G,amount:k*(G/2)}}_n.prototype.clear=function(){this._inertiaBuffer=[]},_n.prototype.record=function(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:g.browser.now(),settings:l})},_n.prototype._drainInertiaBuffer=function(){for(var l=this._inertiaBuffer,d=g.browser.now();l.length>0&&d-l[0].time>160;)l.shift()},_n.prototype._onMoveEnd=function(l){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var d={zoom:0,bearing:0,pitch:0,pan:new g.Point(0,0),pinchAround:void 0,around:void 0},h=0,m=this._inertiaBuffer;h<m.length;h+=1){var E=m[h].settings;d.zoom+=E.zoomDelta||0,d.bearing+=E.bearingDelta||0,d.pitch+=E.pitchDelta||0,E.panDelta&&d.pan._add(E.panDelta),E.around&&(d.around=E.around),E.pinchAround&&(d.pinchAround=E.pinchAround)}var D=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,k={};if(d.pan.mag()){var G=or(d.pan.mag(),D,g.extend({},Ge,l||{}));k.offset=d.pan.mult(G.amount/d.pan.mag()),k.center=this._map.transform.center,on(k,G)}if(d.zoom){var le=or(d.zoom,D,Ze);k.zoom=this._map.transform.zoom+le.amount,on(k,le)}if(d.bearing){var Se=or(d.bearing,D,Mt);k.bearing=this._map.transform.bearing+g.clamp(Se.amount,-179,179),on(k,Se)}if(d.pitch){var Ke=or(d.pitch,D,$t);k.pitch=this._map.transform.pitch+Ke.amount,on(k,Ke)}if(k.zoom||k.bearing){var Xe=void 0===d.pinchAround?d.around:d.pinchAround;k.around=Xe?this._map.unproject(Xe):this._map.getCenter()}return this.clear(),g.extend(k,{noMoveStart:!0})}};var Gn=function(l){function d(m,E,D,k){void 0===k&&(k={});var G=xe.mousePos(E.getCanvasContainer(),D),le=E.unproject(G);l.call(this,m,g.extend({point:G,lngLat:le,originalEvent:D},k)),this._defaultPrevented=!1,this.target=E}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var h={defaultPrevented:{configurable:!0}};return d.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(d.prototype,h),d}(g.Event),dr=function(l){function d(m,E,D){var k="touchend"===m?D.changedTouches:D.touches,G=xe.touchPos(E.getCanvasContainer(),k),le=G.map(function(Xe){return E.unproject(Xe)}),Se=G.reduce(function(Xe,it,xt,wt){return Xe.add(it.div(wt.length))},new g.Point(0,0)),Ke=E.unproject(Se);l.call(this,m,{points:G,point:Se,lngLats:le,lngLat:Ke,originalEvent:D}),this._defaultPrevented=!1}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var h={defaultPrevented:{configurable:!0}};return d.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(d.prototype,h),d}(g.Event),gi=function(l){function d(m,E,D){l.call(this,m,{originalEvent:D}),this._defaultPrevented=!1}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var h={defaultPrevented:{configurable:!0}};return d.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(d.prototype,h),d}(g.Event),Yr=function(l,d){this._map=l,this._clickTolerance=d.clickTolerance};Yr.prototype.reset=function(){delete this._mousedownPos},Yr.prototype.wheel=function(l){return this._firePreventable(new gi(l.type,this._map,l))},Yr.prototype.mousedown=function(l,d){return this._mousedownPos=d,this._firePreventable(new Gn(l.type,this._map,l))},Yr.prototype.mouseup=function(l){this._map.fire(new Gn(l.type,this._map,l))},Yr.prototype.click=function(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new Gn(l.type,this._map,l))},Yr.prototype.dblclick=function(l){return this._firePreventable(new Gn(l.type,this._map,l))},Yr.prototype.mouseover=function(l){this._map.fire(new Gn(l.type,this._map,l))},Yr.prototype.mouseout=function(l){this._map.fire(new Gn(l.type,this._map,l))},Yr.prototype.touchstart=function(l){return this._firePreventable(new dr(l.type,this._map,l))},Yr.prototype.touchmove=function(l){this._map.fire(new dr(l.type,this._map,l))},Yr.prototype.touchend=function(l){this._map.fire(new dr(l.type,this._map,l))},Yr.prototype.touchcancel=function(l){this._map.fire(new dr(l.type,this._map,l))},Yr.prototype._firePreventable=function(l){if(this._map.fire(l),l.defaultPrevented)return{}},Yr.prototype.isEnabled=function(){return!0},Yr.prototype.isActive=function(){return!1},Yr.prototype.enable=function(){},Yr.prototype.disable=function(){};var tr=function(l){this._map=l};tr.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},tr.prototype.mousemove=function(l){this._map.fire(new Gn(l.type,this._map,l))},tr.prototype.mousedown=function(){this._delayContextMenu=!0},tr.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Gn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},tr.prototype.contextmenu=function(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new Gn(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()},tr.prototype.isEnabled=function(){return!0},tr.prototype.isActive=function(){return!1},tr.prototype.enable=function(){},tr.prototype.disable=function(){};var Po=function(l,d){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1};function gs(l,d){for(var h={},m=0;m<l.length;m++)h[l[m].identifier]=d[m];return h}Po.prototype.isEnabled=function(){return!!this._enabled},Po.prototype.isActive=function(){return!!this._active},Po.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Po.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Po.prototype.mousedown=function(l,d){this.isEnabled()&&l.shiftKey&&0===l.button&&(xe.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)},Po.prototype.mousemoveWindow=function(l,d){if(this._active){var h=d;if(!(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)){var m=this._startPos;this._lastPos=h,this._box||(this._box=xe.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));var E=Math.min(m.x,h.x),D=Math.max(m.x,h.x),k=Math.min(m.y,h.y),G=Math.max(m.y,h.y);xe.setTransform(this._box,"translate("+E+"px,"+k+"px)"),this._box.style.width=D-E+"px",this._box.style.height=G-k+"px"}}},Po.prototype.mouseupWindow=function(l,d){var h=this;if(this._active&&0===l.button){var m=this._startPos,E=d;if(this.reset(),xe.suppressClick(),m.x!==E.x||m.y!==E.y)return this._map.fire(new g.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:function(D){return D.fitScreenCoordinates(m,E,h._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",l)}},Po.prototype.keydown=function(l){this._active&&27===l.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",l))},Po.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(xe.remove(this._box),this._box=null),xe.enableDrag(),delete this._startPos,delete this._lastPos},Po.prototype._fireEvent=function(l,d){return this._map.fire(new g.Event(l,{originalEvent:d}))};var Ya=function(l){this.reset(),this.numTouches=l.numTouches};Ya.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ya.prototype.touchstart=function(l,d,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=l.timeStamp),h.length===this.numTouches&&(this.centroid=function(m){for(var E=new g.Point(0,0),D=0,k=m;D<k.length;D+=1)E._add(k[D]);return E.div(m.length)}(d),this.touches=gs(h,d)))},Ya.prototype.touchmove=function(l,d,h){if(!this.aborted&&this.centroid){var m=gs(h,d);for(var E in this.touches){var D=m[E];(!D||D.dist(this.touches[E])>30)&&(this.aborted=!0)}}},Ya.prototype.touchend=function(l,d,h){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),0===h.length){var m=!this.aborted&&this.centroid;if(this.reset(),m)return m}};var wa=function(l){this.singleTap=new Ya(l),this.numTaps=l.numTaps,this.reset()};wa.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},wa.prototype.touchstart=function(l,d,h){this.singleTap.touchstart(l,d,h)},wa.prototype.touchmove=function(l,d,h){this.singleTap.touchmove(l,d,h)},wa.prototype.touchend=function(l,d,h){var m=this.singleTap.touchend(l,d,h);if(m){var E=l.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(m)<30;if(E&&D||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}};var wi=function(){this._zoomIn=new wa({numTouches:1,numTaps:2}),this._zoomOut=new wa({numTouches:2,numTaps:1}),this.reset()};wi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},wi.prototype.touchstart=function(l,d,h){this._zoomIn.touchstart(l,d,h),this._zoomOut.touchstart(l,d,h)},wi.prototype.touchmove=function(l,d,h){this._zoomIn.touchmove(l,d,h),this._zoomOut.touchmove(l,d,h)},wi.prototype.touchend=function(l,d,h){var m=this,E=this._zoomIn.touchend(l,d,h),D=this._zoomOut.touchend(l,d,h);return E?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(E)},{originalEvent:l})}}):D?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(D)},{originalEvent:l})}}):void 0},wi.prototype.touchcancel=function(){this.reset()},wi.prototype.enable=function(){this._enabled=!0},wi.prototype.disable=function(){this._enabled=!1,this.reset()},wi.prototype.isEnabled=function(){return this._enabled},wi.prototype.isActive=function(){return this._active};var Ba={0:1,2:2},rr=function(l){this.reset(),this._clickTolerance=l.clickTolerance||1};rr.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},rr.prototype._correctButton=function(l,d){return!1},rr.prototype._move=function(l,d){return{}},rr.prototype.mousedown=function(l,d){if(!this._lastPoint){var h=xe.mouseButton(l);this._correctButton(l,h)&&(this._lastPoint=d,this._eventButton=h)}},rr.prototype.mousemoveWindow=function(l,d){var m,D,h=this._lastPoint;if(h)if(l.preventDefault(),D=Ba[this._eventButton],void 0===(m=l).buttons||(m.buttons&D)!==D)this.reset();else if(this._moved||!(d.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(h,d)},rr.prototype.mouseupWindow=function(l){this._lastPoint&&xe.mouseButton(l)===this._eventButton&&(this._moved&&xe.suppressClick(),this.reset())},rr.prototype.enable=function(){this._enabled=!0},rr.prototype.disable=function(){this._enabled=!1,this.reset()},rr.prototype.isEnabled=function(){return this._enabled},rr.prototype.isActive=function(){return this._active};var Gu=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.mousedown=function(h,m){l.prototype.mousedown.call(this,h,m),this._lastPoint&&(this._active=!0)},d.prototype._correctButton=function(h,m){return 0===m&&!h.ctrlKey},d.prototype._move=function(h,m){return{around:m,panDelta:m.sub(h)}},d}(rr),cu=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._correctButton=function(h,m){return 0===m&&h.ctrlKey||2===m},d.prototype._move=function(h,m){var E=.8*(m.x-h.x);if(E)return this._active=!0,{bearingDelta:E}},d.prototype.contextmenu=function(h){h.preventDefault()},d}(rr),Ol=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._correctButton=function(h,m){return 0===m&&h.ctrlKey||2===m},d.prototype._move=function(h,m){var E=-.5*(m.y-h.y);if(E)return this._active=!0,{pitchDelta:E}},d.prototype.contextmenu=function(h){h.preventDefault()},d}(rr),Ri=function(l){this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset()};Ri.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new g.Point(0,0)},Ri.prototype.touchstart=function(l,d,h){return this._calculateTransform(l,d,h)},Ri.prototype.touchmove=function(l,d,h){if(this._active&&!(h.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,d,h)},Ri.prototype.touchend=function(l,d,h){this._calculateTransform(l,d,h),this._active&&h.length<this._minTouches&&this.reset()},Ri.prototype.touchcancel=function(){this.reset()},Ri.prototype._calculateTransform=function(l,d,h){h.length>0&&(this._active=!0);var m=gs(h,d),E=new g.Point(0,0),D=new g.Point(0,0),k=0;for(var G in m){var le=m[G],Se=this._touches[G];Se&&(E._add(le),D._add(le.sub(Se)),k++,m[G]=le)}if(this._touches=m,!(k<this._minTouches)&&D.mag()){var Ke=D.div(k);if(this._sum._add(Ke),!(this._sum.mag()<this._clickTolerance))return{around:E.div(k),panDelta:Ke}}},Ri.prototype.enable=function(){this._enabled=!0},Ri.prototype.disable=function(){this._enabled=!1,this.reset()},Ri.prototype.isEnabled=function(){return this._enabled},Ri.prototype.isActive=function(){return this._active};var zs=function(){this.reset()};function Zs(l,d,h){for(var m=0;m<l.length;m++)if(l[m].identifier===h)return d[m]}function qu(l,d){return Math.log(l/d)/Math.LN2}zs.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},zs.prototype._start=function(l){},zs.prototype._move=function(l,d,h){return{}},zs.prototype.touchstart=function(l,d,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([d[0],d[1]]))},zs.prototype.touchmove=function(l,d,h){if(this._firstTwoTouches){l.preventDefault();var m=this._firstTwoTouches,E=m[1],D=Zs(h,d,m[0]),k=Zs(h,d,E);if(D&&k){var G=this._aroundCenter?null:D.add(k).div(2);return this._move([D,k],G,l)}}},zs.prototype.touchend=function(l,d,h){if(this._firstTwoTouches){var m=this._firstTwoTouches,E=m[1],D=Zs(h,d,m[0]),k=Zs(h,d,E);D&&k||(this._active&&xe.suppressClick(),this.reset())}},zs.prototype.touchcancel=function(){this.reset()},zs.prototype.enable=function(l){this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around},zs.prototype.disable=function(){this._enabled=!1,this.reset()},zs.prototype.isEnabled=function(){return this._enabled},zs.prototype.isActive=function(){return this._active};var Qo=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.reset=function(){l.prototype.reset.call(this),delete this._distance,delete this._startDistance},d.prototype._start=function(h){this._startDistance=this._distance=h[0].dist(h[1])},d.prototype._move=function(h,m){var E=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(qu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:qu(this._distance,E),pinchAround:m}},d}(zs);function So(l,d){return 180*l.angleWith(d)/Math.PI}var hu=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.reset=function(){l.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},d.prototype._start=function(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])},d.prototype._move=function(h,m){var E=this._vector;if(this._vector=h[0].sub(h[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:So(this._vector,E),pinchAround:m}},d.prototype._isBelowThreshold=function(h){this._minDiameter=Math.min(this._minDiameter,h.mag());var m=25/(Math.PI*this._minDiameter)*360,E=So(h,this._startVector);return Math.abs(E)<m},d}(zs);function aa(l){return Math.abs(l.y)>Math.abs(l.x)}var bl=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.reset=function(){l.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},d.prototype._start=function(h){this._lastPoints=h,aa(h[0].sub(h[1]))&&(this._valid=!1)},d.prototype._move=function(h,m,E){var D=h[0].sub(this._lastPoints[0]),k=h[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(D,k,E.timeStamp),this._valid)return this._lastPoints=h,this._active=!0,{pitchDelta:(D.y+k.y)/2*-.5}},d.prototype.gestureBeginsVertically=function(h,m,E){if(void 0!==this._valid)return this._valid;var D=h.mag()>=2,k=m.mag()>=2;if(D||k){if(!D||!k)return void 0===this._firstMove&&(this._firstMove=E),E-this._firstMove<100&&void 0;var G=h.y>0==m.y>0;return aa(h)&&aa(m)&&G}},d}(zs),il={panStep:100,bearingStep:15,pitchStep:10},Zn=function(){var l=il;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1};function Mi(l){return l*(2-l)}Zn.prototype.reset=function(){this._active=!1},Zn.prototype.keydown=function(l){var d=this;if(!(l.altKey||l.ctrlKey||l.metaKey)){var h=0,m=0,E=0,D=0,k=0;switch(l.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:l.shiftKey?m=-1:(l.preventDefault(),D=-1);break;case 39:l.shiftKey?m=1:(l.preventDefault(),D=1);break;case 38:l.shiftKey?E=1:(l.preventDefault(),k=-1);break;case 40:l.shiftKey?E=-1:(l.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(m=0,E=0),{cameraAnimation:function(G){var le=G.getZoom();G.easeTo({duration:300,easeId:"keyboardHandler",easing:Mi,zoom:h?Math.round(le)+h*(l.shiftKey?2:1):le,bearing:G.getBearing()+m*d._bearingStep,pitch:G.getPitch()+E*d._pitchStep,offset:[-D*d._panStep,-k*d._panStep],center:G.getCenter()},{originalEvent:l})}}}},Zn.prototype.enable=function(){this._enabled=!0},Zn.prototype.disable=function(){this._enabled=!1,this.reset()},Zn.prototype.isEnabled=function(){return this._enabled},Zn.prototype.isActive=function(){return this._active},Zn.prototype.disableRotation=function(){this._rotationDisabled=!0},Zn.prototype.enableRotation=function(){this._rotationDisabled=!1};var V=function(l,d){this._map=l,this._el=l.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,g.bindAll(["_onTimeout"],this)};V.prototype.setZoomRate=function(l){this._defaultZoomRate=l},V.prototype.setWheelZoomRate=function(l){this._wheelZoomRate=l},V.prototype.isEnabled=function(){return!!this._enabled},V.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},V.prototype.isZooming=function(){return!!this._zooming},V.prototype.enable=function(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&"center"===l.around)},V.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},V.prototype.wheel=function(l){if(this.isEnabled()){var d=l.deltaMode===g.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,h=g.browser.now(),m=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,0!==d&&d%4.000244140625==0?this._type="wheel":0!==d&&Math.abs(d)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(m*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}},V.prototype._onTimeout=function(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},V.prototype._start=function(l){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var d=xe.mousePos(this._el,l);this._around=g.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(d)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},V.prototype.renderFrame=function(){var l=this;if(this._frameId&&(this._frameId=null,this.isActive())){var d=this._map.transform;if(0!==this._delta){var h="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,m=2/(1+Math.exp(-Math.abs(this._delta*h)));this._delta<0&&0!==m&&(m=1/m);var E="number"==typeof this._targetZoom?d.zoomScale(this._targetZoom):d.scale;this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(E*m))),"wheel"===this._type&&(this._startZoom=d.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var D,k="number"==typeof this._targetZoom?this._targetZoom:d.zoom,G=this._startZoom,le=this._easing,Se=!1;if("wheel"===this._type&&G&&le){var Ke=Math.min((g.browser.now()-this._lastWheelEventTime)/200,1),Xe=le(Ke);D=g.number(G,k,Xe),Ke<1?this._frameId||(this._frameId=!0):Se=!0}else D=k,Se=!0;return this._active=!0,Se&&(this._active=!1,this._finishTimeout=setTimeout(function(){l._zooming=!1,l._handler._triggerRenderFrame(),delete l._targetZoom,delete l._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Se,zoomDelta:D-d.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},V.prototype._smoothOutEasing=function(l){var d=g.ease;if(this._prevEase){var h=this._prevEase,m=(g.browser.now()-h.start)/h.duration,E=h.easing(m+.01)-h.easing(m),D=.27/Math.sqrt(E*E+1e-4)*.01,k=Math.sqrt(.0729-D*D);d=g.bezier(D,k,.25,1)}return this._prevEase={start:g.browser.now(),duration:l,easing:d},d},V.prototype.reset=function(){this._active=!1};var F=function(l,d){this._clickZoom=l,this._tapZoom=d};F.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},F.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},F.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},F.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var M=function(){this.reset()};M.prototype.reset=function(){this._active=!1},M.prototype.dblclick=function(l,d){return l.preventDefault(),{cameraAnimation:function(h){h.easeTo({duration:300,zoom:h.getZoom()+(l.shiftKey?-1:1),around:h.unproject(d)},{originalEvent:l})}}},M.prototype.enable=function(){this._enabled=!0},M.prototype.disable=function(){this._enabled=!1,this.reset()},M.prototype.isEnabled=function(){return this._enabled},M.prototype.isActive=function(){return this._active};var J=function(){this._tap=new wa({numTouches:1,numTaps:1}),this.reset()};J.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},J.prototype.touchstart=function(l,d,h){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=d[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(l,d,h))},J.prototype.touchmove=function(l,d,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;var m=d[0],E=m.y-this._swipePoint.y;return this._swipePoint=m,l.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(l,d,h)},J.prototype.touchend=function(l,d,h){this._tapTime?this._swipePoint&&0===h.length&&this.reset():this._tap.touchend(l,d,h)&&(this._tapTime=l.timeStamp)},J.prototype.touchcancel=function(){this.reset()},J.prototype.enable=function(){this._enabled=!0},J.prototype.disable=function(){this._enabled=!1,this.reset()},J.prototype.isEnabled=function(){return this._enabled},J.prototype.isActive=function(){return this._active};var ye=function(l,d,h){this._el=l,this._mousePan=d,this._touchPan=h};ye.prototype.enable=function(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ye.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ye.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ye.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var De=function(l,d,h){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=h};De.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},De.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},De.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},De.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Ne=function(l,d,h,m){this._el=l,this._touchZoom=d,this._touchRotate=h,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0};Ne.prototype.enable=function(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Ne.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Ne.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Ne.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Ne.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Ne.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var at=function(l){return l.zoom||l.drag||l.pitch||l.rotate},pn=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(g.Event);function wn(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}var Fn=function(l,d){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _n(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d),g.bindAll(["handleEvent","handleWindowEvent"],this);var h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[g.window.document,"mousemove",{capture:!0}],[g.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[g.window,"blur",void 0]];for(var m=0,E=this._listeners;m<E.length;m+=1){var D=E[m],k=D[0];xe.addEventListener(k,D[1],k===g.window.document?this.handleWindowEvent:this.handleEvent,D[2])}};Fn.prototype.destroy=function(){for(var l=0,d=this._listeners;l<d.length;l+=1){var h=d[l],m=h[0];xe.removeEventListener(m,h[1],m===g.window.document?this.handleWindowEvent:this.handleEvent,h[2])}},Fn.prototype._addDefaultHandlers=function(l){var d=this._map,h=d.getCanvasContainer();this._add("mapEvent",new Yr(d,l));var m=d.boxZoom=new Po(d,l);this._add("boxZoom",m);var E=new wi,D=new M;d.doubleClickZoom=new F(D,E),this._add("tapZoom",E),this._add("clickZoom",D);var k=new J;this._add("tapDragZoom",k);var G=d.touchPitch=new bl;this._add("touchPitch",G);var le=new cu(l),Se=new Ol(l);d.dragRotate=new De(l,le,Se),this._add("mouseRotate",le,["mousePitch"]),this._add("mousePitch",Se,["mouseRotate"]);var Ke=new Gu(l),Xe=new Ri(l);d.dragPan=new ye(h,Ke,Xe),this._add("mousePan",Ke),this._add("touchPan",Xe,["touchZoom","touchRotate"]);var it=new hu,xt=new Qo;d.touchZoomRotate=new Ne(h,xt,it,k),this._add("touchRotate",it,["touchPan","touchZoom"]),this._add("touchZoom",xt,["touchPan","touchRotate"]);var wt=d.scrollZoom=new V(d,this);this._add("scrollZoom",wt,["mousePan"]);var Pt=d.keyboard=new Zn;this._add("keyboard",Pt),this._add("blockableMapEvent",new tr(d));for(var gt=0,kt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];gt<kt.length;gt+=1){var Bt=kt[gt];l.interactive&&l[Bt]&&d[Bt].enable(l[Bt])}},Fn.prototype._add=function(l,d,h){this._handlers.push({handlerName:l,handler:d,allowed:h}),this._handlersById[l]=d},Fn.prototype.stop=function(l){if(!this._updatingCamera){for(var d=0,h=this._handlers;d<h.length;d+=1)h[d].handler.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}},Fn.prototype.isActive=function(){for(var l=0,d=this._handlers;l<d.length;l+=1)if(d[l].handler.isActive())return!0;return!1},Fn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Fn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Fn.prototype.isMoving=function(){return Boolean(at(this._eventsInProgress))||this.isZooming()},Fn.prototype._blockedByActive=function(l,d,h){for(var m in l)if(m!==h&&(!d||d.indexOf(m)<0))return!0;return!1},Fn.prototype.handleWindowEvent=function(l){this.handleEvent(l,l.type+"Window")},Fn.prototype._getMapTouches=function(l){for(var d=[],h=0,m=l;h<m.length;h+=1){var E=m[h];this._el.contains(E.target)&&d.push(E)}return d},Fn.prototype.handleEvent=function(l,d){if("blur"!==l.type){this._updatingCamera=!0;for(var h="renderFrame"===l.type?void 0:l,m={needsRenderFrame:!1},E={},D={},k=l.touches?this._getMapTouches(l.touches):void 0,G=k?xe.touchPos(this._el,k):xe.mousePos(this._el,l),le=0,Se=this._handlers;le<Se.length;le+=1){var Ke=Se[le],Xe=Ke.handlerName,it=Ke.handler,xt=Ke.allowed;if(it.isEnabled()){var wt=void 0;this._blockedByActive(D,xt,Xe)?it.reset():it[d||l.type]&&(wt=it[d||l.type](l,G,k),this.mergeHandlerResult(m,E,wt,Xe,h),wt&&wt.needsRenderFrame&&this._triggerRenderFrame()),(wt||it.isActive())&&(D[Xe]=it)}}var Pt={};for(var gt in this._previousActiveHandlers)D[gt]||(Pt[gt]=h);this._previousActiveHandlers=D,(Object.keys(Pt).length||wn(m))&&(this._changes.push([m,E,Pt]),this._triggerRenderFrame()),(Object.keys(D).length||wn(m))&&this._map._stop(!0),this._updatingCamera=!1;var kt=m.cameraAnimation;kt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],kt(this._map))}else this.stop(!0)},Fn.prototype.mergeHandlerResult=function(l,d,h,m,E){if(h){g.extend(l,h);var D={handlerName:m,originalEvent:h.originalEvent||E};void 0!==h.zoomDelta&&(d.zoom=D),void 0!==h.panDelta&&(d.drag=D),void 0!==h.pitchDelta&&(d.pitch=D),void 0!==h.bearingDelta&&(d.rotate=D)}},Fn.prototype._applyChanges=function(){for(var l={},d={},h={},m=0,E=this._changes;m<E.length;m+=1){var D=E[m],k=D[0],G=D[1],le=D[2];k.panDelta&&(l.panDelta=(l.panDelta||new g.Point(0,0))._add(k.panDelta)),k.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+k.zoomDelta),k.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+k.bearingDelta),k.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+k.pitchDelta),void 0!==k.around&&(l.around=k.around),void 0!==k.pinchAround&&(l.pinchAround=k.pinchAround),k.noInertia&&(l.noInertia=k.noInertia),g.extend(d,G),g.extend(h,le)}this._updateMapTransform(l,d,h),this._changes=[]},Fn.prototype._updateMapTransform=function(l,d,h){var m=this._map,E=m.transform;if(!wn(l))return this._fireEvents(d,h,!0);var D=l.panDelta,k=l.zoomDelta,G=l.bearingDelta,le=l.pitchDelta,Se=l.around,Ke=l.pinchAround;void 0!==Ke&&(Se=Ke),m._stop(!0),Se=Se||m.transform.centerPoint;var Xe=E.pointLocation(D?Se.sub(D):Se);G&&(E.bearing+=G),le&&(E.pitch+=le),k&&(E.zoom+=k),E.setLocationAtPoint(Xe,Se),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,h,!0)},Fn.prototype._fireEvents=function(l,d,h){var m=this,E=at(this._eventsInProgress),D=at(l),k={};for(var G in l)this._eventsInProgress[G]||(k[G+"start"]=l[G].originalEvent),this._eventsInProgress[G]=l[G];for(var le in!E&&D&&this._fireEvent("movestart",D.originalEvent),k)this._fireEvent(le,k[le]);for(var Se in D&&this._fireEvent("move",D.originalEvent),l)this._fireEvent(Se,l[Se].originalEvent);var Ke,Xe={};for(var it in this._eventsInProgress){var xt=this._eventsInProgress[it],wt=xt.handlerName,Pt=xt.originalEvent;this._handlersById[wt].isActive()||(delete this._eventsInProgress[it],Xe[it+"end"]=Ke=d[wt]||Pt)}for(var gt in Xe)this._fireEvent(gt,Xe[gt]);var kt=at(this._eventsInProgress);if(h&&(E||D)&&!kt){this._updatingCamera=!0;var Bt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Jt=function(tn){return 0!==tn&&-m._bearingSnap<tn&&tn<m._bearingSnap};Bt?(Jt(Bt.bearing||this._map.getBearing())&&(Bt.bearing=0),this._map.easeTo(Bt,{originalEvent:Ke})):(this._map.fire(new g.Event("moveend",{originalEvent:Ke})),Jt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Fn.prototype._fireEvent=function(l,d){this._map.fire(new g.Event(l,d?{originalEvent:d}:{}))},Fn.prototype._requestFrame=function(){var l=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(d){delete l._frameId,l.handleEvent(new pn("renderFrame",{timeStamp:d})),l._applyChanges()})},Fn.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var Pr=function(l){function d(h,m){l.call(this),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=m.bearingSnap,g.bindAll(["_renderFrameCallback"],this)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getCenter=function(){return new g.LngLat(this.transform.center.lng,this.transform.center.lat)},d.prototype.setCenter=function(h,m){return this.jumpTo({center:h},m)},d.prototype.panBy=function(h,m,E){return h=g.Point.convert(h).mult(-1),this.panTo(this.transform.center,g.extend({offset:h},m),E)},d.prototype.panTo=function(h,m,E){return this.easeTo(g.extend({center:h},m),E)},d.prototype.getZoom=function(){return this.transform.zoom},d.prototype.setZoom=function(h,m){return this.jumpTo({zoom:h},m),this},d.prototype.zoomTo=function(h,m,E){return this.easeTo(g.extend({zoom:h},m),E)},d.prototype.zoomIn=function(h,m){return this.zoomTo(this.getZoom()+1,h,m),this},d.prototype.zoomOut=function(h,m){return this.zoomTo(this.getZoom()-1,h,m),this},d.prototype.getBearing=function(){return this.transform.bearing},d.prototype.setBearing=function(h,m){return this.jumpTo({bearing:h},m),this},d.prototype.getPadding=function(){return this.transform.padding},d.prototype.setPadding=function(h,m){return this.jumpTo({padding:h},m),this},d.prototype.rotateTo=function(h,m,E){return this.easeTo(g.extend({bearing:h},m),E)},d.prototype.resetNorth=function(h,m){return this.rotateTo(0,g.extend({duration:1e3},h),m),this},d.prototype.resetNorthPitch=function(h,m){return this.easeTo(g.extend({bearing:0,pitch:0,duration:1e3},h),m),this},d.prototype.snapToNorth=function(h,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,m):this},d.prototype.getPitch=function(){return this.transform.pitch},d.prototype.setPitch=function(h,m){return this.jumpTo({pitch:h},m),this},d.prototype.cameraForBounds=function(h,m){h=g.LngLatBounds.convert(h);var E=m&&m.bearing||0;return this._cameraForBoxAndBearing(h.getNorthWest(),h.getSouthEast(),E,m)},d.prototype._cameraForBoxAndBearing=function(h,m,E,D){var k={top:0,bottom:0,right:0,left:0};if("number"==typeof(D=g.extend({padding:k,offset:[0,0],maxZoom:this.transform.maxZoom},D)).padding){var G=D.padding;D.padding={top:G,bottom:G,right:G,left:G}}D.padding=g.extend(k,D.padding);var le=this.transform,Se=le.padding,Ke=le.project(g.LngLat.convert(h)),Xe=le.project(g.LngLat.convert(m)),it=Ke.rotate(-E*Math.PI/180),xt=Xe.rotate(-E*Math.PI/180),wt=new g.Point(Math.max(it.x,xt.x),Math.max(it.y,xt.y)),Pt=new g.Point(Math.min(it.x,xt.x),Math.min(it.y,xt.y)),gt=wt.sub(Pt),kt=(le.width-(Se.left+Se.right+D.padding.left+D.padding.right))/gt.x,Bt=(le.height-(Se.top+Se.bottom+D.padding.top+D.padding.bottom))/gt.y;if(!(Bt<0||kt<0)){var Jt=Math.min(le.scaleZoom(le.scale*Math.min(kt,Bt)),D.maxZoom),tn="number"==typeof D.offset.x?new g.Point(D.offset.x,D.offset.y):g.Point.convert(D.offset),un=new g.Point((D.padding.left-D.padding.right)/2,(D.padding.top-D.padding.bottom)/2).rotate(E*Math.PI/180),gn=tn.add(un).mult(le.scale/le.zoomScale(Jt));return{center:le.unproject(Ke.add(Xe).div(2).sub(gn)),zoom:Jt,bearing:E}}g.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},d.prototype.fitBounds=function(h,m,E){return this._fitInternal(this.cameraForBounds(h,m),m,E)},d.prototype.fitScreenCoordinates=function(h,m,E,D,k){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(g.Point.convert(h)),this.transform.pointLocation(g.Point.convert(m)),E,D),D,k)},d.prototype._fitInternal=function(h,m,E){return h?(delete(m=g.extend(h,m)).padding,m.linear?this.easeTo(m,E):this.flyTo(m,E)):this},d.prototype.jumpTo=function(h,m){this.stop();var E=this.transform,D=!1,k=!1,G=!1;return"zoom"in h&&E.zoom!==+h.zoom&&(D=!0,E.zoom=+h.zoom),void 0!==h.center&&(E.center=g.LngLat.convert(h.center)),"bearing"in h&&E.bearing!==+h.bearing&&(k=!0,E.bearing=+h.bearing),"pitch"in h&&E.pitch!==+h.pitch&&(G=!0,E.pitch=+h.pitch),null==h.padding||E.isPaddingEqual(h.padding)||(E.padding=h.padding),this.fire(new g.Event("movestart",m)).fire(new g.Event("move",m)),D&&this.fire(new g.Event("zoomstart",m)).fire(new g.Event("zoom",m)).fire(new g.Event("zoomend",m)),k&&this.fire(new g.Event("rotatestart",m)).fire(new g.Event("rotate",m)).fire(new g.Event("rotateend",m)),G&&this.fire(new g.Event("pitchstart",m)).fire(new g.Event("pitch",m)).fire(new g.Event("pitchend",m)),this.fire(new g.Event("moveend",m))},d.prototype.easeTo=function(h,m){var E=this;this._stop(!1,h.easeId),(!1===(h=g.extend({offset:[0,0],duration:500,easing:g.ease},h)).animate||!h.essential&&g.browser.prefersReducedMotion)&&(h.duration=0);var D=this.transform,k=this.getZoom(),G=this.getBearing(),le=this.getPitch(),Se=this.getPadding(),Ke="zoom"in h?+h.zoom:k,Xe="bearing"in h?this._normalizeBearing(h.bearing,G):G,it="pitch"in h?+h.pitch:le,xt="padding"in h?h.padding:D.padding,wt=g.Point.convert(h.offset),Pt=D.centerPoint.add(wt),gt=D.pointLocation(Pt),kt=g.LngLat.convert(h.center||gt);this._normalizeCenter(kt);var Bt,Jt,tn=D.project(gt),un=D.project(kt).sub(tn),gn=D.zoomScale(Ke-k);h.around&&(Bt=g.LngLat.convert(h.around),Jt=D.locationPoint(Bt));var Rn={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ke!==k,this._rotating=this._rotating||G!==Xe,this._pitching=this._pitching||it!==le,this._padding=!D.isPaddingEqual(xt),this._easeId=h.easeId,this._prepareEase(m,h.noMoveStart,Rn),this._ease(function($n){if(E._zooming&&(D.zoom=g.number(k,Ke,$n)),E._rotating&&(D.bearing=g.number(G,Xe,$n)),E._pitching&&(D.pitch=g.number(le,it,$n)),E._padding&&(D.interpolatePadding(Se,xt,$n),Pt=D.centerPoint.add(wt)),Bt)D.setLocationAtPoint(Bt,Jt);else{var Vn=D.zoomScale(D.zoom-k),cr=Ke>k?Math.min(2,gn):Math.max(.5,gn),yr=Math.pow(cr,1-$n),Z=D.unproject(tn.add(un.mult($n*yr)).mult(Vn));D.setLocationAtPoint(D.renderWorldCopies?Z.wrap():Z,Pt)}E._fireMoveEvents(m)},function($n){E._afterEase(m,$n)},h),this},d.prototype._prepareEase=function(h,m,E){void 0===E&&(E={}),this._moving=!0,m||E.moving||this.fire(new g.Event("movestart",h)),this._zooming&&!E.zooming&&this.fire(new g.Event("zoomstart",h)),this._rotating&&!E.rotating&&this.fire(new g.Event("rotatestart",h)),this._pitching&&!E.pitching&&this.fire(new g.Event("pitchstart",h))},d.prototype._fireMoveEvents=function(h){this.fire(new g.Event("move",h)),this._zooming&&this.fire(new g.Event("zoom",h)),this._rotating&&this.fire(new g.Event("rotate",h)),this._pitching&&this.fire(new g.Event("pitch",h))},d.prototype._afterEase=function(h,m){if(!this._easeId||!m||this._easeId!==m){delete this._easeId;var E=this._zooming,D=this._rotating,k=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,E&&this.fire(new g.Event("zoomend",h)),D&&this.fire(new g.Event("rotateend",h)),k&&this.fire(new g.Event("pitchend",h)),this.fire(new g.Event("moveend",h))}},d.prototype.flyTo=function(h,m){var E=this;if(!h.essential&&g.browser.prefersReducedMotion){var D=g.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(D,m)}this.stop(),h=g.extend({offset:[0,0],speed:1.2,curve:1.42,easing:g.ease},h);var k=this.transform,G=this.getZoom(),le=this.getBearing(),Se=this.getPitch(),Ke=this.getPadding(),Xe="zoom"in h?g.clamp(+h.zoom,k.minZoom,k.maxZoom):G,it="bearing"in h?this._normalizeBearing(h.bearing,le):le,xt="pitch"in h?+h.pitch:Se,wt="padding"in h?h.padding:k.padding,Pt=k.zoomScale(Xe-G),gt=g.Point.convert(h.offset),kt=k.centerPoint.add(gt),Bt=k.pointLocation(kt),Jt=g.LngLat.convert(h.center||Bt);this._normalizeCenter(Jt);var tn=k.project(Bt),un=k.project(Jt).sub(tn),gn=h.curve,Rn=Math.max(k.width,k.height),$n=Rn/Pt,Vn=un.mag();if("minZoom"in h){var cr=g.clamp(Math.min(h.minZoom,G,Xe),k.minZoom,k.maxZoom),yr=Rn/k.zoomScale(cr-G);gn=Math.sqrt(yr/Vn*2)}var Z=gn*gn;function Q(sr){var hr=($n*$n-Rn*Rn+(sr?-1:1)*Z*Z*Vn*Vn)/(2*(sr?$n:Rn)*Z*Vn);return Math.log(Math.sqrt(hr*hr+1)-hr)}function Fe(sr){return(Math.exp(sr)-Math.exp(-sr))/2}function st(sr){return(Math.exp(sr)+Math.exp(-sr))/2}var Ut=Q(0),Qt=function(sr){return st(Ut)/st(Ut+gn*sr)},mn=function(sr){return Rn*((st(Ut)*(Fe(hr=Ut+gn*sr)/st(hr))-Fe(Ut))/Z)/Vn;var hr},xn=(Q(1)-Ut)/gn;if(Math.abs(Vn)<1e-6||!isFinite(xn)){if(Math.abs(Rn-$n)<1e-6)return this.easeTo(h,m);var Bn=$n<Rn?-1:1;xn=Math.abs(Math.log($n/Rn))/gn,mn=function(){return 0},Qt=function(sr){return Math.exp(Bn*gn*sr)}}return h.duration="duration"in h?+h.duration:1e3*xn/("screenSpeed"in h?+h.screenSpeed/gn:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0),this._zooming=!0,this._rotating=le!==it,this._pitching=xt!==Se,this._padding=!k.isPaddingEqual(wt),this._prepareEase(m,!1),this._ease(function(sr){var hr=sr*xn,vi=1/Qt(hr);k.zoom=1===sr?Xe:G+k.scaleZoom(vi),E._rotating&&(k.bearing=g.number(le,it,sr)),E._pitching&&(k.pitch=g.number(Se,xt,sr)),E._padding&&(k.interpolatePadding(Ke,wt,sr),kt=k.centerPoint.add(gt));var ki=1===sr?Jt:k.unproject(tn.add(un.mult(mn(hr))).mult(vi));k.setLocationAtPoint(k.renderWorldCopies?ki.wrap():ki,kt),E._fireMoveEvents(m)},function(){return E._afterEase(m)},h),this},d.prototype.isEasing=function(){return!!this._easeFrameId},d.prototype.stop=function(){return this._stop()},d.prototype._stop=function(h,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var E=this._onEaseEnd;delete this._onEaseEnd,E.call(this,m)}if(!h){var D=this.handlers;D&&D.stop(!1)}return this},d.prototype._ease=function(h,m,E){!1===E.animate||0===E.duration?(h(1),m()):(this._easeStart=g.browser.now(),this._easeOptions=E,this._onEaseFrame=h,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},d.prototype._renderFrameCallback=function(){var h=Math.min((g.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},d.prototype._normalizeBearing=function(h,m){h=g.wrap(h,-180,180);var E=Math.abs(h-m);return Math.abs(h-360-m)<E&&(h-=360),Math.abs(h+360-m)<E&&(h+=360),h},d.prototype._normalizeCenter=function(h){var m=this.transform;if(m.renderWorldCopies&&!m.lngRange){var E=h.lng-m.center.lng;h.lng+=E>180?-360:E<-180?360:0}},d}(g.Evented),si=function(l){void 0===l&&(l={}),this.options=l,g.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};si.prototype.getDefaultPosition=function(){return"bottom-right"},si.prototype.onAdd=function(l){var d=this.options&&this.options.compact;return this._map=l,this._container=xe.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=xe.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=xe.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===d&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},si.prototype.onRemove=function(){xe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},si.prototype._setElementTitle=function(l,d){var h=this._map._getUIString("AttributionControl."+d);l.title=h,l.setAttribute("aria-label",h)},si.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},si.prototype._updateEditLink=function(){var l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));var d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||g.config.ACCESS_TOKEN}];if(l){var h=d.reduce(function(m,E,D){return E.value&&(m+=E.key+"="+E.value+(D<d.length-1?"&":"")),m},"?");l.href=g.config.FEEDBACK_URL+"/"+h+(this._map._hash?this._map._hash.getHashString(!0):""),l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}},si.prototype._updateData=function(l){!l||"metadata"!==l.sourceDataType&&"visibility"!==l.sourceDataType&&"style"!==l.dataType||(this._updateAttributions(),this._updateEditLink())},si.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function(G){return"string"!=typeof G?"":G})):"string"==typeof this.options.customAttribution&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}var h=this._map.style.sourceCaches;for(var m in h){var E=h[m];if(E.used){var D=E.getSource();D.attribution&&l.indexOf(D.attribution)<0&&l.push(D.attribution)}}l.sort(function(G,le){return G.length-le.length});var k=(l=l.filter(function(G,le){for(var Se=le+1;Se<l.length;Se++)if(l[Se].indexOf(G)>=0)return!1;return!0})).join(" | ");k!==this._attribHTML&&(this._attribHTML=k,l.length?(this._innerContainer.innerHTML=k,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},si.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var xi=function(){g.bindAll(["_updateLogo"],this),g.bindAll(["_updateCompact"],this)};xi.prototype.onAdd=function(l){this._map=l,this._container=xe.create("div","mapboxgl-ctrl");var d=xe.create("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},xi.prototype.onRemove=function(){xe.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},xi.prototype.getDefaultPosition=function(){return"bottom-left"},xi.prototype._updateLogo=function(l){l&&"metadata"!==l.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},xi.prototype._logoRequired=function(){if(this._map.style){var l=this._map.style.sourceCaches;for(var d in l)if(l[d].getSource().mapbox_logo)return!0;return!1}},xi.prototype._updateCompact=function(){var l=this._container.children;if(l.length){var d=l[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}};var Ro=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ro.prototype.add=function(l){var d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d},Ro.prototype.remove=function(l){for(var d=this._currentlyRunning,h=0,m=d?this._queue.concat(d):this._queue;h<m.length;h+=1){var E=m[h];if(E.id===l)return void(E.cancelled=!0)}},Ro.prototype.run=function(l){void 0===l&&(l=0);var d=this._currentlyRunning=this._queue;this._queue=[];for(var h=0,m=d;h<m.length;h+=1){var E=m[h];if(!E.cancelled&&(E.callback(l),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ro.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Co={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},xa=g.window.HTMLImageElement,Ea=g.window.HTMLElement,Wr=g.window.ImageBitmap,Xi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ks=function(l){function d(m){var E=this;if(null!=(m=g.extend({},Xi,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var D=new P(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies);if(l.call(this,D,m),this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new Ro,this._controls=[],this._mapId=g.uniqueId(),this._locale=g.extend({},Co,m.locale),this._clickTolerance=m.clickTolerance,this._requestManager=new g.RequestManager(m.transformRequest,m.accessToken),"string"==typeof m.container){if(this._container=g.window.document.getElementById(m.container),!this._container)throw new Error("Container '"+m.container+"' not found.")}else{if(!(m.container instanceof Ea))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),g.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return E._update(!1)}),this.on("moveend",function(){return E._update(!1)}),this.on("zoom",function(){return E._update(!0)}),void 0!==g.window&&(g.window.addEventListener("online",this._onWindowOnline,!1),g.window.addEventListener("resize",this._onWindowResize,!1),g.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Fn(this,m),this._hash=m.hash&&new $("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,g.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new si({customAttribution:m.customAttribution})),this.addControl(new xi,m.logoPosition),this.on("style.load",function(){E.transform.unmodified&&E.jumpTo(E.style.stylesheet)}),this.on("data",function(k){E._update("style"===k.dataType),E.fire(new g.Event(k.dataType+"data",k))}),this.on("dataloading",function(k){E.fire(new g.Event(k.dataType+"dataloading",k))})}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var h={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return d.prototype._getMapId=function(){return this._mapId},d.prototype.addControl=function(m,E){if(void 0===E&&(E=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var D=m.onAdd(this);this._controls.push(m);var k=this._controlPositions[E];return-1!==E.indexOf("bottom")?k.insertBefore(D,k.firstChild):k.appendChild(D),this},d.prototype.removeControl=function(m){if(!m||!m.onRemove)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var E=this._controls.indexOf(m);return E>-1&&this._controls.splice(E,1),m.onRemove(this),this},d.prototype.hasControl=function(m){return this._controls.indexOf(m)>-1},d.prototype.resize=function(m){var E=this._containerDimensions(),D=E[0],k=E[1];this._resizeCanvas(D,k),this.transform.resize(D,k),this.painter.resize(D,k);var G=!this._moving;return G&&(this.stop(),this.fire(new g.Event("movestart",m)).fire(new g.Event("move",m))),this.fire(new g.Event("resize",m)),G&&this.fire(new g.Event("moveend",m)),this},d.prototype.getBounds=function(){return this.transform.getBounds()},d.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},d.prototype.setMaxBounds=function(m){return this.transform.setMaxBounds(g.LngLatBounds.convert(m)),this._update()},d.prototype.setMinZoom=function(m){if((m=null==m?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},d.prototype.getMinZoom=function(){return this.transform.minZoom},d.prototype.setMaxZoom=function(m){if((m=null==m?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")},d.prototype.getMaxZoom=function(){return this.transform.maxZoom},d.prototype.setMinPitch=function(m){if((m=null==m?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},d.prototype.getMinPitch=function(){return this.transform.minPitch},d.prototype.setMaxPitch=function(m){if((m=null==m?60:m)>60)throw new Error("maxPitch must be less than or equal to 60");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")},d.prototype.getMaxPitch=function(){return this.transform.maxPitch},d.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},d.prototype.setRenderWorldCopies=function(m){return this.transform.renderWorldCopies=m,this._update()},d.prototype.project=function(m){return this.transform.locationPoint(g.LngLat.convert(m))},d.prototype.unproject=function(m){return this.transform.pointLocation(g.Point.convert(m))},d.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},d.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},d.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},d.prototype._createDelegatedListener=function(m,E,D){var k,G=this;if("mouseenter"===m||"mouseover"===m){var le=!1;return{layer:E,listener:D,delegates:{mousemove:function(Ke){var Xe=G.getLayer(E)?G.queryRenderedFeatures(Ke.point,{layers:[E]}):[];Xe.length?le||(le=!0,D.call(G,new Gn(m,G,Ke.originalEvent,{features:Xe}))):le=!1},mouseout:function(){le=!1}}}}if("mouseleave"===m||"mouseout"===m){var Se=!1;return{layer:E,listener:D,delegates:{mousemove:function(Ke){(G.getLayer(E)?G.queryRenderedFeatures(Ke.point,{layers:[E]}):[]).length?Se=!0:Se&&(Se=!1,D.call(G,new Gn(m,G,Ke.originalEvent)))},mouseout:function(Ke){Se&&(Se=!1,D.call(G,new Gn(m,G,Ke.originalEvent)))}}}}return{layer:E,listener:D,delegates:(k={},k[m]=function(Ke){var Xe=G.getLayer(E)?G.queryRenderedFeatures(Ke.point,{layers:[E]}):[];Xe.length&&(Ke.features=Xe,D.call(G,Ke),delete Ke.features)},k)}},d.prototype.on=function(m,E,D){if(void 0===D)return l.prototype.on.call(this,m,E);var k=this._createDelegatedListener(m,E,D);for(var G in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(k),k.delegates)this.on(G,k.delegates[G]);return this},d.prototype.once=function(m,E,D){if(void 0===D)return l.prototype.once.call(this,m,E);var k=this._createDelegatedListener(m,E,D);for(var G in k.delegates)this.once(G,k.delegates[G]);return this},d.prototype.off=function(m,E,D){var k=this;return void 0===D?l.prototype.off.call(this,m,E):(this._delegatedListeners&&this._delegatedListeners[m]&&function(G){for(var le=G[m],Se=0;Se<le.length;Se++){var Ke=le[Se];if(Ke.layer===E&&Ke.listener===D){for(var Xe in Ke.delegates)k.off(Xe,Ke.delegates[Xe]);return le.splice(Se,1),k}}}(this._delegatedListeners),this)},d.prototype.queryRenderedFeatures=function(m,E){if(!this.style)return[];var D;if(void 0!==E||void 0===m||m instanceof g.Point||Array.isArray(m)||(E=m,m=void 0),E=E||{},(m=m||[[0,0],[this.transform.width,this.transform.height]])instanceof g.Point||"number"==typeof m[0])D=[g.Point.convert(m)];else{var k=g.Point.convert(m[0]),G=g.Point.convert(m[1]);D=[k,new g.Point(G.x,k.y),G,new g.Point(k.x,G.y),k]}return this.style.queryRenderedFeatures(D,E,this.transform)},d.prototype.querySourceFeatures=function(m,E){return this.style.querySourceFeatures(m,E)},d.prototype.setStyle=function(m,E){return!1!==(E=g.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},E)).diff&&E.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,E),this):(this._localIdeographFontFamily=E.localIdeographFontFamily,this._updateStyle(m,E))},d.prototype._getUIString=function(m){var E=this._locale[m];if(null==E)throw new Error("Missing UI string '"+m+"'");return E},d.prototype._updateStyle=function(m,E){return this.style&&(this.style.setEventedParent(null),this.style._remove()),m?(this.style=new po(this,E||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m):this.style.loadJSON(m),this):(delete this.style,this)},d.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new po(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},d.prototype._diffStyle=function(m,E){var D=this;if("string"==typeof m){var k=this._requestManager.normalizeStyleURL(m),G=this._requestManager.transformRequest(k,g.ResourceType.Style);g.getJSON(G,function(le,Se){le?D.fire(new g.ErrorEvent(le)):Se&&D._updateDiff(Se,E)})}else"object"==typeof m&&this._updateDiff(m,E)},d.prototype._updateDiff=function(m,E){try{this.style.setState(m)&&this._update(!0)}catch(D){g.warnOnce("Unable to perform style diff: "+(D.message||D.error||D)+".  Rebuilding the style from scratch."),this._updateStyle(m,E)}},d.prototype.getStyle=function(){if(this.style)return this.style.serialize()},d.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():g.warnOnce("There is no style added to the map.")},d.prototype.addSource=function(m,E){return this._lazyInitEmptyStyle(),this.style.addSource(m,E),this._update(!0)},d.prototype.isSourceLoaded=function(m){var E=this.style&&this.style.sourceCaches[m];if(void 0!==E)return E.loaded();this.fire(new g.ErrorEvent(new Error("There is no source with ID '"+m+"'")))},d.prototype.areTilesLoaded=function(){var m=this.style&&this.style.sourceCaches;for(var E in m){var D=m[E]._tiles;for(var k in D){var G=D[k];if("loaded"!==G.state&&"errored"!==G.state)return!1}}return!0},d.prototype.addSourceType=function(m,E,D){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,E,D)},d.prototype.removeSource=function(m){return this.style.removeSource(m),this._update(!0)},d.prototype.getSource=function(m){return this.style.getSource(m)},d.prototype.addImage=function(m,E,D){void 0===D&&(D={});var k=D.pixelRatio;void 0===k&&(k=1);var G=D.sdf;void 0===G&&(G=!1);var le=D.stretchX,Se=D.stretchY,Ke=D.content;if(this._lazyInitEmptyStyle(),E instanceof xa||Wr&&E instanceof Wr){var Xe=g.browser.getImageData(E);this.style.addImage(m,{data:new g.RGBAImage({width:Xe.width,height:Xe.height},Xe.data),pixelRatio:k,stretchX:le,stretchY:Se,content:Ke,sdf:G,version:0})}else{if(void 0===E.width||void 0===E.height)return this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var it=E;this.style.addImage(m,{data:new g.RGBAImage({width:E.width,height:E.height},new Uint8Array(E.data)),pixelRatio:k,stretchX:le,stretchY:Se,content:Ke,sdf:G,version:0,userImage:it}),it.onAdd&&it.onAdd(this,m)}},d.prototype.updateImage=function(m,E){var D=this.style.getImage(m);if(!D)return this.fire(new g.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var k=E instanceof xa||Wr&&E instanceof Wr?g.browser.getImageData(E):E,G=k.width,le=k.height,Se=k.data;return void 0===G||void 0===le?this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):G!==D.data.width||le!==D.data.height?this.fire(new g.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(D.data.replace(Se,!(E instanceof xa||Wr&&E instanceof Wr)),void this.style.updateImage(m,D))},d.prototype.hasImage=function(m){return m?!!this.style.getImage(m):(this.fire(new g.ErrorEvent(new Error("Missing required image id"))),!1)},d.prototype.removeImage=function(m){this.style.removeImage(m)},d.prototype.loadImage=function(m,E){g.getImage(this._requestManager.transformRequest(m,g.ResourceType.Image),E)},d.prototype.listImages=function(){return this.style.listImages()},d.prototype.addLayer=function(m,E){return this._lazyInitEmptyStyle(),this.style.addLayer(m,E),this._update(!0)},d.prototype.moveLayer=function(m,E){return this.style.moveLayer(m,E),this._update(!0)},d.prototype.removeLayer=function(m){return this.style.removeLayer(m),this._update(!0)},d.prototype.getLayer=function(m){return this.style.getLayer(m)},d.prototype.setLayerZoomRange=function(m,E,D){return this.style.setLayerZoomRange(m,E,D),this._update(!0)},d.prototype.setFilter=function(m,E,D){return void 0===D&&(D={}),this.style.setFilter(m,E,D),this._update(!0)},d.prototype.getFilter=function(m){return this.style.getFilter(m)},d.prototype.setPaintProperty=function(m,E,D,k){return void 0===k&&(k={}),this.style.setPaintProperty(m,E,D,k),this._update(!0)},d.prototype.getPaintProperty=function(m,E){return this.style.getPaintProperty(m,E)},d.prototype.setLayoutProperty=function(m,E,D,k){return void 0===k&&(k={}),this.style.setLayoutProperty(m,E,D,k),this._update(!0)},d.prototype.getLayoutProperty=function(m,E){return this.style.getLayoutProperty(m,E)},d.prototype.setLight=function(m,E){return void 0===E&&(E={}),this._lazyInitEmptyStyle(),this.style.setLight(m,E),this._update(!0)},d.prototype.getLight=function(){return this.style.getLight()},d.prototype.setFeatureState=function(m,E){return this.style.setFeatureState(m,E),this._update()},d.prototype.removeFeatureState=function(m,E){return this.style.removeFeatureState(m,E),this._update()},d.prototype.getFeatureState=function(m){return this.style.getFeatureState(m)},d.prototype.getContainer=function(){return this._container},d.prototype.getCanvasContainer=function(){return this._canvasContainer},d.prototype.getCanvas=function(){return this._canvas},d.prototype._containerDimensions=function(){var m=0,E=0;return this._container&&(m=this._container.clientWidth||400,E=this._container.clientHeight||300),[m,E]},d.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==g.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&g.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},d.prototype._setupContainer=function(){var m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=xe.create("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();var E=this._canvasContainer=xe.create("div","mapboxgl-canvas-container",m);this._interactive&&E.classList.add("mapboxgl-interactive"),this._canvas=xe.create("canvas","mapboxgl-canvas",E),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var D=this._containerDimensions();this._resizeCanvas(D[0],D[1]);var k=this._controlContainer=xe.create("div","mapboxgl-control-container",m),G=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(le){G[le]=xe.create("div","mapboxgl-ctrl-"+le,k)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},d.prototype._resizeCanvas=function(m,E){var D=g.browser.devicePixelRatio||1;this._canvas.width=D*m,this._canvas.height=D*E,this._canvas.style.width=m+"px",this._canvas.style.height=E+"px"},d.prototype._setupPainter=function(){var m=g.extend({},nt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),E=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);E?(this.painter=new Ai(E,this.transform),g.webpSupported.testSupport(E)):this.fire(new g.ErrorEvent(new Error("Failed to initialize WebGL")))},d.prototype._contextLost=function(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new g.Event("webglcontextlost",{originalEvent:m}))},d.prototype._contextRestored=function(m){this._setupPainter(),this.resize(),this._update(),this.fire(new g.Event("webglcontextrestored",{originalEvent:m}))},d.prototype._onMapScroll=function(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},d.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},d.prototype._update=function(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this},d.prototype._requestRenderFrame=function(m){return this._update(),this._renderTaskQueue.add(m)},d.prototype._cancelRenderFrame=function(m){this._renderTaskQueue.remove(m)},d.prototype._render=function(m){var E,D=this,k=0,G=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(E=G.createQueryEXT(),G.beginQueryEXT(G.TIME_ELAPSED_EXT,E),k=g.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),!this._removed){var le=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Se=this.transform.zoom,Ke=g.browser.now();this.style.zoomHistory.update(Se,Ke);var Xe=new g.EvaluationParameters(Se,{now:Ke,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),it=Xe.crossFadingFactor();1===it&&it===this._crossFadingFactor||(le=!0,this._crossFadingFactor=it),this.style.update(Xe)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new g.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new g.Event("load"))),this.style&&(this.style.hasTransitions()||le)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var xt=g.browser.now()-k;G.endQueryEXT(G.TIME_ELAPSED_EXT,E),setTimeout(function(){var gt=G.getQueryObjectEXT(E,G.QUERY_RESULT_EXT)/1e6;G.deleteQueryEXT(E),D.fire(new g.Event("gpu-timing-frame",{cpuTime:xt,gpuTime:gt}))},50)}if(this.listens("gpu-timing-layer")){var wt=this.painter.collectGpuTimers();setTimeout(function(){var gt=D.painter.queryGpuTimers(wt);D.fire(new g.Event("gpu-timing-layer",{layerTimes:gt}))},50)}var Pt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Pt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new g.Event("idle")),!this._loaded||this._fullyLoaded||Pt||(this._fullyLoaded=!0),this}},d.prototype.remove=function(){this._hash&&this._hash.remove();for(var m=0,E=this._controls;m<E.length;m+=1)E[m].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==g.window&&(g.window.removeEventListener("resize",this._onWindowResize,!1),g.window.removeEventListener("orientationchange",this._onWindowResize,!1),g.window.removeEventListener("online",this._onWindowOnline,!1));var D=this.painter.context.gl.getExtension("WEBGL_lose_context");D&&D.loseContext(),Jr(this._canvasContainer),Jr(this._controlContainer),Jr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new g.Event("remove"))},d.prototype.triggerRepaint=function(){var m=this;this.style&&!this._frame&&(this._frame=g.browser.frame(function(E){m._frame=null,m._render(E)}))},d.prototype._onWindowOnline=function(){this._update()},d.prototype._onWindowResize=function(m){this._trackResize&&this.resize({originalEvent:m})._update()},h.showTileBoundaries.get=function(){return!!this._showTileBoundaries},h.showTileBoundaries.set=function(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())},h.showPadding.get=function(){return!!this._showPadding},h.showPadding.set=function(m){this._showPadding!==m&&(this._showPadding=m,this._update())},h.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},h.showCollisionBoxes.set=function(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())},h.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},h.showOverdrawInspector.set=function(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())},h.repaint.get=function(){return!!this._repaint},h.repaint.set=function(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())},h.vertices.get=function(){return!!this._vertices},h.vertices.set=function(m){this._vertices=m,this._update()},d.prototype._setCacheLimits=function(m,E){g.setCacheLimits(m,E)},h.version.get=function(){return g.version},Object.defineProperties(d.prototype,h),d}(Pr);function Jr(l){l.parentNode&&l.parentNode.removeChild(l)}var du={showCompass:!0,showZoom:!0,visualizePitch:!1},Pu=function(l){var d=this;this.options=g.extend({},du,l),this._container=xe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(h){return h.preventDefault()}),this.options.showZoom&&(g.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(h){return d._map.zoomIn({},{originalEvent:h})}),xe.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(h){return d._map.zoomOut({},{originalEvent:h})}),xe.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(g.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(h){d.options.visualizePitch?d._map.resetNorthPitch({},{originalEvent:h}):d._map.resetNorth({},{originalEvent:h})}),this._compassIcon=xe.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Pu.prototype._updateZoomButtons=function(){var l=this._map.getZoom(),d=l===this._map.getMaxZoom(),h=l===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},Pu.prototype._rotateCompassArrow=function(){var l=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=l},Pu.prototype.onAdd=function(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ji(this._map,this._compass,this.options.visualizePitch)),this._container},Pu.prototype.onRemove=function(){xe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Pu.prototype._createButton=function(l,d){var h=xe.create("button",l,this._container);return h.type="button",h.addEventListener("click",d),h},Pu.prototype._setButtonTitle=function(l,d){var h=this._map._getUIString("NavigationControl."+d);l.title=h,l.setAttribute("aria-label",h)};var ji=function(l,d,h){void 0===h&&(h=!1),this._clickTolerance=10,this.element=d,this.mouseRotate=new cu({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,h&&(this.mousePitch=new Ol({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),g.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),xe.addEventListener(d,"mousedown",this.mousedown),xe.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),xe.addEventListener(d,"touchmove",this.touchmove),xe.addEventListener(d,"touchend",this.touchend),xe.addEventListener(d,"touchcancel",this.reset)};function ei(l,d,h){if(l=new g.LngLat(l.lng,l.lat),d){var m=new g.LngLat(l.lng-360,l.lat),E=new g.LngLat(l.lng+360,l.lat),D=h.locationPoint(l).distSqr(d);h.locationPoint(m).distSqr(d)<D?l=m:h.locationPoint(E).distSqr(d)<D&&(l=E)}for(;Math.abs(l.lng-h.center.lng)>180;){var k=h.locationPoint(l);if(k.x>=0&&k.y>=0&&k.x<=h.width&&k.y<=h.height)break;l.lng>h.center.lng?l.lng-=360:l.lng+=360}return l}ji.prototype.down=function(l,d){this.mouseRotate.mousedown(l,d),this.mousePitch&&this.mousePitch.mousedown(l,d),xe.disableDrag()},ji.prototype.move=function(l,d){var h=this.map,m=this.mouseRotate.mousemoveWindow(l,d);if(m&&m.bearingDelta&&h.setBearing(h.getBearing()+m.bearingDelta),this.mousePitch){var E=this.mousePitch.mousemoveWindow(l,d);E&&E.pitchDelta&&h.setPitch(h.getPitch()+E.pitchDelta)}},ji.prototype.off=function(){var l=this.element;xe.removeEventListener(l,"mousedown",this.mousedown),xe.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),xe.removeEventListener(l,"touchmove",this.touchmove),xe.removeEventListener(l,"touchend",this.touchend),xe.removeEventListener(l,"touchcancel",this.reset),this.offTemp()},ji.prototype.offTemp=function(){xe.enableDrag(),xe.removeEventListener(g.window,"mousemove",this.mousemove),xe.removeEventListener(g.window,"mouseup",this.mouseup)},ji.prototype.mousedown=function(l){this.down(g.extend({},l,{ctrlKey:!0,preventDefault:function(){return l.preventDefault()}}),xe.mousePos(this.element,l)),xe.addEventListener(g.window,"mousemove",this.mousemove),xe.addEventListener(g.window,"mouseup",this.mouseup)},ji.prototype.mousemove=function(l){this.move(l,xe.mousePos(this.element,l))},ji.prototype.mouseup=function(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()},ji.prototype.touchstart=function(l){1!==l.targetTouches.length?this.reset():(this._startPos=this._lastPos=xe.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return l.preventDefault()}},this._startPos))},ji.prototype.touchmove=function(l){1!==l.targetTouches.length?this.reset():(this._lastPos=xe.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:function(){return l.preventDefault()}},this._lastPos))},ji.prototype.touchend=function(l){0===l.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},ji.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ja={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function _o(l,d,h){var m=l.classList;for(var E in Ja)m.remove("mapboxgl-"+h+"-anchor-"+E);m.add("mapboxgl-"+h+"-anchor-"+d)}var Ll,wl=function(l){function d(h,m){if(l.call(this),(h instanceof g.window.HTMLElement||m)&&(h=g.extend({element:h},m)),g.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&"auto"!==h.pitchAlignment?h.pitchAlignment:this._rotationAlignment,h&&h.element)this._element=h.element,this._offset=g.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=xe.create("div"),this._element.setAttribute("aria-label","Map marker");var E=xe.createNS("http://www.w3.org/2000/svg","svg");E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height","41px"),E.setAttributeNS(null,"width","27px"),E.setAttributeNS(null,"viewBox","0 0 27 41");var D=xe.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"stroke","none"),D.setAttributeNS(null,"stroke-width","1"),D.setAttributeNS(null,"fill","none"),D.setAttributeNS(null,"fill-rule","evenodd");var k=xe.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill-rule","nonzero");var G=xe.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(3.0, 29.0)"),G.setAttributeNS(null,"fill","#000000");for(var le=0,Se=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];le<Se.length;le+=1){var Ke=Se[le],Xe=xe.createNS("http://www.w3.org/2000/svg","ellipse");Xe.setAttributeNS(null,"opacity","0.04"),Xe.setAttributeNS(null,"cx","10.5"),Xe.setAttributeNS(null,"cy","5.80029008"),Xe.setAttributeNS(null,"rx",Ke.rx),Xe.setAttributeNS(null,"ry",Ke.ry),G.appendChild(Xe)}var it=xe.createNS("http://www.w3.org/2000/svg","g");it.setAttributeNS(null,"fill",this._color);var xt=xe.createNS("http://www.w3.org/2000/svg","path");xt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),it.appendChild(xt);var wt=xe.createNS("http://www.w3.org/2000/svg","g");wt.setAttributeNS(null,"opacity","0.25"),wt.setAttributeNS(null,"fill","#000000");var Pt=xe.createNS("http://www.w3.org/2000/svg","path");Pt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),wt.appendChild(Pt);var gt=xe.createNS("http://www.w3.org/2000/svg","g");gt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),gt.setAttributeNS(null,"fill","#FFFFFF");var kt=xe.createNS("http://www.w3.org/2000/svg","g");kt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Bt=xe.createNS("http://www.w3.org/2000/svg","circle");Bt.setAttributeNS(null,"fill","#000000"),Bt.setAttributeNS(null,"opacity","0.25"),Bt.setAttributeNS(null,"cx","5.5"),Bt.setAttributeNS(null,"cy","5.5"),Bt.setAttributeNS(null,"r","5.4999962");var Jt=xe.createNS("http://www.w3.org/2000/svg","circle");Jt.setAttributeNS(null,"fill","#FFFFFF"),Jt.setAttributeNS(null,"cx","5.5"),Jt.setAttributeNS(null,"cy","5.5"),Jt.setAttributeNS(null,"r","5.4999962"),kt.appendChild(Bt),kt.appendChild(Jt),k.appendChild(G),k.appendChild(it),k.appendChild(wt),k.appendChild(gt),k.appendChild(kt),E.appendChild(k),E.setAttributeNS(null,"height",41*this._scale+"px"),E.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(E),this._offset=g.Point.convert(h&&h.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(tn){tn.preventDefault()}),this._element.addEventListener("mousedown",function(tn){tn.preventDefault()}),_o(this._element,this._anchor,"marker"),this._popup=null}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.addTo=function(h){return this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._update),h.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},d.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),xe.remove(this._element),this._popup&&this._popup.remove(),this},d.prototype.getLngLat=function(){return this._lngLat},d.prototype.setLngLat=function(h){return this._lngLat=g.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},d.prototype.getElement=function(){return this._element},d.prototype.setPopup=function(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){var m=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(24.6+m)],"bottom-right":[-m,-1*(24.6+m)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},d.prototype._onKeyPress=function(h){var m=h.code,E=h.charCode||h.keyCode;"Space"!==m&&"Enter"!==m&&32!==E&&13!==E||this.togglePopup()},d.prototype._onMapClick=function(h){var m=h.originalEvent.target,E=this._element;this._popup&&(m===E||E.contains(m))&&this.togglePopup()},d.prototype.getPopup=function(){return this._popup},d.prototype.togglePopup=function(){var h=this._popup;return h?(h.isOpen()?h.remove():h.addTo(this._map),this):this},d.prototype._update=function(h){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ei(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var m="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?m="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(m="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var E="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?E="rotateX(0deg)":"map"===this._pitchAlignment&&(E="rotateX("+this._map.getPitch()+"deg)"),h&&"moveend"!==h.type||(this._pos=this._pos.round()),xe.setTransform(this._element,Ja[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+E+" "+m)}},d.prototype.getOffset=function(){return this._offset},d.prototype.setOffset=function(h){return this._offset=g.Point.convert(h),this._update(),this},d.prototype._onMove=function(h){if(!this._isDragging){var m=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new g.Event("dragstart"))),this.fire(new g.Event("drag")))},d.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new g.Event("dragend")),this._state="inactive"},d.prototype._addDragHandler=function(h){this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},d.prototype.setDraggable=function(h){return this._draggable=!!h,this._map&&(h?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},d.prototype.isDraggable=function(){return this._draggable},d.prototype.setRotation=function(h){return this._rotation=h||0,this._update(),this},d.prototype.getRotation=function(){return this._rotation},d.prototype.setRotationAlignment=function(h){return this._rotationAlignment=h||"auto",this._update(),this},d.prototype.getRotationAlignment=function(){return this._rotationAlignment},d.prototype.setPitchAlignment=function(h){return this._pitchAlignment=h&&"auto"!==h?h:this._rotationAlignment,this._update(),this},d.prototype.getPitchAlignment=function(){return this._pitchAlignment},d}(g.Evented),uo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Nl=0,es=!1,pl=function(l){function d(h){l.call(this),this.options=g.extend({},uo,h),g.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.onAdd=function(h){var m;return this._map=h,this._container=xe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),m=this._setupUI,void 0!==Ll?m(Ll):void 0!==g.window.navigator.permissions?g.window.navigator.permissions.query({name:"geolocation"}).then(function(E){m(Ll="denied"!==E.state)}):m(Ll=!!g.window.navigator.geolocation),this._container},d.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(g.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),xe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Nl=0,es=!1},d.prototype._isOutOfMapMaxBounds=function(h){var m=this._map.getMaxBounds(),E=h.coords;return m&&(E.longitude<m.getWest()||E.longitude>m.getEast()||E.latitude<m.getSouth()||E.latitude>m.getNorth())},d.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},d.prototype._onSuccess=function(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new g.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(h),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new g.Event("geolocate",h)),this._finish()}},d.prototype._updateCamera=function(h){var m=new g.LngLat(h.coords.longitude,h.coords.latitude),E=h.coords.accuracy,D=this._map.getBearing(),k=g.extend({bearing:D},this.options.fitBoundsOptions);this._map.fitBounds(m.toBounds(E),k,{geolocateSource:!0})},d.prototype._updateMarker=function(h){if(h){var m=new g.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},d.prototype._updateCircleRadius=function(){var h=this._map._container.clientHeight/2,m=this._map.unproject([0,h]),E=this._map.unproject([1,h]),D=m.distanceTo(E),k=Math.ceil(2*this._accuracy/D);this._circleElement.style.width=k+"px",this._circleElement.style.height=k+"px"},d.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},d.prototype._onError=function(h){if(this._map){if(this.options.trackUserLocation)if(1===h.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===h.code&&es)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new g.Event("error",h)),this._finish()}},d.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},d.prototype._setupUI=function(h){var m=this;if(this._container.addEventListener("contextmenu",function(k){return k.preventDefault()}),this._geolocateButton=xe.create("button","mapboxgl-ctrl-geolocate",this._container),xe.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===h){g.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{var D=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=D,this._geolocateButton.setAttribute("aria-label",D)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=xe.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new wl(this._dotElement),this._circleElement=xe.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(k){k.geolocateSource||"ACTIVE_LOCK"!==m._watchState||k.originalEvent&&"resize"===k.originalEvent.type||(m._watchState="BACKGROUND",m._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),m._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),m.fire(new g.Event("trackuserlocationend")))})},d.prototype.trigger=function(){if(!this._setup)return g.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new g.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Nl--,es=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new g.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new g.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Nl>1?(h={maximumAge:6e5,timeout:0},es=!0):(h=this.options.positionOptions,es=!1),this._geolocationWatchID=g.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else g.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},d.prototype._clearWatch=function(){g.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},d}(g.Evented),xl={maxWidth:100,unit:"metric"},no=function(l){this.options=g.extend({},xl,l),g.bindAll(["_onMove","setUnit"],this)};function Lc(l,d,h){var m=h&&h.maxWidth||100,E=l._container.clientHeight/2,D=l.unproject([0,E]),k=l.unproject([m,E]),G=D.distanceTo(k);if(h&&"imperial"===h.unit){var le=3.2808*G;le>5280?Wi(d,m,le/5280,l._getUIString("ScaleControl.Miles")):Wi(d,m,le,l._getUIString("ScaleControl.Feet"))}else h&&"nautical"===h.unit?Wi(d,m,G/1852,l._getUIString("ScaleControl.NauticalMiles")):G>=1e3?Wi(d,m,G/1e3,l._getUIString("ScaleControl.Kilometers")):Wi(d,m,G,l._getUIString("ScaleControl.Meters"))}function Wi(l,d,h,m){var E,D,k,le,Se,G=(E=h,(D=Math.pow(10,(""+Math.floor(E)).length-1))*(k=(k=E/D)>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:(le=k,Se=Math.pow(10,Math.ceil(-Math.log(le)/Math.LN10)),Math.round(le*Se)/Se)));l.style.width=d*(G/h)+"px",l.innerHTML=G+"&nbsp;"+m}no.prototype.getDefaultPosition=function(){return"bottom-left"},no.prototype._onMove=function(){Lc(this._map,this._container,this.options)},no.prototype.onAdd=function(l){return this._map=l,this._container=xe.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},no.prototype.onRemove=function(){xe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},no.prototype.setUnit=function(l){this.options.unit=l,Lc(this._map,this._container,this.options)};var to=function(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof g.window.HTMLElement?this._container=l.container:g.warnOnce("Full screen control 'container' must be a DOM element.")),g.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in g.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in g.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in g.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in g.window.document&&(this._fullscreenchange="MSFullscreenChange")};to.prototype.onAdd=function(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=xe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",g.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},to.prototype.onRemove=function(){xe.remove(this._controlContainer),this._map=null,g.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},to.prototype._checkFullscreenSupport=function(){return!!(g.window.document.fullscreenEnabled||g.window.document.mozFullScreenEnabled||g.window.document.msFullscreenEnabled||g.window.document.webkitFullscreenEnabled)},to.prototype._setupUI=function(){var l=this._fullscreenButton=xe.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);xe.create("span","mapboxgl-ctrl-icon",l).setAttribute("aria-hidden",!0),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),g.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},to.prototype._updateTitle=function(){var l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.title=l},to.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},to.prototype._isFullscreen=function(){return this._fullscreen},to.prototype._changeIcon=function(){(g.window.document.fullscreenElement||g.window.document.mozFullScreenElement||g.window.document.webkitFullscreenElement||g.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},to.prototype._onClickFullscreen=function(){this._isFullscreen()?g.window.document.exitFullscreen?g.window.document.exitFullscreen():g.window.document.mozCancelFullScreen?g.window.document.mozCancelFullScreen():g.window.document.msExitFullscreen?g.window.document.msExitFullscreen():g.window.document.webkitCancelFullScreen&&g.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ua={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Wl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Fl=function(l){function d(h){l.call(this),this.options=g.extend(Object.create(Ua),h),g.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.addTo=function(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new g.Event("open")),this},d.prototype.isOpen=function(){return!!this._map},d.prototype.remove=function(){return this._content&&xe.remove(this._content),this._container&&(xe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new g.Event("close")),this},d.prototype.getLngLat=function(){return this._lngLat},d.prototype.setLngLat=function(h){return this._lngLat=g.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},d.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},d.prototype.getElement=function(){return this._container},d.prototype.setText=function(h){return this.setDOMContent(g.window.document.createTextNode(h))},d.prototype.setHTML=function(h){var m,E=g.window.document.createDocumentFragment(),D=g.window.document.createElement("body");for(D.innerHTML=h;m=D.firstChild;)E.appendChild(m);return this.setDOMContent(E)},d.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},d.prototype.setMaxWidth=function(h){return this.options.maxWidth=h,this._update(),this},d.prototype.setDOMContent=function(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=xe.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this},d.prototype.addClassName=function(h){this._container&&this._container.classList.add(h)},d.prototype.removeClassName=function(h){this._container&&this._container.classList.remove(h)},d.prototype.setOffset=function(h){return this.options.offset=h,this._update(),this},d.prototype.toggleClassName=function(h){if(this._container)return this._container.classList.toggle(h)},d.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=xe.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},d.prototype._onMouseUp=function(h){this._update(h.point)},d.prototype._onMouseMove=function(h){this._update(h.point)},d.prototype._onDrag=function(h){this._update(h.point)},d.prototype._update=function(h){var m=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=xe.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=xe.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Xe){return m._container.classList.add(Xe)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ei(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||h)){var E=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat),D=this.options.anchor,k=function Xe(it){if(it){if("number"==typeof it){var xt=Math.round(Math.sqrt(.5*Math.pow(it,2)));return{center:new g.Point(0,0),top:new g.Point(0,it),"top-left":new g.Point(xt,xt),"top-right":new g.Point(-xt,xt),bottom:new g.Point(0,-it),"bottom-left":new g.Point(xt,-xt),"bottom-right":new g.Point(-xt,-xt),left:new g.Point(it,0),right:new g.Point(-it,0)}}if(it instanceof g.Point||Array.isArray(it)){var wt=g.Point.convert(it);return{center:wt,top:wt,"top-left":wt,"top-right":wt,bottom:wt,"bottom-left":wt,"bottom-right":wt,left:wt,right:wt}}return{center:g.Point.convert(it.center||[0,0]),top:g.Point.convert(it.top||[0,0]),"top-left":g.Point.convert(it["top-left"]||[0,0]),"top-right":g.Point.convert(it["top-right"]||[0,0]),bottom:g.Point.convert(it.bottom||[0,0]),"bottom-left":g.Point.convert(it["bottom-left"]||[0,0]),"bottom-right":g.Point.convert(it["bottom-right"]||[0,0]),left:g.Point.convert(it.left||[0,0]),right:g.Point.convert(it.right||[0,0])}}return Xe(new g.Point(0,0))}(this.options.offset);if(!D){var G,le=this._container.offsetWidth,Se=this._container.offsetHeight;G=E.y+k.bottom.y<Se?["top"]:E.y>this._map.transform.height-Se?["bottom"]:[],E.x<le/2?G.push("left"):E.x>this._map.transform.width-le/2&&G.push("right"),D=0===G.length?"bottom":G.join("-")}var Ke=E.add(k[D]).round();xe.setTransform(this._container,Ja[D]+" translate("+Ke.x+"px,"+Ke.y+"px)"),_o(this._container,D,"popup")}},d.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var h=this._container.querySelector(Wl);h&&h.focus()}},d.prototype._onClose=function(){this.remove()},d}(g.Evented),ls={version:g.version,supported:nt,setRTLTextPlugin:g.setRTLTextPlugin,getRTLTextPluginStatus:g.getRTLTextPluginStatus,Map:Ks,NavigationControl:Pu,GeolocateControl:pl,AttributionControl:si,ScaleControl:no,FullscreenControl:to,Popup:Fl,Marker:wl,Style:po,LngLat:g.LngLat,LngLatBounds:g.LngLatBounds,Point:g.Point,MercatorCoordinate:g.MercatorCoordinate,Evented:g.Evented,config:g.config,prewarm:function(){an().acquire(Tt)},clearPrewarmedResources:function(){var l=Dn;l&&(l.isPreloaded()&&1===l.numActive()?(l.release(Tt),Dn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return g.config.ACCESS_TOKEN},set accessToken(l){g.config.ACCESS_TOKEN=l},get baseApiUrl(){return g.config.API_URL},set baseApiUrl(l){g.config.API_URL=l},get workerCount(){return en.workerCount},set workerCount(l){en.workerCount=l},get maxParallelImageRequests(){return g.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){g.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage:function(l){g.clearTileCache(l)},workerUrl:""};return ls}),w}()},8183:function(Sn){!function(Nt){"use strict";var H={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}|~{3,})([^`~\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6}) +([^\n]*?)(?: +#+)? *(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:bt,table:bt,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/};function w(j){this.tokens=[],this.tokens.links=Object.create(null),this.options=j||Ae.defaults,this.rules=H.normal,this.options.pedantic?this.rules=H.pedantic:this.options.gfm&&(this.rules=H.gfm)}H._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,H._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,H.def=se(H.def).replace("label",H._label).replace("title",H._title).getRegex(),H.bullet=/(?:[*+-]|\d{1,9}\.)/,H.item=/^( *)(bull) ?[^\n]*(?:\n(?!\1bull ?)[^\n]*)*/,H.item=se(H.item,"gm").replace(/bull/g,H.bullet).getRegex(),H.list=se(H.list).replace(/bull/g,H.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+H.def.source+")").getRegex(),H._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",H._comment=/<!--(?!-?>)[\s\S]*?-->/,H.html=se(H.html,"i").replace("comment",H._comment).replace("tag",H._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),H.paragraph=se(H._paragraph).replace("hr",H.hr).replace("heading"," {0,3}#{1,6} +").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}|~{3,})[^`\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",H._tag).getRegex(),H.blockquote=se(H.blockquote).replace("paragraph",H.paragraph).getRegex(),H.normal=Ct({},H),H.gfm=Ct({},H.normal,{nptable:/^ *([^|\n ].*\|.*)\n *([-:]+ *\|[-| :]*)(?:\n((?:.*[^>\n ].*(?:\n|$))*)\n*|$)/,table:/^ *\|(.+)\n *\|?( *[-:]+[-| :]*)(?:\n((?: *[^>\n ].*(?:\n|$))*)\n*|$)/}),H.pedantic=Ct({},H.normal,{html:se("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",H._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,fences:bt,paragraph:se(H.normal._paragraph).replace("hr",H.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",H.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),w.rules=H,w.lex=function(j,W){return new w(W).lex(j)},w.prototype.lex=function(j){return j=j.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(j,!0)},w.prototype.token=function(j,W){j=j.replace(/^ +$/gm,"");for(var ge,q,U,Y,ee,Pe,_e,We,rt,_t,ft,Zt,nn,qt,An,kn;j;)if((U=this.rules.newline.exec(j))&&(j=j.substring(U[0].length),U[0].length>1&&this.tokens.push({type:"space"})),U=this.rules.code.exec(j)){var jn=this.tokens[this.tokens.length-1];j=j.substring(U[0].length),jn&&"paragraph"===jn.type?jn.text+="\n"+U[0].trimRight():(U=U[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",codeBlockStyle:"indented",text:this.options.pedantic?U:ut(U,"\n")}))}else if(U=this.rules.fences.exec(j))j=j.substring(U[0].length),this.tokens.push({type:"code",lang:U[2]?U[2].trim():U[2],text:U[3]||""});else if(U=this.rules.heading.exec(j))j=j.substring(U[0].length),this.tokens.push({type:"heading",depth:U[1].length,text:U[2]});else if((U=this.rules.nptable.exec(j))&&(Pe={type:"table",header:ct(U[1].replace(/^ *| *\| *$/g,"")),align:U[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:U[3]?U[3].replace(/\n$/,"").split("\n"):[]}).header.length===Pe.align.length){for(j=j.substring(U[0].length),ft=0;ft<Pe.align.length;ft++)Pe.align[ft]=/^ *-+: *$/.test(Pe.align[ft])?"right":/^ *:-+: *$/.test(Pe.align[ft])?"center":/^ *:-+ *$/.test(Pe.align[ft])?"left":null;for(ft=0;ft<Pe.cells.length;ft++)Pe.cells[ft]=ct(Pe.cells[ft],Pe.header.length);this.tokens.push(Pe)}else if(U=this.rules.hr.exec(j))j=j.substring(U[0].length),this.tokens.push({type:"hr"});else if(U=this.rules.blockquote.exec(j))j=j.substring(U[0].length),this.tokens.push({type:"blockquote_start"}),U=U[0].replace(/^ *> ?/gm,""),this.token(U,W),this.tokens.push({type:"blockquote_end"});else if(U=this.rules.list.exec(j)){for(j=j.substring(U[0].length),this.tokens.push(_e={type:"list_start",ordered:qt=(Y=U[2]).length>1,start:qt?+Y:"",loose:!1}),We=[],ge=!1,nn=(U=U[0].match(this.rules.item)).length,ft=0;ft<nn;ft++)_t=(Pe=U[ft]).length,~(Pe=Pe.replace(/^ *([*+-]|\d+\.) */,"")).indexOf("\n ")&&(_t-=Pe.length,Pe=Pe.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+_t+"}","gm"),"")),ft!==nn-1&&(ee=H.bullet.exec(U[ft+1])[0],(Y.length>1?1===ee.length:ee.length>1||this.options.smartLists&&ee!==Y)&&(j=U.slice(ft+1).join("\n")+j,ft=nn-1)),q=ge||/\n\n(?!\s*$)/.test(Pe),ft!==nn-1&&(ge="\n"===Pe.charAt(Pe.length-1),q||(q=ge)),q&&(_e.loose=!0),kn=void 0,(An=/^\[[ xX]\] /.test(Pe))&&(kn=" "!==Pe[1],Pe=Pe.replace(/^\[[ xX]\] +/,"")),We.push(rt={type:"list_item_start",task:An,checked:kn,loose:q}),this.tokens.push(rt),this.token(Pe,!1),this.tokens.push({type:"list_item_end"});if(_e.loose)for(nn=We.length,ft=0;ft<nn;ft++)We[ft].loose=!0;this.tokens.push({type:"list_end"})}else if(U=this.rules.html.exec(j))j=j.substring(U[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===U[1]||"script"===U[1]||"style"===U[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(U[0]):Ue(U[0]):U[0]});else if(W&&(U=this.rules.def.exec(j)))j=j.substring(U[0].length),U[3]&&(U[3]=U[3].substring(1,U[3].length-1)),Zt=U[1].toLowerCase().replace(/\s+/g," "),this.tokens.links[Zt]||(this.tokens.links[Zt]={href:U[2],title:U[3]});else if((U=this.rules.table.exec(j))&&(Pe={type:"table",header:ct(U[1].replace(/^ *| *\| *$/g,"")),align:U[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:U[3]?U[3].replace(/\n$/,"").split("\n"):[]}).header.length===Pe.align.length){for(j=j.substring(U[0].length),ft=0;ft<Pe.align.length;ft++)Pe.align[ft]=/^ *-+: *$/.test(Pe.align[ft])?"right":/^ *:-+: *$/.test(Pe.align[ft])?"center":/^ *:-+ *$/.test(Pe.align[ft])?"left":null;for(ft=0;ft<Pe.cells.length;ft++)Pe.cells[ft]=ct(Pe.cells[ft].replace(/^ *\| *| *\| *$/g,""),Pe.header.length);this.tokens.push(Pe)}else if(U=this.rules.lheading.exec(j))j=j.substring(U[0].length),this.tokens.push({type:"heading",depth:"="===U[2].charAt(0)?1:2,text:U[1]});else if(W&&(U=this.rules.paragraph.exec(j)))j=j.substring(U[0].length),this.tokens.push({type:"paragraph",text:"\n"===U[1].charAt(U[1].length-1)?U[1].slice(0,-1):U[1]});else if(U=this.rules.text.exec(j))j=j.substring(U[0].length),this.tokens.push({type:"text",text:U[0]});else if(j)throw new Error("Infinite loop on byte: "+j.charCodeAt(0));return this.tokens};var ue={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:bt,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,strong:/^__([^\s_])__(?!_)|^\*\*([^\s*])\*\*(?!\*)|^__([^\s][\s\S]*?[^\s])__(?!_)|^\*\*([^\s][\s\S]*?[^\s])\*\*(?!\*)/,em:/^_([^\s_])_(?!_)|^\*([^\s*<\[])\*(?!\*)|^_([^\s<][\s\S]*?[^\s_])_(?!_|[^\spunctuation])|^_([^\s_<][\s\S]*?[^\s])_(?!_|[^\spunctuation])|^\*([^\s<"][\s\S]*?[^\s\*])\*(?!\*|[^\spunctuation])|^\*([^\s*"<\[][\s\S]*?[^\s])\*(?!\*)/,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:bt,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n))|(?= {2,}\n))/};function g(j,W){if(this.options=W||Ae.defaults,this.links=j,this.rules=ue.normal,this.renderer=this.options.renderer||new nt,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.pedantic?this.rules=ue.pedantic:this.options.gfm&&(this.rules=this.options.breaks?ue.breaks:ue.gfm)}function nt(j){this.options=j||Ae.defaults}function xe(){}function Le(j){this.tokens=[],this.token=null,this.options=j||Ae.defaults,this.options.renderer=this.options.renderer||new nt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.slugger=new Re}function Re(){this.seen={}}function Ue(j,W){if(W){if(Ue.escapeTest.test(j))return j.replace(Ue.escapeReplace,function(ge){return Ue.replacements[ge]})}else if(Ue.escapeTestNoEncode.test(j))return j.replace(Ue.escapeReplaceNoEncode,function(ge){return Ue.replacements[ge]});return j}function fe(j){return j.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(W,ge){return"colon"===(ge=ge.toLowerCase())?":":"#"===ge.charAt(0)?"x"===ge.charAt(1)?String.fromCharCode(parseInt(ge.substring(2),16)):String.fromCharCode(+ge.substring(1)):""})}function se(j,W){return j=j.source||j,W=W||"",{replace:function(ge,q){return q=(q=q.source||q).replace(/(^|[^\[])\^/g,"$1"),j=j.replace(ge,q),this},getRegex:function(){return new RegExp(j,W)}}}function ae(j,W,ge){if(j){try{var q=decodeURIComponent(fe(ge)).replace(/[^\w:]/g,"").toLowerCase()}catch(U){return null}if(0===q.indexOf("javascript:")||0===q.indexOf("vbscript:")||0===q.indexOf("data:"))return null}W&&!pt.test(ge)&&(ge=function $e(j,W){return St[" "+j]||(St[" "+j]=/^[^:]+:\/*[^/]*$/.test(j)?j+"/":ut(j,"/",!0)),j=St[" "+j],"//"===W.slice(0,2)?j.replace(/:[\s\S]*/,":")+W:"/"===W.charAt(0)?j.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+W:j+W}(W,ge));try{ge=encodeURI(ge).replace(/%25/g,"%")}catch(U){return null}return ge}ue._punctuation="!\"#$%&'()*+,\\-./:;<=>?@\\[^_{|}~",ue.em=se(ue.em).replace(/punctuation/g,ue._punctuation).getRegex(),ue._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,ue._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,ue._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,ue.autolink=se(ue.autolink).replace("scheme",ue._scheme).replace("email",ue._email).getRegex(),ue._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,ue.tag=se(ue.tag).replace("comment",H._comment).replace("attribute",ue._attribute).getRegex(),ue._label=/(?:\[[^\[\]]*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ue._href=/<(?:\\[<>]?|[^\s<>\\])*>|[^\s\x00-\x1f]*/,ue._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,ue.link=se(ue.link).replace("label",ue._label).replace("href",ue._href).replace("title",ue._title).getRegex(),ue.reflink=se(ue.reflink).replace("label",ue._label).getRegex(),ue.normal=Ct({},ue),ue.pedantic=Ct({},ue.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,link:se(/^!?\[(label)\]\((.*?)\)/).replace("label",ue._label).getRegex(),reflink:se(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ue._label).getRegex()}),ue.gfm=Ct({},ue.normal,{escape:se(ue.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?= {2,}\n|[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),ue.gfm.url=se(ue.gfm.url,"i").replace("email",ue.gfm._extended_email).getRegex(),ue.breaks=Ct({},ue.gfm,{br:se(ue.br).replace("{2,}","*").getRegex(),text:se(ue.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),g.rules=ue,g.output=function(j,W,ge){return new g(W,ge).output(j)},g.prototype.output=function(j){for(var ge,q,U,Y,ee,Pe,W="";j;)if(ee=this.rules.escape.exec(j))j=j.substring(ee[0].length),W+=Ue(ee[1]);else if(ee=this.rules.tag.exec(j))!this.inLink&&/^<a /i.test(ee[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(ee[0])&&(this.inLink=!1),!this.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(ee[0])?this.inRawBlock=!0:this.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ee[0])&&(this.inRawBlock=!1),j=j.substring(ee[0].length),W+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ee[0]):Ue(ee[0]):ee[0];else if(ee=this.rules.link.exec(j)){var _e=he(ee[2],"()");if(_e>-1){var We=4+ee[1].length+_e;ee[2]=ee[2].substring(0,_e),ee[0]=ee[0].substring(0,We).trim(),ee[3]=""}j=j.substring(ee[0].length),this.inLink=!0,U=ee[2],this.options.pedantic?(ge=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(U))?(U=ge[1],Y=ge[3]):Y="":Y=ee[3]?ee[3].slice(1,-1):"",U=U.trim().replace(/^<([\s\S]*)>$/,"$1"),W+=this.outputLink(ee,{href:g.escapes(U),title:g.escapes(Y)}),this.inLink=!1}else if((ee=this.rules.reflink.exec(j))||(ee=this.rules.nolink.exec(j))){if(j=j.substring(ee[0].length),ge=(ee[2]||ee[1]).replace(/\s+/g," "),!(ge=this.links[ge.toLowerCase()])||!ge.href){W+=ee[0].charAt(0),j=ee[0].substring(1)+j;continue}this.inLink=!0,W+=this.outputLink(ee,ge),this.inLink=!1}else if(ee=this.rules.strong.exec(j))j=j.substring(ee[0].length),W+=this.renderer.strong(this.output(ee[4]||ee[3]||ee[2]||ee[1]));else if(ee=this.rules.em.exec(j))j=j.substring(ee[0].length),W+=this.renderer.em(this.output(ee[6]||ee[5]||ee[4]||ee[3]||ee[2]||ee[1]));else if(ee=this.rules.code.exec(j))j=j.substring(ee[0].length),W+=this.renderer.codespan(Ue(ee[2].trim(),!0));else if(ee=this.rules.br.exec(j))j=j.substring(ee[0].length),W+=this.renderer.br();else if(ee=this.rules.del.exec(j))j=j.substring(ee[0].length),W+=this.renderer.del(this.output(ee[1]));else if(ee=this.rules.autolink.exec(j))j=j.substring(ee[0].length),U="@"===ee[2]?"mailto:"+(q=Ue(this.mangle(ee[1]))):q=Ue(ee[1]),W+=this.renderer.link(U,null,q);else if(this.inLink||!(ee=this.rules.url.exec(j))){if(ee=this.rules.text.exec(j))j=j.substring(ee[0].length),W+=this.renderer.text(this.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ee[0]):Ue(ee[0]):ee[0]:Ue(this.smartypants(ee[0])));else if(j)throw new Error("Infinite loop on byte: "+j.charCodeAt(0))}else{if("@"===ee[2])U="mailto:"+(q=Ue(ee[0]));else{do{Pe=ee[0],ee[0]=this.rules._backpedal.exec(ee[0])[0]}while(Pe!==ee[0]);q=Ue(ee[0]),U="www."===ee[1]?"http://"+q:q}j=j.substring(ee[0].length),W+=this.renderer.link(U,null,q)}return W},g.escapes=function(j){return j&&j.replace(g.rules._escapes,"$1")},g.prototype.outputLink=function(j,W){var ge=W.href,q=W.title?Ue(W.title):null;return"!"!==j[0].charAt(0)?this.renderer.link(ge,q,this.output(j[1])):this.renderer.image(ge,q,Ue(j[1]))},g.prototype.smartypants=function(j){return this.options.smartypants?j.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026"):j},g.prototype.mangle=function(j){if(!this.options.mangle)return j;for(var U,W="",ge=j.length,q=0;q<ge;q++)U=j.charCodeAt(q),Math.random()>.5&&(U="x"+U.toString(16)),W+="&#"+U+";";return W},nt.prototype.code=function(j,W,ge){var q=(W||"").match(/\S*/)[0];if(this.options.highlight){var U=this.options.highlight(j,q);null!=U&&U!==j&&(ge=!0,j=U)}return q?'<pre><code class="'+this.options.langPrefix+Ue(q,!0)+'">'+(ge?j:Ue(j,!0))+"</code></pre>\n":"<pre><code>"+(ge?j:Ue(j,!0))+"</code></pre>"},nt.prototype.blockquote=function(j){return"<blockquote>\n"+j+"</blockquote>\n"},nt.prototype.html=function(j){return j},nt.prototype.heading=function(j,W,ge,q){return this.options.headerIds?"<h"+W+' id="'+this.options.headerPrefix+q.slug(ge)+'">'+j+"</h"+W+">\n":"<h"+W+">"+j+"</h"+W+">\n"},nt.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},nt.prototype.list=function(j,W,ge){var q=W?"ol":"ul";return"<"+q+(W&&1!==ge?' start="'+ge+'"':"")+">\n"+j+"</"+q+">\n"},nt.prototype.listitem=function(j){return"<li>"+j+"</li>\n"},nt.prototype.checkbox=function(j){return"<input "+(j?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},nt.prototype.paragraph=function(j){return"<p>"+j+"</p>\n"},nt.prototype.table=function(j,W){return W&&(W="<tbody>"+W+"</tbody>"),"<table>\n<thead>\n"+j+"</thead>\n"+W+"</table>\n"},nt.prototype.tablerow=function(j){return"<tr>\n"+j+"</tr>\n"},nt.prototype.tablecell=function(j,W){var ge=W.header?"th":"td";return(W.align?"<"+ge+' align="'+W.align+'">':"<"+ge+">")+j+"</"+ge+">\n"},nt.prototype.strong=function(j){return"<strong>"+j+"</strong>"},nt.prototype.em=function(j){return"<em>"+j+"</em>"},nt.prototype.codespan=function(j){return"<code>"+j+"</code>"},nt.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},nt.prototype.del=function(j){return"<del>"+j+"</del>"},nt.prototype.link=function(j,W,ge){if(null===(j=ae(this.options.sanitize,this.options.baseUrl,j)))return ge;var q='<a href="'+Ue(j)+'"';return W&&(q+=' title="'+W+'"'),q+">"+ge+"</a>"},nt.prototype.image=function(j,W,ge){if(null===(j=ae(this.options.sanitize,this.options.baseUrl,j)))return ge;var q='<img src="'+j+'" alt="'+ge+'"';return W&&(q+=' title="'+W+'"'),q+(this.options.xhtml?"/>":">")},nt.prototype.text=function(j){return j},xe.prototype.strong=xe.prototype.em=xe.prototype.codespan=xe.prototype.del=xe.prototype.text=function(j){return j},xe.prototype.link=xe.prototype.image=function(j,W,ge){return""+ge},xe.prototype.br=function(){return""},Le.parse=function(j,W){return new Le(W).parse(j)},Le.prototype.parse=function(j){this.inline=new g(j.links,this.options),this.inlineText=new g(j.links,Ct({},this.options,{renderer:new xe})),this.tokens=j.reverse();for(var W="";this.next();)W+=this.tok();return W},Le.prototype.next=function(){return this.token=this.tokens.pop(),this.token},Le.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},Le.prototype.parseText=function(){for(var j=this.token.text;"text"===this.peek().type;)j+="\n"+this.next().text;return this.inline.output(j)},Le.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,fe(this.inlineText.output(this.token.text)),this.slugger);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var ge,q,U,Y,j="",W="";for(U="",ge=0;ge<this.token.header.length;ge++)U+=this.renderer.tablecell(this.inline.output(this.token.header[ge]),{header:!0,align:this.token.align[ge]});for(j+=this.renderer.tablerow(U),ge=0;ge<this.token.cells.length;ge++){for(q=this.token.cells[ge],U="",Y=0;Y<q.length;Y++)U+=this.renderer.tablecell(this.inline.output(q[Y]),{header:!1,align:this.token.align[Y]});W+=this.renderer.tablerow(U)}return this.renderer.table(j,W);case"blockquote_start":for(W="";"blockquote_end"!==this.next().type;)W+=this.tok();return this.renderer.blockquote(W);case"list_start":W="";for(var ee=this.token.ordered,Pe=this.token.start;"list_end"!==this.next().type;)W+=this.tok();return this.renderer.list(W,ee,Pe);case"list_item_start":W="";var _e=this.token.loose,We=this.token.checked,rt=this.token.task;for(this.token.task&&(W+=this.renderer.checkbox(We));"list_item_end"!==this.next().type;)W+=_e||"text"!==this.token.type?this.tok():this.parseText();return this.renderer.listitem(W,rt,We);case"html":return this.renderer.html(this.token.text);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText());default:var _t='Token with "'+this.token.type+'" type was not found.';if(!this.options.silent)throw new Error(_t);console.log(_t)}},Re.prototype.slug=function(j){var W=j.toLowerCase().trim().replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");if(this.seen.hasOwnProperty(W)){var ge=W;do{this.seen[ge]++,W=ge+"-"+this.seen[ge]}while(this.seen.hasOwnProperty(W))}return this.seen[W]=0,W},Ue.escapeTest=/[&<>"']/,Ue.escapeReplace=/[&<>"']/g,Ue.replacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ue.escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,Ue.escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g;var St={},pt=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function bt(){}function Ct(j){for(var ge,q,W=1;W<arguments.length;W++)for(q in ge=arguments[W])Object.prototype.hasOwnProperty.call(ge,q)&&(j[q]=ge[q]);return j}function ct(j,W){var q=j.replace(/\|/g,function(Y,ee,Pe){for(var _e=!1,We=ee;--We>=0&&"\\"===Pe[We];)_e=!_e;return _e?"|":" |"}).split(/ \|/),U=0;if(q.length>W)q.splice(W);else for(;q.length<W;)q.push("");for(;U<q.length;U++)q[U]=q[U].trim().replace(/\\\|/g,"|");return q}function ut(j,W,ge){if(0===j.length)return"";for(var q=0;q<j.length;){var U=j.charAt(j.length-q-1);if(U!==W||ge){if(U===W||!ge)break;q++}else q++}return j.substr(0,j.length-q)}function he(j,W){if(-1===j.indexOf(W[1]))return-1;for(var ge=0,q=0;q<j.length;q++)if("\\"===j[q])q++;else if(j[q]===W[0])ge++;else if(j[q]===W[1]&&--ge<0)return q;return-1}function je(j){j&&j.sanitize&&!j.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function Ae(j,W,ge){if(null==j)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof j)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(j)+", string expected");if(ge||"function"==typeof W){ge||(ge=W,W=null),je(W=Ct({},Ae.defaults,W||{}));var U,Y,q=W.highlight,ee=0;try{U=w.lex(j,W)}catch(_e){return ge(_e)}Y=U.length;var Pe=function(_e){if(_e)return W.highlight=q,ge(_e);var We;try{We=Le.parse(U,W)}catch(rt){_e=rt}return W.highlight=q,_e?ge(_e):ge(null,We)};if(!q||q.length<3||(delete W.highlight,!Y))return Pe();for(;ee<U.length;ee++)!function(_e){"code"!==_e.type?--Y||Pe():q(_e.text,_e.lang,function(We,rt){return We?Pe(We):null==rt||rt===_e.text?--Y||Pe():(_e.text=rt,_e.escaped=!0,void(--Y||Pe()))})}(U[ee])}else try{return W&&(W=Ct({},Ae.defaults,W)),je(W),Le.parse(w.lex(j,W),W)}catch(_e){if(_e.message+="\nPlease report this to https://github.com/markedjs/marked.",(W||Ae.defaults).silent)return"<p>An error occurred:</p><pre>"+Ue(_e.message+"",!0)+"</pre>";throw _e}}bt.exec=bt,Ae.options=Ae.setOptions=function(j){return Ct(Ae.defaults,j),Ae},Ae.getDefaults=function(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:new nt,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,xhtml:!1}},Ae.defaults=Ae.getDefaults(),Ae.Parser=Le,Ae.parser=Le.parse,Ae.Renderer=nt,Ae.TextRenderer=xe,Ae.Lexer=w,Ae.lexer=w.lex,Ae.InlineLexer=g,Ae.inlineLexer=g.output,Ae.Slugger=Re,Ae.parse=Ae,Sn.exports=Ae}(this||("undefined"!=typeof window?window:global))},5725:Sn=>{"use strict";const Nt=(H,w)=>{let ue,g=!1;"function"==typeof w?ue=w:(g=!0===(null==w?void 0:w.cycles),ue=null==w?void 0:w.cmp);const nt=new Set;return function xe(Le){if(Le&&Le.toJSON&&"function"==typeof Le.toJSON&&(Le=Le.toJSON()),void 0===Le)return;if(null===Le)return"null";if("number"==typeof Le)return isFinite(Le)?""+Le:"null";if("object"!=typeof Le)return JSON.stringify(Le);if(Array.isArray(Le))return`[${Le.map(fe=>{var se;return null!==(se=xe(fe))&&void 0!==se?se:"null"}).join(",")}]`;if(nt.has(Le)){if(g)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}nt.add(Le);const Re=ue?Object.entries(Le).sort((fe,se)=>ue({key:fe[0],value:fe[1]},{key:se[0],value:se[1]})).map(fe=>fe[0]):Object.keys(Le).sort(),Ue=[];for(const fe of Re){const se=xe(Le[fe]);!se||Ue.push(`"${fe}":${se}`)}return nt.delete(Le),`{${Ue.join(",")}}`}(H)};Nt.default=Nt,Sn.exports=Nt},8306:(Sn,Nt,H)=>{"use strict";H.d(Nt,{y:()=>se});var w=H(930),ue=H(727),g=H(8822),nt=H(4671);var Re=H(2416),Ue=H(576),fe=H(2806);let se=(()=>{class pt{constructor(Ct){Ct&&(this._subscribe=Ct)}lift(Ct){const ct=new pt;return ct.source=this,ct.operator=Ct,ct}subscribe(Ct,ct,ut){const he=function St(pt){return pt&&pt instanceof w.Lv||function $e(pt){return pt&&(0,Ue.m)(pt.next)&&(0,Ue.m)(pt.error)&&(0,Ue.m)(pt.complete)}(pt)&&(0,ue.Nn)(pt)}(Ct)?Ct:new w.Hp(Ct,ct,ut);return(0,fe.x)(()=>{const{operator:je,source:Ae}=this;he.add(je?je.call(he,Ae):Ae?this._subscribe(he):this._trySubscribe(he))}),he}_trySubscribe(Ct){try{return this._subscribe(Ct)}catch(ct){Ct.error(ct)}}forEach(Ct,ct){return new(ct=ae(ct))((ut,he)=>{const je=new w.Hp({next:Ae=>{try{Ct(Ae)}catch(j){he(j),je.unsubscribe()}},error:he,complete:ut});this.subscribe(je)})}_subscribe(Ct){var ct;return null===(ct=this.source)||void 0===ct?void 0:ct.subscribe(Ct)}[g.L](){return this}pipe(...Ct){return function Le(pt){return 0===pt.length?nt.y:1===pt.length?pt[0]:function(Ct){return pt.reduce((ct,ut)=>ut(ct),Ct)}}(Ct)(this)}toPromise(Ct){return new(Ct=ae(Ct))((ct,ut)=>{let he;this.subscribe(je=>he=je,je=>ut(je),()=>ct(he))})}}return pt.create=bt=>new pt(bt),pt})();function ae(pt){var bt;return null!==(bt=null!=pt?pt:Re.v.Promise)&&void 0!==bt?bt:Promise}},4707:(Sn,Nt,H)=>{"use strict";H.d(Nt,{t:()=>g});var w=H(7579),ue=H(6063);class g extends w.x{constructor(xe=1/0,Le=1/0,Re=ue.l){super(),this._bufferSize=xe,this._windowTime=Le,this._timestampProvider=Re,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=Le===1/0,this._bufferSize=Math.max(1,xe),this._windowTime=Math.max(1,Le)}next(xe){const{isStopped:Le,_buffer:Re,_infiniteTimeWindow:Ue,_timestampProvider:fe,_windowTime:se}=this;Le||(Re.push(xe),!Ue&&Re.push(fe.now()+se)),this._trimBuffer(),super.next(xe)}_subscribe(xe){this._throwIfClosed(),this._trimBuffer();const Le=this._innerSubscribe(xe),{_infiniteTimeWindow:Re,_buffer:Ue}=this,fe=Ue.slice();for(let se=0;se<fe.length&&!xe.closed;se+=Re?1:2)xe.next(fe[se]);return this._checkFinalizedStatuses(xe),Le}_trimBuffer(){const{_bufferSize:xe,_timestampProvider:Le,_buffer:Re,_infiniteTimeWindow:Ue}=this,fe=(Ue?1:2)*xe;if(xe<1/0&&fe<Re.length&&Re.splice(0,Re.length-fe),!Ue){const se=Le.now();let ae=0;for(let $e=1;$e<Re.length&&Re[$e]<=se;$e+=2)ae=$e;ae&&Re.splice(0,ae+1)}}}},7579:(Sn,Nt,H)=>{"use strict";H.d(Nt,{x:()=>Re});var w=H(8306),ue=H(727);const nt=(0,H(3888).d)(fe=>function(){fe(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var xe=H(8737),Le=H(2806);let Re=(()=>{class fe extends w.y{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ae){const $e=new Ue(this,this);return $e.operator=ae,$e}_throwIfClosed(){if(this.closed)throw new nt}next(ae){(0,Le.x)(()=>{if(this._throwIfClosed(),!this.isStopped){const $e=this.observers.slice();for(const St of $e)St.next(ae)}})}error(ae){(0,Le.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ae;const{observers:$e}=this;for(;$e.length;)$e.shift().error(ae)}})}complete(){(0,Le.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ae}=this;for(;ae.length;)ae.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var ae;return(null===(ae=this.observers)||void 0===ae?void 0:ae.length)>0}_trySubscribe(ae){return this._throwIfClosed(),super._trySubscribe(ae)}_subscribe(ae){return this._throwIfClosed(),this._checkFinalizedStatuses(ae),this._innerSubscribe(ae)}_innerSubscribe(ae){const{hasError:$e,isStopped:St,observers:pt}=this;return $e||St?ue.Lc:(pt.push(ae),new ue.w0(()=>(0,xe.P)(pt,ae)))}_checkFinalizedStatuses(ae){const{hasError:$e,thrownError:St,isStopped:pt}=this;$e?ae.error(St):pt&&ae.complete()}asObservable(){const ae=new w.y;return ae.source=this,ae}}return fe.create=(se,ae)=>new Ue(se,ae),fe})();class Ue extends Re{constructor(se,ae){super(),this.destination=se,this.source=ae}next(se){var ae,$e;null===($e=null===(ae=this.destination)||void 0===ae?void 0:ae.next)||void 0===$e||$e.call(ae,se)}error(se){var ae,$e;null===($e=null===(ae=this.destination)||void 0===ae?void 0:ae.error)||void 0===$e||$e.call(ae,se)}complete(){var se,ae;null===(ae=null===(se=this.destination)||void 0===se?void 0:se.complete)||void 0===ae||ae.call(se)}_subscribe(se){var ae,$e;return null!==($e=null===(ae=this.source)||void 0===ae?void 0:ae.subscribe(se))&&void 0!==$e?$e:ue.Lc}}},930:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Hp:()=>St,Lv:()=>$e});var w=H(576),ue=H(727),g=H(2416),nt=H(7849),xe=H(5032);const Le=fe("C",void 0,void 0);function fe(ut,he,je){return{kind:ut,value:he,error:je}}var se=H(3410),ae=H(2806);class $e extends ue.w0{constructor(he){super(),this.isStopped=!1,he?(this.destination=he,(0,ue.Nn)(he)&&he.add(this)):this.destination=ct}static create(he,je,Ae){return new St(he,je,Ae)}next(he){this.isStopped?Ct(function Ue(ut){return fe("N",ut,void 0)}(he),this):this._next(he)}error(he){this.isStopped?Ct(function Re(ut){return fe("E",void 0,ut)}(he),this):(this.isStopped=!0,this._error(he))}complete(){this.isStopped?Ct(Le,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(he){this.destination.next(he)}_error(he){try{this.destination.error(he)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class St extends $e{constructor(he,je,Ae){let j;if(super(),(0,w.m)(he))j=he;else if(he){let W;({next:j,error:je,complete:Ae}=he),this&&g.v.useDeprecatedNextContext?(W=Object.create(he),W.unsubscribe=()=>this.unsubscribe()):W=he,j=null==j?void 0:j.bind(W),je=null==je?void 0:je.bind(W),Ae=null==Ae?void 0:Ae.bind(W)}this.destination={next:j?pt(j):xe.Z,error:pt(null!=je?je:bt),complete:Ae?pt(Ae):xe.Z}}}function pt(ut,he){return(...je)=>{try{ut(...je)}catch(Ae){g.v.useDeprecatedSynchronousErrorHandling?(0,ae.O)(Ae):(0,nt.h)(Ae)}}}function bt(ut){throw ut}function Ct(ut,he){const{onStoppedNotification:je}=g.v;je&&se.z.setTimeout(()=>je(ut,he))}const ct={closed:!0,next:xe.Z,error:bt,complete:xe.Z}},727:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Lc:()=>Le,w0:()=>xe,Nn:()=>Re});var w=H(576);const g=(0,H(3888).d)(fe=>function(ae){fe(this),this.message=ae?`${ae.length} errors occurred during unsubscription:\n${ae.map(($e,St)=>`${St+1}) ${$e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ae});var nt=H(8737);class xe{constructor(se){this.initialTeardown=se,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let se;if(!this.closed){this.closed=!0;const{_parentage:ae}=this;if(ae)if(this._parentage=null,Array.isArray(ae))for(const pt of ae)pt.remove(this);else ae.remove(this);const{initialTeardown:$e}=this;if((0,w.m)($e))try{$e()}catch(pt){se=pt instanceof g?pt.errors:[pt]}const{_teardowns:St}=this;if(St){this._teardowns=null;for(const pt of St)try{Ue(pt)}catch(bt){se=null!=se?se:[],bt instanceof g?se=[...se,...bt.errors]:se.push(bt)}}if(se)throw new g(se)}}add(se){var ae;if(se&&se!==this)if(this.closed)Ue(se);else{if(se instanceof xe){if(se.closed||se._hasParent(this))return;se._addParent(this)}(this._teardowns=null!==(ae=this._teardowns)&&void 0!==ae?ae:[]).push(se)}}_hasParent(se){const{_parentage:ae}=this;return ae===se||Array.isArray(ae)&&ae.includes(se)}_addParent(se){const{_parentage:ae}=this;this._parentage=Array.isArray(ae)?(ae.push(se),ae):ae?[ae,se]:se}_removeParent(se){const{_parentage:ae}=this;ae===se?this._parentage=null:Array.isArray(ae)&&(0,nt.P)(ae,se)}remove(se){const{_teardowns:ae}=this;ae&&(0,nt.P)(ae,se),se instanceof xe&&se._removeParent(this)}}xe.EMPTY=(()=>{const fe=new xe;return fe.closed=!0,fe})();const Le=xe.EMPTY;function Re(fe){return fe instanceof xe||fe&&"closed"in fe&&(0,w.m)(fe.remove)&&(0,w.m)(fe.add)&&(0,w.m)(fe.unsubscribe)}function Ue(fe){(0,w.m)(fe)?fe():fe.unsubscribe()}},2416:(Sn,Nt,H)=>{"use strict";H.d(Nt,{v:()=>w});const w={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},7272:(Sn,Nt,H)=>{"use strict";H.d(Nt,{z:()=>xe});var w=H(8189),g=H(3269),nt=H(8996);function xe(...Le){return function ue(){return(0,w.J)(1)}()((0,nt.D)(Le,(0,g.yG)(Le)))}},9770:(Sn,Nt,H)=>{"use strict";H.d(Nt,{P:()=>g});var w=H(8306),ue=H(8421);function g(nt){return new w.y(xe=>{(0,ue.Xf)(nt()).subscribe(xe)})}},515:(Sn,Nt,H)=>{"use strict";H.d(Nt,{E:()=>ue});const ue=new(H(8306).y)(xe=>xe.complete())},4128:(Sn,Nt,H)=>{"use strict";H.d(Nt,{D:()=>Ue});var w=H(8306),ue=H(4742),g=H(8421),nt=H(3269),xe=H(5403),Le=H(3268),Re=H(1810);function Ue(...fe){const se=(0,nt.jO)(fe),{args:ae,keys:$e}=(0,ue.D)(fe),St=new w.y(pt=>{const{length:bt}=ae;if(!bt)return void pt.complete();const Ct=new Array(bt);let ct=bt,ut=bt;for(let he=0;he<bt;he++){let je=!1;(0,g.Xf)(ae[he]).subscribe(new xe.Q(pt,Ae=>{je||(je=!0,ut--),Ct[he]=Ae},()=>ct--,void 0,()=>{(!ct||!je)&&(ut||pt.next($e?(0,Re.n)($e,Ct):Ct),pt.complete())}))}});return se?St.pipe((0,Le.Z)(se)):St}},8996:(Sn,Nt,H)=>{"use strict";H.d(Nt,{D:()=>j});var w=H(8421),ue=H(5363),g=H(9468),Le=H(8306),Ue=H(2202),fe=H(576),se=H(9672);function $e(W,ge){if(!W)throw new Error("Iterable cannot be null");return new Le.y(q=>{(0,se.f)(q,ge,()=>{const U=W[Symbol.asyncIterator]();(0,se.f)(q,ge,()=>{U.next().then(Y=>{Y.done?q.complete():q.next(Y.value)})},0,!0)})})}var St=H(3670),pt=H(8239),bt=H(1144),Ct=H(6495),ct=H(2206),ut=H(4532),he=H(3260);function j(W,ge){return ge?function Ae(W,ge){if(null!=W){if((0,St.c)(W))return function nt(W,ge){return(0,w.Xf)(W).pipe((0,g.R)(ge),(0,ue.Q)(ge))}(W,ge);if((0,bt.z)(W))return function Re(W,ge){return new Le.y(q=>{let U=0;return ge.schedule(function(){U===W.length?q.complete():(q.next(W[U++]),q.closed||this.schedule())})})}(W,ge);if((0,pt.t)(W))return function xe(W,ge){return(0,w.Xf)(W).pipe((0,g.R)(ge),(0,ue.Q)(ge))}(W,ge);if((0,ct.D)(W))return $e(W,ge);if((0,Ct.T)(W))return function ae(W,ge){return new Le.y(q=>{let U;return(0,se.f)(q,ge,()=>{U=W[Ue.h](),(0,se.f)(q,ge,()=>{let Y,ee;try{({value:Y,done:ee}=U.next())}catch(Pe){return void q.error(Pe)}ee?q.complete():q.next(Y)},0,!0)}),()=>(0,fe.m)(null==U?void 0:U.return)&&U.return()})}(W,ge);if((0,he.L)(W))return function je(W,ge){return $e((0,he.Q)(W),ge)}(W,ge)}throw(0,ut.z)(W)}(W,ge):(0,w.Xf)(W)}},4968:(Sn,Nt,H)=>{"use strict";H.d(Nt,{R:()=>se});var w=H(8421),ue=H(8306),g=H(5577),nt=H(1144),xe=H(576),Le=H(3268);const Re=["addListener","removeListener"],Ue=["addEventListener","removeEventListener"],fe=["on","off"];function se(bt,Ct,ct,ut){if((0,xe.m)(ct)&&(ut=ct,ct=void 0),ut)return se(bt,Ct,ct).pipe((0,Le.Z)(ut));const[he,je]=function pt(bt){return(0,xe.m)(bt.addEventListener)&&(0,xe.m)(bt.removeEventListener)}(bt)?Ue.map(Ae=>j=>bt[Ae](Ct,j,ct)):function $e(bt){return(0,xe.m)(bt.addListener)&&(0,xe.m)(bt.removeListener)}(bt)?Re.map(ae(bt,Ct)):function St(bt){return(0,xe.m)(bt.on)&&(0,xe.m)(bt.off)}(bt)?fe.map(ae(bt,Ct)):[];if(!he&&(0,nt.z)(bt))return(0,g.z)(Ae=>se(Ae,Ct,ct))((0,w.Xf)(bt));if(!he)throw new TypeError("Invalid event target");return new ue.y(Ae=>{const j=(...W)=>Ae.next(1<W.length?W:W[0]);return he(j),()=>je(j)})}function ae(bt,Ct){return ct=>ut=>bt[ct](Ct,ut)}},8421:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Xf:()=>St});var w=H(655),ue=H(1144),g=H(8239),nt=H(8306),xe=H(3670),Le=H(2206),Re=H(4532),Ue=H(6495),fe=H(3260),se=H(576),ae=H(7849),$e=H(8822);function St(Ae){if(Ae instanceof nt.y)return Ae;if(null!=Ae){if((0,xe.c)(Ae))return function pt(Ae){return new nt.y(j=>{const W=Ae[$e.L]();if((0,se.m)(W.subscribe))return W.subscribe(j);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ae);if((0,ue.z)(Ae))return function bt(Ae){return new nt.y(j=>{for(let W=0;W<Ae.length&&!j.closed;W++)j.next(Ae[W]);j.complete()})}(Ae);if((0,g.t)(Ae))return function Ct(Ae){return new nt.y(j=>{Ae.then(W=>{j.closed||(j.next(W),j.complete())},W=>j.error(W)).then(null,ae.h)})}(Ae);if((0,Le.D)(Ae))return ut(Ae);if((0,Ue.T)(Ae))return function ct(Ae){return new nt.y(j=>{for(const W of Ae)if(j.next(W),j.closed)return;j.complete()})}(Ae);if((0,fe.L)(Ae))return function he(Ae){return ut((0,fe.Q)(Ae))}(Ae)}throw(0,Re.z)(Ae)}function ut(Ae){return new nt.y(j=>{(function je(Ae,j){var W,ge,q,U;return(0,w.mG)(this,void 0,void 0,function*(){try{for(W=(0,w.KL)(Ae);!(ge=yield W.next()).done;)if(j.next(ge.value),j.closed)return}catch(Y){q={error:Y}}finally{try{ge&&!ge.done&&(U=W.return)&&(yield U.call(W))}finally{if(q)throw q.error}}j.complete()})})(Ae,j).catch(W=>j.error(W))})}},6451:(Sn,Nt,H)=>{"use strict";H.d(Nt,{T:()=>Le});var w=H(8189),ue=H(8421),g=H(515),nt=H(3269),xe=H(8996);function Le(...Re){const Ue=(0,nt.yG)(Re),fe=(0,nt._6)(Re,1/0),se=Re;return se.length?1===se.length?(0,ue.Xf)(se[0]):(0,w.J)(fe)((0,xe.D)(se,Ue)):g.E}},9646:(Sn,Nt,H)=>{"use strict";H.d(Nt,{of:()=>g});var w=H(3269),ue=H(8996);function g(...nt){const xe=(0,w.yG)(nt);return(0,ue.D)(nt,xe)}},5963:(Sn,Nt,H)=>{"use strict";H.d(Nt,{H:()=>xe});var w=H(8306),ue=H(4986),g=H(3532);function xe(Le=0,Re,Ue=ue.P){let fe=-1;return null!=Re&&((0,g.K)(Re)?Ue=Re:fe=Re),new w.y(se=>{let ae=function nt(Le){return Le instanceof Date&&!isNaN(Le)}(Le)?+Le-Ue.now():Le;ae<0&&(ae=0);let $e=0;return Ue.schedule(function(){se.closed||(se.next($e++),0<=fe?this.schedule(void 0,fe):se.complete())},ae)})}},5403:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Q:()=>ue});var w=H(930);class ue extends w.Lv{constructor(nt,xe,Le,Re,Ue){super(nt),this.onFinalize=Ue,this._next=xe?function(fe){try{xe(fe)}catch(se){nt.error(se)}}:super._next,this._error=Re?function(fe){try{Re(fe)}catch(se){nt.error(se)}finally{this.unsubscribe()}}:super._error,this._complete=Le?function(){try{Le()}catch(fe){nt.error(fe)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var nt;const{closed:xe}=this;super.unsubscribe(),!xe&&(null===(nt=this.onFinalize)||void 0===nt||nt.call(this))}}},4351:(Sn,Nt,H)=>{"use strict";H.d(Nt,{b:()=>g});var w=H(5577),ue=H(576);function g(nt,xe){return(0,ue.m)(xe)?(0,w.z)(nt,xe,1):(0,w.z)(nt,1)}},8372:(Sn,Nt,H)=>{"use strict";H.d(Nt,{b:()=>nt});var w=H(4986),ue=H(4482),g=H(5403);function nt(xe,Le=w.z){return(0,ue.e)((Re,Ue)=>{let fe=null,se=null,ae=null;const $e=()=>{if(fe){fe.unsubscribe(),fe=null;const pt=se;se=null,Ue.next(pt)}};function St(){const pt=ae+xe,bt=Le.now();if(bt<pt)return fe=this.schedule(void 0,pt-bt),void Ue.add(fe);$e()}Re.subscribe(new g.Q(Ue,pt=>{se=pt,ae=Le.now(),fe||(fe=Le.schedule(St,xe),Ue.add(fe))},()=>{$e(),Ue.complete()},void 0,()=>{se=fe=null}))})}},6590:(Sn,Nt,H)=>{"use strict";H.d(Nt,{d:()=>g});var w=H(4482),ue=H(5403);function g(nt){return(0,w.e)((xe,Le)=>{let Re=!1;xe.subscribe(new ue.Q(Le,Ue=>{Re=!0,Le.next(Ue)},()=>{Re||Le.next(nt),Le.complete()}))})}},4825:(Sn,Nt,H)=>{"use strict";H.d(Nt,{g:()=>St});var w=H(4986),ue=H(7272),g=H(5698),nt=H(4482),xe=H(5403),Le=H(5032),Ue=H(4004),se=H(5577);function ae(pt,bt){return bt?Ct=>(0,ue.z)(bt.pipe((0,g.q)(1),function Re(){return(0,nt.e)((pt,bt)=>{pt.subscribe(new xe.Q(bt,Le.Z))})}()),Ct.pipe(ae(pt))):(0,se.z)((Ct,ct)=>pt(Ct,ct).pipe((0,g.q)(1),function fe(pt){return(0,Ue.U)(()=>pt)}(Ct)))}var $e=H(5963);function St(pt,bt=w.z){const Ct=(0,$e.H)(pt,bt);return ae(()=>Ct)}},1884:(Sn,Nt,H)=>{"use strict";H.d(Nt,{x:()=>nt});var w=H(4671),ue=H(4482),g=H(5403);function nt(Le,Re=w.y){return Le=null!=Le?Le:xe,(0,ue.e)((Ue,fe)=>{let se,ae=!0;Ue.subscribe(new g.Q(fe,$e=>{const St=Re($e);(ae||!Le(se,St))&&(ae=!1,se=St,fe.next($e))}))})}function xe(Le,Re){return Le===Re}},9300:(Sn,Nt,H)=>{"use strict";H.d(Nt,{h:()=>g});var w=H(4482),ue=H(5403);function g(nt,xe){return(0,w.e)((Le,Re)=>{let Ue=0;Le.subscribe(new ue.Q(Re,fe=>nt.call(xe,fe,Ue++)&&Re.next(fe)))})}},590:(Sn,Nt,H)=>{"use strict";H.d(Nt,{P:()=>Re});var w=H(6805),ue=H(9300),g=H(5698),nt=H(6590),xe=H(8068),Le=H(4671);function Re(Ue,fe){const se=arguments.length>=2;return ae=>ae.pipe(Ue?(0,ue.h)(($e,St)=>Ue($e,St,ae)):Le.y,(0,g.q)(1),se?(0,nt.d)(fe):(0,xe.T)(()=>new w.K))}},4004:(Sn,Nt,H)=>{"use strict";H.d(Nt,{U:()=>g});var w=H(4482),ue=H(5403);function g(nt,xe){return(0,w.e)((Le,Re)=>{let Ue=0;Le.subscribe(new ue.Q(Re,fe=>{Re.next(nt.call(xe,fe,Ue++))}))})}},8189:(Sn,Nt,H)=>{"use strict";H.d(Nt,{J:()=>g});var w=H(5577),ue=H(4671);function g(nt=1/0){return(0,w.z)(ue.y,nt)}},5577:(Sn,Nt,H)=>{"use strict";H.d(Nt,{z:()=>Ue});var w=H(4004),ue=H(8421),g=H(4482),nt=H(9672),xe=H(5403),Re=H(576);function Ue(fe,se,ae=1/0){return(0,Re.m)(se)?Ue(($e,St)=>(0,w.U)((pt,bt)=>se($e,pt,St,bt))((0,ue.Xf)(fe($e,St))),ae):("number"==typeof se&&(ae=se),(0,g.e)(($e,St)=>function Le(fe,se,ae,$e,St,pt,bt,Ct){const ct=[];let ut=0,he=0,je=!1;const Ae=()=>{je&&!ct.length&&!ut&&se.complete()},j=ge=>ut<$e?W(ge):ct.push(ge),W=ge=>{pt&&se.next(ge),ut++;let q=!1;(0,ue.Xf)(ae(ge,he++)).subscribe(new xe.Q(se,U=>{null==St||St(U),pt?j(U):se.next(U)},()=>{q=!0},void 0,()=>{if(q)try{for(ut--;ct.length&&ut<$e;){const U=ct.shift();bt?(0,nt.f)(se,bt,()=>W(U)):W(U)}Ae()}catch(U){se.error(U)}}))};return fe.subscribe(new xe.Q(se,j,()=>{je=!0,Ae()})),()=>{null==Ct||Ct()}}($e,St,fe,ae)))}},5363:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Q:()=>nt});var w=H(9672),ue=H(4482),g=H(5403);function nt(xe,Le=0){return(0,ue.e)((Re,Ue)=>{Re.subscribe(new g.Q(Ue,fe=>(0,w.f)(Ue,xe,()=>Ue.next(fe),Le),()=>(0,w.f)(Ue,xe,()=>Ue.complete(),Le),fe=>(0,w.f)(Ue,xe,()=>Ue.error(fe),Le)))})}},5026:(Sn,Nt,H)=>{"use strict";H.d(Nt,{R:()=>nt});var w=H(4482),ue=H(5403);function g(xe,Le,Re,Ue,fe){return(se,ae)=>{let $e=Re,St=Le,pt=0;se.subscribe(new ue.Q(ae,bt=>{const Ct=pt++;St=$e?xe(St,bt,Ct):($e=!0,bt),Ue&&ae.next(St)},fe&&(()=>{$e&&ae.next(St),ae.complete()})))}}function nt(xe,Le){return(0,w.e)(g(xe,Le,arguments.length>=2,!0))}},3099:(Sn,Nt,H)=>{"use strict";H.d(Nt,{B:()=>Le});var w=H(8996),ue=H(5698),g=H(7579),nt=H(930),xe=H(4482);function Le(Ue={}){const{connector:fe=(()=>new g.x),resetOnError:se=!0,resetOnComplete:ae=!0,resetOnRefCountZero:$e=!0}=Ue;return St=>{let pt=null,bt=null,Ct=null,ct=0,ut=!1,he=!1;const je=()=>{null==bt||bt.unsubscribe(),bt=null},Ae=()=>{je(),pt=Ct=null,ut=he=!1},j=()=>{const W=pt;Ae(),null==W||W.unsubscribe()};return(0,xe.e)((W,ge)=>{ct++,!he&&!ut&&je();const q=Ct=null!=Ct?Ct:fe();ge.add(()=>{ct--,0===ct&&!he&&!ut&&(bt=Re(j,$e))}),q.subscribe(ge),pt||(pt=new nt.Hp({next:U=>q.next(U),error:U=>{he=!0,je(),bt=Re(Ae,se,U),q.error(U)},complete:()=>{ut=!0,je(),bt=Re(Ae,ae),q.complete()}}),(0,w.D)(W).subscribe(pt))})(St)}}function Re(Ue,fe,...se){return!0===fe?(Ue(),null):!1===fe?null:fe(...se).pipe((0,ue.q)(1)).subscribe(()=>Ue())}},8675:(Sn,Nt,H)=>{"use strict";H.d(Nt,{O:()=>nt});var w=H(7272),ue=H(3269),g=H(4482);function nt(...xe){const Le=(0,ue.yG)(xe);return(0,g.e)((Re,Ue)=>{(Le?(0,w.z)(xe,Re,Le):(0,w.z)(xe,Re)).subscribe(Ue)})}},9468:(Sn,Nt,H)=>{"use strict";H.d(Nt,{R:()=>ue});var w=H(4482);function ue(g,nt=0){return(0,w.e)((xe,Le)=>{Le.add(g.schedule(()=>xe.subscribe(Le),nt))})}},3900:(Sn,Nt,H)=>{"use strict";H.d(Nt,{w:()=>nt});var w=H(8421),ue=H(4482),g=H(5403);function nt(xe,Le){return(0,ue.e)((Re,Ue)=>{let fe=null,se=0,ae=!1;const $e=()=>ae&&!fe&&Ue.complete();Re.subscribe(new g.Q(Ue,St=>{null==fe||fe.unsubscribe();let pt=0;const bt=se++;(0,w.Xf)(xe(St,bt)).subscribe(fe=new g.Q(Ue,Ct=>Ue.next(Le?Le(St,Ct,bt,pt++):Ct),()=>{fe=null,$e()}))},()=>{ae=!0,$e()}))})}},5698:(Sn,Nt,H)=>{"use strict";H.d(Nt,{q:()=>nt});var w=H(515),ue=H(4482),g=H(5403);function nt(xe){return xe<=0?()=>w.E:(0,ue.e)((Le,Re)=>{let Ue=0;Le.subscribe(new g.Q(Re,fe=>{++Ue<=xe&&(Re.next(fe),xe<=Ue&&Re.complete())}))})}},8505:(Sn,Nt,H)=>{"use strict";H.d(Nt,{b:()=>xe});var w=H(576),ue=H(4482),g=H(5403),nt=H(4671);function xe(Le,Re,Ue){const fe=(0,w.m)(Le)||Re||Ue?{next:Le,error:Re,complete:Ue}:Le;return fe?(0,ue.e)((se,ae)=>{var $e;null===($e=fe.subscribe)||void 0===$e||$e.call(fe);let St=!0;se.subscribe(new g.Q(ae,pt=>{var bt;null===(bt=fe.next)||void 0===bt||bt.call(fe,pt),ae.next(pt)},()=>{var pt;St=!1,null===(pt=fe.complete)||void 0===pt||pt.call(fe),ae.complete()},pt=>{var bt;St=!1,null===(bt=fe.error)||void 0===bt||bt.call(fe,pt),ae.error(pt)},()=>{var pt,bt;St&&(null===(pt=fe.unsubscribe)||void 0===pt||pt.call(fe)),null===(bt=fe.finalize)||void 0===bt||bt.call(fe)}))}):nt.y}},8068:(Sn,Nt,H)=>{"use strict";H.d(Nt,{T:()=>nt});var w=H(6805),ue=H(4482),g=H(5403);function nt(Le=xe){return(0,ue.e)((Re,Ue)=>{let fe=!1;Re.subscribe(new g.Q(Ue,se=>{fe=!0,Ue.next(se)},()=>fe?Ue.complete():Ue.error(Le())))})}function xe(){return new w.K}},4408:(Sn,Nt,H)=>{"use strict";H.d(Nt,{o:()=>xe});var w=H(727);class ue extends w.w0{constructor(Re,Ue){super()}schedule(Re,Ue=0){return this}}const g={setInterval(...Le){const{delegate:Re}=g;return((null==Re?void 0:Re.setInterval)||setInterval)(...Le)},clearInterval(Le){const{delegate:Re}=g;return((null==Re?void 0:Re.clearInterval)||clearInterval)(Le)},delegate:void 0};var nt=H(8737);class xe extends ue{constructor(Re,Ue){super(Re,Ue),this.scheduler=Re,this.work=Ue,this.pending=!1}schedule(Re,Ue=0){if(this.closed)return this;this.state=Re;const fe=this.id,se=this.scheduler;return null!=fe&&(this.id=this.recycleAsyncId(se,fe,Ue)),this.pending=!0,this.delay=Ue,this.id=this.id||this.requestAsyncId(se,this.id,Ue),this}requestAsyncId(Re,Ue,fe=0){return g.setInterval(Re.flush.bind(Re,this),fe)}recycleAsyncId(Re,Ue,fe=0){if(null!=fe&&this.delay===fe&&!1===this.pending)return Ue;g.clearInterval(Ue)}execute(Re,Ue){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const fe=this._execute(Re,Ue);if(fe)return fe;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Re,Ue){let se,fe=!1;try{this.work(Re)}catch(ae){fe=!0,se=ae||new Error("Scheduled action threw falsy error")}if(fe)return this.unsubscribe(),se}unsubscribe(){if(!this.closed){const{id:Re,scheduler:Ue}=this,{actions:fe}=Ue;this.work=this.state=this.scheduler=null,this.pending=!1,(0,nt.P)(fe,this),null!=Re&&(this.id=this.recycleAsyncId(Ue,Re,null)),this.delay=null,super.unsubscribe()}}}},7565:(Sn,Nt,H)=>{"use strict";H.d(Nt,{v:()=>g});var w=H(6063);class ue{constructor(xe,Le=ue.now){this.schedulerActionCtor=xe,this.now=Le}schedule(xe,Le=0,Re){return new this.schedulerActionCtor(this,xe).schedule(Re,Le)}}ue.now=w.l.now;class g extends ue{constructor(xe,Le=ue.now){super(xe,Le),this.actions=[],this._active=!1,this._scheduled=void 0}flush(xe){const{actions:Le}=this;if(this._active)return void Le.push(xe);let Re;this._active=!0;do{if(Re=xe.execute(xe.state,xe.delay))break}while(xe=Le.shift());if(this._active=!1,Re){for(;xe=Le.shift();)xe.unsubscribe();throw Re}}}},4986:(Sn,Nt,H)=>{"use strict";H.d(Nt,{z:()=>g,P:()=>nt});var w=H(4408);const g=new(H(7565).v)(w.o),nt=g},6063:(Sn,Nt,H)=>{"use strict";H.d(Nt,{l:()=>w});const w={now:()=>(w.delegate||Date).now(),delegate:void 0}},3410:(Sn,Nt,H)=>{"use strict";H.d(Nt,{z:()=>w});const w={setTimeout(...ue){const{delegate:g}=w;return((null==g?void 0:g.setTimeout)||setTimeout)(...ue)},clearTimeout(ue){const{delegate:g}=w;return((null==g?void 0:g.clearTimeout)||clearTimeout)(ue)},delegate:void 0}},2202:(Sn,Nt,H)=>{"use strict";H.d(Nt,{h:()=>ue});const ue=function w(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Sn,Nt,H)=>{"use strict";H.d(Nt,{L:()=>w});const w="function"==typeof Symbol&&Symbol.observable||"@@observable"},6805:(Sn,Nt,H)=>{"use strict";H.d(Nt,{K:()=>ue});const ue=(0,H(3888).d)(g=>function(){g(this),this.name="EmptyError",this.message="no elements in sequence"})},3269:(Sn,Nt,H)=>{"use strict";H.d(Nt,{jO:()=>nt,yG:()=>xe,_6:()=>Le});var w=H(576),ue=H(3532);function g(Re){return Re[Re.length-1]}function nt(Re){return(0,w.m)(g(Re))?Re.pop():void 0}function xe(Re){return(0,ue.K)(g(Re))?Re.pop():void 0}function Le(Re,Ue){return"number"==typeof g(Re)?Re.pop():Ue}},4742:(Sn,Nt,H)=>{"use strict";H.d(Nt,{D:()=>xe});const{isArray:w}=Array,{getPrototypeOf:ue,prototype:g,keys:nt}=Object;function xe(Re){if(1===Re.length){const Ue=Re[0];if(w(Ue))return{args:Ue,keys:null};if(function Le(Re){return Re&&"object"==typeof Re&&ue(Re)===g}(Ue)){const fe=nt(Ue);return{args:fe.map(se=>Ue[se]),keys:fe}}}return{args:Re,keys:null}}},8737:(Sn,Nt,H)=>{"use strict";function w(ue,g){if(ue){const nt=ue.indexOf(g);0<=nt&&ue.splice(nt,1)}}H.d(Nt,{P:()=>w})},3888:(Sn,Nt,H)=>{"use strict";function w(ue){const nt=ue(xe=>{Error.call(xe),xe.stack=(new Error).stack});return nt.prototype=Object.create(Error.prototype),nt.prototype.constructor=nt,nt}H.d(Nt,{d:()=>w})},1810:(Sn,Nt,H)=>{"use strict";function w(ue,g){return ue.reduce((nt,xe,Le)=>(nt[xe]=g[Le],nt),{})}H.d(Nt,{n:()=>w})},2806:(Sn,Nt,H)=>{"use strict";H.d(Nt,{x:()=>g,O:()=>nt});var w=H(2416);let ue=null;function g(xe){if(w.v.useDeprecatedSynchronousErrorHandling){const Le=!ue;if(Le&&(ue={errorThrown:!1,error:null}),xe(),Le){const{errorThrown:Re,error:Ue}=ue;if(ue=null,Re)throw Ue}}else xe()}function nt(xe){w.v.useDeprecatedSynchronousErrorHandling&&ue&&(ue.errorThrown=!0,ue.error=xe)}},9672:(Sn,Nt,H)=>{"use strict";function w(ue,g,nt,xe=0,Le=!1){const Re=g.schedule(function(){nt(),Le?ue.add(this.schedule(null,xe)):this.unsubscribe()},xe);if(ue.add(Re),!Le)return Re}H.d(Nt,{f:()=>w})},4671:(Sn,Nt,H)=>{"use strict";function w(ue){return ue}H.d(Nt,{y:()=>w})},1144:(Sn,Nt,H)=>{"use strict";H.d(Nt,{z:()=>w});const w=ue=>ue&&"number"==typeof ue.length&&"function"!=typeof ue},2206:(Sn,Nt,H)=>{"use strict";H.d(Nt,{D:()=>ue});var w=H(576);function ue(g){return Symbol.asyncIterator&&(0,w.m)(null==g?void 0:g[Symbol.asyncIterator])}},576:(Sn,Nt,H)=>{"use strict";function w(ue){return"function"==typeof ue}H.d(Nt,{m:()=>w})},3670:(Sn,Nt,H)=>{"use strict";H.d(Nt,{c:()=>g});var w=H(8822),ue=H(576);function g(nt){return(0,ue.m)(nt[w.L])}},6495:(Sn,Nt,H)=>{"use strict";H.d(Nt,{T:()=>g});var w=H(2202),ue=H(576);function g(nt){return(0,ue.m)(null==nt?void 0:nt[w.h])}},8239:(Sn,Nt,H)=>{"use strict";H.d(Nt,{t:()=>ue});var w=H(576);function ue(g){return(0,w.m)(null==g?void 0:g.then)}},3260:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Q:()=>g,L:()=>nt});var w=H(655),ue=H(576);function g(xe){return(0,w.FC)(this,arguments,function*(){const Re=xe.getReader();try{for(;;){const{value:Ue,done:fe}=yield(0,w.qq)(Re.read());if(fe)return yield(0,w.qq)(void 0);yield yield(0,w.qq)(Ue)}}finally{Re.releaseLock()}})}function nt(xe){return(0,ue.m)(null==xe?void 0:xe.getReader)}},3532:(Sn,Nt,H)=>{"use strict";H.d(Nt,{K:()=>ue});var w=H(576);function ue(g){return g&&(0,w.m)(g.schedule)}},4482:(Sn,Nt,H)=>{"use strict";H.d(Nt,{A:()=>ue,e:()=>g});var w=H(576);function ue(nt){return(0,w.m)(null==nt?void 0:nt.lift)}function g(nt){return xe=>{if(ue(xe))return xe.lift(function(Le){try{return nt(Le,this)}catch(Re){this.error(Re)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Z:()=>nt});var w=H(4004);const{isArray:ue}=Array;function nt(xe){return(0,w.U)(Le=>function g(xe,Le){return ue(Le)?xe(...Le):xe(Le)}(xe,Le))}},5032:(Sn,Nt,H)=>{"use strict";function w(){}H.d(Nt,{Z:()=>w})},7849:(Sn,Nt,H)=>{"use strict";H.d(Nt,{h:()=>g});var w=H(2416),ue=H(3410);function g(nt){ue.z.setTimeout(()=>{const{onUnhandledError:xe}=w.v;if(!xe)throw nt;xe(nt)})}},4532:(Sn,Nt,H)=>{"use strict";function w(ue){return new TypeError(`You provided ${null!==ue&&"object"==typeof ue?"an invalid object":`'${ue}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}H.d(Nt,{z:()=>w})},8907:(Sn,Nt,H)=>{"use strict";H.d(Nt,{pi:()=>g,fl:()=>pt});var g=function(){return g=Object.assign||function(U){for(var Y,ee=1,Pe=arguments.length;ee<Pe;ee++)for(var _e in Y=arguments[ee])Object.prototype.hasOwnProperty.call(Y,_e)&&(U[_e]=Y[_e]);return U},g.apply(this,arguments)};function St(q,U){var Y="function"==typeof Symbol&&q[Symbol.iterator];if(!Y)return q;var Pe,We,ee=Y.call(q),_e=[];try{for(;(void 0===U||U-- >0)&&!(Pe=ee.next()).done;)_e.push(Pe.value)}catch(rt){We={error:rt}}finally{try{Pe&&!Pe.done&&(Y=ee.return)&&Y.call(ee)}finally{if(We)throw We.error}}return _e}function pt(){for(var q=[],U=0;U<arguments.length;U++)q=q.concat(St(arguments[U]));return q}},1132:(Sn,Nt,H)=>{"use strict";H.d(Nt,{ZT:()=>ue,pi:()=>g,_T:()=>nt,XA:()=>$e,fl:()=>pt});var w=function(q,U){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,ee){Y.__proto__=ee}||function(Y,ee){for(var Pe in ee)ee.hasOwnProperty(Pe)&&(Y[Pe]=ee[Pe])})(q,U)};function ue(q,U){function Y(){this.constructor=q}w(q,U),q.prototype=null===U?Object.create(U):(Y.prototype=U.prototype,new Y)}var g=function(){return g=Object.assign||function(U){for(var Y,ee=1,Pe=arguments.length;ee<Pe;ee++)for(var _e in Y=arguments[ee])Object.prototype.hasOwnProperty.call(Y,_e)&&(U[_e]=Y[_e]);return U},g.apply(this,arguments)};function nt(q,U){var Y={};for(var ee in q)Object.prototype.hasOwnProperty.call(q,ee)&&U.indexOf(ee)<0&&(Y[ee]=q[ee]);if(null!=q&&"function"==typeof Object.getOwnPropertySymbols){var Pe=0;for(ee=Object.getOwnPropertySymbols(q);Pe<ee.length;Pe++)U.indexOf(ee[Pe])<0&&Object.prototype.propertyIsEnumerable.call(q,ee[Pe])&&(Y[ee[Pe]]=q[ee[Pe]])}return Y}function $e(q){var U="function"==typeof Symbol&&Symbol.iterator,Y=U&&q[U],ee=0;if(Y)return Y.call(q);if(q&&"number"==typeof q.length)return{next:function(){return q&&ee>=q.length&&(q=void 0),{value:q&&q[ee++],done:!q}}};throw new TypeError(U?"Object is not iterable.":"Symbol.iterator is not defined.")}function St(q,U){var Y="function"==typeof Symbol&&q[Symbol.iterator];if(!Y)return q;var Pe,We,ee=Y.call(q),_e=[];try{for(;(void 0===U||U-- >0)&&!(Pe=ee.next()).done;)_e.push(Pe.value)}catch(rt){We={error:rt}}finally{try{Pe&&!Pe.done&&(Y=ee.return)&&Y.call(ee)}finally{if(We)throw We.error}}return _e}function pt(){for(var q=[],U=0;U<arguments.length;U++)q=q.concat(St(arguments[U]));return q}},832:(Sn,Nt,H)=>{"use strict";H.d(Nt,{ZT:()=>ue,pi:()=>g,XA:()=>$e,CR:()=>St});var w=function(q,U){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,ee){Y.__proto__=ee}||function(Y,ee){for(var Pe in ee)ee.hasOwnProperty(Pe)&&(Y[Pe]=ee[Pe])})(q,U)};function ue(q,U){function Y(){this.constructor=q}w(q,U),q.prototype=null===U?Object.create(U):(Y.prototype=U.prototype,new Y)}var g=function(){return g=Object.assign||function(U){for(var Y,ee=1,Pe=arguments.length;ee<Pe;ee++)for(var _e in Y=arguments[ee])Object.prototype.hasOwnProperty.call(Y,_e)&&(U[_e]=Y[_e]);return U},g.apply(this,arguments)};function $e(q){var U="function"==typeof Symbol&&Symbol.iterator,Y=U&&q[U],ee=0;if(Y)return Y.call(q);if(q&&"number"==typeof q.length)return{next:function(){return q&&ee>=q.length&&(q=void 0),{value:q&&q[ee++],done:!q}}};throw new TypeError(U?"Object is not iterable.":"Symbol.iterator is not defined.")}function St(q,U){var Y="function"==typeof Symbol&&q[Symbol.iterator];if(!Y)return q;var Pe,We,ee=Y.call(q),_e=[];try{for(;(void 0===U||U-- >0)&&!(Pe=ee.next()).done;)_e.push(Pe.value)}catch(rt){We={error:rt}}finally{try{Pe&&!Pe.done&&(Y=ee.return)&&Y.call(ee)}finally{if(We)throw We.error}}return _e}},655:(Sn,Nt,H)=>{"use strict";function nt(Y,ee){var Pe={};for(var _e in Y)Object.prototype.hasOwnProperty.call(Y,_e)&&ee.indexOf(_e)<0&&(Pe[_e]=Y[_e]);if(null!=Y&&"function"==typeof Object.getOwnPropertySymbols){var We=0;for(_e=Object.getOwnPropertySymbols(Y);We<_e.length;We++)ee.indexOf(_e[We])<0&&Object.prototype.propertyIsEnumerable.call(Y,_e[We])&&(Pe[_e[We]]=Y[_e[We]])}return Pe}function Ue(Y,ee,Pe,_e){return new(Pe||(Pe=Promise))(function(rt,_t){function ft(qt){try{nn(_e.next(qt))}catch(An){_t(An)}}function Zt(qt){try{nn(_e.throw(qt))}catch(An){_t(An)}}function nn(qt){qt.done?rt(qt.value):function We(rt){return rt instanceof Pe?rt:new Pe(function(_t){_t(rt)})}(qt.value).then(ft,Zt)}nn((_e=_e.apply(Y,ee||[])).next())})}function ct(Y){return this instanceof ct?(this.v=Y,this):new ct(Y)}function ut(Y,ee,Pe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var We,_e=Pe.apply(Y,ee||[]),rt=[];return We={},_t("next"),_t("throw"),_t("return"),We[Symbol.asyncIterator]=function(){return this},We;function _t(kn){_e[kn]&&(We[kn]=function(jn){return new Promise(function(gr,lr){rt.push([kn,jn,gr,lr])>1||ft(kn,jn)})})}function ft(kn,jn){try{!function Zt(kn){kn.value instanceof ct?Promise.resolve(kn.value.v).then(nn,qt):An(rt[0][2],kn)}(_e[kn](jn))}catch(gr){An(rt[0][3],gr)}}function nn(kn){ft("next",kn)}function qt(kn){ft("throw",kn)}function An(kn,jn){kn(jn),rt.shift(),rt.length&&ft(rt[0][0],rt[0][1])}}function je(Y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Pe,ee=Y[Symbol.asyncIterator];return ee?ee.call(Y):(Y=function $e(Y){var ee="function"==typeof Symbol&&Symbol.iterator,Pe=ee&&Y[ee],_e=0;if(Pe)return Pe.call(Y);if(Y&&"number"==typeof Y.length)return{next:function(){return Y&&_e>=Y.length&&(Y=void 0),{value:Y&&Y[_e++],done:!Y}}};throw new TypeError(ee?"Object is not iterable.":"Symbol.iterator is not defined.")}(Y),Pe={},_e("next"),_e("throw"),_e("return"),Pe[Symbol.asyncIterator]=function(){return this},Pe);function _e(rt){Pe[rt]=Y[rt]&&function(_t){return new Promise(function(ft,Zt){!function We(rt,_t,ft,Zt){Promise.resolve(Zt).then(function(nn){rt({value:nn,done:ft})},_t)}(ft,Zt,(_t=Y[rt](_t)).done,_t.value)})}}}H.d(Nt,{_T:()=>nt,mG:()=>Ue,qq:()=>ct,FC:()=>ut,KL:()=>je})},9808:(Sn,Nt,H)=>{"use strict";H.d(Nt,{mr:()=>he,ez:()=>uu,K0:()=>Re,Do:()=>Ae,V_:()=>se,Ye:()=>j,S$:()=>ct,sg:()=>Pi,O5:()=>zi,b0:()=>je,lw:()=>Ue,EM:()=>qa,JF:()=>qr,PM:()=>ss,w_:()=>Le,bD:()=>Ga,q:()=>g,Mx:()=>hs,HT:()=>xe});var w=H(5e3);let ue=null;function g(){return ue}function xe(oe){ue||(ue=oe)}class Le{}const Re=new w.OlP("DocumentToken");let Ue=(()=>{class oe{historyGo(ne){throw new Error("Not implemented")}}return oe.\u0275fac=function(ne){return new(ne||oe)},oe.\u0275prov=w.Yz7({token:oe,factory:function(){return function fe(){return(0,w.LFG)(ae)}()},providedIn:"platform"}),oe})();const se=new w.OlP("Location Initialized");let ae=(()=>{class oe extends Ue{constructor(ne){super(),this._doc=ne,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return g().getBaseHref(this._doc)}onPopState(ne){const et=g().getGlobalEventTarget(this._doc,"window");return et.addEventListener("popstate",ne,!1),()=>et.removeEventListener("popstate",ne)}onHashChange(ne){const et=g().getGlobalEventTarget(this._doc,"window");return et.addEventListener("hashchange",ne,!1),()=>et.removeEventListener("hashchange",ne)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(ne){this.location.pathname=ne}pushState(ne,et,Ot){$e()?this._history.pushState(ne,et,Ot):this.location.hash=Ot}replaceState(ne,et,Ot){$e()?this._history.replaceState(ne,et,Ot):this.location.hash=Ot}forward(){this._history.forward()}back(){this._history.back()}historyGo(ne=0){this._history.go(ne)}getState(){return this._history.state}}return oe.\u0275fac=function(ne){return new(ne||oe)(w.LFG(Re))},oe.\u0275prov=w.Yz7({token:oe,factory:function(){return function St(){return new ae((0,w.LFG)(Re))}()},providedIn:"platform"}),oe})();function $e(){return!!window.history.pushState}function pt(oe,qe){if(0==oe.length)return qe;if(0==qe.length)return oe;let ne=0;return oe.endsWith("/")&&ne++,qe.startsWith("/")&&ne++,2==ne?oe+qe.substring(1):1==ne?oe+qe:oe+"/"+qe}function bt(oe){const qe=oe.match(/#|\?|$/),ne=qe&&qe.index||oe.length;return oe.slice(0,ne-("/"===oe[ne-1]?1:0))+oe.slice(ne)}function Ct(oe){return oe&&"?"!==oe[0]?"?"+oe:oe}let ct=(()=>{class oe{historyGo(ne){throw new Error("Not implemented")}}return oe.\u0275fac=function(ne){return new(ne||oe)},oe.\u0275prov=w.Yz7({token:oe,factory:function(){return function ut(oe){const qe=(0,w.LFG)(Re).location;return new je((0,w.LFG)(Ue),qe&&qe.origin||"")}()},providedIn:"root"}),oe})();const he=new w.OlP("appBaseHref");let je=(()=>{class oe extends ct{constructor(ne,et){if(super(),this._platformLocation=ne,this._removeListenerFns=[],null==et&&(et=this._platformLocation.getBaseHrefFromDOM()),null==et)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=et}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(ne){this._removeListenerFns.push(this._platformLocation.onPopState(ne),this._platformLocation.onHashChange(ne))}getBaseHref(){return this._baseHref}prepareExternalUrl(ne){return pt(this._baseHref,ne)}path(ne=!1){const et=this._platformLocation.pathname+Ct(this._platformLocation.search),Ot=this._platformLocation.hash;return Ot&&ne?`${et}${Ot}`:et}pushState(ne,et,Ot,vn){const On=this.prepareExternalUrl(Ot+Ct(vn));this._platformLocation.pushState(ne,et,On)}replaceState(ne,et,Ot,vn){const On=this.prepareExternalUrl(Ot+Ct(vn));this._platformLocation.replaceState(ne,et,On)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(ne=0){var et,Ot;null===(Ot=(et=this._platformLocation).historyGo)||void 0===Ot||Ot.call(et,ne)}}return oe.\u0275fac=function(ne){return new(ne||oe)(w.LFG(Ue),w.LFG(he,8))},oe.\u0275prov=w.Yz7({token:oe,factory:oe.\u0275fac}),oe})(),Ae=(()=>{class oe extends ct{constructor(ne,et){super(),this._platformLocation=ne,this._baseHref="",this._removeListenerFns=[],null!=et&&(this._baseHref=et)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(ne){this._removeListenerFns.push(this._platformLocation.onPopState(ne),this._platformLocation.onHashChange(ne))}getBaseHref(){return this._baseHref}path(ne=!1){let et=this._platformLocation.hash;return null==et&&(et="#"),et.length>0?et.substring(1):et}prepareExternalUrl(ne){const et=pt(this._baseHref,ne);return et.length>0?"#"+et:et}pushState(ne,et,Ot,vn){let On=this.prepareExternalUrl(Ot+Ct(vn));0==On.length&&(On=this._platformLocation.pathname),this._platformLocation.pushState(ne,et,On)}replaceState(ne,et,Ot,vn){let On=this.prepareExternalUrl(Ot+Ct(vn));0==On.length&&(On=this._platformLocation.pathname),this._platformLocation.replaceState(ne,et,On)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(ne=0){var et,Ot;null===(Ot=(et=this._platformLocation).historyGo)||void 0===Ot||Ot.call(et,ne)}}return oe.\u0275fac=function(ne){return new(ne||oe)(w.LFG(Ue),w.LFG(he,8))},oe.\u0275prov=w.Yz7({token:oe,factory:oe.\u0275fac}),oe})(),j=(()=>{class oe{constructor(ne,et){this._subject=new w.vpe,this._urlChangeListeners=[],this._platformStrategy=ne;const Ot=this._platformStrategy.getBaseHref();this._platformLocation=et,this._baseHref=bt(q(Ot)),this._platformStrategy.onPopState(vn=>{this._subject.emit({url:this.path(!0),pop:!0,state:vn.state,type:vn.type})})}path(ne=!1){return this.normalize(this._platformStrategy.path(ne))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(ne,et=""){return this.path()==this.normalize(ne+Ct(et))}normalize(ne){return oe.stripTrailingSlash(function ge(oe,qe){return oe&&qe.startsWith(oe)?qe.substring(oe.length):qe}(this._baseHref,q(ne)))}prepareExternalUrl(ne){return ne&&"/"!==ne[0]&&(ne="/"+ne),this._platformStrategy.prepareExternalUrl(ne)}go(ne,et="",Ot=null){this._platformStrategy.pushState(Ot,"",ne,et),this._notifyUrlChangeListeners(this.prepareExternalUrl(ne+Ct(et)),Ot)}replaceState(ne,et="",Ot=null){this._platformStrategy.replaceState(Ot,"",ne,et),this._notifyUrlChangeListeners(this.prepareExternalUrl(ne+Ct(et)),Ot)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(ne=0){var et,Ot;null===(Ot=(et=this._platformStrategy).historyGo)||void 0===Ot||Ot.call(et,ne)}onUrlChange(ne){this._urlChangeListeners.push(ne),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(et=>{this._notifyUrlChangeListeners(et.url,et.state)}))}_notifyUrlChangeListeners(ne="",et){this._urlChangeListeners.forEach(Ot=>Ot(ne,et))}subscribe(ne,et,Ot){return this._subject.subscribe({next:ne,error:et,complete:Ot})}}return oe.normalizeQueryParams=Ct,oe.joinWithSlash=pt,oe.stripTrailingSlash=bt,oe.\u0275fac=function(ne){return new(ne||oe)(w.LFG(ct),w.LFG(Ue))},oe.\u0275prov=w.Yz7({token:oe,factory:function(){return function W(){return new j((0,w.LFG)(ct),(0,w.LFG)(Ue))}()},providedIn:"root"}),oe})();function q(oe){return oe.replace(/\/index.html$/,"")}var ee=(()=>((ee=ee||{})[ee.Zero=0]="Zero",ee[ee.One=1]="One",ee[ee.Two=2]="Two",ee[ee.Few=3]="Few",ee[ee.Many=4]="Many",ee[ee.Other=5]="Other",ee))();const bi=w.kL8;class Mr{}let Fr=(()=>{class oe extends Mr{constructor(ne){super(),this.locale=ne}getPluralCategory(ne,et){switch(bi(et||this.locale)(ne)){case ee.Zero:return"zero";case ee.One:return"one";case ee.Two:return"two";case ee.Few:return"few";case ee.Many:return"many";default:return"other"}}}return oe.\u0275fac=function(ne){return new(ne||oe)(w.LFG(w.soG))},oe.\u0275prov=w.Yz7({token:oe,factory:oe.\u0275fac}),oe})();function hs(oe,qe){qe=encodeURIComponent(qe);for(const ne of oe.split(";")){const et=ne.indexOf("="),[Ot,vn]=-1==et?[ne,""]:[ne.slice(0,et),ne.slice(et+1)];if(Ot.trim()===qe)return decodeURIComponent(vn)}return null}class Bo{constructor(qe,ne,et,Ot){this.$implicit=qe,this.ngForOf=ne,this.index=et,this.count=Ot}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Pi=(()=>{class oe{constructor(ne,et,Ot){this._viewContainer=ne,this._template=et,this._differs=Ot,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(ne){this._ngForOf=ne,this._ngForOfDirty=!0}set ngForTrackBy(ne){this._trackByFn=ne}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(ne){ne&&(this._template=ne)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const ne=this._ngForOf;!this._differ&&ne&&(this._differ=this._differs.find(ne).create(this.ngForTrackBy))}if(this._differ){const ne=this._differ.diff(this._ngForOf);ne&&this._applyChanges(ne)}}_applyChanges(ne){const et=this._viewContainer;ne.forEachOperation((Ot,vn,On)=>{if(null==Ot.previousIndex)et.createEmbeddedView(this._template,new Bo(Ot.item,this._ngForOf,-1,-1),null===On?void 0:On);else if(null==On)et.remove(null===vn?void 0:vn);else if(null!==vn){const er=et.get(vn);et.move(er,On),Si(er,Ot)}});for(let Ot=0,vn=et.length;Ot<vn;Ot++){const er=et.get(Ot).context;er.index=Ot,er.count=vn,er.ngForOf=this._ngForOf}ne.forEachIdentityChange(Ot=>{Si(et.get(Ot.currentIndex),Ot)})}static ngTemplateContextGuard(ne,et){return!0}}return oe.\u0275fac=function(ne){return new(ne||oe)(w.Y36(w.s_b),w.Y36(w.Rgc),w.Y36(w.ZZ4))},oe.\u0275dir=w.lG2({type:oe,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),oe})();function Si(oe,qe){oe.context.$implicit=qe.item}let zi=(()=>{class oe{constructor(ne,et){this._viewContainer=ne,this._context=new Br,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=et}set ngIf(ne){this._context.$implicit=this._context.ngIf=ne,this._updateView()}set ngIfThen(ne){ds("ngIfThen",ne),this._thenTemplateRef=ne,this._thenViewRef=null,this._updateView()}set ngIfElse(ne){ds("ngIfElse",ne),this._elseTemplateRef=ne,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(ne,et){return!0}}return oe.\u0275fac=function(ne){return new(ne||oe)(w.Y36(w.s_b),w.Y36(w.Rgc))},oe.\u0275dir=w.lG2({type:oe,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),oe})();class Br{constructor(){this.$implicit=null,this.ngIf=null}}function ds(oe,qe){if(qe&&!qe.createEmbeddedView)throw new Error(`${oe} must be a TemplateRef, but received '${(0,w.AaK)(qe)}'.`)}let uu=(()=>{class oe{}return oe.\u0275fac=function(ne){return new(ne||oe)},oe.\u0275mod=w.oAB({type:oe}),oe.\u0275inj=w.cJS({providers:[{provide:Mr,useClass:Fr}]}),oe})();const Ga="browser";function ss(oe){return"server"===oe}let qa=(()=>{class oe{}return oe.\u0275prov=(0,w.Yz7)({token:oe,providedIn:"root",factory:()=>new eo((0,w.LFG)(Re),window)}),oe})();class eo{constructor(qe,ne){this.document=qe,this.window=ne,this.offset=()=>[0,0]}setOffset(qe){this.offset=Array.isArray(qe)?()=>qe:qe}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(qe){this.supportsScrolling()&&this.window.scrollTo(qe[0],qe[1])}scrollToAnchor(qe){if(!this.supportsScrolling())return;const ne=function ps(oe,qe){const ne=oe.getElementById(qe)||oe.getElementsByName(qe)[0];if(ne)return ne;if("function"==typeof oe.createTreeWalker&&oe.body&&(oe.body.createShadowRoot||oe.body.attachShadow)){const et=oe.createTreeWalker(oe.body,NodeFilter.SHOW_ELEMENT);let Ot=et.currentNode;for(;Ot;){const vn=Ot.shadowRoot;if(vn){const On=vn.getElementById(qe)||vn.querySelector(`[name="${qe}"]`);if(On)return On}Ot=et.nextNode()}}return null}(this.document,qe);ne&&(this.scrollToElement(ne),ne.focus())}setHistoryScrollRestoration(qe){if(this.supportScrollRestoration()){const ne=this.window.history;ne&&ne.scrollRestoration&&(ne.scrollRestoration=qe)}}scrollToElement(qe){const ne=qe.getBoundingClientRect(),et=ne.left+this.window.pageXOffset,Ot=ne.top+this.window.pageYOffset,vn=this.offset();this.window.scrollTo(et-vn[0],Ot-vn[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const qe=Cu(this.window.history)||Cu(Object.getPrototypeOf(this.window.history));return!(!qe||!qe.writable&&!qe.set)}catch(qe){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(qe){return!1}}}function Cu(oe){return Object.getOwnPropertyDescriptor(oe,"scrollRestoration")}class qr{}},520:(Sn,Nt,H)=>{"use strict";H.d(Nt,{eN:()=>rt,JF:()=>En});var w=H(9808),ue=H(5e3),g=H(9646),nt=H(8306),xe=H(4351),Le=H(9300),Re=H(4004);class Ue{}class fe{}class se{constructor(ve){this.normalizedNames=new Map,this.lazyUpdate=null,ve?this.lazyInit="string"==typeof ve?()=>{this.headers=new Map,ve.split("\n").forEach(me=>{const re=me.indexOf(":");if(re>0){const ht=me.slice(0,re),zt=ht.toLowerCase(),sn=me.slice(re+1).trim();this.maybeSetNormalizedName(ht,zt),this.headers.has(zt)?this.headers.get(zt).push(sn):this.headers.set(zt,[sn])}})}:()=>{this.headers=new Map,Object.keys(ve).forEach(me=>{let re=ve[me];const ht=me.toLowerCase();"string"==typeof re&&(re=[re]),re.length>0&&(this.headers.set(ht,re),this.maybeSetNormalizedName(me,ht))})}:this.headers=new Map}has(ve){return this.init(),this.headers.has(ve.toLowerCase())}get(ve){this.init();const me=this.headers.get(ve.toLowerCase());return me&&me.length>0?me[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(ve){return this.init(),this.headers.get(ve.toLowerCase())||null}append(ve,me){return this.clone({name:ve,value:me,op:"a"})}set(ve,me){return this.clone({name:ve,value:me,op:"s"})}delete(ve,me){return this.clone({name:ve,value:me,op:"d"})}maybeSetNormalizedName(ve,me){this.normalizedNames.has(me)||this.normalizedNames.set(me,ve)}init(){this.lazyInit&&(this.lazyInit instanceof se?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(ve=>this.applyUpdate(ve)),this.lazyUpdate=null))}copyFrom(ve){ve.init(),Array.from(ve.headers.keys()).forEach(me=>{this.headers.set(me,ve.headers.get(me)),this.normalizedNames.set(me,ve.normalizedNames.get(me))})}clone(ve){const me=new se;return me.lazyInit=this.lazyInit&&this.lazyInit instanceof se?this.lazyInit:this,me.lazyUpdate=(this.lazyUpdate||[]).concat([ve]),me}applyUpdate(ve){const me=ve.name.toLowerCase();switch(ve.op){case"a":case"s":let re=ve.value;if("string"==typeof re&&(re=[re]),0===re.length)return;this.maybeSetNormalizedName(ve.name,me);const ht=("a"===ve.op?this.headers.get(me):void 0)||[];ht.push(...re),this.headers.set(me,ht);break;case"d":const zt=ve.value;if(zt){let sn=this.headers.get(me);if(!sn)return;sn=sn.filter(Mn=>-1===zt.indexOf(Mn)),0===sn.length?(this.headers.delete(me),this.normalizedNames.delete(me)):this.headers.set(me,sn)}else this.headers.delete(me),this.normalizedNames.delete(me)}}forEach(ve){this.init(),Array.from(this.normalizedNames.keys()).forEach(me=>ve(this.normalizedNames.get(me),this.headers.get(me)))}}class ae{encodeKey(ve){return bt(ve)}encodeValue(ve){return bt(ve)}decodeKey(ve){return decodeURIComponent(ve)}decodeValue(ve){return decodeURIComponent(ve)}}const St=/%(\d[a-f0-9])/gi,pt={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function bt(jt){return encodeURIComponent(jt).replace(St,(ve,me)=>{var re;return null!==(re=pt[me])&&void 0!==re?re:ve})}function Ct(jt){return`${jt}`}class ct{constructor(ve={}){if(this.updates=null,this.cloneFrom=null,this.encoder=ve.encoder||new ae,ve.fromString){if(ve.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function $e(jt,ve){const me=new Map;return jt.length>0&&jt.replace(/^\?/,"").split("&").forEach(ht=>{const zt=ht.indexOf("="),[sn,Mn]=-1==zt?[ve.decodeKey(ht),""]:[ve.decodeKey(ht.slice(0,zt)),ve.decodeValue(ht.slice(zt+1))],Jn=me.get(sn)||[];Jn.push(Mn),me.set(sn,Jn)}),me}(ve.fromString,this.encoder)}else ve.fromObject?(this.map=new Map,Object.keys(ve.fromObject).forEach(me=>{const re=ve.fromObject[me];this.map.set(me,Array.isArray(re)?re:[re])})):this.map=null}has(ve){return this.init(),this.map.has(ve)}get(ve){this.init();const me=this.map.get(ve);return me?me[0]:null}getAll(ve){return this.init(),this.map.get(ve)||null}keys(){return this.init(),Array.from(this.map.keys())}append(ve,me){return this.clone({param:ve,value:me,op:"a"})}appendAll(ve){const me=[];return Object.keys(ve).forEach(re=>{const ht=ve[re];Array.isArray(ht)?ht.forEach(zt=>{me.push({param:re,value:zt,op:"a"})}):me.push({param:re,value:ht,op:"a"})}),this.clone(me)}set(ve,me){return this.clone({param:ve,value:me,op:"s"})}delete(ve,me){return this.clone({param:ve,value:me,op:"d"})}toString(){return this.init(),this.keys().map(ve=>{const me=this.encoder.encodeKey(ve);return this.map.get(ve).map(re=>me+"="+this.encoder.encodeValue(re)).join("&")}).filter(ve=>""!==ve).join("&")}clone(ve){const me=new ct({encoder:this.encoder});return me.cloneFrom=this.cloneFrom||this,me.updates=(this.updates||[]).concat(ve),me}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(ve=>this.map.set(ve,this.cloneFrom.map.get(ve))),this.updates.forEach(ve=>{switch(ve.op){case"a":case"s":const me=("a"===ve.op?this.map.get(ve.param):void 0)||[];me.push(Ct(ve.value)),this.map.set(ve.param,me);break;case"d":if(void 0===ve.value){this.map.delete(ve.param);break}{let re=this.map.get(ve.param)||[];const ht=re.indexOf(Ct(ve.value));-1!==ht&&re.splice(ht,1),re.length>0?this.map.set(ve.param,re):this.map.delete(ve.param)}}}),this.cloneFrom=this.updates=null)}}class he{constructor(){this.map=new Map}set(ve,me){return this.map.set(ve,me),this}get(ve){return this.map.has(ve)||this.map.set(ve,ve.defaultValue()),this.map.get(ve)}delete(ve){return this.map.delete(ve),this}has(ve){return this.map.has(ve)}keys(){return this.map.keys()}}function Ae(jt){return"undefined"!=typeof ArrayBuffer&&jt instanceof ArrayBuffer}function j(jt){return"undefined"!=typeof Blob&&jt instanceof Blob}function W(jt){return"undefined"!=typeof FormData&&jt instanceof FormData}class q{constructor(ve,me,re,ht){let zt;if(this.url=me,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=ve.toUpperCase(),function je(jt){switch(jt){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||ht?(this.body=void 0!==re?re:null,zt=ht):zt=re,zt&&(this.reportProgress=!!zt.reportProgress,this.withCredentials=!!zt.withCredentials,zt.responseType&&(this.responseType=zt.responseType),zt.headers&&(this.headers=zt.headers),zt.context&&(this.context=zt.context),zt.params&&(this.params=zt.params)),this.headers||(this.headers=new se),this.context||(this.context=new he),this.params){const sn=this.params.toString();if(0===sn.length)this.urlWithParams=me;else{const Mn=me.indexOf("?");this.urlWithParams=me+(-1===Mn?"?":Mn<me.length-1?"&":"")+sn}}else this.params=new ct,this.urlWithParams=me}serializeBody(){return null===this.body?null:Ae(this.body)||j(this.body)||W(this.body)||function ge(jt){return"undefined"!=typeof URLSearchParams&&jt instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ct?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||W(this.body)?null:j(this.body)?this.body.type||null:Ae(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ct?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(ve={}){var me;const re=ve.method||this.method,ht=ve.url||this.url,zt=ve.responseType||this.responseType,sn=void 0!==ve.body?ve.body:this.body,Mn=void 0!==ve.withCredentials?ve.withCredentials:this.withCredentials,Jn=void 0!==ve.reportProgress?ve.reportProgress:this.reportProgress;let Tr=ve.headers||this.headers,wr=ve.params||this.params;const Ki=null!==(me=ve.context)&&void 0!==me?me:this.context;return void 0!==ve.setHeaders&&(Tr=Object.keys(ve.setHeaders).reduce((Li,Ht)=>Li.set(Ht,ve.setHeaders[Ht]),Tr)),ve.setParams&&(wr=Object.keys(ve.setParams).reduce((Li,Ht)=>Li.set(Ht,ve.setParams[Ht]),wr)),new q(re,ht,sn,{params:wr,headers:Tr,context:Ki,reportProgress:Jn,responseType:zt,withCredentials:Mn})}}var U=(()=>((U=U||{})[U.Sent=0]="Sent",U[U.UploadProgress=1]="UploadProgress",U[U.ResponseHeader=2]="ResponseHeader",U[U.DownloadProgress=3]="DownloadProgress",U[U.Response=4]="Response",U[U.User=5]="User",U))();class Y{constructor(ve,me=200,re="OK"){this.headers=ve.headers||new se,this.status=void 0!==ve.status?ve.status:me,this.statusText=ve.statusText||re,this.url=ve.url||null,this.ok=this.status>=200&&this.status<300}}class ee extends Y{constructor(ve={}){super(ve),this.type=U.ResponseHeader}clone(ve={}){return new ee({headers:ve.headers||this.headers,status:void 0!==ve.status?ve.status:this.status,statusText:ve.statusText||this.statusText,url:ve.url||this.url||void 0})}}class Pe extends Y{constructor(ve={}){super(ve),this.type=U.Response,this.body=void 0!==ve.body?ve.body:null}clone(ve={}){return new Pe({body:void 0!==ve.body?ve.body:this.body,headers:ve.headers||this.headers,status:void 0!==ve.status?ve.status:this.status,statusText:ve.statusText||this.statusText,url:ve.url||this.url||void 0})}}class _e extends Y{constructor(ve){super(ve,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${ve.url||"(unknown url)"}`:`Http failure response for ${ve.url||"(unknown url)"}: ${ve.status} ${ve.statusText}`,this.error=ve.error||null}}function We(jt,ve){return{body:ve,headers:jt.headers,context:jt.context,observe:jt.observe,params:jt.params,reportProgress:jt.reportProgress,responseType:jt.responseType,withCredentials:jt.withCredentials}}let rt=(()=>{class jt{constructor(me){this.handler=me}request(me,re,ht={}){let zt;if(me instanceof q)zt=me;else{let Jn,Tr;Jn=ht.headers instanceof se?ht.headers:new se(ht.headers),ht.params&&(Tr=ht.params instanceof ct?ht.params:new ct({fromObject:ht.params})),zt=new q(me,re,void 0!==ht.body?ht.body:null,{headers:Jn,context:ht.context,params:Tr,reportProgress:ht.reportProgress,responseType:ht.responseType||"json",withCredentials:ht.withCredentials})}const sn=(0,g.of)(zt).pipe((0,xe.b)(Jn=>this.handler.handle(Jn)));if(me instanceof q||"events"===ht.observe)return sn;const Mn=sn.pipe((0,Le.h)(Jn=>Jn instanceof Pe));switch(ht.observe||"body"){case"body":switch(zt.responseType){case"arraybuffer":return Mn.pipe((0,Re.U)(Jn=>{if(null!==Jn.body&&!(Jn.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Jn.body}));case"blob":return Mn.pipe((0,Re.U)(Jn=>{if(null!==Jn.body&&!(Jn.body instanceof Blob))throw new Error("Response is not a Blob.");return Jn.body}));case"text":return Mn.pipe((0,Re.U)(Jn=>{if(null!==Jn.body&&"string"!=typeof Jn.body)throw new Error("Response is not a string.");return Jn.body}));default:return Mn.pipe((0,Re.U)(Jn=>Jn.body))}case"response":return Mn;default:throw new Error(`Unreachable: unhandled observe type ${ht.observe}}`)}}delete(me,re={}){return this.request("DELETE",me,re)}get(me,re={}){return this.request("GET",me,re)}head(me,re={}){return this.request("HEAD",me,re)}jsonp(me,re){return this.request("JSONP",me,{params:(new ct).append(re,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(me,re={}){return this.request("OPTIONS",me,re)}patch(me,re,ht={}){return this.request("PATCH",me,We(ht,re))}post(me,re,ht={}){return this.request("POST",me,We(ht,re))}put(me,re,ht={}){return this.request("PUT",me,We(ht,re))}}return jt.\u0275fac=function(me){return new(me||jt)(ue.LFG(Ue))},jt.\u0275prov=ue.Yz7({token:jt,factory:jt.\u0275fac}),jt})();class _t{constructor(ve,me){this.next=ve,this.interceptor=me}handle(ve){return this.interceptor.intercept(ve,this.next)}}const ft=new ue.OlP("HTTP_INTERCEPTORS");let Zt=(()=>{class jt{intercept(me,re){return re.handle(me)}}return jt.\u0275fac=function(me){return new(me||jt)},jt.\u0275prov=ue.Yz7({token:jt,factory:jt.\u0275fac}),jt})();const Er=/^\)\]\}',?\n/;let di=(()=>{class jt{constructor(me){this.xhrFactory=me}handle(me){if("JSONP"===me.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new nt.y(re=>{const ht=this.xhrFactory.build();if(ht.open(me.method,me.urlWithParams),me.withCredentials&&(ht.withCredentials=!0),me.headers.forEach((Ht,Te)=>ht.setRequestHeader(Ht,Te.join(","))),me.headers.has("Accept")||ht.setRequestHeader("Accept","application/json, text/plain, */*"),!me.headers.has("Content-Type")){const Ht=me.detectContentTypeHeader();null!==Ht&&ht.setRequestHeader("Content-Type",Ht)}if(me.responseType){const Ht=me.responseType.toLowerCase();ht.responseType="json"!==Ht?Ht:"text"}const zt=me.serializeBody();let sn=null;const Mn=()=>{if(null!==sn)return sn;const Ht=1223===ht.status?204:ht.status,Te=ht.statusText||"OK",ke=new se(ht.getAllResponseHeaders()),tt=function Sr(jt){return"responseURL"in jt&&jt.responseURL?jt.responseURL:/^X-Request-URL:/m.test(jt.getAllResponseHeaders())?jt.getResponseHeader("X-Request-URL"):null}(ht)||me.url;return sn=new ee({headers:ke,status:Ht,statusText:Te,url:tt}),sn},Jn=()=>{let{headers:Ht,status:Te,statusText:ke,url:tt}=Mn(),Ft=null;204!==Te&&(Ft=void 0===ht.response?ht.responseText:ht.response),0===Te&&(Te=Ft?200:0);let vt=Te>=200&&Te<300;if("json"===me.responseType&&"string"==typeof Ft){const dn=Ft;Ft=Ft.replace(Er,"");try{Ft=""!==Ft?JSON.parse(Ft):null}catch(Pn){Ft=dn,vt&&(vt=!1,Ft={error:Pn,text:Ft})}}vt?(re.next(new Pe({body:Ft,headers:Ht,status:Te,statusText:ke,url:tt||void 0})),re.complete()):re.error(new _e({error:Ft,headers:Ht,status:Te,statusText:ke,url:tt||void 0}))},Tr=Ht=>{const{url:Te}=Mn(),ke=new _e({error:Ht,status:ht.status||0,statusText:ht.statusText||"Unknown Error",url:Te||void 0});re.error(ke)};let wr=!1;const Ki=Ht=>{wr||(re.next(Mn()),wr=!0);let Te={type:U.DownloadProgress,loaded:Ht.loaded};Ht.lengthComputable&&(Te.total=Ht.total),"text"===me.responseType&&!!ht.responseText&&(Te.partialText=ht.responseText),re.next(Te)},Li=Ht=>{let Te={type:U.UploadProgress,loaded:Ht.loaded};Ht.lengthComputable&&(Te.total=Ht.total),re.next(Te)};return ht.addEventListener("load",Jn),ht.addEventListener("error",Tr),ht.addEventListener("timeout",Tr),ht.addEventListener("abort",Tr),me.reportProgress&&(ht.addEventListener("progress",Ki),null!==zt&&ht.upload&&ht.upload.addEventListener("progress",Li)),ht.send(zt),re.next({type:U.Sent}),()=>{ht.removeEventListener("error",Tr),ht.removeEventListener("abort",Tr),ht.removeEventListener("load",Jn),ht.removeEventListener("timeout",Tr),me.reportProgress&&(ht.removeEventListener("progress",Ki),null!==zt&&ht.upload&&ht.upload.removeEventListener("progress",Li)),ht.readyState!==ht.DONE&&ht.abort()}})}}return jt.\u0275fac=function(me){return new(me||jt)(ue.LFG(w.JF))},jt.\u0275prov=ue.Yz7({token:jt,factory:jt.\u0275fac}),jt})();const vr=new ue.OlP("XSRF_COOKIE_NAME"),qi=new ue.OlP("XSRF_HEADER_NAME");class ii{}let fi=(()=>{class jt{constructor(me,re,ht){this.doc=me,this.platform=re,this.cookieName=ht,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const me=this.doc.cookie||"";return me!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,w.Mx)(me,this.cookieName),this.lastCookieString=me),this.lastToken}}return jt.\u0275fac=function(me){return new(me||jt)(ue.LFG(w.K0),ue.LFG(ue.Lbi),ue.LFG(vr))},jt.\u0275prov=ue.Yz7({token:jt,factory:jt.\u0275fac}),jt})(),bi=(()=>{class jt{constructor(me,re){this.tokenService=me,this.headerName=re}intercept(me,re){const ht=me.url.toLowerCase();if("GET"===me.method||"HEAD"===me.method||ht.startsWith("http://")||ht.startsWith("https://"))return re.handle(me);const zt=this.tokenService.getToken();return null!==zt&&!me.headers.has(this.headerName)&&(me=me.clone({headers:me.headers.set(this.headerName,zt)})),re.handle(me)}}return jt.\u0275fac=function(me){return new(me||jt)(ue.LFG(ii),ue.LFG(qi))},jt.\u0275prov=ue.Yz7({token:jt,factory:jt.\u0275fac}),jt})(),pi=(()=>{class jt{constructor(me,re){this.backend=me,this.injector=re,this.chain=null}handle(me){if(null===this.chain){const re=this.injector.get(ft,[]);this.chain=re.reduceRight((ht,zt)=>new _t(ht,zt),this.backend)}return this.chain.handle(me)}}return jt.\u0275fac=function(me){return new(me||jt)(ue.LFG(fe),ue.LFG(ue.zs3))},jt.\u0275prov=ue.Yz7({token:jt,factory:jt.\u0275fac}),jt})(),ln=(()=>{class jt{static disable(){return{ngModule:jt,providers:[{provide:bi,useClass:Zt}]}}static withOptions(me={}){return{ngModule:jt,providers:[me.cookieName?{provide:vr,useValue:me.cookieName}:[],me.headerName?{provide:qi,useValue:me.headerName}:[]]}}}return jt.\u0275fac=function(me){return new(me||jt)},jt.\u0275mod=ue.oAB({type:jt}),jt.\u0275inj=ue.cJS({providers:[bi,{provide:ft,useExisting:bi,multi:!0},{provide:ii,useClass:fi},{provide:vr,useValue:"XSRF-TOKEN"},{provide:qi,useValue:"X-XSRF-TOKEN"}]}),jt})(),En=(()=>{class jt{}return jt.\u0275fac=function(me){return new(me||jt)},jt.\u0275mod=ue.oAB({type:jt}),jt.\u0275inj=ue.cJS({providers:[rt,{provide:Ue,useClass:pi},di,{provide:fe,useExisting:di}],imports:[[ln.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),jt})()},5e3:(Sn,Nt,H)=>{"use strict";H.d(Nt,{deG:()=>Ll,tb:()=>mw,AFp:()=>dw,ip1:()=>W0,CZH:()=>bg,hGG:()=>x1,z2F:()=>Ny,sBO:()=>Jx,Sil:()=>K0,_Vd:()=>Zp,EJc:()=>yw,Xek:()=>Sx,SBq:()=>Am,qLn:()=>jc,vpe:()=>Xd,tBr:()=>Ei,XFs:()=>Xt,GSi:()=>vv,OlP:()=>_o,zs3:()=>ll,IIB:()=>Cx,ZZ4:()=>hv,aQg:()=>dv,soG:()=>lv,LVF:()=>Dx,YKP:()=>S,h0i:()=>y,PXZ:()=>Hx,R0b:()=>sh,FiY:()=>Qi,Lbi:()=>pw,g9A:()=>fw,Qsj:()=>gg,FYo:()=>mg,JOm:()=>ar,q3G:()=>Vs,tp0:()=>vo,Rgc:()=>Oy,dDg:()=>bw,q4F:()=>Ay,GfV:()=>Q_,s_b:()=>ov,ifc:()=>zt,eFA:()=>Ew,G48:()=>Yx,X6Q:()=>Kx,_c5:()=>m1,VLi:()=>zx,c2e:()=>gw,zSh:()=>If,wAp:()=>ci,vHH:()=>bt,EiD:()=>yu,mCW:()=>Ul,qzn:()=>pc,JVY:()=>Gf,pB0:()=>Bc,eBb:()=>ch,L6k:()=>Fc,LAX:()=>mu,cg1:()=>$p,kL8:()=>w_,yhl:()=>Fh,dqk:()=>wr,sIi:()=>Rp,CqO:()=>Yy,QGY:()=>Bf,F4k:()=>hd,RDi:()=>Cu,AaK:()=>Ue,z3N:()=>Cl,TTD:()=>Ni,xp6:()=>mf,uIk:()=>dm,Tol:()=>u_,ekj:()=>ty,Suo:()=>$b,Xpm:()=>be,lG2:()=>ze,Yz7:()=>gr,cJS:()=>Er,oAB:()=>Lt,Yjl:()=>Ve,Y36:()=>ym,_UZ:()=>$d,BQk:()=>Bg,ynx:()=>Oh,qZA:()=>Fp,TgZ:()=>Fg,EpF:()=>Ug,LFG:()=>xn,$8M:()=>Wr,$Z:()=>tg,NdJ:()=>zg,CRH:()=>Gb,kcU:()=>P,O4$:()=>Ka,oxw:()=>Hg,Hsn:()=>$g,F$t:()=>Qy,Q6J:()=>Np,DdM:()=>$r,iGM:()=>jb,Jf7:()=>np,CHM:()=>Fa,oJD:()=>of,LSH:()=>_c,B6R:()=>Oe,Akn:()=>ih,Udp:()=>ey,YNc:()=>Vy,_uU:()=>Hp,Oqu:()=>dl,hij:()=>ig,Gf:()=>Hb});var w=H(7579),ue=H(727),g=H(8306),nt=H(6451),xe=H(3099);function Le(r){for(let o in r)if(r[o]===Le)return o;throw Error("Could not find renamed property on target object.")}function Re(r,o){for(const a in o)o.hasOwnProperty(a)&&!r.hasOwnProperty(a)&&(r[a]=o[a])}function Ue(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(Ue).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const o=r.toString();if(null==o)return""+o;const a=o.indexOf("\n");return-1===a?o:o.substring(0,a)}function fe(r,o){return null==r||""===r?null===o?"":o:null==o||""===o?r:r+" "+o}const se=Le({__forward_ref__:Le});function ae(r){return r.__forward_ref__=ae,r.toString=function(){return Ue(this())},r}function $e(r){return St(r)?r():r}function St(r){return"function"==typeof r&&r.hasOwnProperty(se)&&r.__forward_ref__===ae}class bt extends Error{constructor(o,a){super(function Ct(r,o){return`NG0${Math.abs(r)}${o?": "+o:""}`}(o,a)),this.code=o}}function ct(r){return"string"==typeof r?r:null==r?"":String(r)}function ut(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():ct(r)}function j(r,o){const a=o?` in ${o}`:"";throw new bt(-201,`No provider for ${ut(r)} found${a}`)}function qt(r,o,a,f){throw new Error(`ASSERTION ERROR: ${r}`+(null==f?"":` [Expected=> ${a} ${f} ${o} <=Actual]`))}function gr(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Er(r){return{providers:r.providers||[],imports:r.imports||[]}}function Sr(r){return di(r,fi)||di(r,pi)}function di(r,o){return r.hasOwnProperty(o)?r[o]:null}function ii(r){return r&&(r.hasOwnProperty(bi)||r.hasOwnProperty(oi))?r[bi]:null}const fi=Le({\u0275prov:Le}),bi=Le({\u0275inj:Le}),pi=Le({ngInjectableDef:Le}),oi=Le({ngInjectorDef:Le});var Xt=(()=>((Xt=Xt||{})[Xt.Default=0]="Default",Xt[Xt.Host=1]="Host",Xt[Xt.Self=2]="Self",Xt[Xt.SkipSelf=4]="SkipSelf",Xt[Xt.Optional=8]="Optional",Xt))();let ln;function bn(r){const o=ln;return ln=r,o}function Wn(r,o,a){const f=Sr(r);return f&&"root"==f.providedIn?void 0===f.value?f.value=f.factory():f.value:a&Xt.Optional?null:void 0!==o?o:void j(Ue(r),"Injector")}function ve(r){return{toString:r}.toString()}var me=(()=>((me=me||{})[me.OnPush=0]="OnPush",me[me.Default=1]="Default",me))(),zt=(()=>{return(r=zt||(zt={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",zt;var r})();const sn="undefined"!=typeof globalThis&&globalThis,Mn="undefined"!=typeof window&&window,Jn="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,wr=sn||"undefined"!=typeof global&&global||Mn||Jn,Ht={},Te=[],ke=Le({\u0275cmp:Le}),tt=Le({\u0275dir:Le}),Ft=Le({\u0275pipe:Le}),vt=Le({\u0275mod:Le}),dn=Le({\u0275fac:Le}),Pn=Le({__NG_ELEMENT_ID__:Le});let ce=0;function be(r){return ve(()=>{const a={},f={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:a,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===me.OnPush,directiveDefs:null,pipeDefs:null,selectors:r.selectors||Te,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||zt.Emulated,id:"c",styles:r.styles||Te,_:null,setInput:null,schemas:r.schemas||null,tView:null},_=r.directives,T=r.features,R=r.pipes;return f.id+=ce++,f.inputs=Ie(r.inputs,a),f.outputs=Ie(r.outputs),T&&T.forEach(z=>z(f)),f.directiveDefs=_?()=>("function"==typeof _?_():_).map(Qe):null,f.pipeDefs=R?()=>("function"==typeof R?R():R).map(ot):null,f})}function Oe(r,o,a){const f=r.\u0275cmp;f.directiveDefs=()=>o.map(Qe),f.pipeDefs=()=>a.map(ot)}function Qe(r){return mt(r)||Tt(r)}function ot(r){return function en(r){return r[Ft]||null}(r)}const Dt={};function Lt(r){return ve(()=>{const o={type:r.type,bootstrap:r.bootstrap||Te,declarations:r.declarations||Te,imports:r.imports||Te,exports:r.exports||Te,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null};return null!=r.id&&(Dt[r.id]=r.type),o})}function Je(r,o){return ve(()=>{const a=Dn(r,!0);a.declarations=o.declarations||Te,a.imports=o.imports||Te,a.exports=o.exports||Te})}function Ie(r,o){if(null==r)return Ht;const a={};for(const f in r)if(r.hasOwnProperty(f)){let _=r[f],T=_;Array.isArray(_)&&(T=_[1],_=_[0]),a[_]=f,o&&(o[_]=T)}return a}const ze=be;function Ve(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,onDestroy:r.type.prototype.ngOnDestroy||null}}function mt(r){return r[ke]||null}function Tt(r){return r[tt]||null}function Dn(r,o){const a=r[vt]||null;if(!a&&!0===o)throw new Error(`Type ${Ue(r)} does not have '\u0275mod' property.`);return a}function fo(r){return Array.isArray(r)&&"object"==typeof r[1]}function Ji(r){return Array.isArray(r)&&!0===r[1]}function ou(r){return 0!=(8&r.flags)}function ns(r){return 2==(2&r.flags)}function fs(r){return 1==(1&r.flags)}function Io(r){return null!==r.template}function jo(r){return 0!=(512&r[2])}function is(r,o){return r.hasOwnProperty(dn)?r[dn]:null}class po{constructor(o,a,f){this.previousValue=o,this.currentValue=a,this.firstChange=f}isFirstChange(){return this.firstChange}}function Ni(){return Uo}function Uo(r){return r.type.prototype.ngOnChanges&&(r.setInput=na),el}function el(){const r=Ga(this),o=null==r?void 0:r.current;if(o){const a=r.previous;if(a===Ht)r.previous=o;else for(let f in o)a[f]=o[f];r.current=null,this.ngOnChanges(o)}}function na(r,o,a,f){const _=Ga(r)||function Gs(r,o){return r[uu]=o}(r,{previous:Ht,current:null}),T=_.current||(_.current={}),R=_.previous,z=this.declaredInputs[a],X=R[z];T[z]=new po(X&&X.currentValue,o,R===Ht),r[f]=o}Ni.ngInherit=!0;const uu="__ngSimpleChanges__";function Ga(r){return r[uu]||null}const wo="math";let eo;function Cu(r){eo=r}function ps(){return void 0!==eo?eo:"undefined"!=typeof document?document:void 0}function qr(r){return!!r.listen}const oe={createRenderer:(r,o)=>ps()};function ne(r){for(;Array.isArray(r);)r=r[0];return r}function vn(r,o){return ne(o[r])}function On(r,o){return ne(o[r.index])}function Hr(r,o){return r.data[o]}function li(r,o){return r[o]}function ni(r,o){const a=o[r];return fo(a)?a:a[0]}function Qr(r){return 4==(4&r[2])}function mo(r){return 128==(128&r[2])}function Di(r,o){return null==o?null:r[o]}function ms(r){r[18]=0}function go(r,o){r[5]+=o;let a=r,f=r[3];for(;null!==f&&(1===o&&1===a[5]||-1===o&&0===a[5]);)f[5]+=o,a=f,f=f[3]}const Rr={lFrame:us(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Na(){return Rr.bindingsEnabled}function Xo(){Rr.bindingsEnabled=!0}function vl(){Rr.bindingsEnabled=!1}function Nn(){return Rr.lFrame.lView}function Cr(){return Rr.lFrame.tView}function Fa(r){return Rr.lFrame.contextLView=r,r[8]}function xo(){let r=Ws();for(;null!==r&&64===r.type;)r=r.parent;return r}function Ws(){return Rr.lFrame.currentTNode}function Wa(){const r=Rr.lFrame,o=r.currentTNode;return r.isParent?o:o.parent}function as(r,o){const a=Rr.lFrame;a.currentTNode=r,a.isParent=o}function zu(){return Rr.lFrame.isParent}function Vu(){Rr.lFrame.isParent=!1}function ya(){return Rr.isInCheckNoChangesMode}function As(r){Rr.isInCheckNoChangesMode=r}function yo(){const r=Rr.lFrame;let o=r.bindingRootIndex;return-1===o&&(o=r.bindingRootIndex=r.tView.bindingStartIndex),o}function Bs(){return Rr.lFrame.bindingIndex}function Za(r){return Rr.lFrame.bindingIndex=r}function Eo(){return Rr.lFrame.bindingIndex++}function Us(r){const o=Rr.lFrame,a=o.bindingIndex;return o.bindingIndex=o.bindingIndex+r,a}function Fo(r){Rr.lFrame.inI18n=r}function ia(r,o){const a=Rr.lFrame;a.bindingIndex=a.bindingRootIndex=r,_a(o)}function _a(r){Rr.lFrame.currentDirectiveIndex=r}function tl(r){const o=Rr.lFrame.currentDirectiveIndex;return-1===o?null:r[o]}function va(){return Rr.lFrame.currentQueryIndex}function $u(r){Rr.lFrame.currentQueryIndex=r}function Mu(r){const o=r[1];return 2===o.type?o.declTNode:1===o.type?r[6]:null}function Ms(r,o,a){if(a&Xt.SkipSelf){let _=o,T=r;for(;!(_=_.parent,null!==_||a&Xt.Host||(_=Mu(T),null===_||(T=T[15],10&_.type))););if(null===_)return!1;o=_,r=T}const f=Rr.lFrame=nl();return f.currentTNode=o,f.lView=r,!0}function ba(r){const o=nl(),a=r[1];Rr.lFrame=o,o.currentTNode=a.firstChild,o.lView=r,o.tView=a,o.contextLView=r,o.bindingIndex=a.bindingStartIndex,o.inI18n=!1}function nl(){const r=Rr.lFrame,o=null===r?null:r.child;return null===o?us(r):o}function us(r){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=o),o}function rl(){const r=Rr.lFrame;return Rr.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const fl=rl;function lu(){const r=rl();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function To(){return Rr.lFrame.selectedIndex}function Ai(r){Rr.lFrame.selectedIndex=r}function ao(){const r=Rr.lFrame;return Hr(r.tView,r.selectedIndex)}function Ka(){Rr.lFrame.currentNamespace="svg"}function sa(){Rr.lFrame.currentNamespace=wo}function P(){!function B(){Rr.lFrame.currentNamespace=null}()}function Ge(r,o){for(let a=o.directiveStart,f=o.directiveEnd;a<f;a++){const T=r.data[a].type.prototype,{ngAfterContentInit:R,ngAfterContentChecked:z,ngAfterViewInit:X,ngAfterViewChecked:Ce,ngOnDestroy:He}=T;R&&(r.contentHooks||(r.contentHooks=[])).push(-a,R),z&&((r.contentHooks||(r.contentHooks=[])).push(a,z),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(a,z)),X&&(r.viewHooks||(r.viewHooks=[])).push(-a,X),Ce&&((r.viewHooks||(r.viewHooks=[])).push(a,Ce),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(a,Ce)),null!=He&&(r.destroyHooks||(r.destroyHooks=[])).push(a,He)}}function Ze(r,o,a){_n(r,o,3,a)}function Mt(r,o,a,f){(3&r[2])===a&&_n(r,o,a,f)}function $t(r,o){let a=r[2];(3&a)===o&&(a&=2047,a+=1,r[2]=a)}function _n(r,o,a,f){const T=null!=f?f:-1,R=o.length-1;let z=0;for(let X=void 0!==f?65535&r[18]:0;X<R;X++)if("number"==typeof o[X+1]){if(z=o[X],null!=f&&z>=f)break}else o[X]<0&&(r[18]+=65536),(z<T||-1==T)&&(on(r,a,o,X),r[18]=(4294901760&r[18])+X+2),X++}function on(r,o,a,f){const _=a[f]<0,T=a[f+1],z=r[_?-a[f]:a[f]];if(_){if(r[2]>>11<r[18]>>16&&(3&r[2])===o){r[2]+=2048;try{T.call(z)}finally{}}}else try{T.call(z)}finally{}}class Gn{constructor(o,a,f){this.factory=o,this.resolving=!1,this.canSeeViewProviders=a,this.injectImpl=f}}function wi(r,o,a){const f=qr(r);let _=0;for(;_<a.length;){const T=a[_];if("number"==typeof T){if(0!==T)break;_++;const R=a[_++],z=a[_++],X=a[_++];f?r.setAttribute(o,z,X,R):o.setAttributeNS(R,z,X)}else{const R=T,z=a[++_];rr(R)?f&&r.setProperty(o,R,z):f?r.setAttribute(o,R,z):o.setAttribute(R,z),_++}}return _}function Ba(r){return 3===r||4===r||6===r}function rr(r){return 64===r.charCodeAt(0)}function Gu(r,o){if(null!==o&&0!==o.length)if(null===r||0===r.length)r=o.slice();else{let a=-1;for(let f=0;f<o.length;f++){const _=o[f];"number"==typeof _?a=_:0===a||cu(r,a,_,null,-1===a||2===a?o[++f]:null)}}return r}function cu(r,o,a,f,_){let T=0,R=r.length;if(-1===o)R=-1;else for(;T<r.length;){const z=r[T++];if("number"==typeof z){if(z===o){R=-1;break}if(z>o){R=T-1;break}}}for(;T<r.length;){const z=r[T];if("number"==typeof z)break;if(z===a){if(null===f)return void(null!==_&&(r[T+1]=_));if(f===r[T+1])return void(r[T+2]=_)}T++,null!==f&&T++,null!==_&&T++}-1!==R&&(r.splice(R,0,o),T=R+1),r.splice(T++,0,a),null!==f&&r.splice(T++,0,f),null!==_&&r.splice(T++,0,_)}function Ol(r){return-1!==r}function Ri(r){return 32767&r}function Zs(r,o){let a=function zs(r){return r>>16}(r),f=o;for(;a>0;)f=f[15],a--;return f}let qu=!0;function Qo(r){const o=qu;return qu=r,o}let bl=0;function Zn(r,o){const a=V(r,o);if(-1!==a)return a;const f=o[1];f.firstCreatePass&&(r.injectorIndex=o.length,Mi(f.data,r),Mi(o,null),Mi(f.blueprint,null));const _=F(r,o),T=r.injectorIndex;if(Ol(_)){const R=Ri(_),z=Zs(_,o),X=z[1].data;for(let Ce=0;Ce<8;Ce++)o[T+Ce]=z[R+Ce]|X[R+Ce]}return o[T+8]=_,T}function Mi(r,o){r.push(0,0,0,0,0,0,0,0,o)}function V(r,o){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===o[r.injectorIndex+8]?-1:r.injectorIndex}function F(r,o){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let a=0,f=null,_=o;for(;null!==_;){const T=_[1],R=T.type;if(f=2===R?T.declTNode:1===R?_[6]:null,null===f)return-1;if(a++,_=_[15],-1!==f.injectorIndex)return f.injectorIndex|a<<16}return-1}function M(r,o,a){!function il(r,o,a){let f;"string"==typeof a?f=a.charCodeAt(0)||0:a.hasOwnProperty(Pn)&&(f=a[Pn]),null==f&&(f=a[Pn]=bl++);const _=255&f;o.data[r+(_>>5)]|=1<<_}(r,o,a)}function ye(r,o,a){if(a&Xt.Optional)return r;j(o,"NodeInjector")}function De(r,o,a,f){if(a&Xt.Optional&&void 0===f&&(f=null),0==(a&(Xt.Self|Xt.Host))){const _=r[9],T=bn(void 0);try{return _?_.get(o,f,a&Xt.Optional):Wn(o,f,a&Xt.Optional)}finally{bn(T)}}return ye(f,o,a)}function Ne(r,o,a,f=Xt.Default,_){if(null!==r){const T=function si(r){if("string"==typeof r)return r.charCodeAt(0)||0;const o=r.hasOwnProperty(Pn)?r[Pn]:void 0;return"number"==typeof o?o>=0?255&o:pn:o}(a);if("function"==typeof T){if(!Ms(o,r,f))return f&Xt.Host?ye(_,a,f):De(o,a,f,_);try{const R=T(f);if(null!=R||f&Xt.Optional)return R;j(a)}finally{fl()}}else if("number"==typeof T){let R=null,z=V(r,o),X=-1,Ce=f&Xt.Host?o[16][6]:null;for((-1===z||f&Xt.SkipSelf)&&(X=-1===z?F(r,o):o[z+8],-1!==X&&Ro(f,!1)?(R=o[1],z=Ri(X),o=Zs(X,o)):z=-1);-1!==z;){const He=o[1];if(xi(T,z,He.data)){const It=wn(z,o,a,R,f,Ce);if(It!==at)return It}X=o[z+8],-1!==X&&Ro(f,o[1].data[z+8]===Ce)&&xi(T,z,o)?(R=He,z=Ri(X),o=Zs(X,o)):z=-1}}}return De(o,a,f,_)}const at={};function pn(){return new Co(xo(),Nn())}function wn(r,o,a,f,_,T){const R=o[1],z=R.data[r+8],He=Fn(z,R,a,null==f?ns(z)&&qu:f!=R&&0!=(3&z.type),_&Xt.Host&&T===z);return null!==He?Pr(o,R,He,z):at}function Fn(r,o,a,f,_){const T=r.providerIndexes,R=o.data,z=1048575&T,X=r.directiveStart,He=T>>20,Gt=_?z+He:r.directiveEnd;for(let hn=f?z:z+He;hn<Gt;hn++){const Ln=R[hn];if(hn<X&&a===Ln||hn>=X&&Ln.type===a)return hn}if(_){const hn=R[X];if(hn&&Io(hn)&&hn.type===a)return X}return null}function Pr(r,o,a,f){let _=r[a];const T=o.data;if(function dr(r){return r instanceof Gn}(_)){const R=_;R.resolving&&function he(r,o){const a=o?`. Dependency path: ${o.join(" > ")} > ${r}`:"";throw new bt(-200,`Circular dependency in DI detected for ${r}${a}`)}(ut(T[a]));const z=Qo(R.canSeeViewProviders);R.resolving=!0;const X=R.injectImpl?bn(R.injectImpl):null;Ms(r,f,Xt.Default);try{_=r[a]=R.factory(void 0,T,r,f),o.firstCreatePass&&a>=f.directiveStart&&function de(r,o,a){const{ngOnChanges:f,ngOnInit:_,ngDoCheck:T}=o.type.prototype;if(f){const R=Uo(o);(a.preOrderHooks||(a.preOrderHooks=[])).push(r,R),(a.preOrderCheckHooks||(a.preOrderCheckHooks=[])).push(r,R)}_&&(a.preOrderHooks||(a.preOrderHooks=[])).push(0-r,_),T&&((a.preOrderHooks||(a.preOrderHooks=[])).push(r,T),(a.preOrderCheckHooks||(a.preOrderCheckHooks=[])).push(r,T))}(a,T[a],o)}finally{null!==X&&bn(X),Qo(z),R.resolving=!1,fl()}}return _}function xi(r,o,a){return!!(a[o+(r>>5)]&1<<r)}function Ro(r,o){return!(r&Xt.Self||r&Xt.Host&&o)}class Co{constructor(o,a){this._tNode=o,this._lView=a}get(o,a,f){return Ne(this._tNode,this._lView,o,f,a)}}function xa(r){return ve(()=>{const o=r.prototype.constructor,a=o[dn]||Ea(o),f=Object.prototype;let _=Object.getPrototypeOf(r.prototype).constructor;for(;_&&_!==f;){const T=_[dn]||Ea(_);if(T&&T!==a)return T;_=Object.getPrototypeOf(_)}return T=>new T})}function Ea(r){return St(r)?()=>{const o=Ea($e(r));return o&&o()}:is(r)}function Wr(r){return function J(r,o){if("class"===o)return r.classes;if("style"===o)return r.styles;const a=r.attrs;if(a){const f=a.length;let _=0;for(;_<f;){const T=a[_];if(Ba(T))break;if(0===T)_+=2;else if("number"==typeof T)for(_++;_<f&&"string"==typeof a[_];)_++;else{if(T===o)return a[_+1];_+=2}}}return null}(xo(),r)}const Xi="__annotations__",Ks="__parameters__",Jr="__prop__metadata__";function du(r,o,a,f,_){return ve(()=>{const T=Pu(o);function R(...z){if(this instanceof R)return T.call(this,...z),this;const X=new R(...z);return function(He){return _&&_(He,...z),(He.hasOwnProperty(Xi)?He[Xi]:Object.defineProperty(He,Xi,{value:[]})[Xi]).push(X),f&&f(He),He}}return a&&(R.prototype=Object.create(a.prototype)),R.prototype.ngMetadataName=r,R.annotationCls=R,R})}function Pu(r){return function(...a){if(r){const f=r(...a);for(const _ in f)this[_]=f[_]}}}function ji(r,o,a){return ve(()=>{const f=Pu(o);function _(...T){if(this instanceof _)return f.apply(this,T),this;const R=new _(...T);return z.annotation=R,z;function z(X,Ce,He){const It=X.hasOwnProperty(Ks)?X[Ks]:Object.defineProperty(X,Ks,{value:[]})[Ks];for(;It.length<=He;)It.push(null);return(It[He]=It[He]||[]).push(R),X}}return a&&(_.prototype=Object.create(a.prototype)),_.prototype.ngMetadataName=r,_.annotationCls=_,_})}function ei(r,o,a,f){return ve(()=>{const _=Pu(o);function T(...R){if(this instanceof T)return _.apply(this,R),this;const z=new T(...R);return function X(Ce,He){const It=Ce.constructor,Gt=It.hasOwnProperty(Jr)?It[Jr]:Object.defineProperty(It,Jr,{value:{}})[Jr];Gt[He]=Gt.hasOwnProperty(He)&&Gt[He]||[],Gt[He].unshift(z),f&&f(Ce,He,...R)}}return a&&(T.prototype=Object.create(a.prototype)),T.prototype.ngMetadataName=r,T.annotationCls=T,T})}const Ja=ji("Attribute",r=>({attributeName:r,__NG_ELEMENT_ID__:()=>Wr(r)}));class _o{constructor(o,a){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof a?this.__NG_ELEMENT_ID__=a:void 0!==a&&(this.\u0275prov=gr({token:this,providedIn:a.providedIn||"root",factory:a.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Ll=new _o("AnalyzeForEntryComponents");function Wi(r){const o=wr.ng;if(o&&o.\u0275compilerFacade)return o.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}const to=Function;function Ua(r){return"function"==typeof r}function ls(r,o){void 0===o&&(o=r);for(let a=0;a<r.length;a++){let f=r[a];Array.isArray(f)?(o===r&&(o=r.slice(0,a)),ls(f,o)):o!==r&&o.push(f)}return o}function l(r,o){r.forEach(a=>Array.isArray(a)?l(a,o):o(a))}function d(r,o,a){o>=r.length?r.push(a):r.splice(o,0,a)}function h(r,o){return o>=r.length-1?r.pop():r.splice(o,1)[0]}function m(r,o){const a=[];for(let f=0;f<r;f++)a.push(o);return a}function Ke(r,o,a){let f=it(r,o);return f>=0?r[1|f]=a:(f=~f,function k(r,o,a,f){let _=r.length;if(_==o)r.push(a,f);else if(1===_)r.push(f,r[0]),r[0]=a;else{for(_--,r.push(r[_-1],r[_]);_>o;)r[_]=r[_-2],_--;r[o]=a,r[o+1]=f}}(r,f,o,a)),f}function Xe(r,o){const a=it(r,o);if(a>=0)return r[1|a]}function it(r,o){return function wt(r,o,a){let f=0,_=r.length>>a;for(;_!==f;){const T=f+(_-f>>1),R=r[T<<a];if(o===R)return T<<a;R>o?_=T:f=T+1}return~(_<<a)}(r,o,1)}const Pt=/^function\s+\S+\(\)\s*{[\s\S]+\.apply\(this,\s*(arguments|(?:[^()]+\(\[\],)?[^()]+\(arguments\).*)\)/,gt=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{/,kt=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{[\s\S]*constructor\s*\(/,Bt=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{[\s\S]*constructor\s*\(\)\s*{[^}]*super\(\.\.\.arguments\)/;class tn{constructor(o){this._reflect=o||wr.Reflect}isReflectionEnabled(){return!0}factory(o){return(...a)=>new o(...a)}_zipTypesAndAnnotations(o,a){let f;f=m(void 0===o?a.length:o.length);for(let _=0;_<f.length;_++)f[_]=void 0===o?[]:o[_]&&o[_]!=Object?[o[_]]:[],a&&null!=a[_]&&(f[_]=f[_].concat(a[_]));return f}_ownParameters(o,a){if(function Jt(r){return Pt.test(r)||Bt.test(r)||gt.test(r)&&!kt.test(r)}(o.toString()))return null;if(o.parameters&&o.parameters!==a.parameters)return o.parameters;const _=o.ctorParameters;if(_&&_!==a.ctorParameters){const z="function"==typeof _?_():_,X=z.map(He=>He&&He.type),Ce=z.map(He=>He&&un(He.decorators));return this._zipTypesAndAnnotations(X,Ce)}const T=o.hasOwnProperty(Ks)&&o[Ks],R=this._reflect&&this._reflect.getOwnMetadata&&this._reflect.getOwnMetadata("design:paramtypes",o);return R||T?this._zipTypesAndAnnotations(R,T):m(o.length)}parameters(o){if(!Ua(o))return[];const a=gn(o);let f=this._ownParameters(o,a);return!f&&a!==Object&&(f=this.parameters(a)),f||[]}_ownAnnotations(o,a){if(o.annotations&&o.annotations!==a.annotations){let f=o.annotations;return"function"==typeof f&&f.annotations&&(f=f.annotations),f}return o.decorators&&o.decorators!==a.decorators?un(o.decorators):o.hasOwnProperty(Xi)?o[Xi]:null}annotations(o){if(!Ua(o))return[];const a=gn(o),f=this._ownAnnotations(o,a)||[];return(a!==Object?this.annotations(a):[]).concat(f)}_ownPropMetadata(o,a){if(o.propMetadata&&o.propMetadata!==a.propMetadata){let f=o.propMetadata;return"function"==typeof f&&f.propMetadata&&(f=f.propMetadata),f}if(o.propDecorators&&o.propDecorators!==a.propDecorators){const f=o.propDecorators,_={};return Object.keys(f).forEach(T=>{_[T]=un(f[T])}),_}return o.hasOwnProperty(Jr)?o[Jr]:null}propMetadata(o){if(!Ua(o))return{};const a=gn(o),f={};if(a!==Object){const T=this.propMetadata(a);Object.keys(T).forEach(R=>{f[R]=T[R]})}const _=this._ownPropMetadata(o,a);return _&&Object.keys(_).forEach(T=>{const R=[];f.hasOwnProperty(T)&&R.push(...f[T]),R.push(..._[T]),f[T]=R}),f}ownPropMetadata(o){return Ua(o)&&this._ownPropMetadata(o,gn(o))||{}}hasLifecycleHook(o,a){return o instanceof to&&a in o.prototype}guards(o){return{}}getter(o){return new Function("o","return o."+o+";")}setter(o){return new Function("o","v","return o."+o+" = v;")}method(o){return new Function("o","args",`if (!o.${o}) throw new Error('"${o}" is undefined');\n        return o.${o}.apply(o, args);`)}importUri(o){return"object"==typeof o&&o.filePath?o.filePath:`./${Ue(o)}`}resourceUri(o){return`./${Ue(o)}`}resolveIdentifier(o,a,f,_){return _}resolveEnum(o,a){return o[a]}}function un(r){return r?r.map(o=>new(0,o.type.annotationCls)(...o.args?o.args:[])):[]}function gn(r){const o=r.prototype?Object.getPrototypeOf(r.prototype):null;return(o?o.constructor:null)||Object}const $n={},Vn="__NG_DI_FLAG__",cr="ngTempTokenPath",Z=/\n/gm,Fe="__source",st=Le({provide:String,useValue:Le});let Ut;function Qt(r){const o=Ut;return Ut=r,o}function mn(r,o=Xt.Default){if(void 0===Ut)throw new bt(203,"");return null===Ut?Wn(r,void 0,o):Ut.get(r,o&Xt.Optional?null:void 0,o)}function xn(r,o=Xt.Default){return(function En(){return ln}()||mn)($e(r),o)}function Bn(r){throw new Error("invalid")}function hr(r){const o=[];for(let a=0;a<r.length;a++){const f=$e(r[a]);if(Array.isArray(f)){if(0===f.length)throw new bt(900,"");let _,T=Xt.Default;for(let R=0;R<f.length;R++){const z=f[R],X=ki(z);"number"==typeof X?-1===X?_=z.token:T|=X:_=z}o.push(xn(_,T))}else o.push(xn(f))}return o}function vi(r,o){return r[Vn]=o,r.prototype[Vn]=o,r}function ki(r){return r[Vn]}const Ei=vi(ji("Inject",r=>({token:r})),-1),Qi=vi(ji("Optional"),8),ko=vi(ji("Self"),2),vo=vi(ji("SkipSelf"),4),Xa=vi(ji("Host"),1);let Va,fu,ua=null;function za(){return ua=ua||new tn}function Ys(r){return ol(za().parameters(r))}function ol(r){return r.map(o=>function Ia(r){const o={token:null,attribute:null,host:!1,optional:!1,self:!1,skipSelf:!1};if(Array.isArray(r)&&r.length>0)for(let a=0;a<r.length;a++){const f=r[a];if(void 0===f)continue;const _=Object.getPrototypeOf(f);if(f instanceof Qi||"Optional"===_.ngMetadataName)o.optional=!0;else if(f instanceof vo||"SkipSelf"===_.ngMetadataName)o.skipSelf=!0;else if(f instanceof ko||"Self"===_.ngMetadataName)o.self=!0;else if(f instanceof Xa||"Host"===_.ngMetadataName)o.host=!0;else if(f instanceof Ei)o.token=f.token;else if(f instanceof Ja){if(void 0===f.attributeName)throw new Error("Attribute name must be defined.");o.attribute=f.attributeName}else o.token=f}else o.token=void 0===r||Array.isArray(r)&&0===r.length?null:r;return o}(o))}function Sa(){if(void 0===Va&&(Va=null,wr.trustedTypes))try{Va=wr.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch(r){}return Va}function Ru(r){var o;return(null===(o=Sa())||void 0===o?void 0:o.createHTML(r))||r}function Nc(){if(void 0===fu&&(fu=null,wr.trustedTypes))try{fu=wr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch(r){}return fu}function Yu(r){var o;return(null===(o=Nc())||void 0===o?void 0:o.createHTML(r))||r}function fc(r){var o;return(null===(o=Nc())||void 0===o?void 0:o.createScript(r))||r}function uh(r){var o;return(null===(o=Nc())||void 0===o?void 0:o.createScriptURL(r))||r}class Qa{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class pu extends Qa{getTypeName(){return"HTML"}}class Kp extends Qa{getTypeName(){return"Style"}}class Js extends Qa{getTypeName(){return"Script"}}class lh extends Qa{getTypeName(){return"URL"}}class fd extends Qa{getTypeName(){return"ResourceURL"}}function Cl(r){return r instanceof Qa?r.changingThisBreaksApplicationSecurity:r}function pc(r,o){const a=Fh(r);if(null!=a&&a!==o){if("ResourceURL"===a&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${a} (see https://g.co/ng/security#xss)`)}return a===o}function Fh(r){return r instanceof Qa&&r.getTypeName()||null}function Gf(r){return new pu(r)}function Fc(r){return new Kp(r)}function ch(r){return new Js(r)}function mu(r){return new lh(r)}function Bc(r){return new fd(r)}function ef(r){const o=new Bh(r);return function Wf(){try{return!!(new window.DOMParser).parseFromString(Ru(""),"text/html")}catch(r){return!1}}()?new qf(o):o}class qf{constructor(o){this.inertDocumentHelper=o}getInertBodyElement(o){o="<body><remove></remove>"+o;try{const a=(new window.DOMParser).parseFromString(Ru(o),"text/html").body;return null===a?this.inertDocumentHelper.getInertBodyElement(o):(a.removeChild(a.firstChild),a)}catch(a){return null}}}class Bh{constructor(o){if(this.defaultDoc=o,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const a=this.inertDocument.createElement("html");this.inertDocument.appendChild(a);const f=this.inertDocument.createElement("body");a.appendChild(f)}}getInertBodyElement(o){const a=this.inertDocument.createElement("template");if("content"in a)return a.innerHTML=Ru(o),a;const f=this.inertDocument.createElement("body");return f.innerHTML=Ru(o),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(f),f}stripCustomNsAttrs(o){const a=o.attributes;for(let _=a.length-1;0<_;_--){const R=a.item(_).name;("xmlns:ns1"===R||0===R.indexOf("ns1:"))&&o.removeAttribute(R)}let f=o.firstChild;for(;f;)f.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(f),f=f.nextSibling}}const Uc=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,bo=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ul(r){return(r=String(r)).match(Uc)||r.match(bo)?r:"unsafe:"+r}function tf(r){return(r=String(r)).split(",").map(o=>Ul(o.trim())).join(", ")}function lo(r){const o={};for(const a of r.split(","))o[a]=!0;return o}function mc(...r){const o={};for(const a of r)for(const f in a)a.hasOwnProperty(f)&&(o[f]=!0);return o}const $i=lo("area,br,col,hr,img,wbr"),Go=lo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),pd=lo("rp,rt"),hh=mc($i,mc(Go,lo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),mc(pd,lo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),mc(pd,Go)),gd=lo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),gc=lo("srcset"),yd=mc(gd,gc,lo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),lo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),yc=lo("script,style,template");class Uh{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(o){let a=o.firstChild,f=!0;for(;a;)if(a.nodeType===Node.ELEMENT_NODE?f=this.startElement(a):a.nodeType===Node.TEXT_NODE?this.chars(a.nodeValue):this.sanitizedSomething=!0,f&&a.firstChild)a=a.firstChild;else for(;a;){a.nodeType===Node.ELEMENT_NODE&&this.endElement(a);let _=this.checkClobberedElement(a,a.nextSibling);if(_){a=_;break}a=this.checkClobberedElement(a,a.parentNode)}return this.buf.join("")}startElement(o){const a=o.nodeName.toLowerCase();if(!hh.hasOwnProperty(a))return this.sanitizedSomething=!0,!yc.hasOwnProperty(a);this.buf.push("<"),this.buf.push(a);const f=o.attributes;for(let _=0;_<f.length;_++){const T=f.item(_),R=T.name,z=R.toLowerCase();if(!yd.hasOwnProperty(z)){this.sanitizedSomething=!0;continue}let X=T.value;gd[z]&&(X=Ul(X)),gc[z]&&(X=tf(X)),this.buf.push(" ",R,'="',zh(X),'"')}return this.buf.push(">"),!0}endElement(o){const a=o.nodeName.toLowerCase();hh.hasOwnProperty(a)&&!$i.hasOwnProperty(a)&&(this.buf.push("</"),this.buf.push(a),this.buf.push(">"))}chars(o){this.buf.push(zh(o))}checkClobberedElement(o,a){if(a&&(o.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${o.outerHTML}`);return a}}const Zl=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,dh=/([^\#-~ |!])/g;function zh(r){return r.replace(/&/g,"&amp;").replace(Zl,function(o){return"&#"+(1024*(o.charCodeAt(0)-55296)+(o.charCodeAt(1)-56320)+65536)+";"}).replace(dh,function(o){return"&#"+o.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let zc;function yu(r,o){let a=null;try{zc=zc||ef(r);let f=o?String(o):"";a=zc.getInertBodyElement(f);let _=5,T=f;do{if(0===_)throw new Error("Failed to sanitize html because the input is unstable");_--,f=T,T=a.innerHTML,a=zc.getInertBodyElement(f)}while(f!==T);return Ru((new Uh).sanitizeChildren(rf(a)||a))}finally{if(a){const f=rf(a)||a;for(;f.firstChild;)f.removeChild(f.firstChild)}}}function rf(r){return"content"in r&&function Kf(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Vs=(()=>((Vs=Vs||{})[Vs.NONE=0]="NONE",Vs[Vs.HTML=1]="HTML",Vs[Vs.STYLE=2]="STYLE",Vs[Vs.SCRIPT=3]="SCRIPT",Vs[Vs.URL=4]="URL",Vs[Vs.RESOURCE_URL=5]="RESOURCE_URL",Vs))();function of(r){const o=Jl();return o?Yu(o.sanitize(Vs.HTML,r)||""):pc(r,"HTML")?Yu(Cl(r)):yu(ps(),ct(r))}function Yf(r){const o=Jl();return o?o.sanitize(Vs.STYLE,r)||"":pc(r,"Style")?Cl(r):ct(r)}function _c(r){const o=Jl();return o?o.sanitize(Vs.URL,r)||"":pc(r,"URL")?Cl(r):Ul(ct(r))}function fh(r){const o=Jl();if(o)return uh(o.sanitize(Vs.RESOURCE_URL,r)||"");if(pc(r,"ResourceURL"))return uh(Cl(r));throw new bt(904,"")}function Jf(r){const o=Jl();if(o)return fc(o.sanitize(Vs.SCRIPT,r)||"");if(pc(r,"Script"))return fc(Cl(r));throw new bt(905,"")}function Vh(r){return Ru(r[0])}function Da(r){return function Ku(r){var o;return(null===(o=Sa())||void 0===o?void 0:o.createScriptURL(r))||r}(r[0])}function Xf(r,o,a){return function _d(r,o){return"src"===o&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===o&&("base"===r||"link"===r)?fh:_c}(o,a)(r)}function Jl(){const r=Nn();return r&&r[12]}const vd="__ngContext__";function eu(r,o){r[vd]=o}function _u(r){const o=function Dl(r){return r[vd]||null}(r);return o?Array.isArray(o)?o:o.lView:null}function bc(r){return r.ngOriginalError}function ku(r,...o){r.error(...o)}class jc{constructor(){this._console=console}handleError(o){const a=this._findOriginalError(o),f=function Vc(r){return r&&r.ngErrorLogger||ku}(o);f(this._console,"ERROR",o),a&&f(this._console,"ORIGINAL ERROR",a)}_findOriginalError(o){let a=o&&bc(o);for(;a&&bc(a);)a=bc(a);return a||null}}const la=/^>|^->|<!--|-->|--!>|<!-$/g,gh=/(<|>)/;const tu=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(wr))();function np(r){return r.ownerDocument.defaultView}function A(r){return r.ownerDocument}function b(r){return r.ownerDocument.body}function N(r){return r instanceof Function?r():r}var ar=(()=>((ar=ar||{})[ar.Important=1]="Important",ar[ar.DashCase=2]="DashCase",ar))();let Lr;function ai(r,o){return Lr(r,o)}function Un(r){const o=r[3];return Ji(o)?o[3]:o}function Xl(r){return Ju(r[13])}function ea(r){return Ju(r[4])}function Ju(r){for(;null!==r&&!Ji(r);)r=r[4];return r}function vu(r,o,a,f,_){if(null!=f){let T,R=!1;Ji(f)?T=f:fo(f)&&(R=!0,f=f[0]);const z=ne(f);0===r&&null!==a?null==_?Qp(o,a,z):vh(o,a,z,_||null,!0):1===r&&null!==a?vh(o,a,z,_||null,!0):2===r?df(o,z,R):3===r&&o.destroyNode(z),null!=T&&function bh(r,o,a,f,_){const T=a[7];T!==ne(a)&&vu(o,r,f,T,_);for(let z=10;z<a.length;z++){const X=a[z];Wh(X[1],X,r,o,f,T)}}(o,r,T,a,_)}}function wc(r,o){return qr(r)?r.createText(o):r.createTextNode(o)}function ca(r,o,a){qr(r)?r.setValue(o,a):o.textContent=a}function wd(r,o){return r.createComment(function Bi(r){return r.replace(la,o=>o.replace(gh,"\u200b$1\u200b"))}(o))}function ru(r,o,a){if(qr(r))return r.createElement(o,a);{const f=null!==a?function qa(r){const o=r.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":o===wo?"http://www.w3.org/1998/MathML/":null}(a):null;return null===f?r.createElement(o):r.createElementNS(f,o)}}function Hc(r,o){const a=r[9],f=a.indexOf(o),_=o[3];1024&o[2]&&(o[2]&=-1025,go(_,-1)),a.splice(f,1)}function Ed(r,o){if(r.length<=10)return;const a=10+o,f=r[a];if(f){const _=f[17];null!==_&&_!==r&&Hc(_,f),o>0&&(r[a-1][4]=f[4]);const T=h(r,10+o);!function $h(r,o){Wh(r,o,o[11],2,null,null),o[0]=null,o[6]=null}(f[1],f);const R=T[19];null!==R&&R.detachView(T[1]),f[3]=null,f[4]=null,f[2]&=-129}return f}function _h(r,o){if(!(256&o[2])){const a=o[11];qr(a)&&a.destroyNode&&Wh(r,o,a,3,null,null),function rp(r){let o=r[13];if(!o)return $c(r[1],r);for(;o;){let a=null;if(fo(o))a=o[13];else{const f=o[10];f&&(a=f)}if(!a){for(;o&&!o[4]&&o!==r;)fo(o)&&$c(o[1],o),o=o[3];null===o&&(o=r),fo(o)&&$c(o[1],o),a=o&&o[4]}o=a}}(o)}}function $c(r,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function Td(r,o){let a;if(null!=r&&null!=(a=r.destroyHooks))for(let f=0;f<a.length;f+=2){const _=o[a[f]];if(!(_ instanceof Gn)){const T=a[f+1];if(Array.isArray(T))for(let R=0;R<T.length;R+=2){const z=_[T[R]],X=T[R+1];try{X.call(z)}finally{}}else try{T.call(_)}finally{}}}}(r,o),function Id(r,o){const a=r.cleanup,f=o[7];let _=-1;if(null!==a)for(let T=0;T<a.length-1;T+=2)if("string"==typeof a[T]){const R=a[T+1],z="function"==typeof R?R(o):ne(o[R]),X=f[_=a[T+2]],Ce=a[T+3];"boolean"==typeof Ce?z.removeEventListener(a[T],X,Ce):Ce>=0?f[_=Ce]():f[_=-Ce].unsubscribe(),T+=2}else{const R=f[_=a[T+1]];a[T].call(R)}if(null!==f){for(let T=_+1;T<f.length;T++)f[T]();o[7]=null}}(r,o),1===o[1].type&&qr(o[11])&&o[11].destroy();const a=o[17];if(null!==a&&Ji(o[3])){a!==o[3]&&Hc(a,o);const f=o[19];null!==f&&f.detachView(r)}}}function ip(r,o,a){return cf(r,o.parent,a)}function cf(r,o,a){let f=o;for(;null!==f&&40&f.type;)f=(o=f).parent;if(null===f)return a[0];if(2&f.flags){const _=r.data[f.directiveStart].encapsulation;if(_===zt.None||_===zt.Emulated)return null}return On(f,a)}function vh(r,o,a,f,_){qr(r)?r.insertBefore(o,a,f,_):o.insertBefore(a,f,_)}function Qp(r,o,a){qr(r)?r.appendChild(o,a):o.appendChild(a)}function em(r,o,a,f,_){null!==f?vh(r,o,a,f,_):Qp(r,o,a)}function Gh(r,o){return qr(r)?r.parentNode(o):o.parentNode}function sp(r,o,a){return bu(r,o,a)}function Sd(r,o,a){return 40&r.type?On(r,a):null}let qh,bu=Sd;function Ec(r,o){bu=r,qh=o}function Cd(r,o,a,f){const _=ip(r,f,o),T=o[11],z=sp(f.parent||o[6],f,o);if(null!=_)if(Array.isArray(a))for(let X=0;X<a.length;X++)em(T,_,a[X],z,!1);else em(T,_,a,z,!1);void 0!==qh&&qh(T,f,o,a,_)}function hf(r,o){if(null!==o){const a=o.type;if(3&a)return On(o,r);if(4&a)return Ml(-1,r[o.index]);if(8&a){const f=o.child;if(null!==f)return hf(r,f);{const _=r[o.index];return Ji(_)?Ml(-1,_):ne(_)}}if(32&a)return ai(o,r)()||ne(r[o.index]);{const f=Gc(r,o);return null!==f?Array.isArray(f)?f[0]:hf(Un(r[16]),f):hf(r,o.next)}}return null}function Gc(r,o){return null!==o?r[16][6].projection[o.projection]:null}function Ml(r,o){const a=10+r+1;if(a<o.length){const f=o[a],_=f[1].firstChild;if(null!==_)return hf(f,_)}return o[7]}function df(r,o,a){const f=Gh(r,o);f&&function Om(r,o,a,f){qr(r)?r.removeChild(o,a,f):o.removeChild(a)}(r,f,o,a)}function Ic(r,o,a,f,_,T,R){for(;null!=a;){const z=f[a.index],X=a.type;if(R&&0===o&&(z&&eu(ne(z),f),a.flags|=4),64!=(64&a.flags))if(8&X)Ic(r,o,a.child,f,_,T,!1),vu(o,r,_,z,T);else if(32&X){const Ce=ai(a,f);let He;for(;He=Ce();)vu(o,r,_,He,T);vu(o,r,_,z,T)}else 16&X?ap(r,o,f,a,_,T):vu(o,r,_,z,T);a=R?a.projectionNext:a.next}}function Wh(r,o,a,f,_,T){Ic(a,f,r.firstChild,o,_,T,!1)}function ap(r,o,a,f,_,T){const R=a[16],X=R[6].projection[f.projection];if(Array.isArray(X))for(let Ce=0;Ce<X.length;Ce++)vu(o,r,_,X[Ce],T);else Ic(r,o,X,R[3],_,T,!0)}function up(r,o,a){qr(r)?r.setAttribute(o,"style",a):o.style.cssText=a}function Yh(r,o,a){qr(r)?""===a?r.removeAttribute(o,"class"):r.setAttribute(o,"class",a):o.className=a}function lp(r,o,a){let f=r.length;for(;;){const _=r.indexOf(o,a);if(-1===_)return _;if(0===_||r.charCodeAt(_-1)<=32){const T=o.length;if(_+T===f||r.charCodeAt(_+T)<=32)return _}a=_+1}}const Jh="ng-template";function ff(r,o,a){let f=0;for(;f<r.length;){let _=r[f++];if(a&&"class"===_){if(_=r[f],-1!==lp(_.toLowerCase(),o,0))return!0}else if(1===_){for(;f<r.length&&"string"==typeof(_=r[f++]);)if(_.toLowerCase()===o)return!0;return!1}}return!1}function ro(r){return 4===r.type&&r.value!==Jh}function Dd(r,o,a){return o===(4!==r.type||a?r.value:Jh)}function cp(r,o,a){let f=4;const _=r.attrs||[],T=function hp(r){for(let o=0;o<r.length;o++)if(Ba(r[o]))return o;return r.length}(_);let R=!1;for(let z=0;z<o.length;z++){const X=o[z];if("number"!=typeof X){if(!R)if(4&f){if(f=2|1&f,""!==X&&!Dd(r,X,a)||""===X&&1===o.length){if(Xu(f))return!1;R=!0}}else{const Ce=8&f?X:o[++z];if(8&f&&null!==r.attrs){if(!ff(r.attrs,Ce,a)){if(Xu(f))return!1;R=!0}continue}const It=wg(8&f?"class":X,_,ro(r),a);if(-1===It){if(Xu(f))return!1;R=!0;continue}if(""!==Ce){let Gt;Gt=It>T?"":_[It+1].toLowerCase();const hn=8&f?Gt:null;if(hn&&-1!==lp(hn,Ce,0)||2&f&&Ce!==Gt){if(Xu(f))return!1;R=!0}}}}else{if(!R&&!Xu(f)&&!Xu(X))return!1;if(R&&Xu(X))continue;R=!1,f=X|1&f}}return Xu(f)||R}function Xu(r){return 0==(1&r)}function wg(r,o,a,f){if(null===o)return-1;let _=0;if(f||!a){let T=!1;for(;_<o.length;){const R=o[_];if(R===r)return _;if(3===R||6===R)T=!0;else{if(1===R||2===R){let z=o[++_];for(;"string"==typeof z;)z=o[++_];continue}if(4===R)break;if(0===R){_+=4;continue}}_+=T?1:2}return-1}return function xg(r,o){let a=r.indexOf(4);if(a>-1)for(a++;a<r.length;){const f=r[a];if("number"==typeof f)return-1;if(f===o)return a;a++}return-1}(o,r)}function tm(r,o,a=!1){for(let f=0;f<o.length;f++)if(cp(r,o[f],a))return!0;return!1}function Lm(r,o){e:for(let a=0;a<o.length;a++){const f=o[a];if(r.length===f.length){for(let _=0;_<r.length;_++)if(r[_]!==f[_])continue e;return!0}}return!1}function dp(r,o){return r?":not("+o.trim()+")":o}function fp(r){let o=r[0],a=1,f=2,_="",T=!1;for(;a<r.length;){let R=r[a];if("string"==typeof R)if(2&f){const z=r[++a];_+="["+R+(z.length>0?'="'+z+'"':"")+"]"}else 8&f?_+="."+R:4&f&&(_+=" "+R);else""!==_&&!Xu(R)&&(o+=dp(T,_),_=""),f=R,T=T||!Xu(f);a++}return""!==_&&(o+=dp(T,_)),o}const Ii={};function mf(r){qc(Cr(),Nn(),To()+r,ya())}function qc(r,o,a,f){if(!f)if(3==(3&o[2])){const T=r.preOrderCheckHooks;null!==T&&Ze(o,T,a)}else{const T=r.preOrderHooks;null!==T&&Mt(o,T,0,a)}Ai(a)}function Tc(r,o){return r<<17|o<<2}function Vl(r){return r>>17&32767}function Pd(r){return 2|r}function Sc(r){return(131068&r)>>2}function gf(r,o){return-131069&r|o<<2}function yf(r){return 1|r}function pr(r,o){const a=r.contentQueries;if(null!==a)for(let f=0;f<a.length;f+=2){const _=a[f],T=a[f+1];if(-1!==T){const R=r.data[T];$u(_),R.contentQueries(2,o[T],T)}}}function ri(r,o,a,f,_,T,R,z,X,Ce){const He=o.blueprint.slice();return He[0]=_,He[2]=140|f,ms(He),He[3]=He[15]=r,He[8]=a,He[10]=R||r&&r[10],He[11]=z||r&&r[11],He[12]=X||r&&r[12]||null,He[9]=Ce||r&&r[9]||null,He[6]=T,He[16]=2==o.type?r[16]:He,He}function Nr(r,o,a,f,_){let T=r.data[o];if(null===T)T=xr(r,o,a,f,_),function Au(){return Rr.lFrame.inI18n}()&&(T.flags|=64);else if(64&T.type){T.type=a,T.value=f,T.attrs=_;const R=Wa();T.injectorIndex=null===R?-1:R.injectorIndex}return as(T,!0),T}function xr(r,o,a,f,_){const T=Ws(),R=zu(),X=r.data[o]=function _s(r,o,a,f,_,T){return{type:a,index:f,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:_,attrs:T,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,R?T:T&&T.parent,a,o,f,_);return null===r.firstChild&&(r.firstChild=X),null!==T&&(R?null==T.child&&null!==X.parent&&(T.child=X):null===T.next&&(T.next=X)),X}function ti(r,o,a,f){if(0===a)return-1;const _=o.length;for(let T=0;T<a;T++)o.push(f),r.blueprint.push(f),r.data.push(null);return _}function Kr(r,o,a){ba(o);try{const f=r.viewQuery;null!==f&&id(1,f,a);const _=r.template;null!==_&&Gi(r,o,_,1,a),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&pr(r,o),r.staticViewQueries&&id(2,r.viewQuery,a);const T=r.components;null!==T&&function mr(r,o){for(let a=0;a<o.length;a++)ed(r,o[a])}(o,T)}catch(f){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),f}finally{o[2]&=-5,lu()}}function yi(r,o,a,f){const _=o[2];if(256==(256&_))return;ba(o);const T=ya();try{ms(o),Za(r.bindingStartIndex),null!==a&&Gi(r,o,a,2,f);const R=3==(3&_);if(!T)if(R){const Ce=r.preOrderCheckHooks;null!==Ce&&Ze(o,Ce,null)}else{const Ce=r.preOrderHooks;null!==Ce&&Mt(o,Ce,0,null),$t(o,0)}if(function Th(r){for(let o=Xl(r);null!==o;o=ea(o)){if(!o[2])continue;const a=o[9];for(let f=0;f<a.length;f++){const _=a[f],T=_[3];0==(1024&_[2])&&go(T,1),_[2]|=1024}}}(o),function Pc(r){for(let o=Xl(r);null!==o;o=ea(o))for(let a=10;a<o.length;a++){const f=o[a],_=f[1];mo(f)&&yi(_,f,_.template,f[8])}}(o),null!==r.contentQueries&&pr(r,o),!T)if(R){const Ce=r.contentCheckHooks;null!==Ce&&Ze(o,Ce)}else{const Ce=r.contentHooks;null!==Ce&&Mt(o,Ce,1),$t(o,1)}!function kr(r,o){const a=r.hostBindingOpCodes;if(null!==a)try{for(let f=0;f<a.length;f++){const _=a[f];if(_<0)Ai(~_);else{const T=_,R=a[++f],z=a[++f];ia(R,T),z(2,o[T])}}}finally{Ai(-1)}}(r,o);const z=r.components;null!==z&&function Ur(r,o){for(let a=0;a<o.length;a++)gp(r,o[a])}(o,z);const X=r.viewQuery;if(null!==X&&id(2,X,f),!T)if(R){const Ce=r.viewCheckHooks;null!==Ce&&Ze(o,Ce)}else{const Ce=r.viewHooks;null!==Ce&&Mt(o,Ce,2),$t(o,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),T||(o[2]&=-73),1024&o[2]&&(o[2]&=-1025,go(o[3],-1))}finally{lu()}}function Or(r,o,a,f){const _=o[10],T=!ya(),R=Qr(o);try{T&&!R&&_.begin&&_.begin(),R&&Kr(r,o,f),yi(r,o,a,f)}finally{T&&!R&&_.end&&_.end()}}function Gi(r,o,a,f,_){const T=To(),R=2&f;try{Ai(-1),R&&o.length>20&&qc(r,o,20,ya()),a(f,_)}finally{Ai(T)}}function zo(r,o,a){if(ou(o)){const _=o.directiveEnd;for(let T=o.directiveStart;T<_;T++){const R=r.data[T];R.contentQueries&&R.contentQueries(1,a[T],T)}}}function Wo(r,o,a){!Na()||(function vs(r,o,a,f){const _=a.directiveStart,T=a.directiveEnd;r.firstCreatePass||Zn(a,o),eu(f,o);const R=a.initialInputs;for(let z=_;z<T;z++){const X=r.data[z],Ce=Io(X);Ce&&tc(o,a,X);const He=Pr(o,r,z,a);eu(He,o),null!==R&&mp(0,z-_,He,X,0,R),Ce&&(ni(a.index,o)[8]=He)}}(r,o,a,On(a,o)),128==(128&a.flags)&&function Dc(r,o,a){const f=a.directiveStart,_=a.directiveEnd,R=a.index,z=function Hu(){return Rr.lFrame.currentDirectiveIndex}();try{Ai(R);for(let X=f;X<_;X++){const Ce=r.data[X],He=o[X];_a(X),(null!==Ce.hostBindings||0!==Ce.hostVars||null!==Ce.hostAttrs)&&al(Ce,He)}}finally{Ai(-1),_a(z)}}(r,o,a))}function Vo(r,o,a=On){const f=o.localNames;if(null!==f){let _=o.index+1;for(let T=0;T<f.length;T+=2){const R=f[T+1],z=-1===R?a(o,r):r[R];r[_++]=z}}}function co(r){const o=r.tView;return null===o||o.incompleteFirstPass?r.tView=Zo(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):o}function Zo(r,o,a,f,_,T,R,z,X,Ce){const He=20+f,It=He+_,Gt=function ha(r,o){const a=[];for(let f=0;f<o;f++)a.push(f<r?null:Ii);return a}(He,It),hn="function"==typeof Ce?Ce():Ce;return Gt[1]={type:r,blueprint:Gt,template:a,queries:null,viewQuery:z,declTNode:o,data:Gt.slice().fill(null,He),bindingStartIndex:He,expandoStartIndex:It,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof T?T():T,pipeRegistry:"function"==typeof R?R():R,firstChild:null,schemas:X,consts:hn,incompleteFirstPass:!1}}function iu(r,o,a,f){const _=Jc(o);null===a?_.push(f):(_.push(a),r.firstCreatePass&&Fd(r).push(f,_.length-1))}function Os(r,o,a){for(let f in r)if(r.hasOwnProperty(f)){const _=r[f];(a=null===a?{}:a).hasOwnProperty(f)?a[f].push(o,_):a[f]=[o,_]}return a}function ui(r,o,a,f,_,T,R,z){const X=On(o,a);let He,Ce=o.inputs;!z&&null!=Ce&&(He=Ce[f])?(Ef(r,a,He,f,_),ns(o)&&function Ui(r,o){const a=ni(o,r);16&a[2]||(a[2]|=64)}(a,o.index)):3&o.type&&(f=function Do(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(f),_=null!=R?R(_,o.value||"",f):_,qr(T)?T.setProperty(X,f,_):rr(f)||(X.setProperty?X.setProperty(f,_):X[f]=_))}function Hl(r,o,a,f){let _=!1;if(Na()){const T=function Ih(r,o,a){const f=r.directiveRegistry;let _=null;if(f)for(let T=0;T<f.length;T++){const R=f[T];tm(a,R.selectors,!1)&&(_||(_=[]),M(Zn(a,o),r,R.type),Io(R)?(Ac(r,a),_.unshift(R)):_.push(R))}return _}(r,o,a),R=null===f?null:{"":-1};if(null!==T){_=!0,Zc(a,r.data.length,T.length);for(let He=0;He<T.length;He++){const It=T[He];It.providersResolver&&It.providersResolver(It)}let z=!1,X=!1,Ce=ti(r,o,T.length,null);for(let He=0;He<T.length;He++){const It=T[He];a.mergedAttrs=Gu(a.mergedAttrs,It.hostAttrs),Mc(r,a,o,Ce,It),Qu(Ce,It,R),null!==It.contentQueries&&(a.flags|=8),(null!==It.hostBindings||null!==It.hostAttrs||0!==It.hostVars)&&(a.flags|=128);const Gt=It.type.prototype;!z&&(Gt.ngOnChanges||Gt.ngOnInit||Gt.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(a.index),z=!0),!X&&(Gt.ngOnChanges||Gt.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(a.index),X=!0),Ce++}!function Ti(r,o){const f=o.directiveEnd,_=r.data,T=o.attrs,R=[];let z=null,X=null;for(let Ce=o.directiveStart;Ce<f;Ce++){const He=_[Ce],It=He.inputs,Gt=null===T||ro(o)?null:Kc(It,T);R.push(Gt),z=Os(It,Ce,z),X=Os(He.outputs,Ce,X)}null!==z&&(z.hasOwnProperty("class")&&(o.flags|=16),z.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=R,o.inputs=z,o.outputs=X}(r,a)}R&&function ec(r,o,a){if(o){const f=r.localNames=[];for(let _=0;_<o.length;_+=2){const T=a[o[_+1]];if(null==T)throw new bt(-301,`Export of name '${o[_+1]}' not found!`);f.push(o[_],T)}}}(a,f,R)}return a.mergedAttrs=Gu(a.mergedAttrs,a.attrs),_}function Nu(r,o,a,f,_,T){const R=T.hostBindings;if(R){let z=r.hostBindingOpCodes;null===z&&(z=r.hostBindingOpCodes=[]);const X=~o.index;(function Cc(r){let o=r.length;for(;o>0;){const a=r[--o];if("number"==typeof a&&a<0)return a}return 0})(z)!=X&&z.push(X),z.push(f,_,R)}}function al(r,o){null!==r.hostBindings&&r.hostBindings(1,o)}function Ac(r,o){o.flags|=2,(r.components||(r.components=[])).push(o.index)}function Qu(r,o,a){if(a){if(o.exportAs)for(let f=0;f<o.exportAs.length;f++)a[o.exportAs[f]]=r;Io(o)&&(a[""]=r)}}function Zc(r,o,a){r.flags|=1,r.directiveStart=o,r.directiveEnd=o+a,r.providerIndexes=o}function Mc(r,o,a,f,_){r.data[f]=_;const T=_.factory||(_.factory=is(_.type)),R=new Gn(T,Io(_),null);r.blueprint[f]=R,a[f]=R,Nu(r,o,0,f,ti(r,a,_.hostVars,Ii),_)}function tc(r,o,a){const f=On(o,r),_=co(a),T=r[10],R=nd(r,ri(r,_,null,a.onPush?64:16,f,o,T,T.createRenderer(f,a),null,null));r[o.index]=R}function ul(r,o,a,f,_,T){const R=On(r,o);nc(o[11],R,T,r.value,a,f,_)}function nc(r,o,a,f,_,T,R){if(null==T)qr(r)?r.removeAttribute(o,_,a):o.removeAttribute(_);else{const z=null==R?ct(T):R(T,f||"",_);qr(r)?r.setAttribute(o,_,z,a):a?o.setAttributeNS(a,_,z):o.setAttribute(_,z)}}function mp(r,o,a,f,_,T){const R=T[o];if(null!==R){const z=f.setInput;for(let X=0;X<R.length;){const Ce=R[X++],He=R[X++],It=R[X++];null!==z?f.setInput(a,It,Ce,He):a[He]=It}}}function Kc(r,o){let a=null,f=0;for(;f<o.length;){const _=o[f];if(0!==_)if(5!==_){if("number"==typeof _)break;r.hasOwnProperty(_)&&(null===a&&(a=[]),a.push(_,r[_],o[f+1])),f+=2}else f+=2;else f+=4}return a}function Yc(r,o,a,f){return new Array(r,!0,!1,o,null,0,f,a,null,null)}function gp(r,o){const a=ni(o,r);if(mo(a)){const f=a[1];80&a[2]?yi(f,a,f.template,a[8]):a[5]>0&&Od(a)}}function Od(r){for(let f=Xl(r);null!==f;f=ea(f))for(let _=10;_<f.length;_++){const T=f[_];if(1024&T[2]){const R=T[1];yi(R,T,R.template,T[8])}else T[5]>0&&Od(T)}const a=r[1].components;if(null!==a)for(let f=0;f<a.length;f++){const _=ni(a[f],r);mo(_)&&_[5]>0&&Od(_)}}function ed(r,o){const a=ni(o,r),f=a[1];(function td(r,o){for(let a=o.length;a<r.blueprint.length;a++)o.push(r.blueprint[a])})(f,a),Kr(f,a,a[8])}function nd(r,o){return r[13]?r[14][4]=o:r[13]=o,r[14]=o,o}function Sh(r){for(;r;){r[2]|=64;const o=Un(r);if(jo(r)&&!o)return r;r=o}return null}function rd(r,o,a){const f=o[10];f.begin&&f.begin();try{yi(r,o,r.template,a)}catch(_){throw yp(o,_),_}finally{f.end&&f.end()}}function Dh(r){!function Ch(r){for(let o=0;o<r.components.length;o++){const a=r.components[o],f=_u(a),_=f[1];Or(_,f,_.template,a)}}(r[8])}function id(r,o,a){$u(0),o(r,a)}const wf=(()=>Promise.resolve(null))();function Jc(r){return r[7]||(r[7]=[])}function Fd(r){return r.cleanup||(r.cleanup=[])}function xf(r,o,a){return(null===r||Io(r))&&(a=function et(r){for(;Array.isArray(r);){if("object"==typeof r[1])return r;r=r[0]}return null}(a[o.index])),a[11]}function yp(r,o){const a=r[9],f=a?a.get(jc,null):null;f&&f.handleError(o)}function Ef(r,o,a,f,_){for(let T=0;T<a.length;){const R=a[T++],z=a[T++],X=o[R],Ce=r.data[R];null!==Ce.setInput?Ce.setInput(X,_,f,z):X[z]=_}}function rc(r,o,a){const f=vn(o,r);ca(r[11],f,a)}function Bd(r,o,a){let f=a?r.styles:null,_=a?r.classes:null,T=0;if(null!==o)for(let R=0;R<o.length;R++){const z=o[R];"number"==typeof z?T=z:1==T?_=fe(_,z):2==T&&(f=fe(f,z+": "+o[++R]+";"))}a?r.styles=f:r.stylesWithoutHost=f,a?r.classes=_:r.classesWithoutHost=_}const sm=new _o("INJECTOR",-1);class oc{get(o,a=$n){if(a===$n){const f=new Error(`NullInjectorError: No provider for ${Ue(o)}!`);throw f.name="NullInjectorError",f}return a}}const If=new _o("Set Injector scope."),Ah={},_p={};let gl;function Tf(){return void 0===gl&&(gl=new oc),gl}function Mh(r,o=null,a=null,f){const _=od(r,o,a,f);return _._resolveInjectorDefTypes(),_}function od(r,o=null,a=null,f){return new zd(r,a,o||Tf(),f)}class zd{constructor(o,a,f,_=null){this.parent=f,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const T=[];a&&l(a,z=>this.processProvider(z,o,a)),l([o],z=>this.processInjectorType(z,[],T)),this.records.set(sm,Xc(void 0,this));const R=this.records.get(If);this.scope=null!=R?R.value:null,this.source=_||("object"==typeof o?null:Ue(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,a=$n,f=Xt.Default){this.assertNotDestroyed();const _=Qt(this),T=bn(void 0);try{if(!(f&Xt.SkipSelf)){let z=this.records.get(o);if(void 0===z){const X=function Eg(r){return"function"==typeof r||"object"==typeof r&&r instanceof _o}(o)&&Sr(o);z=X&&this.injectableDefInScope(X)?Xc(Rc(o),Ah):null,this.records.set(o,z)}if(null!=z)return this.hydrate(o,z)}return(f&Xt.Self?Tf():this.parent).get(o,a=f&Xt.Optional&&a===$n?null:a)}catch(R){if("NullInjectorError"===R.name){if((R[cr]=R[cr]||[]).unshift(Ue(o)),_)throw R;return function Hi(r,o,a,f){const _=r[cr];throw o[Fe]&&_.unshift(o[Fe]),r.message=function $o(r,o,a,f=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.substr(2):r;let _=Ue(o);if(Array.isArray(o))_=o.map(Ue).join(" -> ");else if("object"==typeof o){let T=[];for(let R in o)if(o.hasOwnProperty(R)){let z=o[R];T.push(R+":"+("string"==typeof z?JSON.stringify(z):Ue(z)))}_=`{${T.join(", ")}}`}return`${a}${f?"("+f+")":""}[${_}]: ${r.replace(Z,"\n  ")}`}("\n"+r.message,_,a,f),r.ngTokenPath=_,r[cr]=null,r}(R,o,"R3InjectorError",this.source)}throw R}finally{bn(T),Qt(_)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((f,_)=>o.push(Ue(_))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new bt(205,"")}processInjectorType(o,a,f){if(!(o=$e(o)))return!1;let _=ii(o);const T=null==_&&o.ngModule||void 0,R=void 0===T?o:T,z=-1!==f.indexOf(R);if(void 0!==T&&(_=ii(T)),null==_)return!1;if(null!=_.imports&&!z){let He;f.push(R);try{l(_.imports,It=>{this.processInjectorType(It,a,f)&&(void 0===He&&(He=[]),He.push(It))})}finally{}if(void 0!==He)for(let It=0;It<He.length;It++){const{ngModule:Gt,providers:hn}=He[It];l(hn,Ln=>this.processProvider(Ln,Gt,hn||Te))}}this.injectorDefTypes.add(R);const X=is(R)||(()=>new R);this.records.set(R,Xc(X,Ah));const Ce=_.providers;if(null!=Ce&&!z){const He=o;l(Ce,It=>this.processProvider(It,He,Ce))}return void 0!==T&&void 0!==o.providers}processProvider(o,a,f){let _=Pa(o=$e(o))?o:$e(o&&o.provide);const T=function sd(r,o,a){return sc(r)?Xc(void 0,r.useValue):Xc(um(r),Ah)}(o);if(Pa(o)||!0!==o.multi)this.records.get(_);else{let R=this.records.get(_);R||(R=Xc(void 0,Ah,!0),R.factory=()=>hr(R.multi),this.records.set(_,R)),_=o,R.multi.push(o)}this.records.set(_,T)}hydrate(o,a){return a.value===Ah&&(a.value=_p,a.value=a.factory()),"object"==typeof a.value&&a.value&&function $l(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(a.value)&&this.onDestroy.add(a.value),a.value}injectableDefInScope(o){if(!o.providedIn)return!1;const a=$e(o.providedIn);return"string"==typeof a?"any"===a||a===this.scope:this.injectorDefTypes.has(a)}}function Rc(r){const o=Sr(r),a=null!==o?o.factory:is(r);if(null!==a)return a;if(r instanceof _o)throw new bt(204,"");if(r instanceof Function)return function am(r){const o=r.length;if(o>0)throw m(o,"?"),new bt(204,"");const a=function vr(r){const o=r&&(r[fi]||r[pi]);if(o){const a=function qi(r){if(r.hasOwnProperty("name"))return r.name;const o=(""+r).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${a}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${a}" class.`),o}return null}(r);return null!==a?()=>a.factory(r):()=>new r}(r);throw new bt(204,"")}function um(r,o,a){let f;if(Pa(r)){const _=$e(r);return is(_)||Rc(_)}if(sc(r))f=()=>$e(r.useValue);else if(function Bm(r){return!(!r||!r.useFactory)}(r))f=()=>r.useFactory(...hr(r.deps||[]));else if(function vp(r){return!(!r||!r.useExisting)}(r))f=()=>xn($e(r.useExisting));else{const _=$e(r&&(r.useClass||r.provide));if(!function Um(r){return!!r.deps}(r))return is(_)||Rc(_);f=()=>new _(...hr(r.deps))}return f}function Xc(r,o,a=!1){return{factory:r,value:o,multi:a?[]:void 0}}function sc(r){return null!==r&&"object"==typeof r&&st in r}function Pa(r){return"function"==typeof r}let ll=(()=>{class r{static create(a,f){var _;if(Array.isArray(a))return Mh({name:""},f,a,"");{const T=null!==(_=a.name)&&void 0!==_?_:"";return Mh({name:T},a.parent,a.providers,T)}}}return r.THROW_IF_NOT_FOUND=$n,r.NULL=new oc,r.\u0275prov=gr({token:r,providedIn:"any",factory:()=>xn(sm)}),r.__NG_ELEMENT_ID__=-1,r})();function Wm(r,o){Ge(_u(r)[1],xo())}function Sp(r){return Object.getPrototypeOf(r.prototype).constructor}function Cp(r){let o=Sp(r.type),a=!0;const f=[r];for(;o;){let _;if(Io(r))_=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new bt(903,"");_=o.\u0275dir}if(_){if(a){f.push(_);const R=r;R.inputs=Af(r.inputs),R.declaredInputs=Af(r.declaredInputs),R.outputs=Af(r.outputs);const z=_.hostBindings;z&&Mf(r,z);const X=_.viewQuery,Ce=_.contentQueries;if(X&&Km(r,X),Ce&&ql(r,Ce),Re(r.inputs,_.inputs),Re(r.declaredInputs,_.declaredInputs),Re(r.outputs,_.outputs),Io(_)&&_.data.animation){const He=r.data;He.animation=(He.animation||[]).concat(_.data.animation)}}const T=_.features;if(T)for(let R=0;R<T.length;R++){const z=T[R];z&&z.ngInherit&&z(r),z===Cp&&(a=!1)}}o=Object.getPrototypeOf(o)}!function Dp(r){let o=0,a=null;for(let f=r.length-1;f>=0;f--){const _=r[f];_.hostVars=o+=_.hostVars,_.hostAttrs=Gu(_.hostAttrs,a=Gu(a,_.hostAttrs))}}(f)}function Af(r){return r===Ht?{}:r===Te?[]:r}function Km(r,o){const a=r.viewQuery;r.viewQuery=a?(f,_)=>{o(f,_),a(f,_)}:o}function ql(r,o){const a=r.contentQueries;r.contentQueries=a?(f,_,T)=>{o(f,_,T),a(f,_,T)}:o}function Mf(r,o){const a=r.hostBindings;r.hostBindings=a?(f,_)=>{o(f,_),a(f,_)}:o}const Ap=["providersResolver"],kc=["template","decls","consts","vars","onPush","ngContentSelectors","styles","encapsulation","schemas"];function Mp(r){let a,o=Sp(r.type);a=Io(r)?o.\u0275cmp:o.\u0275dir;const f=r;for(const _ of Ap)f[_]=a[_];if(Io(a))for(const _ of kc)f[_]=a[_]}let Ym=null;function Pp(){if(!Ym){const r=wr.Symbol;if(r&&r.iterator)Ym=r.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let a=0;a<o.length;++a){const f=o[a];"entries"!==f&&"size"!==f&&Map.prototype[f]===Map.prototype.entries&&(Ym=f)}}}return Ym}function Rp(r){return!!Tg(r)&&(Array.isArray(r)||!(r instanceof Map)&&Pp()in r)}function Tg(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function Rh(r,o,a){return r[o]=a}function hm(r,o){return r[o]}function yl(r,o,a){return!Object.is(r[o],a)&&(r[o]=a,!0)}function Pf(r,o,a,f){const _=yl(r,o,a);return yl(r,o+1,f)||_}function ud(r,o,a,f,_){const T=Pf(r,o,a,f);return yl(r,o+2,_)||T}function ac(r,o,a,f,_,T){const R=Pf(r,o,a,f);return Pf(r,o+2,_,T)||R}function dm(r,o,a,f){const _=Nn();return yl(_,Eo(),o)&&(Cr(),ul(ao(),_,r,o,a,f)),dm}function Rf(r,o){let a=!1,f=Bs();for(let T=1;T<o.length;T+=2)a=yl(r,f++,o[T])||a;if(Za(f),!a)return Ii;let _=o[0];for(let T=1;T<o.length;T+=2)_+=ct(o[T])+o[T+1];return _}function kf(r,o,a,f){return yl(r,Eo(),a)?o+ct(a)+f:Ii}function Of(r,o,a,f,_,T){const z=Pf(r,Bs(),a,_);return Us(2),z?o+ct(a)+f+ct(_)+T:Ii}function ld(r,o,a,f,_,T,R,z){const Ce=ud(r,Bs(),a,_,R);return Us(3),Ce?o+ct(a)+f+ct(_)+T+ct(R)+z:Ii}function ho(r,o,a,f,_,T,R,z,X,Ce){const It=ac(r,Bs(),a,_,R,X);return Us(4),It?o+ct(a)+f+ct(_)+T+ct(R)+z+ct(X)+Ce:Ii}function Lf(r,o,a,f,_,T,R,z,X,Ce,He,It){const Gt=Bs();let hn=ac(r,Gt,a,_,R,X);return hn=yl(r,Gt+4,He)||hn,Us(5),hn?o+ct(a)+f+ct(_)+T+ct(R)+z+ct(X)+Ce+ct(He)+It:Ii}function Nf(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn){const Ln=Bs();let _r=ac(r,Ln,a,_,R,X);return _r=Pf(r,Ln+4,He,Gt)||_r,Us(6),_r?o+ct(a)+f+ct(_)+T+ct(R)+z+ct(X)+Ce+ct(He)+It+ct(Gt)+hn:Ii}function kh(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r){const Ar=Bs();let Zr=ac(r,Ar,a,_,R,X);return Zr=ud(r,Ar+4,He,Gt,Ln)||Zr,Us(7),Zr?o+ct(a)+f+ct(_)+T+ct(R)+z+ct(X)+Ce+ct(He)+It+ct(Gt)+hn+ct(Ln)+_r:Ii}function kp(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar,Zr){const Qn=Bs();let hi=ac(r,Qn,a,_,R,X);return hi=ac(r,Qn+4,He,Gt,Ln,Ar)||hi,Us(8),hi?o+ct(a)+f+ct(_)+T+ct(R)+z+ct(X)+Ce+ct(He)+It+ct(Gt)+hn+ct(Ln)+_r+ct(Ar)+Zr:Ii}function Hs(r,o,a,f,_,T){const R=Nn(),z=kf(R,o,a,f);return z!==Ii&&ul(ao(),R,r,z,_,T),Hs}function hl(r,o,a,f,_,T,R,z){const X=Nn(),Ce=Of(X,o,a,f,_,T);return Ce!==Ii&&ul(ao(),X,r,Ce,R,z),hl}function nh(r,o,a,f,_,T,R,z,X,Ce){const He=Nn(),It=ld(He,o,a,f,_,T,R,z);return It!==Ii&&ul(ao(),He,r,It,X,Ce),nh}function Sg(r,o,a,f,_,T,R,z,X,Ce,He,It){const Gt=Nn(),hn=ho(Gt,o,a,f,_,T,R,z,X,Ce);return hn!==Ii&&ul(ao(),Gt,r,hn,He,It),Sg}function Uy(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn){const Ln=Nn(),_r=Lf(Ln,o,a,f,_,T,R,z,X,Ce,He,It);return _r!==Ii&&ul(ao(),Ln,r,_r,Gt,hn),Uy}function fm(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r){const Ar=Nn(),Zr=Nf(Ar,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn);return Zr!==Ii&&ul(ao(),Ar,r,Zr,Ln,_r),fm}function Cg(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar,Zr){const Qn=Nn(),hi=kh(Qn,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r);return hi!==Ii&&ul(ao(),Qn,r,hi,Ar,Zr),Cg}function Dg(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar,Zr,Qn,hi){const Lo=Nn(),Ts=kp(Lo,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar,Zr);return Ts!==Ii&&ul(ao(),Lo,r,Ts,Qn,hi),Dg}function zy(r,o,a,f){const _=Nn(),T=Rf(_,o);return T!==Ii&&ul(ao(),_,r,T,a,f),zy}function Vy(r,o,a,f,_,T,R,z){const X=Nn(),Ce=Cr(),He=r+20,It=Ce.firstCreatePass?function Ag(r,o,a,f,_,T,R,z,X){const Ce=o.consts,He=Nr(o,r,4,R||null,Di(Ce,z));Hl(o,a,He,Di(Ce,X)),Ge(o,He);const It=He.tViews=Zo(2,He,f,_,T,o.directiveRegistry,o.pipeRegistry,null,o.schemas,Ce);return null!==o.queries&&(o.queries.template(o,He),It.queries=o.queries.embeddedTView(He)),He}(He,Ce,X,o,a,f,_,T,R):Ce.data[He];as(It,!1);const Gt=X[11].createComment("");Cd(Ce,X,Gt,It),eu(Gt,X),nd(X,X[He]=Yc(Gt,X,Gt,It)),fs(It)&&Wo(Ce,X,It),null!=R&&Vo(X,It,z)}function Ra(r){return li(function ju(){return Rr.lFrame.contextLView}(),20+r)}const gv={\u0275\u0275defineInjectable:gr,\u0275\u0275defineInjector:Er,\u0275\u0275inject:xn,\u0275\u0275invalidFactoryDep:Bn,resolveForwardRef:$e};const Fu=Le({provide:String,useValue:Le});function Mg(r){return void 0!==r.useClass}function jy(r){return void 0!==r.useFactory}const vv=du("Injectable",void 0,void 0,void 0,(r,o)=>function pb(r,o){let a=null,f=null;r.hasOwnProperty(fi)||Object.defineProperty(r,fi,{get:()=>(null===a&&(a=Wi().compileInjectable(gv,`ng:///${r.name}/\u0275prov.js`,function _v(r,o){const a=o||{providedIn:null},f={name:r.name,type:r,typeArgumentCount:0,providedIn:a.providedIn};return(Mg(a)||jy(a))&&void 0!==a.deps&&(f.deps=ol(a.deps)),Mg(a)?f.useClass=a.useClass:function yv(r){return Fu in r}(a)?f.useValue=a.useValue:jy(a)?f.useFactory=a.useFactory:function Hy(r){return void 0!==r.useExisting}(a)&&(f.useExisting=a.useExisting),f}(r,o))),a)}),r.hasOwnProperty(dn)||Object.defineProperty(r,dn,{get:()=>{if(null===f){const _=Wi();f=_.compileFactory(gv,`ng:///${r.name}/\u0275fac.js`,{name:r.name,type:r,typeArgumentCount:0,deps:Ys(r),target:_.FactoryTarget.Injectable})}return f},configurable:!0})}(r,o));function ym(r,o=Xt.Default){const a=Nn();return null===a?xn(r,o):Ne(xo(),a,$e(r),o)}function tg(){throw new Error("invalid")}function Np(r,o,a){const f=Nn();return yl(f,Eo(),o)&&ui(Cr(),ao(),f,r,o,f[11],a,!1),Np}function ng(r,o,a,f,_){const R=_?"class":"style";Ef(r,a,o.inputs[R],R,f)}function Fg(r,o,a,f){const _=Nn(),T=Cr(),R=20+r,z=_[11],X=_[R]=ru(z,o,function $(){return Rr.lFrame.currentNamespace}()),Ce=T.firstCreatePass?function _m(r,o,a,f,_,T,R){const z=o.consts,Ce=Nr(o,r,2,_,Di(z,T));return Hl(o,a,Ce,Di(z,R)),null!==Ce.attrs&&Bd(Ce,Ce.attrs,!1),null!==Ce.mergedAttrs&&Bd(Ce,Ce.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,Ce),Ce}(R,T,_,0,o,a,f):T.data[R];as(Ce,!0);const He=Ce.mergedAttrs;null!==He&&wi(z,X,He);const It=Ce.classes;null!==It&&Yh(z,X,It);const Gt=Ce.styles;null!==Gt&&up(z,X,Gt),64!=(64&Ce.flags)&&Cd(T,_,X,Ce),0===function La(){return Rr.lFrame.elementDepthCount}()&&eu(X,_),function Ns(){Rr.lFrame.elementDepthCount++}(),fs(Ce)&&(Wo(T,_,Ce),zo(T,Ce,_)),null!==f&&Vo(_,Ce)}function Fp(){let r=xo();zu()?Vu():(r=r.parent,as(r,!1));const o=r;!function Fs(){Rr.lFrame.elementDepthCount--}();const a=Cr();a.firstCreatePass&&(Ge(a,r),ou(r)&&a.queries.elementEnd(r)),null!=o.classesWithoutHost&&function Po(r){return 0!=(16&r.flags)}(o)&&ng(a,o,Nn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function gs(r){return 0!=(32&r.flags)}(o)&&ng(a,o,Nn(),o.stylesWithoutHost,!1)}function $d(r,o,a,f){Fg(r,o,a,f),Fp()}function Oh(r,o,a){const f=Nn(),_=Cr(),T=r+20,R=_.firstCreatePass?function vm(r,o,a,f,_){const T=o.consts,R=Di(T,f),z=Nr(o,r,8,"ng-container",R);return null!==R&&Bd(z,R,!0),Hl(o,a,z,Di(T,_)),null!==o.queries&&o.queries.elementStart(o,z),z}(T,_,f,o,a):_.data[T];as(R,!0);const z=f[T]=f[11].createComment("");Cd(_,f,z,R),eu(z,f),fs(R)&&(Wo(_,f,R),zo(_,R,f)),null!=a&&Vo(f,R)}function Bg(){let r=xo();const o=Cr();zu()?Vu():(r=r.parent,as(r,!1)),o.firstCreatePass&&(Ge(o,r),ou(r)&&o.queries.elementEnd(r))}function Ky(r,o,a){Oh(r,o,a),Bg()}function Ug(){return Nn()}function Bf(r){return!!r&&"function"==typeof r.then}function hd(r){return!!r&&"function"==typeof r.subscribe}const Yy=hd;function zg(r,o,a,f){const _=Nn(),T=Cr(),R=xo();return Vg(T,_,_[11],R,r,o,!!a,f),zg}function Jy(r,o){const a=xo(),f=Nn(),_=Cr();return Vg(_,f,xf(tl(_.data),a,f),a,r,o,!1),Jy}function Vg(r,o,a,f,_,T,R,z){const X=fs(f),He=r.firstCreatePass&&Fd(r),It=o[8],Gt=Jc(o);let hn=!0;if(3&f.type||z){const Ar=On(f,o),Zr=z?z(Ar):Ar,Qn=Gt.length,hi=z?Lo=>z(ne(Lo[f.index])):f.index;if(qr(a)){let Lo=null;if(!z&&X&&(Lo=function Cv(r,o,a,f){const _=r.cleanup;if(null!=_)for(let T=0;T<_.length-1;T+=2){const R=_[T];if(R===a&&_[T+1]===f){const z=o[7],X=_[T+2];return z.length>X?z[X]:null}"string"==typeof R&&(T+=2)}return null}(r,o,_,f.index)),null!==Lo)(Lo.__ngLastListenerFn__||Lo).__ngNextListenerFn__=T,Lo.__ngLastListenerFn__=T,hn=!1;else{T=jg(f,o,It,T,!1);const Ts=a.listen(Zr,_,T);Gt.push(T,Ts),He&&He.push(_,hi,Qn,Qn+1)}}else T=jg(f,o,It,T,!0),Zr.addEventListener(_,T,R),Gt.push(T),He&&He.push(_,hi,Qn,R)}else T=jg(f,o,It,T,!1);const Ln=f.outputs;let _r;if(hn&&null!==Ln&&(_r=Ln[_])){const Ar=_r.length;if(Ar)for(let Zr=0;Zr<Ar;Zr+=2){const ah=o[_r[Zr]][_r[Zr+1]].subscribe(T),km=Gt.length;Gt.push(T,ah),He&&He.push(_,f.index,km,-(km+1))}}}function Xy(r,o,a,f){try{return!1!==a(f)}catch(_){return yp(r,_),!1}}function jg(r,o,a,f,_){return function T(R){if(R===Function)return f;const z=2&r.flags?ni(r.index,o):o;0==(32&o[2])&&Sh(z);let X=Xy(o,0,f,R),Ce=T.__ngNextListenerFn__;for(;Ce;)X=Xy(o,0,Ce,R)&&X,Ce=Ce.__ngNextListenerFn__;return _&&!1===X&&(R.preventDefault(),R.returnValue=!1),X}}function Hg(r=1){return function oa(r){return(Rr.lFrame.contextLView=function kl(r,o){for(;r>0;)o=o[15],r--;return o}(r,Rr.lFrame.contextLView))[8]}(r)}function Dv(r,o){let a=null;const f=function wh(r){const o=r.attrs;if(null!=o){const a=o.indexOf(5);if(0==(1&a))return o[a+1]}return null}(r);for(let _=0;_<o.length;_++){const T=o[_];if("*"!==T){if(null===f?tm(r,T,!0):Lm(f,T))return _}else a=_}return a}function Qy(r){const o=Nn()[16][6];if(!o.projection){const f=o.projection=m(r?r.length:1,null),_=f.slice();let T=o.child;for(;null!==T;){const R=r?Dv(T,r):0;null!==R&&(_[R]?_[R].projectionNext=T:f[R]=T,_[R]=T),T=T.next}}}function $g(r,o=0,a){const f=Nn(),_=Cr(),T=Nr(_,20+r,16,null,a||null);null===T.projection&&(T.projection=o),Vu(),64!=(64&T.flags)&&function Zh(r,o,a){ap(o[11],0,o,a,ip(r,a,o),sp(a.parent||o[6],a,o))}(_,f,T)}function e_(r,o,a){return Gg(r,"",o,"",a),e_}function Gg(r,o,a,f,_){const T=Nn(),R=kf(T,o,a,f);return R!==Ii&&ui(Cr(),ao(),T,r,R,T[11],_,!1),Gg}function qg(r,o,a,f,_,T,R){const z=Nn(),X=Of(z,o,a,f,_,T);return X!==Ii&&ui(Cr(),ao(),z,r,X,z[11],R,!1),qg}function Wg(r,o,a,f,_,T,R,z,X){const Ce=Nn(),He=ld(Ce,o,a,f,_,T,R,z);return He!==Ii&&ui(Cr(),ao(),Ce,r,He,Ce[11],X,!1),Wg}function Zg(r,o,a,f,_,T,R,z,X,Ce,He){const It=Nn(),Gt=ho(It,o,a,f,_,T,R,z,X,Ce);return Gt!==Ii&&ui(Cr(),ao(),It,r,Gt,It[11],He,!1),Zg}function Kg(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt){const hn=Nn(),Ln=Lf(hn,o,a,f,_,T,R,z,X,Ce,He,It);return Ln!==Ii&&ui(Cr(),ao(),hn,r,Ln,hn[11],Gt,!1),Kg}function rg(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln){const _r=Nn(),Ar=Nf(_r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn);return Ar!==Ii&&ui(Cr(),ao(),_r,r,Ar,_r[11],Ln,!1),rg}function bm(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar){const Zr=Nn(),Qn=kh(Zr,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r);return Qn!==Ii&&ui(Cr(),ao(),Zr,r,Qn,Zr[11],Ar,!1),bm}function t_(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar,Zr,Qn){const hi=Nn(),Lo=kp(hi,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar,Zr);return Lo!==Ii&&ui(Cr(),ao(),hi,r,Lo,hi[11],Qn,!1),t_}function Yg(r,o,a){const f=Nn(),_=Rf(f,o);return _!==Ii&&ui(Cr(),ao(),f,r,_,f[11],a,!1),Yg}function n_(r,o,a,f,_){const T=r[a+1],R=null===o;let z=f?Vl(T):Sc(T),X=!1;for(;0!==z&&(!1===X||R);){const He=r[z+1];Mv(r[z],o)&&(X=!0,r[z+1]=f?yf(He):Pd(He)),z=f?Vl(He):Sc(He)}X&&(r[a+1]=f?Pd(T):yf(T))}function Mv(r,o){return null===r||null==o||(Array.isArray(r)?r[1]:r)===o||!(!Array.isArray(r)||"string"!=typeof o)&&it(r,o)>=0}const Bu={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function r_(r){return r.substring(Bu.key,Bu.keyEnd)}function Pv(r){return r.substring(Bu.value,Bu.valueEnd)}function Jg(r,o){const a=Bu.textEnd;return a===o?-1:(o=Bu.keyEnd=function Up(r,o,a){for(;o<a&&r.charCodeAt(o)>32;)o++;return o}(r,Bu.key=o,a),Bp(r,o,a))}function o_(r,o){const a=Bu.textEnd;let f=Bu.key=Bp(r,o,a);return a===f?-1:(f=Bu.keyEnd=function Qg(r,o,a){let f;for(;o<a&&(45===(f=r.charCodeAt(o))||95===f||(-33&f)>=65&&(-33&f)<=90||f>=48&&f<=57);)o++;return o}(r,f,a),f=s_(r,f,a),f=Bu.value=Bp(r,f,a),f=Bu.valueEnd=function kv(r,o,a){let f=-1,_=-1,T=-1,R=o,z=R;for(;R<a;){const X=r.charCodeAt(R++);if(59===X)return z;34===X||39===X?z=R=a_(r,X,R,a):o===R-4&&85===T&&82===_&&76===f&&40===X?z=R=a_(r,41,R,a):X>32&&(z=R),T=_,_=f,f=-33&X}return z}(r,f,a),s_(r,f,a))}function Xg(r){Bu.key=0,Bu.keyEnd=0,Bu.value=0,Bu.valueEnd=0,Bu.textEnd=r.length}function Bp(r,o,a){for(;o<a&&r.charCodeAt(o)<=32;)o++;return o}function s_(r,o,a,f){return(o=Bp(r,o,a))<a&&o++,o}function a_(r,o,a,f){let _=-1,T=a;for(;T<f;){const R=r.charCodeAt(T++);if(R==o&&92!==_)return T;_=92==R&&92===_?0:R}throw new Error}function ey(r,o,a){return uc(r,o,a,!1),ey}function ty(r,o){return uc(r,o,null,!0),ty}function ih(r){Oc(iy,_b,r,!1)}function _b(r,o){for(let a=function Rv(r){return Xg(r),o_(r,Bp(r,0,Bu.textEnd))}(o);a>=0;a=o_(o,a))iy(r,r_(o),Pv(o))}function u_(r){Oc(Ke,Lh,r,!0)}function Lh(r,o){for(let a=function i_(r){return Xg(r),Jg(r,Bp(r,0,Bu.textEnd))}(o);a>=0;a=Jg(o,a))Ke(r,r_(o),!0)}function uc(r,o,a,f){const _=Nn(),T=Cr(),R=Us(2);T.firstUpdatePass&&zp(T,r,R,f),o!==Ii&&yl(_,R,o)&&lc(T,T.data[To()],_,_[11],r,_[R+1]=function h_(r,o){return null==r||("string"==typeof o?r+=o:"object"==typeof r&&(r=Ue(Cl(r)))),r}(o,a),f,R)}function Oc(r,o,a,f){const _=Cr(),T=Us(2);_.firstUpdatePass&&zp(_,null,T,f);const R=Nn();if(a!==Ii&&yl(R,T,a)){const z=_.data[To()];if(jp(z,f)&&!ny(_,T)){let X=f?z.classesWithoutHost:z.stylesWithoutHost;null!==X&&(a=fe(X,a||"")),ng(_,z,R,a,f)}else!function Vf(r,o,a,f,_,T,R,z){_===Ii&&(_=Te);let X=0,Ce=0,He=0<_.length?_[0]:null,It=0<T.length?T[0]:null;for(;null!==He||null!==It;){const Gt=X<_.length?_[X+1]:void 0,hn=Ce<T.length?T[Ce+1]:void 0;let _r,Ln=null;He===It?(X+=2,Ce+=2,Gt!==hn&&(Ln=It,_r=hn)):null===It||null!==He&&He<It?(X+=2,Ln=He):(Ce+=2,Ln=It,_r=hn),null!==Ln&&lc(r,o,a,f,Ln,_r,R,z),He=X<_.length?_[X]:null,It=Ce<T.length?T[Ce]:null}}(_,z,R,R[11],R[T+1],R[T+1]=function c_(r,o,a){if(null==a||""===a)return Te;const f=[],_=Cl(a);if(Array.isArray(_))for(let T=0;T<_.length;T++)r(f,_[T],!0);else if("object"==typeof _)for(const T in _)_.hasOwnProperty(T)&&r(f,T,_[T]);else"string"==typeof _&&o(f,_);return f}(r,o,a),f,T)}}function ny(r,o){return o>=r.expandoStartIndex}function zp(r,o,a,f){const _=r.data;if(null===_[a+1]){const T=_[To()],R=ny(r,a);jp(T,f)&&null===o&&!R&&(o=!1),o=function ry(r,o,a,f){const _=tl(r);let T=f?o.residualClasses:o.residualStyles;if(null===_)0===(f?o.classBindings:o.styleBindings)&&(a=wm(a=Vp(null,r,o,a,f),o.attrs,f),T=null);else{const R=o.directiveStylingLast;if(-1===R||r[R]!==_)if(a=Vp(_,r,o,a,f),null===T){let X=function Ov(r,o,a){const f=a?o.classBindings:o.styleBindings;if(0!==Sc(f))return r[Vl(f)]}(r,o,f);void 0!==X&&Array.isArray(X)&&(X=Vp(null,r,o,X[1],f),X=wm(X,o.attrs,f),function Lv(r,o,a,f){r[Vl(a?o.classBindings:o.styleBindings)]=f}(r,o,f,X))}else T=function l_(r,o,a){let f;const _=o.directiveEnd;for(let T=1+o.directiveStylingLast;T<_;T++)f=wm(f,r[T].hostAttrs,a);return wm(f,o.attrs,a)}(r,o,f)}return void 0!==T&&(f?o.residualClasses=T:o.residualStyles=T),a}(_,T,o,f),function Av(r,o,a,f,_,T){let R=T?o.classBindings:o.styleBindings,z=Vl(R),X=Sc(R);r[f]=a;let He,Ce=!1;if(Array.isArray(a)){const It=a;He=It[1],(null===He||it(It,He)>0)&&(Ce=!0)}else He=a;if(_)if(0!==X){const Gt=Vl(r[z+1]);r[f+1]=Tc(Gt,z),0!==Gt&&(r[Gt+1]=gf(r[Gt+1],f)),r[z+1]=function qo(r,o){return 131071&r|o<<17}(r[z+1],f)}else r[f+1]=Tc(z,0),0!==z&&(r[z+1]=gf(r[z+1],f)),z=f;else r[f+1]=Tc(X,0),0===z?z=f:r[X+1]=gf(r[X+1],f),X=f;Ce&&(r[f+1]=Pd(r[f+1])),n_(r,He,f,!0),n_(r,He,f,!1),function zf(r,o,a,f,_){const T=_?r.residualClasses:r.residualStyles;null!=T&&"string"==typeof o&&it(T,o)>=0&&(a[f+1]=yf(a[f+1]))}(o,He,r,f,T),R=Tc(z,X),T?o.classBindings=R:o.styleBindings=R}(_,T,o,a,R,f)}}function Vp(r,o,a,f,_){let T=null;const R=a.directiveEnd;let z=a.directiveStylingLast;for(-1===z?z=a.directiveStart:z++;z<R&&(T=o[z],f=wm(f,T.hostAttrs,_),T!==r);)z++;return null!==r&&(a.directiveStylingLast=z),f}function wm(r,o,a){const f=a?1:2;let _=-1;if(null!==o)for(let T=0;T<o.length;T++){const R=o[T];"number"==typeof R?_=R:_===f&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),Ke(r,R,!!a||o[++T]))}return void 0===r?null:r}function iy(r,o,a){Ke(r,o,Cl(a))}function lc(r,o,a,f,_,T,R,z){if(!(3&o.type))return;const X=r.data,Ce=X[z+1];xm(function nm(r){return 1==(1&r)}(Ce)?_l(X,o,a,_,Sc(Ce),R):void 0)||(xm(T)||function Rs(r){return 2==(2&r)}(Ce)&&(T=_l(X,null,a,_,z,R)),function Kh(r,o,a,f,_){const T=qr(r);if(o)_?T?r.addClass(a,f):a.classList.add(f):T?r.removeClass(a,f):a.classList.remove(f);else{let R=-1===f.indexOf("-")?void 0:ar.DashCase;if(null==_)T?r.removeStyle(a,f,R):a.style.removeProperty(f);else{const z="string"==typeof _&&_.endsWith("!important");z&&(_=_.slice(0,-10),R|=ar.Important),T?r.setStyle(a,f,_,R):a.style.setProperty(f,_,z?"important":"")}}}(f,R,vn(To(),a),_,T))}function _l(r,o,a,f,_,T){const R=null===o;let z;for(;_>0;){const X=r[_],Ce=Array.isArray(X),He=Ce?X[1]:X,It=null===He;let Gt=a[_+1];Gt===Ii&&(Gt=It?Te:void 0);let hn=It?Xe(Gt,f):He===f?Gt:void 0;if(Ce&&!xm(hn)&&(hn=Xe(X,f)),xm(hn)&&(z=hn,R))return z;const Ln=r[_+1];_=R?Vl(Ln):Sc(Ln)}if(null!==o){let X=T?o.residualClasses:o.residualStyles;null!=X&&(z=Xe(X,f))}return z}function xm(r){return void 0!==r}function jp(r,o){return 0!=(r.flags&(o?16:32))}function Hp(r,o=""){const a=Nn(),f=Cr(),_=r+20,T=f.firstCreatePass?Nr(f,_,1,o,null):f.data[_],R=a[_]=wc(a[11],o);Cd(f,a,R,T),as(T,!1)}function dl(r){return ig("",r,""),dl}function ig(r,o,a){const f=Nn(),_=kf(f,r,o,a);return _!==Ii&&rc(f,To(),_),ig}function og(r,o,a,f,_){const T=Nn(),R=Of(T,r,o,a,f,_);return R!==Ii&&rc(T,To(),R),og}function jf(r,o,a,f,_,T,R){const z=Nn(),X=ld(z,r,o,a,f,_,T,R);return X!==Ii&&rc(z,To(),X),jf}function qd(r,o,a,f,_,T,R,z,X){const Ce=Nn(),He=ho(Ce,r,o,a,f,_,T,R,z,X);return He!==Ii&&rc(Ce,To(),He),qd}function sg(r,o,a,f,_,T,R,z,X,Ce,He){const It=Nn(),Gt=Lf(It,r,o,a,f,_,T,R,z,X,Ce,He);return Gt!==Ii&&rc(It,To(),Gt),sg}function Wd(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt){const hn=Nn(),Ln=Nf(hn,r,o,a,f,_,T,R,z,X,Ce,He,It,Gt);return Ln!==Ii&&rc(hn,To(),Ln),Wd}function d_(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln){const _r=Nn(),Ar=kh(_r,r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln);return Ar!==Ii&&rc(_r,To(),Ar),d_}function f_(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar){const Zr=Nn(),Qn=kp(Zr,r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar);return Qn!==Ii&&rc(Zr,To(),Qn),f_}function p_(r){const o=Nn(),a=Rf(o,r);return a!==Ii&&rc(o,To(),a),p_}function Nv(r,o,a){Oc(Ke,Lh,kf(Nn(),r,o,a),!0)}function Fv(r,o,a,f,_){Oc(Ke,Lh,Of(Nn(),r,o,a,f,_),!0)}function ag(r,o,a,f,_,T,R){Oc(Ke,Lh,ld(Nn(),r,o,a,f,_,T,R),!0)}function Zd(r,o,a,f,_,T,R,z,X){Oc(Ke,Lh,ho(Nn(),r,o,a,f,_,T,R,z,X),!0)}function Bv(r,o,a,f,_,T,R,z,X,Ce,He){Oc(Ke,Lh,Lf(Nn(),r,o,a,f,_,T,R,z,X,Ce,He),!0)}function Uv(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt){Oc(Ke,Lh,Nf(Nn(),r,o,a,f,_,T,R,z,X,Ce,He,It,Gt),!0)}function m_(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln){Oc(Ke,Lh,kh(Nn(),r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln),!0)}function zv(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar){Oc(Ke,Lh,kp(Nn(),r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar),!0)}function Vv(r){Oc(Ke,Lh,Rf(Nn(),r),!0)}function g_(r,o,a){ih(kf(Nn(),r,o,a))}function oy(r,o,a,f,_){ih(Of(Nn(),r,o,a,f,_))}function y_(r,o,a,f,_,T,R){ih(ld(Nn(),r,o,a,f,_,T,R))}function ug(r,o,a,f,_,T,R,z,X){ih(ho(Nn(),r,o,a,f,_,T,R,z,X))}function jv(r,o,a,f,_,T,R,z,X,Ce,He){ih(Lf(Nn(),r,o,a,f,_,T,R,z,X,Ce,He))}function vb(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt){ih(Nf(Nn(),r,o,a,f,_,T,R,z,X,Ce,He,It,Gt))}function Hv(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln){ih(kh(Nn(),r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln))}function sy(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar){ih(kp(Nn(),r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar))}function bb(r){ih(Rf(Nn(),r))}function $v(r,o,a,f,_){return uc(r,kf(Nn(),o,a,f),_,!1),$v}function __(r,o,a,f,_,T,R){return uc(r,Of(Nn(),o,a,f,_,T),R,!1),__}function v_(r,o,a,f,_,T,R,z,X){return uc(r,ld(Nn(),o,a,f,_,T,R,z),X,!1),v_}function Gv(r,o,a,f,_,T,R,z,X,Ce,He){return uc(r,ho(Nn(),o,a,f,_,T,R,z,X,Ce),He,!1),Gv}function qv(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt){return uc(r,Lf(Nn(),o,a,f,_,T,R,z,X,Ce,He,It),Gt,!1),qv}function Wv(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln){return uc(r,Nf(Nn(),o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn),Ln,!1),Wv}function Zv(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar){return uc(r,kh(Nn(),o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r),Ar,!1),Zv}function Kv(r,o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar,Zr,Qn){return uc(r,kp(Nn(),o,a,f,_,T,R,z,X,Ce,He,It,Gt,hn,Ln,_r,Ar,Zr),Qn,!1),Kv}function Yv(r,o,a){return uc(r,Rf(Nn(),o),a,!1),Yv}function Jv(r,o,a){const f=Nn();return yl(f,Eo(),o)&&ui(Cr(),ao(),f,r,o,f[11],a,!0),Jv}function Xv(r,o,a){const f=Nn();if(yl(f,Eo(),o)){const T=Cr(),R=ao();ui(T,R,f,r,o,xf(tl(T.data),R,f),a,!0)}return Xv}const Kd=void 0;var e0=["en",[["a","p"],["AM","PM"],Kd],[["AM","PM"],Kd,Kd],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Kd,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Kd,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Kd,"{1} 'at' {0}",Kd],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Qv(r){const a=Math.floor(Math.abs(r)),f=r.toString().replace(/^[^.]*\.?/,"").length;return 1===a&&0===f?1:5}];let ka={};function $p(r){const o=function t0(r){return r.toLowerCase().replace(/_/g,"-")}(r);let a=x_(o);if(a)return a;const f=o.split("-")[0];if(a=x_(f),a)return a;if("en"===f)return e0;throw new Error(`Missing locale data for the locale "${r}".`)}function w_(r){return $p(r)[ci.PluralCase]}function x_(r){return r in ka||(ka[r]=wr.ng&&wr.ng.common&&wr.ng.common.locales&&wr.ng.common.locales[r]),ka[r]}var ci=(()=>((ci=ci||{})[ci.LocaleId=0]="LocaleId",ci[ci.DayPeriodsFormat=1]="DayPeriodsFormat",ci[ci.DayPeriodsStandalone=2]="DayPeriodsStandalone",ci[ci.DaysFormat=3]="DaysFormat",ci[ci.DaysStandalone=4]="DaysStandalone",ci[ci.MonthsFormat=5]="MonthsFormat",ci[ci.MonthsStandalone=6]="MonthsStandalone",ci[ci.Eras=7]="Eras",ci[ci.FirstDayOfWeek=8]="FirstDayOfWeek",ci[ci.WeekendRange=9]="WeekendRange",ci[ci.DateFormat=10]="DateFormat",ci[ci.TimeFormat=11]="TimeFormat",ci[ci.DateTimeFormat=12]="DateTimeFormat",ci[ci.NumberSymbols=13]="NumberSymbols",ci[ci.NumberFormats=14]="NumberFormats",ci[ci.CurrencyCode=15]="CurrencyCode",ci[ci.CurrencySymbol=16]="CurrencySymbol",ci[ci.CurrencyName=17]="CurrencyName",ci[ci.Currencies=18]="Currencies",ci[ci.Directionality=19]="Directionality",ci[ci.PluralCase=20]="PluralCase",ci[ci.ExtraData=21]="ExtraData",ci))();const n0=["zero","one","two","few","many"],lg="en-US",Hf={marker:"element"},Em={marker:"ICU"};var Ha=(()=>((Ha=Ha||{})[Ha.SHIFT=2]="SHIFT",Ha[Ha.APPEND_EAGERLY=1]="APPEND_EAGERLY",Ha[Ha.COMMENT=2]="COMMENT",Ha))();let Im=lg;function I_(r,o,a){const f=o.insertBeforeIndex,_=Array.isArray(f)?f[0]:f;return null===_?Sd(r,0,a):ne(a[_])}function T_(r,o,a,f,_){const T=o.insertBeforeIndex;if(Array.isArray(T)){let R=f,z=null;if(3&o.type||(z=R,R=_),null!==R&&0==(2&o.flags))for(let X=1;X<T.length;X++)vh(r,R,a[T[X]],z,!1)}}function S_(r,o){if(r.push(o),r.length>1)for(let a=r.length-2;a>=0;a--){const f=r[a];C_(f)||o0(f,o)&&null===Tm(f)&&D_(f,o.index)}}function C_(r){return!(64&r.type)}function o0(r,o){return C_(o)||r.index>o.index}function Tm(r){const o=r.insertBeforeIndex;return Array.isArray(o)?o[0]:o}function D_(r,o){const a=r.insertBeforeIndex;Array.isArray(a)?a[0]=o:(Ec(I_,T_),r.insertBeforeIndex=o)}function Yd(r,o){const a=r.data[o];return null===a||"string"==typeof a?null:a.hasOwnProperty("currentCaseLViewIndex")?a:a.value}function a0(r,o,a){const f=xr(r,a,64,null,null);return S_(o,f),f}function cg(r,o){const a=o[r.currentCaseLViewIndex];return null===a?a:a<0?~a:a}function M_(r){return r>>>17}function ly(r){return(131070&r)>>>1}let $f=0,Gp=0;function hy(r,o,a,f){const _=a[11];let R,T=null;for(let z=0;z<o.length;z++){const X=o[z];if("string"==typeof X){const Ce=o[++z];null===a[Ce]&&(a[Ce]=wc(_,X))}else if("number"==typeof X)switch(1&X){case 0:const Ce=M_(X);let He,It;if(null===T&&(T=Ce,R=Gh(_,f)),Ce===T?(He=f,It=R):(He=null,It=ne(a[Ce])),null!==It){const _r=ly(X);vh(_,It,a[_r],He,!1);const Zr=Yd(r,_r);if(null!==Zr&&"object"==typeof Zr){const Qn=cg(Zr,a);null!==Qn&&hy(r,Zr.create[Qn],a,a[Zr.anchorIdx])}}break;case 1:const hn=o[++z],Ln=o[++z];nc(_,vn(X>>>1,a),null,null,hn,Ln,null)}else switch(X){case Em:const Ce=o[++z],He=o[++z];null===a[He]&&eu(a[He]=wd(_,Ce),a);break;case Hf:const It=o[++z],Gt=o[++z];null===a[Gt]&&eu(a[Gt]=ru(_,It,null),a)}}}function R_(r,o,a,f,_){for(let T=0;T<a.length;T++){const R=a[T],z=a[++T];if(R&_){let X="";for(let Ce=T+1;Ce<=T+z;Ce++){const He=a[Ce];if("string"==typeof He)X+=He;else if("number"==typeof He)if(He<0)X+=ct(o[f-He]);else{const It=He>>>2;switch(3&He){case 1:const Gt=a[++Ce],hn=a[++Ce],Ln=r.data[It];"string"==typeof Ln?nc(o[11],o[It],null,Ln,Gt,X,hn):ui(r,Ln,o,Gt,X,o[11],hn,!1);break;case 0:const _r=o[It];null!==_r&&ca(o[11],_r,X);break;case 2:k_(r,Yd(r,It),o,X);break;case 3:dg(r,Yd(r,It),f,o)}}}}else{const X=a[T+1];if(X>0&&3==(3&X)){const He=Yd(r,X>>>2);o[He.currentCaseLViewIndex]<0&&dg(r,He,f,o)}}T+=z}}function dg(r,o,a,f){let _=f[o.currentCaseLViewIndex];if(null!==_){let T=$f;_<0&&(_=f[o.currentCaseLViewIndex]=~_,T=-1),R_(r,f,o.update[_],a,T)}}function k_(r,o,a,f){const _=function fy(r,o){let a=r.cases.indexOf(o);if(-1===a)switch(r.type){case 1:{const f=function r0(r,o){const a=w_(o)(parseInt(r,10)),f=n0[a];return void 0!==f?f:"other"}(o,function uy(){return Im}());a=r.cases.indexOf(f),-1===a&&"other"!==f&&(a=r.cases.indexOf("other"));break}case 0:a=r.cases.indexOf("other")}return-1===a?null:a}(o,f);if(cg(o,a)!==_&&(dy(r,o,a),a[o.currentCaseLViewIndex]=null===_?null:~_,null!==_)){const R=a[o.anchorIdx];R&&hy(r,o.create[_],a,R)}}function dy(r,o,a){let f=cg(o,a);if(null!==f){const _=o.remove[f];for(let T=0;T<_.length;T++){const R=_[T];if(R>0){const z=vn(R,a);null!==z&&df(a[11],z)}else dy(r,Yd(r,~R),a)}}}function l0(){const r=[];let a,f,o=-1;function T(z,X){o=0;const Ce=cg(z,X);f=null!==Ce?z.remove[Ce]:Te}function R(){if(o<f.length){const z=f[o++];return z>0?a[z]:(r.push(o,f),T(a[1].data[~z],a),R())}return 0===r.length?null:(f=r.pop(),o=r.pop(),R())}return function _(z,X){for(a=X;r.length;)r.pop();return T(z.value,X),R}}const qp=/\ufffd(\d+):?\d*\ufffd/gi,L_=/({\s*\ufffd\d+:?\d*\ufffd\s*,\s*\S{6}\s*,[\s\S]*})/gi,c0=/\ufffd(\d+)\ufffd/,my=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,h0=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,d0=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,f0=/\uE500/g;function N_(r,o,a,f,_,T,R){const z=ti(r,f,1,null);let X=z<<Ha.SHIFT,Ce=Wa();o===Ce&&(Ce=null),null===Ce&&(X|=Ha.APPEND_EAGERLY),R&&(X|=Ha.COMMENT,function Xr(r){void 0===Lr&&(Lr=r())}(l0)),_.push(X,null===T?"":T);const He=xr(r,z,R?32:1,null===T?"":T,null);S_(a,He);const It=He.index;return as(He,!1),null!==Ce&&o!==Ce&&function s0(r,o){let a=r.insertBeforeIndex;null===a?(Ec(I_,T_),a=r.insertBeforeIndex=[null,o]):(function Y(r,o,a){r!=o&&qt(a,r,o,"==")}(Array.isArray(a),!0,"Expecting array here"),a.push(o))}(Ce,It),He}function g0(r,o,a,f,_,T,R){const z=R.match(qp),X=N_(r,o,a,T,f,z?null:R,!1);z&&Wp(_,R,X.index,null,0,null)}function Wp(r,o,a,f,_,T){const R=r.length,z=R+1;r.push(null,null);const X=R+2,Ce=o.split(qp);let He=0;for(let It=0;It<Ce.length;It++){const Gt=Ce[It];if(1&It){const hn=_+parseInt(Gt,10);r.push(-1-hn),He|=Cm(hn)}else""!==Gt&&r.push(Gt)}return r.push(a<<2|(f?1:0)),f&&r.push(f,T),r[R]=He,r[z]=r.length-X,He}function _0(r){let o=0;for(let a=0;a<r.length;a++){const f=r[a];"number"==typeof f&&f<0&&o++}return o}function Cm(r){return 1<<Math.min(r,31)}function gy(r){let o,T,a="",f=0,_=!1;for(;null!==(o=h0.exec(r));)_?o[0]===`\ufffd/*${T}\ufffd`&&(f=o.index,_=!1):(a+=r.substring(f,o.index+o[0].length),T=o[1],_=!0);return a+=r.substr(f),a}function B_(r,o,a,f,_,T){let R=0;const z={type:_.type,currentCaseLViewIndex:ti(r,o,1,null),anchorIdx:T,cases:[],create:[],remove:[],update:[]};(function V_(r,o,a){r.push(Cm(o.mainBinding),2,-1-o.mainBinding,a<<2|2)})(a,_,T),function A_(r,o,a){const f=r.data[o];null===f?r.data[o]=a:f.value=a}(r,T,z);const X=_.values;for(let Ce=0;Ce<X.length;Ce++){const He=X[Ce],It=[];for(let Gt=0;Gt<He.length;Gt++){const hn=He[Gt];if("string"!=typeof hn){const Ln=It.push(hn)-1;He[Gt]=`\x3c!--\ufffd${Ln}\ufffd--\x3e`}}R=U_(r,z,o,a,f,_.cases[Ce],He.join(""),It)|R}R&&function Ib(r,o,a){r.push(o,1,a<<2|3)}(a,R,T)}function v0(r){const o=[],a=[];let f=1,_=0;const T=_y(r=r.replace(my,function(R,z,X){return f="select"===X?0:1,_=parseInt(z.substr(1),10),""}));for(let R=0;R<T.length;){let z=T[R++].trim();1===f&&(z=z.replace(/\s*(?:=)?(\w+)\s*/,"$1")),z.length&&o.push(z);const X=_y(T[R++]);o.length>a.length&&a.push(X)}return{type:f,mainBinding:_,cases:o,values:a}}function _y(r){if(!r)return[];let o=0;const a=[],f=[],_=/[{}]/g;let T;for(_.lastIndex=0;T=_.exec(r);){const z=T.index;if("}"==T[0]){if(a.pop(),0==a.length){const X=r.substring(o,z);my.test(X)?f.push(v0(X)):f.push(X),o=z+1}}else{if(0==a.length){const X=r.substring(o,z);f.push(X),o=z+1}a.push("{")}}const R=r.substring(o);return f.push(R),f}function U_(r,o,a,f,_,T,R,z){const X=[],Ce=[],He=[];o.cases.push(T),o.create.push(X),o.remove.push(Ce),o.update.push(He);const Gt=ef(ps()).getInertBodyElement(R),hn=rf(Gt)||Gt;return hn?vy(r,o,a,f,X,Ce,He,hn,_,z,0):0}function vy(r,o,a,f,_,T,R,z,X,Ce,He){let It=0,Gt=z.firstChild;for(;Gt;){const hn=ti(r,a,1,null);switch(Gt.nodeType){case Node.ELEMENT_NODE:const Ln=Gt,_r=Ln.tagName.toLowerCase();if(hh.hasOwnProperty(_r)){wy(_,Hf,_r,X,hn),r.data[hn]=_r;const hi=Ln.attributes;for(let Lo=0;Lo<hi.length;Lo++){const Ts=hi.item(Lo),ah=Ts.name.toLowerCase();Ts.value.match(qp)?yd.hasOwnProperty(ah)&&Wp(R,Ts.value,hn,Ts.name,0,gd[ah]?Ul:gc[ah]?tf:null):Tb(_,hn,Ts)}It=vy(r,o,a,f,_,T,R,Gt,hn,Ce,He+1)|It,by(T,hn,He)}break;case Node.TEXT_NODE:const Ar=Gt.textContent||"",Zr=Ar.match(qp);wy(_,null,Zr?"":Ar,X,hn),by(T,hn,He),Zr&&(It=Wp(R,Ar,hn,null,0,null)|It);break;case Node.COMMENT_NODE:const Qn=c0.exec(Gt.textContent||"");if(Qn){const Lo=Ce[parseInt(Qn[1],10)];wy(_,Em,"",X,hn),B_(r,a,f,X,Lo,hn),z_(T,hn,He)}}Gt=Gt.nextSibling}return It}function by(r,o,a){0===a&&r.push(o)}function z_(r,o,a){0===a&&(r.push(~o),r.push(o))}function wy(r,o,a,f,_){null!==o&&r.push(o),r.push(a,_,function P_(r,o,a){return r|o<<17|a<<1}(0,f,_))}function Tb(r,o,a){r.push(o<<1|1,a.name,a.value)}const xy=/\[(\ufffd.+?\ufffd?)\]/,Sb=/\[(\ufffd.+?\ufffd?)\]|(\ufffd\/?\*\d+:\d+\ufffd)/g,w0=/({\s*)(VAR_(PLURAL|SELECT)(_\d+)?)(\s*,)/g,j_=/{([A-Z0-9_]+)}/g,x0=/\ufffdI18N_EXP_(ICU(_\d+)?)\ufffd/g,H_=/\/\*/,Ey=/\d+\:(\d+)/;function E0(r,o,a=-1){const f=Cr(),_=Nn(),T=20+r,R=Di(f.consts,o),z=Wa();f.firstCreatePass&&function m0(r,o,a,f,_,T){const R=Wa(),z=[],X=[],Ce=[[]];_=function yy(r,o){if(function F_(r){return-1===r}(o))return gy(r);{const a=r.indexOf(`:${o}\ufffd`)+2+o.toString().length,f=r.search(new RegExp(`\ufffd\\/\\*\\d+:${o}\ufffd`));return gy(r.substring(a,f))}}(_,T);const He=function p0(r){return r.replace(f0," ")}(_).split(d0);for(let It=0;It<He.length;It++){let Gt=He[It];if(0==(1&It)){const hn=_y(Gt);for(let Ln=0;Ln<hn.length;Ln++){let _r=hn[Ln];if(0==(1&Ln)){const Ar=_r;""!==Ar&&g0(r,R,Ce[0],z,X,a,Ar)}else{const Ar=_r;if("object"!=typeof Ar)throw new Error(`Unable to parse ICU expression in "${_}" message.`);B_(r,a,X,o,Ar,N_(r,R,Ce[0],a,z,"",!0).index)}}}else{const hn=47===Gt.charCodeAt(0),_r=(Gt.charCodeAt(hn?1:0),20+Number.parseInt(Gt.substring(hn?2:1)));if(hn)Ce.shift(),as(Wa(),!1);else{const Ar=a0(r,Ce[0],_r);Ce.unshift([]),as(Ar,!0)}}}r.data[f]={create:z,update:X}}(f,null===z?0:z.index,_,T,R,a);const X=f.data[T],He=cf(f,z===_[6]?null:z,_);(function cy(r,o,a,f){const _=r[11];for(let T=0;T<o.length;T++){const R=o[T++],z=o[T],X=(R&Ha.COMMENT)===Ha.COMMENT,Ce=(R&Ha.APPEND_EAGERLY)===Ha.APPEND_EAGERLY,He=R>>>Ha.SHIFT;let It=r[He];null===It&&(It=r[He]=X?_.createComment(z):wc(_,z)),Ce&&null!==a&&vh(_,a,It,f,!1)}})(_,X.create,He,z&&8&z.type?_[z.index]:null),Fo(!0)}function pg(){Fo(!1)}function Cb(r,o,a){E0(r,o,a),pg()}function I0(r,o){const a=Cr();!function y0(r,o,a){const _=xo().index,T=[];if(r.firstCreatePass&&null===r.data[o]){for(let R=0;R<a.length;R+=2){const z=a[R],X=a[R+1];if(""!==X){if(L_.test(X))throw new Error(`ICU expressions are not supported in attributes. Message: "${X}".`);Wp(T,X,_,z,_0(T),null)}}r.data[o]=T}}(a,r+20,Di(a.consts,o))}function T0(r){return function Sm(r){r&&($f|=1<<Math.min(Gp,31)),Gp++}(yl(Nn(),Eo(),r)),T0}function S0(r){!function u0(r,o,a){if(Gp>0){const f=r.data[a];R_(r,o,Array.isArray(f)?f:f.update,Bs()-Gp-1,$f)}$f=0,Gp=0}(Cr(),Nn(),r+20)}function C0(r,o={}){return function Iy(r,o={}){let a=r;if(xy.test(r)){const f={},_=[0];a=a.replace(Sb,(T,R,z)=>{const X=R||z,Ce=f[X]||[];if(Ce.length||(X.split("|").forEach(_r=>{const Ar=_r.match(Ey),Zr=Ar?parseInt(Ar[1],10):0,Qn=H_.test(_r);Ce.push([Zr,Qn,_r])}),f[X]=Ce),!Ce.length)throw new Error(`i18n postprocess: unmatched placeholder - ${X}`);const He=_[_.length-1];let It=0;for(let _r=0;_r<Ce.length;_r++)if(Ce[_r][0]===He){It=_r;break}const[Gt,hn,Ln]=Ce[It];return hn?_.pop():He!==Gt&&_.push(Gt),Ce.splice(It,1),Ln})}return Object.keys(o).length&&(a=a.replace(w0,(f,_,T,R,z,X)=>o.hasOwnProperty(T)?`${_}${o[T]}${X}`:f),a=a.replace(j_,(f,_)=>o.hasOwnProperty(_)?o[_]:f),a=a.replace(x0,(f,_)=>{if(o.hasOwnProperty(_)){const T=o[_];if(!T.length)throw new Error(`i18n postprocess: unmatched ICU - ${f} with key: ${_}`);return T.shift()}return f})),a}(r,o)}function $_(r,o,a,f,_){if(r=$e(r),Array.isArray(r))for(let T=0;T<r.length;T++)$_(r[T],o,a,f,_);else{const T=Cr(),R=Nn();let z=Pa(r)?r:$e(r.provide),X=um(r);const Ce=xo(),He=1048575&Ce.providerIndexes,It=Ce.directiveStart,Gt=Ce.providerIndexes>>20;if(Pa(r)||!r.multi){const hn=new Gn(X,_,ym),Ln=G_(z,o,_?He:He+Gt,It);-1===Ln?(M(Zn(Ce,R),T,z),Ty(T,r,o.length),o.push(z),Ce.directiveStart++,Ce.directiveEnd++,_&&(Ce.providerIndexes+=1048576),a.push(hn),R.push(hn)):(a[Ln]=hn,R[Ln]=hn)}else{const hn=G_(z,o,He+Gt,It),Ln=G_(z,o,He,He+Gt),_r=hn>=0&&a[hn],Ar=Ln>=0&&a[Ln];if(_&&!Ar||!_&&!_r){M(Zn(Ce,R),T,z);const Zr=function A0(r,o,a,f,_){const T=new Gn(r,a,ym);return T.multi=[],T.index=o,T.componentProviders=0,D0(T,_,f&&!a),T}(_?Mb:Ab,a.length,_,f,X);!_&&Ar&&(a[Ln].providerFactory=Zr),Ty(T,r,o.length,0),o.push(z),Ce.directiveStart++,Ce.directiveEnd++,_&&(Ce.providerIndexes+=1048576),a.push(Zr),R.push(Zr)}else Ty(T,r,hn>-1?hn:Ln,D0(a[_?Ln:hn],X,!_&&f));!_&&f&&Ar&&a[Ln].componentProviders++}}}function Ty(r,o,a,f){const _=Pa(o),T=function bp(r){return!!r.useClass}(o);if(_||T){const X=(T?$e(o.useClass):o).prototype.ngOnDestroy;if(X){const Ce=r.destroyHooks||(r.destroyHooks=[]);if(!_&&o.multi){const He=Ce.indexOf(a);-1===He?Ce.push(a,[f,X]):Ce[He+1].push(f,X)}else Ce.push(a,X)}}}function D0(r,o,a){return a&&r.componentProviders++,r.multi.push(o)-1}function G_(r,o,a,f){for(let _=a;_<f;_++)if(o[_]===r)return _;return-1}function Ab(r,o,a,f){return q_(this.multi,[])}function Mb(r,o,a,f){const _=this.multi;let T;if(this.providerFactory){const R=this.providerFactory.componentProviders,z=Pr(a,a[1],this.providerFactory.index,f);T=z.slice(0,R),q_(_,T);for(let X=R;X<z.length;X++)T.push(z[X])}else T=[],q_(_,T);return T}function q_(r,o){for(let a=0;a<r.length;a++)o.push((0,r[a])());return o}function M0(r,o=[]){return a=>{a.providersResolver=(f,_)=>function Db(r,o,a){const f=Cr();if(f.firstCreatePass){const _=Io(r);$_(a,f.data,f.blueprint,_,!0),$_(o,f.data,f.blueprint,_,!1)}}(f,_?_(r):r,o)}}class Sy{}class K_{resolveComponentFactory(o){throw function Z_(r){const o=Error(`No component factory found for ${Ue(r)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=r,o}(o)}}let Zp=(()=>{class r{}return r.NULL=new K_,r})();function Y_(){return Dm(xo(),Nn())}function Dm(r,o){return new Am(On(r,o))}let Am=(()=>{class r{constructor(a){this.nativeElement=a}}return r.__NG_ELEMENT_ID__=Y_,r})();function J_(r){return r instanceof Am?r.nativeElement:r}class mg{}let gg=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function R0(){const r=Nn(),a=ni(xo().index,r);return function X_(r){return r[11]}(fo(a)?a:r)}(),r})(),Dy=(()=>{class r{}return r.\u0275prov=gr({token:r,providedIn:"root",factory:()=>null}),r})();class Q_{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Ay=new Q_("13.2.0"),yg={};function Mm(r,o,a,f,_=!1){for(;null!==a;){const T=o[a.index];if(null!==T&&f.push(ne(T)),Ji(T))for(let z=10;z<T.length;z++){const X=T[z],Ce=X[1].firstChild;null!==Ce&&Mm(X[1],X,Ce,f)}const R=a.type;if(8&R)Mm(r,o,a.child,f);else if(32&R){const z=ai(a,o);let X;for(;X=z();)f.push(X)}else if(16&R){const z=Gc(o,a);if(Array.isArray(z))f.push(...z);else{const X=Un(o[16]);Mm(X[1],X,z,f,!0)}}a=_?a.projectionNext:a.next}return f}class Pm{constructor(o,a){this._lView=o,this._cdRefInjectingView=a,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,a=o[1];return Mm(a,o,a.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Ji(o)){const a=o[8],f=a?a.indexOf(this):-1;f>-1&&(Ed(o,f),h(a,f))}this._attachedToViewContainer=!1}_h(this._lView[1],this._lView)}onDestroy(o){iu(this._lView[1],this._lView,null,o)}markForCheck(){Sh(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){rd(this._lView[1],this._lView,this.context)}checkNoChanges(){!function bf(r,o,a){As(!0);try{rd(r,o,a)}finally{As(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new bt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function xc(r,o){Wh(r,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new bt(902,"");this._appRef=o}}class ev extends Pm{constructor(o){super(o),this._view=o}detectChanges(){Dh(this._view)}checkNoChanges(){!function Ld(r){As(!0);try{Dh(r)}finally{As(!1)}}(this._view)}get context(){return null}}class My extends Zp{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const a=mt(o);return new Py(a,this.ngModule)}}function tv(r){const o=[];for(let a in r)r.hasOwnProperty(a)&&o.push({propName:r[a],templateName:a});return o}const nv=new _o("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>tu});class Py extends Sy{constructor(o,a){super(),this.componentDef=o,this.ngModule=a,this.componentType=o.type,this.selector=function Ad(r){return r.map(fp).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!a}get inputs(){return tv(this.componentDef.inputs)}get outputs(){return tv(this.componentDef.outputs)}create(o,a,f,_){const T=(_=_||this.ngModule)?function rv(r,o){return{get:(a,f,_)=>{const T=r.get(a,yg,_);return T!==yg||f===yg?T:o.get(a,f,_)}}}(o,_.injector):o,R=T.get(mg,oe),z=T.get(Dy,null),X=R.createRenderer(null,this.componentDef),Ce=this.componentDef.selectors[0][0]||"div",He=f?function js(r,o,a){if(qr(r))return r.selectRootElement(o,a===zt.ShadowDom);let f="string"==typeof o?r.querySelector(o):o;return f.textContent="",f}(X,f,this.componentDef.encapsulation):ru(R.createRenderer(null,this.componentDef),Ce,function k0(r){const o=r.toLowerCase();return"svg"===o?"svg":"math"===o?wo:null}(Ce)),It=this.componentDef.onPush?576:528,Gt=function Tp(r,o){return{components:[],scheduler:r||tu,clean:wf,playerHandler:o||null,flags:0}}(),hn=Zo(0,null,null,1,0,null,null,null,null,null),Ln=ri(null,hn,Gt,It,null,null,R,X,z,T);let _r,Ar;ba(Ln);try{const Zr=function qm(r,o,a,f,_,T){const R=a[1];a[20]=r;const X=Nr(R,20,2,"#host",null),Ce=X.mergedAttrs=o.hostAttrs;null!==Ce&&(Bd(X,Ce,!0),null!==r&&(wi(_,r,Ce),null!==X.classes&&Yh(_,r,X.classes),null!==X.styles&&up(_,r,X.styles)));const He=f.createRenderer(r,o),It=ri(a,co(o),null,o.onPush?64:16,a[20],X,f,He,T||null,null);return R.firstCreatePass&&(M(Zn(X,a),R,o.type),Ac(R,X),Zc(X,a.length,1)),nd(a,It),a[20]=It}(He,this.componentDef,Ln,R,X);if(He)if(f)wi(X,He,["ng-version",Ay.full]);else{const{attrs:Qn,classes:hi}=function pf(r){const o=[],a=[];let f=1,_=2;for(;f<r.length;){let T=r[f];if("string"==typeof T)2===_?""!==T&&o.push(T,r[++f]):8===_&&a.push(T);else{if(!Xu(_))break;_=T}f++}return{attrs:o,classes:a}}(this.componentDef.selectors[0]);Qn&&wi(X,He,Qn),hi&&hi.length>0&&Yh(X,He,hi.join(" "))}if(Ar=Hr(hn,20),void 0!==a){const Qn=Ar.projection=[];for(let hi=0;hi<this.ngContentSelectors.length;hi++){const Lo=a[hi];Qn.push(null!=Lo?Array.from(Lo):null)}}_r=function Ip(r,o,a,f,_){const T=a[1],R=function Zi(r,o,a){const f=xo();r.firstCreatePass&&(a.providersResolver&&a.providersResolver(a),Mc(r,f,o,ti(r,o,1,null),a));const _=Pr(o,r,f.directiveStart,f);eu(_,o);const T=On(f,o);return T&&eu(T,o),_}(T,a,o);if(f.components.push(R),r[8]=R,_&&_.forEach(X=>X(R,o)),o.contentQueries){const X=xo();o.contentQueries(1,R,X.directiveStart)}const z=xo();return!T.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(Ai(z.index),Nu(a[1],z,0,z.directiveStart,z.directiveEnd,o),al(o,R)),R}(Zr,this.componentDef,Ln,Gt,[Wm]),Kr(hn,Ln,null)}finally{lu()}return new n(this.componentType,_r,Dm(Ar,Ln),Ln,Ar)}}class n extends class W_{}{constructor(o,a,f,_,T){super(),this.location=f,this._rootLView=_,this._tNode=T,this.instance=a,this.hostView=this.changeDetectorRef=new ev(_),this.componentType=o}get injector(){return new Co(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}class y{}class S{}const L=new Map;class nr extends y{constructor(o,a){super(),this._parent=a,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new My(this);const f=Dn(o);this._bootstrapComponents=N(f.bootstrap),this._r3Injector=od(o,a,[{provide:y,useValue:this},{provide:Zp,useValue:this.componentFactoryResolver}],Ue(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,a=ll.THROW_IF_NOT_FOUND,f=Xt.Default){return o===ll||o===y||o===sm?this:this._r3Injector.get(o,a,f)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(a=>a()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class fr extends S{constructor(o){super(),this.moduleType=o,null!==Dn(o)&&function dt(r){const o=new Set;!function a(f){const _=Dn(f,!0),T=_.id;null!==T&&(function Me(r,o,a){if(o&&o!==a)throw new Error(`Duplicate module registered for ${r} - ${Ue(o)} vs ${Ue(o.name)}`)}(T,L.get(T),f),L.set(T,f));const R=N(_.imports);for(const z of R)o.has(z)||(o.add(z),a(z))}(r)}(o)}create(o){return new nr(this.moduleType,o)}}function $r(r,o,a){const f=yo()+r,_=Nn();return _[f]===Ii?Rh(_,f,a?o.call(a):o()):hm(_,f)}function Oi(r,o,a,f){return Rb(Nn(),yo(),r,o,a,f)}function da(r,o,a,f,_){return kb(Nn(),yo(),r,o,a,f,_)}function Eu(r,o,a,f,_,T){return Ob(Nn(),yo(),r,o,a,f,_,T)}function cc(r,o,a,f,_,T,R){return Lb(Nn(),yo(),r,o,a,f,_,T,R)}function ws(r,o,a,f,_,T,R,z){const X=yo()+r,Ce=Nn(),He=ac(Ce,X,a,f,_,T);return yl(Ce,X+4,R)||He?Rh(Ce,X+5,z?o.call(z,a,f,_,T,R):o(a,f,_,T,R)):hm(Ce,X+5)}function Iu(r,o,a,f,_,T,R,z,X){const Ce=yo()+r,He=Nn(),It=ac(He,Ce,a,f,_,T);return Pf(He,Ce+4,R,z)||It?Rh(He,Ce+6,X?o.call(X,a,f,_,T,R,z):o(a,f,_,T,R,z)):hm(He,Ce+6)}function oh(r,o,a,f,_,T,R,z,X,Ce){const He=yo()+r,It=Nn();let Gt=ac(It,He,a,f,_,T);return ud(It,He+4,R,z,X)||Gt?Rh(It,He+7,Ce?o.call(Ce,a,f,_,T,R,z,X):o(a,f,_,T,R,z,X)):hm(It,He+7)}function _g(r,o,a,f,_,T,R,z,X,Ce,He){const It=yo()+r,Gt=Nn(),hn=ac(Gt,It,a,f,_,T);return ac(Gt,It+4,R,z,X,Ce)||hn?Rh(Gt,It+8,He?o.call(He,a,f,_,T,R,z,X,Ce):o(a,f,_,T,R,z,X,Ce)):hm(Gt,It+8)}function Vw(r,o,a,f){return Nb(Nn(),yo(),r,o,a,f)}function Ry(r,o){const a=r[o];return a===Ii?void 0:a}function Rb(r,o,a,f,_,T){const R=o+a;return yl(r,R,_)?Rh(r,R+1,T?f.call(T,_):f(_)):Ry(r,R+1)}function kb(r,o,a,f,_,T,R){const z=o+a;return Pf(r,z,_,T)?Rh(r,z+2,R?f.call(R,_,T):f(_,T)):Ry(r,z+2)}function Ob(r,o,a,f,_,T,R,z){const X=o+a;return ud(r,X,_,T,R)?Rh(r,X+3,z?f.call(z,_,T,R):f(_,T,R)):Ry(r,X+3)}function Lb(r,o,a,f,_,T,R,z,X){const Ce=o+a;return ac(r,Ce,_,T,R,z)?Rh(r,Ce+4,X?f.call(X,_,T,R,z):f(_,T,R,z)):Ry(r,Ce+4)}function Nb(r,o,a,f,_,T){let R=o+a,z=!1;for(let X=0;X<_.length;X++)yl(r,R++,_[X])&&(z=!0);return z?Rh(r,R,f.apply(T,_)):Ry(r,R)}function jw(r,o){const a=Cr();let f;const _=r+20;a.firstCreatePass?(f=function Hw(r,o){if(o)for(let a=o.length-1;a>=0;a--){const f=o[a];if(r===f.name)return f}}(o,a.pipeRegistry),a.data[_]=f,f.onDestroy&&(a.destroyHooks||(a.destroyHooks=[])).push(_,f.onDestroy)):f=a.data[_];const T=f.factory||(f.factory=is(f.type)),R=bn(ym);try{const z=Qo(!1),X=T();return Qo(z),function mv(r,o,a,f){a>=r.data.length&&(r.data[a]=null,r.blueprint[a]=null),o[a]=f}(a,Nn(),_,X),X}finally{bn(R)}}function $w(r,o,a){const f=r+20,_=Nn(),T=li(_,f);return ky(_,f)?Rb(_,yo(),o,T.transform,a,T):T.transform(a)}function Gw(r,o,a,f){const _=r+20,T=Nn(),R=li(T,_);return ky(T,_)?kb(T,yo(),o,R.transform,a,f,R):R.transform(a,f)}function qw(r,o,a,f,_){const T=r+20,R=Nn(),z=li(R,T);return ky(R,T)?Ob(R,yo(),o,z.transform,a,f,_,z):z.transform(a,f,_)}function Ww(r,o,a,f,_,T){const R=r+20,z=Nn(),X=li(z,R);return ky(z,R)?Lb(z,yo(),o,X.transform,a,f,_,T,X):X.transform(a,f,_,T)}function Zw(r,o,a){const f=r+20,_=Nn(),T=li(_,f);return ky(_,f)?Nb(_,yo(),o,T.transform,a,T):T.transform.apply(T,a)}function ky(r,o){return r[1].data[o].pure}function O0(r){return o=>{setTimeout(r,void 0,o)}}const Xd=class Kw extends w.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,a,f){var _,T,R;let z=o,X=a||(()=>null),Ce=f;if(o&&"object"==typeof o){const It=o;z=null===(_=It.next)||void 0===_?void 0:_.bind(It),X=null===(T=It.error)||void 0===T?void 0:T.bind(It),Ce=null===(R=It.complete)||void 0===R?void 0:R.bind(It)}this.__isAsync&&(X=O0(X),z&&(z=O0(z)),Ce&&(Ce=O0(Ce)));const He=super.subscribe({next:z,error:X,complete:Ce});return o instanceof ue.w0&&o.add(He),He}};function Yw(){return this._results[Pp()]()}class L0{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const a=Pp(),f=L0.prototype;f[a]||(f[a]=Yw)}get changes(){return this._changes||(this._changes=new Xd)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,a){return this._results.reduce(o,a)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,a){const f=this;f.dirty=!1;const _=ls(o);(this._changesDetected=!function Fl(r,o,a){if(r.length!==o.length)return!1;for(let f=0;f<r.length;f++){let _=r[f],T=o[f];if(a&&(_=a(_),T=a(T)),T!==_)return!1}return!0}(f._results,_,a))&&(f._results=_,f.length=_.length,f.last=_[this.length-1],f.first=_[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Oy=(()=>{class r{}return r.__NG_ELEMENT_ID__=Qw,r})();const Jw=Oy,Xw=class extends Jw{constructor(o,a,f){super(),this._declarationLView=o,this._declarationTContainer=a,this.elementRef=f}createEmbeddedView(o){const a=this._declarationTContainer.tViews,f=ri(this._declarationLView,a,o,16,null,a.declTNode,null,null,null,null);f[17]=this._declarationLView[this._declarationTContainer.index];const T=this._declarationLView[19];return null!==T&&(f[19]=T.createEmbeddedView(a)),Kr(a,f,o),new Pm(f)}};function Qw(){return iv(xo(),Nn())}function iv(r,o){return 4&r.type?new Xw(o,r,Dm(r,o)):null}let ov=(()=>{class r{}return r.__NG_ELEMENT_ID__=ex,r})();function ex(){return Ub(xo(),Nn())}const tx=ov,Fb=class extends tx{constructor(o,a,f){super(),this._lContainer=o,this._hostTNode=a,this._hostLView=f}get element(){return Dm(this._hostTNode,this._hostLView)}get injector(){return new Co(this._hostTNode,this._hostLView)}get parentInjector(){const o=F(this._hostTNode,this._hostLView);if(Ol(o)){const a=Zs(o,this._hostLView),f=Ri(o);return new Co(a[1].data[f+8],a)}return new Co(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const a=Bb(this._lContainer);return null!==a&&a[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,a,f){const _=o.createEmbeddedView(a||{});return this.insert(_,f),_}createComponent(o,a,f,_,T){const R=o&&!Ua(o);let z;if(R)z=a;else{const It=a||{};z=It.index,f=It.injector,_=It.projectableNodes,T=It.ngModuleRef}const X=R?o:new Py(mt(o)),Ce=f||this.parentInjector;if(!T&&null==X.ngModule&&Ce){const It=Ce.get(y,null);It&&(T=It)}const He=X.create(Ce,_,void 0,T);return this.insert(He.hostView,z),He}insert(o,a){const f=o._lView,_=f[1];if(function Vi(r){return Ji(r[3])}(f)){const He=this.indexOf(o);if(-1!==He)this.detach(He);else{const It=f[3],Gt=new Fb(It,It[6],It[3]);Gt.detach(Gt.indexOf(o))}}const T=this._adjustIndex(a),R=this._lContainer;!function Jp(r,o,a,f){const _=10+f,T=a.length;f>0&&(a[_-1][4]=o),f<T-10?(o[4]=a[_],d(a,10+f,o)):(a.push(o),o[4]=null),o[3]=a;const R=o[17];null!==R&&a!==R&&function Xp(r,o){const a=r[9];o[16]!==o[3][3][16]&&(r[2]=!0),null===a?r[9]=[o]:a.push(o)}(R,o);const z=o[19];null!==z&&z.insertView(r),o[2]|=128}(_,f,R,T);const z=Ml(T,R),X=f[11],Ce=Gh(X,R[7]);return null!==Ce&&function xd(r,o,a,f,_,T){f[0]=_,f[6]=o,Wh(r,f,a,1,_,T)}(_,R[6],X,f,Ce,z),o.attachToViewContainerRef(),d(N0(R),T,o),o}move(o,a){return this.insert(o,a)}indexOf(o){const a=Bb(this._lContainer);return null!==a?a.indexOf(o):-1}remove(o){const a=this._adjustIndex(o,-1),f=Ed(this._lContainer,a);f&&(h(N0(this._lContainer),a),_h(f[1],f))}detach(o){const a=this._adjustIndex(o,-1),f=Ed(this._lContainer,a);return f&&null!=h(N0(this._lContainer),a)?new Pm(f):null}_adjustIndex(o,a=0){return null==o?this.length+a:o}};function Bb(r){return r[8]}function N0(r){return r[8]||(r[8]=[])}function Ub(r,o){let a;const f=o[r.index];if(Ji(f))a=f;else{let _;if(8&r.type)_=ne(f);else{const T=o[11];_=T.createComment("");const R=On(r,o);vh(T,Gh(T,R),_,function op(r,o){return qr(r)?r.nextSibling(o):o.nextSibling}(T,R),!1)}o[r.index]=a=Yc(f,o,_,r),nd(o,a)}return new Fb(a,r,o)}class F0{constructor(o){this.queryList=o,this.matches=null}clone(){return new F0(this.queryList)}setDirty(){this.queryList.setDirty()}}class B0{constructor(o=[]){this.queries=o}createEmbeddedView(o){const a=o.queries;if(null!==a){const f=null!==o.contentQueries?o.contentQueries[0]:a.length,_=[];for(let T=0;T<f;T++){const R=a.getByIndex(T);_.push(this.queries[R.indexInDeclarationView].clone())}return new B0(_)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let a=0;a<this.queries.length;a++)null!==Zb(o,a).matches&&this.queries[a].setDirty()}}class zb{constructor(o,a,f=null){this.predicate=o,this.flags=a,this.read=f}}class U0{constructor(o=[]){this.queries=o}elementStart(o,a){for(let f=0;f<this.queries.length;f++)this.queries[f].elementStart(o,a)}elementEnd(o){for(let a=0;a<this.queries.length;a++)this.queries[a].elementEnd(o)}embeddedTView(o){let a=null;for(let f=0;f<this.length;f++){const _=null!==a?a.length:0,T=this.getByIndex(f).embeddedTView(o,_);T&&(T.indexInDeclarationView=f,null!==a?a.push(T):a=[T])}return null!==a?new U0(a):null}template(o,a){for(let f=0;f<this.queries.length;f++)this.queries[f].template(o,a)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class z0{constructor(o,a=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=a}elementStart(o,a){this.isApplyingToNode(a)&&this.matchTNode(o,a)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,a){this.elementStart(o,a)}embeddedTView(o,a){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,a),new z0(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const a=this._declarationNodeIndex;let f=o.parent;for(;null!==f&&8&f.type&&f.index!==a;)f=f.parent;return a===(null!==f?f.index:-1)}return this._appliesToNextNode}matchTNode(o,a){const f=this.metadata.predicate;if(Array.isArray(f))for(let _=0;_<f.length;_++){const T=f[_];this.matchTNodeWithReadOption(o,a,ix(a,T)),this.matchTNodeWithReadOption(o,a,Fn(a,o,T,!1,!1))}else f===Oy?4&a.type&&this.matchTNodeWithReadOption(o,a,-1):this.matchTNodeWithReadOption(o,a,Fn(a,o,f,!1,!1))}matchTNodeWithReadOption(o,a,f){if(null!==f){const _=this.metadata.read;if(null!==_)if(_===Am||_===ov||_===Oy&&4&a.type)this.addMatch(a.index,-2);else{const T=Fn(a,o,_,!1,!1);null!==T&&this.addMatch(a.index,T)}else this.addMatch(a.index,f)}}addMatch(o,a){null===this.matches?this.matches=[o,a]:this.matches.push(o,a)}}function ix(r,o){const a=r.localNames;if(null!==a)for(let f=0;f<a.length;f+=2)if(a[f]===o)return a[f+1];return null}function sx(r,o,a,f){return-1===a?function ox(r,o){return 11&r.type?Dm(r,o):4&r.type?iv(r,o):null}(o,r):-2===a?function ax(r,o,a){return a===Am?Dm(o,r):a===Oy?iv(o,r):a===ov?Ub(o,r):void 0}(r,o,f):Pr(r,r[1],a,o)}function Vb(r,o,a,f){const _=o[19].queries[f];if(null===_.matches){const T=r.data,R=a.matches,z=[];for(let X=0;X<R.length;X+=2){const Ce=R[X];z.push(Ce<0?null:sx(o,T[Ce],R[X+1],a.metadata.read))}_.matches=z}return _.matches}function V0(r,o,a,f){const _=r.queries.getByIndex(a),T=_.matches;if(null!==T){const R=Vb(r,o,_,a);for(let z=0;z<T.length;z+=2){const X=T[z];if(X>0)f.push(R[z/2]);else{const Ce=T[z+1],He=o[-X];for(let It=10;It<He.length;It++){const Gt=He[It];Gt[17]===Gt[3]&&V0(Gt[1],Gt,Ce,f)}if(null!==He[9]){const It=He[9];for(let Gt=0;Gt<It.length;Gt++){const hn=It[Gt];V0(hn[1],hn,Ce,f)}}}}}return f}function jb(r){const o=Nn(),a=Cr(),f=va();$u(f+1);const _=Zb(a,f);if(r.dirty&&Qr(o)===(2==(2&_.metadata.flags))){if(null===_.matches)r.reset([]);else{const T=_.crossesNgTemplate?V0(a,o,f,[]):Vb(a,o,_,f);r.reset(T,J_),r.notifyOnChanges()}return!0}return!1}function Hb(r,o,a){const f=Cr();f.firstCreatePass&&(Wb(f,new zb(r,o,a),-1),2==(2&o)&&(f.staticViewQueries=!0)),qb(f,Nn(),o)}function $b(r,o,a,f){const _=Cr();if(_.firstCreatePass){const T=xo();Wb(_,new zb(o,a,f),T.index),function lx(r,o){const a=r.contentQueries||(r.contentQueries=[]);o!==(a.length?a[a.length-1]:-1)&&a.push(r.queries.length-1,o)}(_,r),2==(2&a)&&(_.staticContentQueries=!0)}qb(_,Nn(),a)}function Gb(){return function ux(r,o){return r[19].queries[o].queryList}(Nn(),va())}function qb(r,o,a){const f=new L0(4==(4&a));iu(r,o,f,f.destroy),null===o[19]&&(o[19]=new B0),o[19].queries.push(new F0(f))}function Wb(r,o,a){null===r.queries&&(r.queries=new U0),r.queries.track(new z0(o,a))}function Zb(r,o){return r.queries.getByIndex(o)}function cx(r,o){return iv(r,o)}const hc=(()=>({\u0275\u0275attribute:dm,\u0275\u0275attributeInterpolate1:Hs,\u0275\u0275attributeInterpolate2:hl,\u0275\u0275attributeInterpolate3:nh,\u0275\u0275attributeInterpolate4:Sg,\u0275\u0275attributeInterpolate5:Uy,\u0275\u0275attributeInterpolate6:fm,\u0275\u0275attributeInterpolate7:Cg,\u0275\u0275attributeInterpolate8:Dg,\u0275\u0275attributeInterpolateV:zy,\u0275\u0275defineComponent:be,\u0275\u0275defineDirective:ze,\u0275\u0275defineInjectable:gr,\u0275\u0275defineInjector:Er,\u0275\u0275defineNgModule:Lt,\u0275\u0275definePipe:Ve,\u0275\u0275directiveInject:ym,\u0275\u0275getInheritedFactory:xa,\u0275\u0275inject:xn,\u0275\u0275injectAttribute:Wr,\u0275\u0275invalidFactory:tg,\u0275\u0275invalidFactoryDep:Bn,\u0275\u0275templateRefExtractor:cx,\u0275\u0275NgOnChangesFeature:Ni,\u0275\u0275ProvidersFeature:M0,\u0275\u0275CopyDefinitionFeature:Mp,\u0275\u0275InheritDefinitionFeature:Cp,\u0275\u0275nextContext:Hg,\u0275\u0275namespaceHTML:P,\u0275\u0275namespaceMathML:sa,\u0275\u0275namespaceSVG:Ka,\u0275\u0275enableBindings:Xo,\u0275\u0275disableBindings:vl,\u0275\u0275elementStart:Fg,\u0275\u0275elementEnd:Fp,\u0275\u0275element:$d,\u0275\u0275elementContainerStart:Oh,\u0275\u0275elementContainerEnd:Bg,\u0275\u0275elementContainer:Ky,\u0275\u0275pureFunction0:$r,\u0275\u0275pureFunction1:Oi,\u0275\u0275pureFunction2:da,\u0275\u0275pureFunction3:Eu,\u0275\u0275pureFunction4:cc,\u0275\u0275pureFunction5:ws,\u0275\u0275pureFunction6:Iu,\u0275\u0275pureFunction7:oh,\u0275\u0275pureFunction8:_g,\u0275\u0275pureFunctionV:Vw,\u0275\u0275getCurrentView:Ug,\u0275\u0275restoreView:Fa,\u0275\u0275listener:zg,\u0275\u0275projection:$g,\u0275\u0275syntheticHostProperty:Xv,\u0275\u0275syntheticHostListener:Jy,\u0275\u0275pipeBind1:$w,\u0275\u0275pipeBind2:Gw,\u0275\u0275pipeBind3:qw,\u0275\u0275pipeBind4:Ww,\u0275\u0275pipeBindV:Zw,\u0275\u0275projectionDef:Qy,\u0275\u0275hostProperty:Jv,\u0275\u0275property:Np,\u0275\u0275propertyInterpolate:e_,\u0275\u0275propertyInterpolate1:Gg,\u0275\u0275propertyInterpolate2:qg,\u0275\u0275propertyInterpolate3:Wg,\u0275\u0275propertyInterpolate4:Zg,\u0275\u0275propertyInterpolate5:Kg,\u0275\u0275propertyInterpolate6:rg,\u0275\u0275propertyInterpolate7:bm,\u0275\u0275propertyInterpolate8:t_,\u0275\u0275propertyInterpolateV:Yg,\u0275\u0275pipe:jw,\u0275\u0275queryRefresh:jb,\u0275\u0275viewQuery:Hb,\u0275\u0275loadQuery:Gb,\u0275\u0275contentQuery:$b,\u0275\u0275reference:Ra,\u0275\u0275classMap:u_,\u0275\u0275classMapInterpolate1:Nv,\u0275\u0275classMapInterpolate2:Fv,\u0275\u0275classMapInterpolate3:ag,\u0275\u0275classMapInterpolate4:Zd,\u0275\u0275classMapInterpolate5:Bv,\u0275\u0275classMapInterpolate6:Uv,\u0275\u0275classMapInterpolate7:m_,\u0275\u0275classMapInterpolate8:zv,\u0275\u0275classMapInterpolateV:Vv,\u0275\u0275styleMap:ih,\u0275\u0275styleMapInterpolate1:g_,\u0275\u0275styleMapInterpolate2:oy,\u0275\u0275styleMapInterpolate3:y_,\u0275\u0275styleMapInterpolate4:ug,\u0275\u0275styleMapInterpolate5:jv,\u0275\u0275styleMapInterpolate6:vb,\u0275\u0275styleMapInterpolate7:Hv,\u0275\u0275styleMapInterpolate8:sy,\u0275\u0275styleMapInterpolateV:bb,\u0275\u0275styleProp:ey,\u0275\u0275stylePropInterpolate1:$v,\u0275\u0275stylePropInterpolate2:__,\u0275\u0275stylePropInterpolate3:v_,\u0275\u0275stylePropInterpolate4:Gv,\u0275\u0275stylePropInterpolate5:qv,\u0275\u0275stylePropInterpolate6:Wv,\u0275\u0275stylePropInterpolate7:Zv,\u0275\u0275stylePropInterpolate8:Kv,\u0275\u0275stylePropInterpolateV:Yv,\u0275\u0275classProp:ty,\u0275\u0275advance:mf,\u0275\u0275template:Vy,\u0275\u0275text:Hp,\u0275\u0275textInterpolate:dl,\u0275\u0275textInterpolate1:ig,\u0275\u0275textInterpolate2:og,\u0275\u0275textInterpolate3:jf,\u0275\u0275textInterpolate4:qd,\u0275\u0275textInterpolate5:sg,\u0275\u0275textInterpolate6:Wd,\u0275\u0275textInterpolate7:d_,\u0275\u0275textInterpolate8:f_,\u0275\u0275textInterpolateV:p_,\u0275\u0275i18n:Cb,\u0275\u0275i18nAttributes:I0,\u0275\u0275i18nExp:T0,\u0275\u0275i18nStart:E0,\u0275\u0275i18nEnd:pg,\u0275\u0275i18nApply:S0,\u0275\u0275i18nPostprocess:C0,\u0275\u0275resolveWindow:np,\u0275\u0275resolveDocument:A,\u0275\u0275resolveBody:b,\u0275\u0275setComponentScope:Oe,\u0275\u0275setNgModuleScope:Je,\u0275\u0275sanitizeHtml:of,\u0275\u0275sanitizeStyle:Yf,\u0275\u0275sanitizeResourceUrl:fh,\u0275\u0275sanitizeScript:Jf,\u0275\u0275sanitizeUrl:_c,\u0275\u0275sanitizeUrlOrResourceUrl:Xf,\u0275\u0275trustConstantHtml:Vh,\u0275\u0275trustConstantResourceUrl:Da,forwardRef:ae,resolveForwardRef:$e}))(),Ly=[];function ew(r){return function _x(r){return void 0!==r.ngModule}(r)?r.ngModule:r}function tw(r,o){let a=null;(function rw(r,o){let a=null;Object.defineProperty(r,dn,{get:()=>{if(null===a){const f=nw(r,o),_=Wi();a=_.compileFactory(hc,`ng:///${r.name}/\u0275fac.js`,{name:f.metadata.name,type:f.metadata.type,typeArgumentCount:0,deps:Ys(r),target:_.FactoryTarget.Directive})}return a},configurable:!1})})(r,o||{}),Object.defineProperty(r,tt,{get:()=>{if(null===a){const f=nw(r,o||{});a=Wi().compileDirective(hc,f.sourceMapUrl,f.metadata)}return a},configurable:!1})}function nw(r,o){const a=r&&r.name,f=`ng:///${a}/\u0275dir.js`,_=Wi(),T=function iw(r,o){const a=za(),f=a.ownPropMetadata(r);return{name:r.name,type:r,selector:void 0!==o.selector?o.selector:null,host:o.host||Ht,propMetadata:f,inputs:o.inputs||Te,outputs:o.outputs||Te,queries:sw(r,f,aw),lifecycle:{usesOnChanges:a.hasLifecycleHook(r,"ngOnChanges")},typeSourceSpan:null,usesInheritance:!bx(r),exportAs:Ex(o.exportAs),providers:o.providers||null,viewQueries:sw(r,f,uw)}}(r,o);return T.typeSourceSpan=_.createParseSourceSpan("Directive",a,f),T.usesInheritance&&function ow(r){const o=Object.prototype;let a=Object.getPrototypeOf(r.prototype).constructor;for(;a&&a!==o;)!Tt(a)&&!mt(a)&&Tx(a)&&tw(a,null),a=Object.getPrototypeOf(a)}(r),{metadata:T,sourceMapUrl:f}}function bx(r){return Object.getPrototypeOf(r.prototype)===Object.prototype}function wx(r){return"string"==typeof r?cw(r):$e(r)}function xx(r,o){return{propertyName:r,predicate:wx(o.selector),descendants:o.descendants,first:o.first,read:o.read?o.read:null,static:!!o.static,emitDistinctChangesOnly:!!o.emitDistinctChangesOnly}}function sw(r,o,a){const f=[];for(const _ in o)if(o.hasOwnProperty(_)){const T=o[_];T.forEach(R=>{if(a(R)){if(!R.selector)throw new Error(`Can't construct a query for the property "${_}" of "${ut(r)}" since the query selector wasn't defined.`);if(T.some(lw))throw new Error("Cannot combine @Input decorators with query decorators");f.push(xx(_,R))}})}return f}function Ex(r){return void 0===r?null:cw(r)}function aw(r){const o=r.ngMetadataName;return"ContentChild"===o||"ContentChildren"===o}function uw(r){const o=r.ngMetadataName;return"ViewChild"===o||"ViewChildren"===o}function lw(r){return"Input"===r.ngMetadataName}function cw(r){return r.split(",").map(o=>o.trim())}const Ix=["ngOnChanges","ngOnInit","ngOnDestroy","ngDoCheck","ngAfterViewInit","ngAfterViewChecked","ngAfterContentInit","ngAfterContentChecked"];function Tx(r){const o=za();if(Ix.some(f=>o.hasLifecycleHook(r,f)))return!0;const a=o.propMetadata(r);for(const f in a){const _=a[f];for(let T=0;T<_.length;T++){const R=_[T],z=R.ngMetadataName;if(lw(R)||aw(R)||uw(R)||"Output"===z||"HostBinding"===z||"HostListener"===z)return!0}}return!1}const Sx=du("Directive",(r={})=>r,void 0,void 0,(r,o)=>tw(r,o)),Cx=ei("Input",r=>({bindingPropertyName:r})),Dx=du("NgModule",r=>r,void 0,void 0,(r,o)=>function mx(r,o={}){(function gx(r,o,a=!1){const f=ls(o.declarations||Te);let _=null;Object.defineProperty(r,vt,{configurable:!0,get:()=>(null===_&&(_=Wi().compileNgModule(hc,`ng:///${r.name}/\u0275mod.js`,{type:r,bootstrap:ls(o.bootstrap||Te).map($e),declarations:f.map($e),imports:ls(o.imports||Te).map($e).map(ew),exports:ls(o.exports||Te).map($e).map(ew),schemas:o.schemas?ls(o.schemas):null,id:o.id||null}),_.schemas||(_.schemas=[])),_)});let T=null;Object.defineProperty(r,dn,{get:()=>{if(null===T){const z=Wi();T=z.compileFactory(hc,`ng:///${r.name}/\u0275fac.js`,{name:r.name,type:r,deps:Ys(r),target:z.FactoryTarget.NgModule,typeArgumentCount:0})}return T},configurable:!1});let R=null;Object.defineProperty(r,bi,{get:()=>{if(null===R){const z={name:r.name,type:r,providers:o.providers||Te,imports:[(o.imports||Te).map($e),(o.exports||Te).map($e)]};R=Wi().compileInjector(hc,`ng:///${r.name}/\u0275inj.js`,z)}return R},configurable:!1})})(r,o),function fx(r,o){Ly.push({moduleType:r,ngModule:o})}(r,o)}(r,o));function uv(...r){}const W0=new _o("Application Initializer");let bg=(()=>{class r{constructor(a){this.appInits=a,this.resolve=uv,this.reject=uv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((f,_)=>{this.resolve=f,this.reject=_})}runInitializers(){if(this.initialized)return;const a=[],f=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let _=0;_<this.appInits.length;_++){const T=this.appInits[_]();if(Bf(T))a.push(T);else if(Yy(T)){const R=new Promise((z,X)=>{T.subscribe({complete:z,error:X})});a.push(R)}}Promise.all(a).then(()=>{f()}).catch(_=>{this.reject(_)}),0===a.length&&f(),this.initialized=!0}}return r.\u0275fac=function(a){return new(a||r)(xn(W0,8))},r.\u0275prov=gr({token:r,factory:r.\u0275fac}),r})();const dw=new _o("AppId"),Mx={provide:dw,useFactory:function Ax(){return`${Z0()}${Z0()}${Z0()}`},deps:[]};function Z0(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const fw=new _o("Platform Initializer"),pw=new _o("Platform ID"),mw=new _o("appBootstrapListener");let gw=(()=>{class r{log(a){console.log(a)}warn(a){console.warn(a)}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=gr({token:r,factory:r.\u0275fac}),r})();const lv=new _o("LocaleId"),yw=new _o("DefaultCurrencyCode");class Px{constructor(o,a){this.ngModuleFactory=o,this.componentFactories=a}}let K0=(()=>{class r{compileModuleSync(a){return new fr(a)}compileModuleAsync(a){return Promise.resolve(this.compileModuleSync(a))}compileModuleAndAllComponentsSync(a){const f=this.compileModuleSync(a),T=N(Dn(a).declarations).reduce((R,z)=>{const X=mt(z);return X&&R.push(new Py(X)),R},[]);return new Px(f,T)}compileModuleAndAllComponentsAsync(a){return Promise.resolve(this.compileModuleAndAllComponentsSync(a))}clearCache(){}clearCacheFor(a){}getModuleId(a){}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=gr({token:r,factory:r.\u0275fac}),r})();const kx=(()=>Promise.resolve(0))();function Y0(r){"undefined"==typeof Zone?kx.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class sh{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:a=!1,shouldCoalesceRunChangeDetection:f=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Xd(!1),this.onMicrotaskEmpty=new Xd(!1),this.onStable=new Xd(!1),this.onError=new Xd(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const _=this;_._nesting=0,_._outer=_._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(_._inner=_._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(_._inner=_._inner.fork(Zone.longStackTraceZoneSpec)),_.shouldCoalesceEventChangeDetection=!f&&a,_.shouldCoalesceRunChangeDetection=f,_.lastRequestAnimationFrameId=-1,_.nativeRequestAnimationFrame=function Ox(){let r=wr.requestAnimationFrame,o=wr.cancelAnimationFrame;if("undefined"!=typeof Zone&&r&&o){const a=r[Zone.__symbol__("OriginalDelegate")];a&&(r=a);const f=o[Zone.__symbol__("OriginalDelegate")];f&&(o=f)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Fx(r){const o=()=>{!function Nx(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(wr,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,X0(r),r.isCheckStableRunning=!0,J0(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),X0(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(a,f,_,T,R,z)=>{try{return _w(r),a.invokeTask(_,T,R,z)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===T.type||r.shouldCoalesceRunChangeDetection)&&o(),vw(r)}},onInvoke:(a,f,_,T,R,z,X)=>{try{return _w(r),a.invoke(_,T,R,z,X)}finally{r.shouldCoalesceRunChangeDetection&&o(),vw(r)}},onHasTask:(a,f,_,T)=>{a.hasTask(_,T),f===_&&("microTask"==T.change?(r._hasPendingMicrotasks=T.microTask,X0(r),J0(r)):"macroTask"==T.change&&(r.hasPendingMacrotasks=T.macroTask))},onHandleError:(a,f,_,T)=>(a.handleError(_,T),r.runOutsideAngular(()=>r.onError.emit(T)),!1)})}(_)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!sh.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(sh.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,a,f){return this._inner.run(o,a,f)}runTask(o,a,f,_){const T=this._inner,R=T.scheduleEventTask("NgZoneEvent: "+_,o,Lx,uv,uv);try{return T.runTask(R,a,f)}finally{T.cancelTask(R)}}runGuarded(o,a,f){return this._inner.runGuarded(o,a,f)}runOutsideAngular(o){return this._outer.run(o)}}const Lx={};function J0(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function X0(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function _w(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function vw(r){r._nesting--,J0(r)}class Bx{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Xd,this.onMicrotaskEmpty=new Xd,this.onStable=new Xd,this.onError=new Xd}run(o,a,f){return o.apply(a,f)}runGuarded(o,a,f){return o.apply(a,f)}runOutsideAngular(o){return o()}runTask(o,a,f,_){return o.apply(a,f)}}let bw=(()=>{class r{constructor(a){this._ngZone=a,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),a.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{sh.assertNotInAngularZone(),Y0(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Y0(()=>{for(;0!==this._callbacks.length;){let a=this._callbacks.pop();clearTimeout(a.timeoutId),a.doneCb(this._didWork)}this._didWork=!1});else{let a=this.getPendingTasks();this._callbacks=this._callbacks.filter(f=>!f.updateCb||!f.updateCb(a)||(clearTimeout(f.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(a=>({source:a.source,creationLocation:a.creationLocation,data:a.data})):[]}addCallback(a,f,_){let T=-1;f&&f>0&&(T=setTimeout(()=>{this._callbacks=this._callbacks.filter(R=>R.timeoutId!==T),a(this._didWork,this.getPendingTasks())},f)),this._callbacks.push({doneCb:a,timeoutId:T,updateCb:_})}whenStable(a,f,_){if(_&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(a,f,_),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(a,f,_){return[]}}return r.\u0275fac=function(a){return new(a||r)(xn(sh))},r.\u0275prov=gr({token:r,factory:r.\u0275fac}),r})(),ww=(()=>{class r{constructor(){this._applications=new Map,Q0.addToWindow(this)}registerApplication(a,f){this._applications.set(a,f)}unregisterApplication(a){this._applications.delete(a)}unregisterAllApplications(){this._applications.clear()}getTestability(a){return this._applications.get(a)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(a,f=!0){return Q0.findTestabilityInTree(this,a,f)}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=gr({token:r,factory:r.\u0275fac}),r})();class Ux{addToWindow(o){}findTestabilityInTree(o,a,f){return null}}function zx(r){Q0=r}let dd,Q0=new Ux;const xw=new _o("AllowMultipleToken");class Hx{constructor(o,a){this.name=o,this.token=a}}function Ew(r,o,a=[]){const f=`Platform: ${o}`,_=new _o(f);return(T=[])=>{let R=Iw();if(!R||R.injector.get(xw,!1))if(r)r(a.concat(T).concat({provide:_,useValue:!0}));else{const z=a.concat(T).concat({provide:_,useValue:!0},{provide:If,useValue:"platform"});!function $x(r){if(dd&&!dd.destroyed&&!dd.injector.get(xw,!1))throw new bt(400,"");dd=r.get(Tw);const o=r.get(fw,null);o&&o.forEach(a=>a())}(ll.create({providers:z,name:f}))}return function Gx(r){const o=Iw();if(!o)throw new bt(401,"");return o}()}}function Iw(){return dd&&!dd.destroyed?dd:null}let Tw=(()=>{class r{constructor(a){this._injector=a,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(a,f){const z=function qx(r,o){let a;return a="noop"===r?new Bx:("zone.js"===r?void 0:r)||new sh({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==o?void 0:o.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==o?void 0:o.ngZoneRunCoalescing)}),a}(f?f.ngZone:void 0,{ngZoneEventCoalescing:f&&f.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:f&&f.ngZoneRunCoalescing||!1}),X=[{provide:sh,useValue:z}];return z.run(()=>{const Ce=ll.create({providers:X,parent:this.injector,name:a.moduleType.name}),He=a.create(Ce),It=He.injector.get(jc,null);if(!It)throw new bt(402,"");return z.runOutsideAngular(()=>{const Gt=z.onError.subscribe({next:hn=>{It.handleError(hn)}});He.onDestroy(()=>{eb(this._modules,He),Gt.unsubscribe()})}),function Wx(r,o,a){try{const f=a();return Bf(f)?f.catch(_=>{throw o.runOutsideAngular(()=>r.handleError(_)),_}):f}catch(f){throw o.runOutsideAngular(()=>r.handleError(f)),f}}(It,z,()=>{const Gt=He.injector.get(bg);return Gt.runInitializers(),Gt.donePromise.then(()=>(function ay(r){(function nn(r,o){null==r&&qt(o,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(Im=r.toLowerCase().replace(/_/g,"-"))}(He.injector.get(lv,lg)||lg),this._moduleDoBootstrap(He),He))})})}bootstrapModule(a,f=[]){const _=Sw({},f);return function Vx(r,o,a){const f=new fr(a);return Promise.resolve(f)}(0,0,a).then(T=>this.bootstrapModuleFactory(T,_))}_moduleDoBootstrap(a){const f=a.injector.get(Ny);if(a._bootstrapComponents.length>0)a._bootstrapComponents.forEach(_=>f.bootstrap(_));else{if(!a.instance.ngDoBootstrap)throw new bt(403,"");a.instance.ngDoBootstrap(f)}this._modules.push(a)}onDestroy(a){this._destroyListeners.push(a)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new bt(404,"");this._modules.slice().forEach(a=>a.destroy()),this._destroyListeners.forEach(a=>a()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(a){return new(a||r)(xn(ll))},r.\u0275prov=gr({token:r,factory:r.\u0275fac}),r})();function Sw(r,o){return Array.isArray(o)?o.reduce(Sw,r):Object.assign(Object.assign({},r),o)}let Ny=(()=>{class r{constructor(a,f,_,T,R){this._zone=a,this._injector=f,this._exceptionHandler=_,this._componentFactoryResolver=T,this._initStatus=R,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const z=new g.y(Ce=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{Ce.next(this._stable),Ce.complete()})}),X=new g.y(Ce=>{let He;this._zone.runOutsideAngular(()=>{He=this._zone.onStable.subscribe(()=>{sh.assertNotInAngularZone(),Y0(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,Ce.next(!0))})})});const It=this._zone.onUnstable.subscribe(()=>{sh.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{Ce.next(!1)}))});return()=>{He.unsubscribe(),It.unsubscribe()}});this.isStable=(0,nt.T)(z,X.pipe((0,xe.B)()))}bootstrap(a,f){if(!this._initStatus.done)throw new bt(405,"");let _;_=a instanceof Sy?a:this._componentFactoryResolver.resolveComponentFactory(a),this.componentTypes.push(_.componentType);const T=function jx(r){return r.isBoundToModule}(_)?void 0:this._injector.get(y),z=_.create(ll.NULL,[],f||_.selector,T),X=z.location.nativeElement,Ce=z.injector.get(bw,null),He=Ce&&z.injector.get(ww);return Ce&&He&&He.registerApplication(X,Ce),z.onDestroy(()=>{this.detachView(z.hostView),eb(this.components,z),He&&He.unregisterApplication(X)}),this._loadComponent(z),z}tick(){if(this._runningTick)throw new bt(101,"");try{this._runningTick=!0;for(let a of this._views)a.detectChanges()}catch(a){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(a))}finally{this._runningTick=!1}}attachView(a){const f=a;this._views.push(f),f.attachToAppRef(this)}detachView(a){const f=a;eb(this._views,f),f.detachFromAppRef()}_loadComponent(a){this.attachView(a.hostView),this.tick(),this.components.push(a),this._injector.get(mw,[]).concat(this._bootstrapListeners).forEach(_=>_(a))}ngOnDestroy(){this._views.slice().forEach(a=>a.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return r.\u0275fac=function(a){return new(a||r)(xn(sh),xn(ll),xn(jc),xn(Zp),xn(bg))},r.\u0275prov=gr({token:r,factory:r.\u0275fac}),r})();function eb(r,o){const a=r.indexOf(o);a>-1&&r.splice(a,1)}let Dw=!0,Aw=!1;function Kx(){return Aw=!0,Dw}function Yx(){if(Aw)throw new Error("Cannot enable prod mode after platform setup.");Dw=!1}let Jx=(()=>{class r{}return r.__NG_ELEMENT_ID__=Xx,r})();function Xx(r){return function Qx(r,o,a){if(ns(r)&&!a){const f=ni(r.index,o);return new Pm(f,f)}return 47&r.type?new Pm(o[16],o):null}(xo(),Nn(),16==(16&r))}class Lw{constructor(){}supports(o){return Rp(o)}create(o){return new s1(o)}}const o1=(r,o)=>o;class s1{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||o1}forEachItem(o){let a;for(a=this._itHead;null!==a;a=a._next)o(a)}forEachOperation(o){let a=this._itHead,f=this._removalsHead,_=0,T=null;for(;a||f;){const R=!f||a&&a.currentIndex<Fw(f,_,T)?a:f,z=Fw(R,_,T),X=R.currentIndex;if(R===f)_--,f=f._nextRemoved;else if(a=a._next,null==R.previousIndex)_++;else{T||(T=[]);const Ce=z-_,He=X-_;if(Ce!=He){for(let Gt=0;Gt<Ce;Gt++){const hn=Gt<T.length?T[Gt]:T[Gt]=0,Ln=hn+Gt;He<=Ln&&Ln<Ce&&(T[Gt]=hn+1)}T[R.previousIndex]=He-Ce}}z!==X&&o(R,z,X)}}forEachPreviousItem(o){let a;for(a=this._previousItHead;null!==a;a=a._nextPrevious)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachMovedItem(o){let a;for(a=this._movesHead;null!==a;a=a._nextMoved)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}forEachIdentityChange(o){let a;for(a=this._identityChangesHead;null!==a;a=a._nextIdentityChange)o(a)}diff(o){if(null==o&&(o=[]),!Rp(o))throw new bt(900,"");return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let _,T,R,a=this._itHead,f=!1;if(Array.isArray(o)){this.length=o.length;for(let z=0;z<this.length;z++)T=o[z],R=this._trackByFn(z,T),null!==a&&Object.is(a.trackById,R)?(f&&(a=this._verifyReinsertion(a,T,R,z)),Object.is(a.item,T)||this._addIdentityChange(a,T)):(a=this._mismatch(a,T,R,z),f=!0),a=a._next}else _=0,function By(r,o){if(Array.isArray(r))for(let a=0;a<r.length;a++)o(r[a]);else{const a=r[Pp()]();let f;for(;!(f=a.next()).done;)o(f.value)}}(o,z=>{R=this._trackByFn(_,z),null!==a&&Object.is(a.trackById,R)?(f&&(a=this._verifyReinsertion(a,z,R,_)),Object.is(a.item,z)||this._addIdentityChange(a,z)):(a=this._mismatch(a,z,R,_),f=!0),a=a._next,_++}),this.length=_;return this._truncate(a),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,a,f,_){let T;return null===o?T=this._itTail:(T=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._reinsertAfter(o,T,_)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(f,_))?(Object.is(o.item,a)||this._addIdentityChange(o,a),this._moveAfter(o,T,_)):o=this._addAfter(new a1(a,f),T,_),o}_verifyReinsertion(o,a,f,_){let T=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null);return null!==T?o=this._reinsertAfter(T,o._prev,_):o.currentIndex!=_&&(o.currentIndex=_,this._addToMoves(o,_)),o}_truncate(o){for(;null!==o;){const a=o._next;this._addToRemovals(this._unlink(o)),o=a}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,a,f){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const _=o._prevRemoved,T=o._nextRemoved;return null===_?this._removalsHead=T:_._nextRemoved=T,null===T?this._removalsTail=_:T._prevRemoved=_,this._insertAfter(o,a,f),this._addToMoves(o,f),o}_moveAfter(o,a,f){return this._unlink(o),this._insertAfter(o,a,f),this._addToMoves(o,f),o}_addAfter(o,a,f){return this._insertAfter(o,a,f),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,a,f){const _=null===a?this._itHead:a._next;return o._next=_,o._prev=a,null===_?this._itTail=o:_._prev=o,null===a?this._itHead=o:a._next=o,null===this._linkedRecords&&(this._linkedRecords=new Nw),this._linkedRecords.put(o),o.currentIndex=f,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const a=o._prev,f=o._next;return null===a?this._itHead=f:a._next=f,null===f?this._itTail=a:f._prev=a,o}_addToMoves(o,a){return o.previousIndex===a||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Nw),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,a){return o.item=a,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class a1{constructor(o,a){this.item=o,this.trackById=a,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class u1{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,a){let f;for(f=this._head;null!==f;f=f._nextDup)if((null===a||a<=f.currentIndex)&&Object.is(f.trackById,o))return f;return null}remove(o){const a=o._prevDup,f=o._nextDup;return null===a?this._head=f:a._nextDup=f,null===f?this._tail=a:f._prevDup=a,null===this._head}}class Nw{constructor(){this.map=new Map}put(o){const a=o.trackById;let f=this.map.get(a);f||(f=new u1,this.map.set(a,f)),f.add(o)}get(o,a){const _=this.map.get(o);return _?_.get(o,a):null}remove(o){const a=o.trackById;return this.map.get(a).remove(o)&&this.map.delete(a),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Fw(r,o,a){const f=r.previousIndex;if(null===f)return f;let _=0;return a&&f<a.length&&(_=a[f]),f+o+_}class Bw{constructor(){}supports(o){return o instanceof Map||Tg(o)}create(){return new l1}}class l1{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let a;for(a=this._mapHead;null!==a;a=a._next)o(a)}forEachPreviousItem(o){let a;for(a=this._previousMapHead;null!==a;a=a._nextPrevious)o(a)}forEachChangedItem(o){let a;for(a=this._changesHead;null!==a;a=a._nextChanged)o(a)}forEachAddedItem(o){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)o(a)}forEachRemovedItem(o){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)o(a)}diff(o){if(o){if(!(o instanceof Map||Tg(o)))throw new bt(900,"")}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let a=this._mapHead;if(this._appendAfter=null,this._forEach(o,(f,_)=>{if(a&&a.key===_)this._maybeAddToChanges(a,f),this._appendAfter=a,a=a._next;else{const T=this._getOrCreateRecordForKey(_,f);a=this._insertBeforeOrAppend(a,T)}}),a){a._prev&&(a._prev._next=null),this._removalsHead=a;for(let f=a;null!==f;f=f._nextRemoved)f===this._mapHead&&(this._mapHead=null),this._records.delete(f.key),f._nextRemoved=f._next,f.previousValue=f.currentValue,f.currentValue=null,f._prev=null,f._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,a){if(o){const f=o._prev;return a._next=o,a._prev=f,o._prev=a,f&&(f._next=a),o===this._mapHead&&(this._mapHead=a),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=a,a._prev=this._appendAfter):this._mapHead=a,this._appendAfter=a,null}_getOrCreateRecordForKey(o,a){if(this._records.has(o)){const _=this._records.get(o);this._maybeAddToChanges(_,a);const T=_._prev,R=_._next;return T&&(T._next=R),R&&(R._prev=T),_._next=null,_._prev=null,_}const f=new c1(o);return this._records.set(o,f),f.currentValue=a,this._addToAdditions(f),f}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,a){Object.is(a,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=a,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,a){o instanceof Map?o.forEach(a):Object.keys(o).forEach(f=>a(o[f],f))}}class c1{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Uw(){return new hv([new Lw])}let hv=(()=>{class r{constructor(a){this.factories=a}static create(a,f){if(null!=f){const _=f.factories.slice();a=a.concat(_)}return new r(a)}static extend(a){return{provide:r,useFactory:f=>r.create(a,f||Uw()),deps:[[r,new vo,new Qi]]}}find(a){const f=this.factories.find(_=>_.supports(a));if(null!=f)return f;throw new bt(901,"")}}return r.\u0275prov=gr({token:r,providedIn:"root",factory:Uw}),r})();function zw(){return new dv([new Bw])}let dv=(()=>{class r{constructor(a){this.factories=a}static create(a,f){if(f){const _=f.factories.slice();a=a.concat(_)}return new r(a)}static extend(a){return{provide:r,useFactory:f=>r.create(a,f||zw()),deps:[[r,new vo,new Qi]]}}find(a){const f=this.factories.find(T=>T.supports(a));if(f)return f;throw new bt(901,"")}}return r.\u0275prov=gr({token:r,providedIn:"root",factory:zw}),r})();const h1=[new Bw],f1=new hv([new Lw]),p1=new dv(h1),m1=Ew(null,"core",[{provide:pw,useValue:"unknown"},{provide:Tw,deps:[ll]},{provide:ww,deps:[]},{provide:gw,deps:[]}]),b1=[{provide:Ny,useClass:Ny,deps:[sh,ll,jc,Zp,bg]},{provide:nv,deps:[sh],useFactory:function w1(r){let o=[];return r.onStable.subscribe(()=>{for(;o.length;)o.pop()()}),function(a){o.push(a)}}},{provide:bg,useClass:bg,deps:[[new Qi,W0]]},{provide:K0,useClass:K0,deps:[]},Mx,{provide:hv,useFactory:function g1(){return f1},deps:[]},{provide:dv,useFactory:function y1(){return p1},deps:[]},{provide:lv,useFactory:function _1(r){return r||function v1(){return"undefined"!=typeof $localize&&$localize.locale||lg}()},deps:[[new Ei(lv),new Qi,new vo]]},{provide:yw,useValue:"USD"}];let x1=(()=>{class r{constructor(a){}}return r.\u0275fac=function(a){return new(a||r)(xn(Ny))},r.\u0275mod=Lt({type:r}),r.\u0275inj=Er({providers:b1}),r})()},2313:(Sn,Nt,H)=>{"use strict";H.d(Nt,{b2:()=>pi,H7:()=>ot,q6:()=>fi});var w=H(9808),ue=H(5e3);class g extends w.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class nt extends g{static makeCurrent(){(0,w.HT)(new nt)}onAndCancel(ze,Ve,mt){return ze.addEventListener(Ve,mt,!1),()=>{ze.removeEventListener(Ve,mt,!1)}}dispatchEvent(ze,Ve){ze.dispatchEvent(Ve)}remove(ze){ze.parentNode&&ze.parentNode.removeChild(ze)}createElement(ze,Ve){return(Ve=Ve||this.getDefaultDocument()).createElement(ze)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(ze){return ze.nodeType===Node.ELEMENT_NODE}isShadowRoot(ze){return ze instanceof DocumentFragment}getGlobalEventTarget(ze,Ve){return"window"===Ve?window:"document"===Ve?ze:"body"===Ve?ze.body:null}getBaseHref(ze){const Ve=function Le(){return xe=xe||document.querySelector("base"),xe?xe.getAttribute("href"):null}();return null==Ve?null:function Ue(Ie){Re=Re||document.createElement("a"),Re.setAttribute("href",Ie);const ze=Re.pathname;return"/"===ze.charAt(0)?ze:`/${ze}`}(Ve)}resetBaseElement(){xe=null}getUserAgent(){return window.navigator.userAgent}getCookie(ze){return(0,w.Mx)(document.cookie,ze)}}let Re,xe=null;const fe=new ue.OlP("TRANSITION_ID"),ae=[{provide:ue.ip1,useFactory:function se(Ie,ze,Ve){return()=>{Ve.get(ue.CZH).donePromise.then(()=>{const mt=(0,w.q)(),Tt=ze.querySelectorAll(`style[ng-transition="${Ie}"]`);for(let en=0;en<Tt.length;en++)mt.remove(Tt[en])})}},deps:[fe,w.K0,ue.zs3],multi:!0}];class $e{static init(){(0,ue.VLi)(new $e)}addToWindow(ze){ue.dqk.getAngularTestability=(mt,Tt=!0)=>{const en=ze.findTestabilityInTree(mt,Tt);if(null==en)throw new Error("Could not find testability for element.");return en},ue.dqk.getAllAngularTestabilities=()=>ze.getAllTestabilities(),ue.dqk.getAllAngularRootElements=()=>ze.getAllRootElements(),ue.dqk.frameworkStabilizers||(ue.dqk.frameworkStabilizers=[]),ue.dqk.frameworkStabilizers.push(mt=>{const Tt=ue.dqk.getAllAngularTestabilities();let en=Tt.length,Dn=!1;const zn=function(an){Dn=Dn||an,en--,0==en&&mt(Dn)};Tt.forEach(function(an){an.whenStable(zn)})})}findTestabilityInTree(ze,Ve,mt){if(null==Ve)return null;const Tt=ze.getTestability(Ve);return null!=Tt?Tt:mt?(0,w.q)().isShadowRoot(Ve)?this.findTestabilityInTree(ze,Ve.host,!0):this.findTestabilityInTree(ze,Ve.parentElement,!0):null}}let St=(()=>{class Ie{build(){return new XMLHttpRequest}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)},Ie.\u0275prov=ue.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})();const pt=new ue.OlP("EventManagerPlugins");let bt=(()=>{class Ie{constructor(Ve,mt){this._zone=mt,this._eventNameToPlugin=new Map,Ve.forEach(Tt=>Tt.manager=this),this._plugins=Ve.slice().reverse()}addEventListener(Ve,mt,Tt){return this._findPluginFor(mt).addEventListener(Ve,mt,Tt)}addGlobalEventListener(Ve,mt,Tt){return this._findPluginFor(mt).addGlobalEventListener(Ve,mt,Tt)}getZone(){return this._zone}_findPluginFor(Ve){const mt=this._eventNameToPlugin.get(Ve);if(mt)return mt;const Tt=this._plugins;for(let en=0;en<Tt.length;en++){const Dn=Tt[en];if(Dn.supports(Ve))return this._eventNameToPlugin.set(Ve,Dn),Dn}throw new Error(`No event manager plugin found for event ${Ve}`)}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)(ue.LFG(pt),ue.LFG(ue.R0b))},Ie.\u0275prov=ue.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})();class Ct{constructor(ze){this._doc=ze}addGlobalEventListener(ze,Ve,mt){const Tt=(0,w.q)().getGlobalEventTarget(this._doc,ze);if(!Tt)throw new Error(`Unsupported event target ${Tt} for event ${Ve}`);return this.addEventListener(Tt,Ve,mt)}}let ct=(()=>{class Ie{constructor(){this._stylesSet=new Set}addStyles(Ve){const mt=new Set;Ve.forEach(Tt=>{this._stylesSet.has(Tt)||(this._stylesSet.add(Tt),mt.add(Tt))}),this.onStylesAdded(mt)}onStylesAdded(Ve){}getAllStyles(){return Array.from(this._stylesSet)}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)},Ie.\u0275prov=ue.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})(),ut=(()=>{class Ie extends ct{constructor(Ve){super(),this._doc=Ve,this._hostNodes=new Map,this._hostNodes.set(Ve.head,[])}_addStylesToHost(Ve,mt,Tt){Ve.forEach(en=>{const Dn=this._doc.createElement("style");Dn.textContent=en,Tt.push(mt.appendChild(Dn))})}addHost(Ve){const mt=[];this._addStylesToHost(this._stylesSet,Ve,mt),this._hostNodes.set(Ve,mt)}removeHost(Ve){const mt=this._hostNodes.get(Ve);mt&&mt.forEach(he),this._hostNodes.delete(Ve)}onStylesAdded(Ve){this._hostNodes.forEach((mt,Tt)=>{this._addStylesToHost(Ve,Tt,mt)})}ngOnDestroy(){this._hostNodes.forEach(Ve=>Ve.forEach(he))}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)(ue.LFG(w.K0))},Ie.\u0275prov=ue.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})();function he(Ie){(0,w.q)().remove(Ie)}const je={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ae=/%COMP%/g,W="%COMP%",ge=`_nghost-${W}`,q=`_ngcontent-${W}`;function ee(Ie,ze,Ve){for(let mt=0;mt<ze.length;mt++){let Tt=ze[mt];Array.isArray(Tt)?ee(Ie,Tt,Ve):(Tt=Tt.replace(Ae,Ie),Ve.push(Tt))}return Ve}function Pe(Ie){return ze=>{if("__ngUnwrap__"===ze)return Ie;!1===Ie(ze)&&(ze.preventDefault(),ze.returnValue=!1)}}let We=(()=>{class Ie{constructor(Ve,mt,Tt){this.eventManager=Ve,this.sharedStylesHost=mt,this.appId=Tt,this.rendererByCompId=new Map,this.defaultRenderer=new rt(Ve)}createRenderer(Ve,mt){if(!Ve||!mt)return this.defaultRenderer;switch(mt.encapsulation){case ue.ifc.Emulated:{let Tt=this.rendererByCompId.get(mt.id);return Tt||(Tt=new Zt(this.eventManager,this.sharedStylesHost,mt,this.appId),this.rendererByCompId.set(mt.id,Tt)),Tt.applyToHost(Ve),Tt}case 1:case ue.ifc.ShadowDom:return new nn(this.eventManager,this.sharedStylesHost,Ve,mt);default:if(!this.rendererByCompId.has(mt.id)){const Tt=ee(mt.id,mt.styles,[]);this.sharedStylesHost.addStyles(Tt),this.rendererByCompId.set(mt.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)(ue.LFG(bt),ue.LFG(ut),ue.LFG(ue.AFp))},Ie.\u0275prov=ue.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})();class rt{constructor(ze){this.eventManager=ze,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(ze,Ve){return Ve?document.createElementNS(je[Ve],ze):document.createElement(ze)}createComment(ze){return document.createComment(ze)}createText(ze){return document.createTextNode(ze)}appendChild(ze,Ve){ze.appendChild(Ve)}insertBefore(ze,Ve,mt){ze&&ze.insertBefore(Ve,mt)}removeChild(ze,Ve){ze&&ze.removeChild(Ve)}selectRootElement(ze,Ve){let mt="string"==typeof ze?document.querySelector(ze):ze;if(!mt)throw new Error(`The selector "${ze}" did not match any elements`);return Ve||(mt.textContent=""),mt}parentNode(ze){return ze.parentNode}nextSibling(ze){return ze.nextSibling}setAttribute(ze,Ve,mt,Tt){if(Tt){Ve=Tt+":"+Ve;const en=je[Tt];en?ze.setAttributeNS(en,Ve,mt):ze.setAttribute(Ve,mt)}else ze.setAttribute(Ve,mt)}removeAttribute(ze,Ve,mt){if(mt){const Tt=je[mt];Tt?ze.removeAttributeNS(Tt,Ve):ze.removeAttribute(`${mt}:${Ve}`)}else ze.removeAttribute(Ve)}addClass(ze,Ve){ze.classList.add(Ve)}removeClass(ze,Ve){ze.classList.remove(Ve)}setStyle(ze,Ve,mt,Tt){Tt&(ue.JOm.DashCase|ue.JOm.Important)?ze.style.setProperty(Ve,mt,Tt&ue.JOm.Important?"important":""):ze.style[Ve]=mt}removeStyle(ze,Ve,mt){mt&ue.JOm.DashCase?ze.style.removeProperty(Ve):ze.style[Ve]=""}setProperty(ze,Ve,mt){ze[Ve]=mt}setValue(ze,Ve){ze.nodeValue=Ve}listen(ze,Ve,mt){return"string"==typeof ze?this.eventManager.addGlobalEventListener(ze,Ve,Pe(mt)):this.eventManager.addEventListener(ze,Ve,Pe(mt))}}class Zt extends rt{constructor(ze,Ve,mt,Tt){super(ze),this.component=mt;const en=ee(Tt+"-"+mt.id,mt.styles,[]);Ve.addStyles(en),this.contentAttr=function U(Ie){return q.replace(Ae,Ie)}(Tt+"-"+mt.id),this.hostAttr=function Y(Ie){return ge.replace(Ae,Ie)}(Tt+"-"+mt.id)}applyToHost(ze){super.setAttribute(ze,this.hostAttr,"")}createElement(ze,Ve){const mt=super.createElement(ze,Ve);return super.setAttribute(mt,this.contentAttr,""),mt}}class nn extends rt{constructor(ze,Ve,mt,Tt){super(ze),this.sharedStylesHost=Ve,this.hostEl=mt,this.shadowRoot=mt.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const en=ee(Tt.id,Tt.styles,[]);for(let Dn=0;Dn<en.length;Dn++){const zn=document.createElement("style");zn.textContent=en[Dn],this.shadowRoot.appendChild(zn)}}nodeOrShadowRoot(ze){return ze===this.hostEl?this.shadowRoot:ze}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(ze,Ve){return super.appendChild(this.nodeOrShadowRoot(ze),Ve)}insertBefore(ze,Ve,mt){return super.insertBefore(this.nodeOrShadowRoot(ze),Ve,mt)}removeChild(ze,Ve){return super.removeChild(this.nodeOrShadowRoot(ze),Ve)}parentNode(ze){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(ze)))}}let qt=(()=>{class Ie extends Ct{constructor(Ve){super(Ve)}supports(Ve){return!0}addEventListener(Ve,mt,Tt){return Ve.addEventListener(mt,Tt,!1),()=>this.removeEventListener(Ve,mt,Tt)}removeEventListener(Ve,mt,Tt){return Ve.removeEventListener(mt,Tt)}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)(ue.LFG(w.K0))},Ie.\u0275prov=ue.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})();const An=["alt","control","meta","shift"],jn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gr={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},lr={alt:Ie=>Ie.altKey,control:Ie=>Ie.ctrlKey,meta:Ie=>Ie.metaKey,shift:Ie=>Ie.shiftKey};let Er=(()=>{class Ie extends Ct{constructor(Ve){super(Ve)}supports(Ve){return null!=Ie.parseEventName(Ve)}addEventListener(Ve,mt,Tt){const en=Ie.parseEventName(mt),Dn=Ie.eventCallback(en.fullKey,Tt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,w.q)().onAndCancel(Ve,en.domEventName,Dn))}static parseEventName(Ve){const mt=Ve.toLowerCase().split("."),Tt=mt.shift();if(0===mt.length||"keydown"!==Tt&&"keyup"!==Tt)return null;const en=Ie._normalizeKey(mt.pop());let Dn="";if(An.forEach(an=>{const Kn=mt.indexOf(an);Kn>-1&&(mt.splice(Kn,1),Dn+=an+".")}),Dn+=en,0!=mt.length||0===en.length)return null;const zn={};return zn.domEventName=Tt,zn.fullKey=Dn,zn}static getEventFullKey(Ve){let mt="",Tt=function Sr(Ie){let ze=Ie.key;if(null==ze){if(ze=Ie.keyIdentifier,null==ze)return"Unidentified";ze.startsWith("U+")&&(ze=String.fromCharCode(parseInt(ze.substring(2),16)),3===Ie.location&&gr.hasOwnProperty(ze)&&(ze=gr[ze]))}return jn[ze]||ze}(Ve);return Tt=Tt.toLowerCase()," "===Tt?Tt="space":"."===Tt&&(Tt="dot"),An.forEach(en=>{en!=Tt&&lr[en](Ve)&&(mt+=en+".")}),mt+=Tt,mt}static eventCallback(Ve,mt,Tt){return en=>{Ie.getEventFullKey(en)===Ve&&Tt.runGuarded(()=>mt(en))}}static _normalizeKey(Ve){return"esc"===Ve?"escape":Ve}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)(ue.LFG(w.K0))},Ie.\u0275prov=ue.Yz7({token:Ie,factory:Ie.\u0275fac}),Ie})();const fi=(0,ue.eFA)(ue._c5,"browser",[{provide:ue.Lbi,useValue:w.bD},{provide:ue.g9A,useValue:function di(){nt.makeCurrent(),$e.init()},multi:!0},{provide:w.K0,useFactory:function qi(){return(0,ue.RDi)(document),document},deps:[]}]),bi=[{provide:ue.zSh,useValue:"root"},{provide:ue.qLn,useFactory:function vr(){return new ue.qLn},deps:[]},{provide:pt,useClass:qt,multi:!0,deps:[w.K0,ue.R0b,ue.Lbi]},{provide:pt,useClass:Er,multi:!0,deps:[w.K0]},{provide:We,useClass:We,deps:[bt,ut,ue.AFp]},{provide:ue.FYo,useExisting:We},{provide:ct,useExisting:ut},{provide:ut,useClass:ut,deps:[w.K0]},{provide:ue.dDg,useClass:ue.dDg,deps:[ue.R0b]},{provide:bt,useClass:bt,deps:[pt,ue.R0b]},{provide:w.JF,useClass:St,deps:[]}];let pi=(()=>{class Ie{constructor(Ve){if(Ve)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(Ve){return{ngModule:Ie,providers:[{provide:ue.AFp,useValue:Ve.appId},{provide:fe,useExisting:ue.AFp},ae]}}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)(ue.LFG(Ie,12))},Ie.\u0275mod=ue.oAB({type:Ie}),Ie.\u0275inj=ue.cJS({providers:bi,imports:[w.ez,ue.hGG]}),Ie})();"undefined"!=typeof window&&window;let ot=(()=>{class Ie{}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)},Ie.\u0275prov=ue.Yz7({token:Ie,factory:function(Ve){let mt=null;return mt=Ve?new(Ve||Ie):ue.LFG(Lt),mt},providedIn:"root"}),Ie})(),Lt=(()=>{class Ie extends ot{constructor(Ve){super(),this._doc=Ve}sanitize(Ve,mt){if(null==mt)return null;switch(Ve){case ue.q3G.NONE:return mt;case ue.q3G.HTML:return(0,ue.qzn)(mt,"HTML")?(0,ue.z3N)(mt):(0,ue.EiD)(this._doc,String(mt)).toString();case ue.q3G.STYLE:return(0,ue.qzn)(mt,"Style")?(0,ue.z3N)(mt):mt;case ue.q3G.SCRIPT:if((0,ue.qzn)(mt,"Script"))return(0,ue.z3N)(mt);throw new Error("unsafe value used in a script context");case ue.q3G.URL:return(0,ue.yhl)(mt),(0,ue.qzn)(mt,"URL")?(0,ue.z3N)(mt):(0,ue.mCW)(String(mt));case ue.q3G.RESOURCE_URL:if((0,ue.qzn)(mt,"ResourceURL"))return(0,ue.z3N)(mt);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${Ve} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(Ve){return(0,ue.JVY)(Ve)}bypassSecurityTrustStyle(Ve){return(0,ue.L6k)(Ve)}bypassSecurityTrustScript(Ve){return(0,ue.eBb)(Ve)}bypassSecurityTrustUrl(Ve){return(0,ue.LAX)(Ve)}bypassSecurityTrustResourceUrl(Ve){return(0,ue.pB0)(Ve)}}return Ie.\u0275fac=function(Ve){return new(Ve||Ie)(ue.LFG(w.K0))},Ie.\u0275prov=ue.Yz7({token:Ie,factory:function(Ve){let mt=null;return mt=Ve?new Ve:function Dt(Ie){return new Lt(Ie.get(w.K0))}(ue.LFG(ue.zs3)),mt},providedIn:"root"}),Ie})()},4259:(Sn,Nt,H)=>{"use strict";H.d(Nt,{gz:()=>Br,m2:()=>vr,OD:()=>di,F0:()=>Mt,yS:()=>or,Bz:()=>cu,lC:()=>wo});var w=H(5e3),ue=H(7579);class g extends ue.x{constructor(F){super(),this._value=F}get value(){return this.getValue()}_subscribe(F){const M=super._subscribe(F);return!M.closed&&F.next(this._value),M}getValue(){const{hasError:F,thrownError:M,_value:J}=this;if(F)throw M;return this._throwIfClosed(),J}next(F){super.next(this._value=F)}}var nt=H(8306),xe=H(4742),Le=H(8996),Re=H(4671),Ue=H(3268),fe=H(3269),se=H(1810),ae=H(5403),$e=H(9672);function bt(V,F,M){V?(0,$e.f)(M,V,F):F()}var Ct=H(727),ct=H(4482);function ut(){return(0,ct.e)((V,F)=>{let M=null;V._refCount++;const J=new ae.Q(F,void 0,void 0,void 0,()=>{if(!V||V._refCount<=0||0<--V._refCount)return void(M=null);const ye=V._connection,De=M;M=null,ye&&(!De||ye===De)&&ye.unsubscribe(),F.unsubscribe()});V.subscribe(J),J.closed||(M=V.connect())})}class he extends nt.y{constructor(F,M){super(),this.source=F,this.subjectFactory=M,this._subject=null,this._refCount=0,this._connection=null,(0,ct.A)(F)&&(this.lift=F.lift)}_subscribe(F){return this.getSubject().subscribe(F)}getSubject(){const F=this._subject;return(!F||F.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:F}=this;this._subject=this._connection=null,null==F||F.unsubscribe()}connect(){let F=this._connection;if(!F){F=this._connection=new Ct.w0;const M=this.getSubject();F.add(this.source.subscribe(new ae.Q(M,void 0,()=>{this._teardown(),M.complete()},J=>{this._teardown(),M.error(J)},()=>this._teardown()))),F.closed&&(this._connection=null,F=Ct.w0.EMPTY)}return F}refCount(){return ut()(this)}}var je=H(9646),Ae=H(6805),j=H(7272),W=H(9770),ge=H(515),q=H(8421);function U(V){return(0,ct.e)((F,M)=>{let De,J=null,ye=!1;J=F.subscribe(new ae.Q(M,void 0,void 0,Ne=>{De=(0,q.Xf)(V(Ne,U(V)(F))),J?(J.unsubscribe(),J=null,De.subscribe(M)):ye=!0})),ye&&(J.unsubscribe(),J=null,De.subscribe(M))})}var Y=H(9300);function ee(V){return V<=0?()=>ge.E:(0,ct.e)((F,M)=>{let J=[];F.subscribe(new ae.Q(M,ye=>{J.push(ye),V<J.length&&J.shift()},()=>{for(const ye of J)M.next(ye);M.complete()},void 0,()=>{J=null}))})}var Pe=H(8068),_e=H(6590),_t=H(4004),ft=H(3900),Zt=H(5698),nn=H(8675),qt=H(5026),An=H(4351),kn=H(590),jn=H(5577),gr=H(8505),lr=H(8189),Er=H(9808);class Sr{constructor(F,M){this.id=F,this.url=M}}class di extends Sr{constructor(F,M,J="imperative",ye=null){super(F,M),this.navigationTrigger=J,this.restoredState=ye}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class vr extends Sr{constructor(F,M,J){super(F,M),this.urlAfterRedirects=J}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class qi extends Sr{constructor(F,M,J){super(F,M),this.reason=J}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ii extends Sr{constructor(F,M,J){super(F,M),this.error=J}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class fi extends Sr{constructor(F,M,J,ye){super(F,M),this.urlAfterRedirects=J,this.state=ye}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bi extends Sr{constructor(F,M,J,ye){super(F,M),this.urlAfterRedirects=J,this.state=ye}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pi extends Sr{constructor(F,M,J,ye,De){super(F,M),this.urlAfterRedirects=J,this.state=ye,this.shouldActivate=De}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class oi extends Sr{constructor(F,M,J,ye){super(F,M),this.urlAfterRedirects=J,this.state=ye}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xt extends Sr{constructor(F,M,J,ye){super(F,M),this.urlAfterRedirects=J,this.state=ye}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ln{constructor(F){this.route=F}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class En{constructor(F){this.route=F}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class bn{constructor(F){this.snapshot=F}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Wn{constructor(F){this.snapshot=F}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class jt{constructor(F){this.snapshot=F}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ve{constructor(F){this.snapshot=F}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class me{constructor(F,M,J){this.routerEvent=F,this.position=M,this.anchor=J}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const re="primary";class ht{constructor(F){this.params=F||{}}has(F){return Object.prototype.hasOwnProperty.call(this.params,F)}get(F){if(this.has(F)){const M=this.params[F];return Array.isArray(M)?M[0]:M}return null}getAll(F){if(this.has(F)){const M=this.params[F];return Array.isArray(M)?M:[M]}return[]}get keys(){return Object.keys(this.params)}}function zt(V){return new ht(V)}const sn="ngNavigationCancelingError";function Mn(V){const F=Error("NavigationCancelingError: "+V);return F[sn]=!0,F}function Tr(V,F,M){const J=M.path.split("/");if(J.length>V.length||"full"===M.pathMatch&&(F.hasChildren()||J.length<V.length))return null;const ye={};for(let De=0;De<J.length;De++){const Ne=J[De],at=V[De];if(Ne.startsWith(":"))ye[Ne.substring(1)]=at;else if(Ne!==at.path)return null}return{consumed:V.slice(0,J.length),posParams:ye}}function Ki(V,F){const M=V?Object.keys(V):void 0,J=F?Object.keys(F):void 0;if(!M||!J||M.length!=J.length)return!1;let ye;for(let De=0;De<M.length;De++)if(ye=M[De],!Li(V[ye],F[ye]))return!1;return!0}function Li(V,F){if(Array.isArray(V)&&Array.isArray(F)){if(V.length!==F.length)return!1;const M=[...V].sort(),J=[...F].sort();return M.every((ye,De)=>J[De]===ye)}return V===F}function Ht(V){return Array.prototype.concat.apply([],V)}function Te(V){return V.length>0?V[V.length-1]:null}function tt(V,F){for(const M in V)V.hasOwnProperty(M)&&F(V[M],M)}function Ft(V){return(0,w.CqO)(V)?V:(0,w.QGY)(V)?(0,Le.D)(Promise.resolve(V)):(0,je.of)(V)}const dn={exact:function Oe(V,F,M){if(!mt(V.segments,F.segments)||!Lt(V.segments,F.segments,M)||V.numberOfChildren!==F.numberOfChildren)return!1;for(const J in F.children)if(!V.children[J]||!Oe(V.children[J],F.children[J],M))return!1;return!0},subset:ot},Pn={exact:function be(V,F){return Ki(V,F)},subset:function Qe(V,F){return Object.keys(F).length<=Object.keys(V).length&&Object.keys(F).every(M=>Li(V[M],F[M]))},ignored:()=>!0};function ce(V,F,M){return dn[M.paths](V.root,F.root,M.matrixParams)&&Pn[M.queryParams](V.queryParams,F.queryParams)&&!("exact"===M.fragment&&V.fragment!==F.fragment)}function ot(V,F,M){return Dt(V,F,F.segments,M)}function Dt(V,F,M,J){if(V.segments.length>M.length){const ye=V.segments.slice(0,M.length);return!(!mt(ye,M)||F.hasChildren()||!Lt(ye,M,J))}if(V.segments.length===M.length){if(!mt(V.segments,M)||!Lt(V.segments,M,J))return!1;for(const ye in F.children)if(!V.children[ye]||!ot(V.children[ye],F.children[ye],J))return!1;return!0}{const ye=M.slice(0,V.segments.length),De=M.slice(V.segments.length);return!!(mt(V.segments,ye)&&Lt(V.segments,ye,J)&&V.children[re])&&Dt(V.children[re],F,De,J)}}function Lt(V,F,M){return F.every((J,ye)=>Pn[M](V[ye].parameters,J.parameters))}class Je{constructor(F,M,J){this.root=F,this.queryParams=M,this.fragment=J}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=zt(this.queryParams)),this._queryParamMap}toString(){return zn.serialize(this)}}class Ie{constructor(F,M){this.segments=F,this.children=M,this.parent=null,tt(M,(J,ye)=>J.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return an(this)}}class ze{constructor(F,M){this.path=F,this.parameters=M}get parameterMap(){return this._parameterMap||(this._parameterMap=zt(this.parameters)),this._parameterMap}toString(){return ur(this)}}function mt(V,F){return V.length===F.length&&V.every((M,J)=>M.path===F[J].path)}class en{}class Dn{parse(F){const M=new Vr(F);return new Je(M.parseRootSegment(),M.parseQueryParams(),M.parseFragment())}serialize(F){const M=`/${Kn(F.root,!0)}`,J=function jr(V){const F=Object.keys(V).map(M=>{const J=V[M];return Array.isArray(J)?J.map(ye=>`${Hn(M)}=${Hn(ye)}`).join("&"):`${Hn(M)}=${Hn(J)}`}).filter(M=>!!M);return F.length?`?${F.join("&")}`:""}(F.queryParams);return`${M}${J}${"string"==typeof F.fragment?`#${function Ir(V){return encodeURI(V)}(F.fragment)}`:""}`}}const zn=new Dn;function an(V){return V.segments.map(F=>ur(F)).join("/")}function Kn(V,F){if(!V.hasChildren())return an(V);if(F){const M=V.children[re]?Kn(V.children[re],!1):"",J=[];return tt(V.children,(ye,De)=>{De!==re&&J.push(`${De}:${Kn(ye,!1)}`)}),J.length>0?`${M}(${J.join("//")})`:M}{const M=function Tt(V,F){let M=[];return tt(V.children,(J,ye)=>{ye===re&&(M=M.concat(F(J,ye)))}),tt(V.children,(J,ye)=>{ye!==re&&(M=M.concat(F(J,ye)))}),M}(V,(J,ye)=>ye===re?[Kn(V.children[re],!1)]:[`${ye}:${Kn(J,!1)}`]);return 1===Object.keys(V.children).length&&null!=V.children[re]?`${an(V)}/${M[0]}`:`${an(V)}/(${M.join("//")})`}}function Yn(V){return encodeURIComponent(V).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Hn(V){return Yn(V).replace(/%3B/gi,";")}function Xn(V){return Yn(V).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function br(V){return decodeURIComponent(V)}function yn(V){return br(V.replace(/\+/g,"%20"))}function ur(V){return`${Xn(V.path)}${function Dr(V){return Object.keys(V).map(F=>`;${Xn(F)}=${Xn(V[F])}`).join("")}(V.parameters)}`}const oo=/^[^\/()?;=#]+/;function zr(V){const F=V.match(oo);return F?F[0]:""}const Ci=/^[^=?&#]+/,Gr=/^[^&#]+/;class Vr{constructor(F){this.url=F,this.remaining=F}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ie([],{}):new Ie([],this.parseChildren())}parseQueryParams(){const F={};if(this.consumeOptional("?"))do{this.parseQueryParam(F)}while(this.consumeOptional("&"));return F}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const F=[];for(this.peekStartsWith("(")||F.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),F.push(this.parseSegment());let M={};this.peekStartsWith("/(")&&(this.capture("/"),M=this.parseParens(!0));let J={};return this.peekStartsWith("(")&&(J=this.parseParens(!1)),(F.length>0||Object.keys(M).length>0)&&(J[re]=new Ie(F,M)),J}parseSegment(){const F=zr(this.remaining);if(""===F&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(F),new ze(br(F),this.parseMatrixParams())}parseMatrixParams(){const F={};for(;this.consumeOptional(";");)this.parseParam(F);return F}parseParam(F){const M=zr(this.remaining);if(!M)return;this.capture(M);let J="";if(this.consumeOptional("=")){const ye=zr(this.remaining);ye&&(J=ye,this.capture(J))}F[br(M)]=br(J)}parseQueryParam(F){const M=function Mr(V){const F=V.match(Ci);return F?F[0]:""}(this.remaining);if(!M)return;this.capture(M);let J="";if(this.consumeOptional("=")){const Ne=function Fr(V){const F=V.match(Gr);return F?F[0]:""}(this.remaining);Ne&&(J=Ne,this.capture(J))}const ye=yn(M),De=yn(J);if(F.hasOwnProperty(ye)){let Ne=F[ye];Array.isArray(Ne)||(Ne=[Ne],F[ye]=Ne),Ne.push(De)}else F[ye]=De}parseParens(F){const M={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const J=zr(this.remaining),ye=this.remaining[J.length];if("/"!==ye&&")"!==ye&&";"!==ye)throw new Error(`Cannot parse url '${this.url}'`);let De;J.indexOf(":")>-1?(De=J.substr(0,J.indexOf(":")),this.capture(De),this.capture(":")):F&&(De=re);const Ne=this.parseChildren();M[De]=1===Object.keys(Ne).length?Ne[re]:new Ie([],Ne),this.consumeOptional("//")}return M}peekStartsWith(F){return this.remaining.startsWith(F)}consumeOptional(F){return!!this.peekStartsWith(F)&&(this.remaining=this.remaining.substring(F.length),!0)}capture(F){if(!this.consumeOptional(F))throw new Error(`Expected "${F}".`)}}class hs{constructor(F){this._root=F}get root(){return this._root.value}parent(F){const M=this.pathFromRoot(F);return M.length>1?M[M.length-2]:null}children(F){const M=Yi(F,this._root);return M?M.children.map(J=>J.value):[]}firstChild(F){const M=Yi(F,this._root);return M&&M.children.length>0?M.children[0].value:null}siblings(F){const M=Ao(F,this._root);return M.length<2?[]:M[M.length-2].children.map(ye=>ye.value).filter(ye=>ye!==F)}pathFromRoot(F){return Ao(F,this._root).map(M=>M.value)}}function Yi(V,F){if(V===F.value)return F;for(const M of F.children){const J=Yi(V,M);if(J)return J}return null}function Ao(V,F){if(V===F.value)return[F];for(const M of F.children){const J=Ao(V,M);if(J.length)return J.unshift(F),J}return[]}class Bo{constructor(F,M){this.value=F,this.children=M}toString(){return`TreeNode(${this.value})`}}function Pi(V){const F={};return V&&V.children.forEach(M=>F[M.value.outlet]=M),F}class Si extends hs{constructor(F,M){super(F),this.snapshot=M,ou(this,F)}toString(){return this.snapshot.toString()}}function xs(V,F){const M=function zi(V,F){const Ne=new fo([],{},{},"",{},re,F,null,V.root,-1,{});return new Ji("",new Bo(Ne,[]))}(V,F),J=new g([new ze("",{})]),ye=new g({}),De=new g({}),Ne=new g({}),at=new g(""),pn=new Br(J,ye,Ne,at,De,re,F,M.root);return pn.snapshot=M.root,new Si(new Bo(pn,[]),M)}class Br{constructor(F,M,J,ye,De,Ne,at,pn){this.url=F,this.params=M,this.queryParams=J,this.fragment=ye,this.data=De,this.outlet=Ne,this.component=at,this._futureSnapshot=pn}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,_t.U)(F=>zt(F)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,_t.U)(F=>zt(F)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ds(V,F="emptyOnly"){const M=V.pathFromRoot;let J=0;if("always"!==F)for(J=M.length-1;J>=1;){const ye=M[J],De=M[J-1];if(ye.routeConfig&&""===ye.routeConfig.path)J--;else{if(De.component)break;J--}}return function _i(V){return V.reduce((F,M)=>({params:Object.assign(Object.assign({},F.params),M.params),data:Object.assign(Object.assign({},F.data),M.data),resolve:Object.assign(Object.assign({},F.resolve),M._resolvedData)}),{params:{},data:{},resolve:{}})}(M.slice(J))}class fo{constructor(F,M,J,ye,De,Ne,at,pn,wn,Fn,Pr){this.url=F,this.params=M,this.queryParams=J,this.fragment=ye,this.data=De,this.outlet=Ne,this.component=at,this.routeConfig=pn,this._urlSegment=wn,this._lastPathIndex=Fn,this._resolve=Pr}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=zt(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=zt(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(J=>J.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ji extends hs{constructor(F,M){super(M),this.url=F,ou(this,M)}toString(){return ns(this._root)}}function ou(V,F){F.value._routerState=V,F.children.forEach(M=>ou(V,M))}function ns(V){const F=V.children.length>0?` { ${V.children.map(ns).join(", ")} } `:"";return`${V.value}${F}`}function fs(V){if(V.snapshot){const F=V.snapshot,M=V._futureSnapshot;V.snapshot=M,Ki(F.queryParams,M.queryParams)||V.queryParams.next(M.queryParams),F.fragment!==M.fragment&&V.fragment.next(M.fragment),Ki(F.params,M.params)||V.params.next(M.params),function wr(V,F){if(V.length!==F.length)return!1;for(let M=0;M<V.length;++M)if(!Ki(V[M],F[M]))return!1;return!0}(F.url,M.url)||V.url.next(M.url),Ki(F.data,M.data)||V.data.next(M.data)}else V.snapshot=V._futureSnapshot,V.data.next(V._futureSnapshot.data)}function Io(V,F){const M=Ki(V.params,F.params)&&function Ve(V,F){return mt(V,F)&&V.every((M,J)=>Ki(M.parameters,F[J].parameters))}(V.url,F.url);return M&&!(!V.parent!=!F.parent)&&(!V.parent||Io(V.parent,F.parent))}function Mo(V,F,M){if(M&&V.shouldReuseRoute(F.value,M.value.snapshot)){const J=M.value;J._futureSnapshot=F.value;const ye=function No(V,F,M){return F.children.map(J=>{for(const ye of M.children)if(V.shouldReuseRoute(J.value,ye.value.snapshot))return Mo(V,J,ye);return Mo(V,J)})}(V,F,M);return new Bo(J,ye)}{if(V.shouldAttach(F.value)){const De=V.retrieve(F.value);if(null!==De){const Ne=De.route;return Ne.value._futureSnapshot=F.value,Ne.children=F.children.map(at=>Mo(V,at)),Ne}}const J=function mi(V){return new Br(new g(V.url),new g(V.params),new g(V.queryParams),new g(V.fragment),new g(V.data),V.outlet,V.component,V)}(F.value),ye=F.children.map(De=>Mo(V,De));return new Bo(J,ye)}}function Oa(V){return"object"==typeof V&&null!=V&&!V.outlets&&!V.segmentPath}function rs(V){return"object"==typeof V&&null!=V&&V.outlets}function Yo(V,F,M,J,ye){let De={};return J&&tt(J,(Ne,at)=>{De[at]=Array.isArray(Ne)?Ne.map(pn=>`${pn}`):`${Ne}`}),new Je(M.root===V?F:$a(M.root,V,F),De,ye)}function $a(V,F,M){const J={};return tt(V.children,(ye,De)=>{J[De]=ye===F?M:$a(ye,F,M)}),new Ie(V.segments,J)}class au{constructor(F,M,J){if(this.isAbsolute=F,this.numberOfDoubleDots=M,this.commands=J,F&&J.length>0&&Oa(J[0]))throw new Error("Root segment cannot have matrix parameters");const ye=J.find(rs);if(ye&&ye!==Te(J))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ta{constructor(F,M,J){this.segmentGroup=F,this.processChildren=M,this.index=J}}function ma(V,F,M){if(V||(V=new Ie([],{})),0===V.segments.length&&V.hasChildren())return Ss(V,F,M);const J=function Ls(V,F,M){let J=0,ye=F;const De={match:!1,pathIndex:0,commandIndex:0};for(;ye<V.segments.length;){if(J>=M.length)return De;const Ne=V.segments[ye],at=M[J];if(rs(at))break;const pn=`${at}`,wn=J<M.length-1?M[J+1]:null;if(ye>0&&void 0===pn)break;if(pn&&wn&&"object"==typeof wn&&void 0===wn.outlets){if(!Cs(pn,wn,Ne))return De;J+=2}else{if(!Cs(pn,{},Ne))return De;J++}ye++}return{match:!0,pathIndex:ye,commandIndex:J}}(V,F,M),ye=M.slice(J.commandIndex);if(J.match&&J.pathIndex<V.segments.length){const De=new Ie(V.segments.slice(0,J.pathIndex),{});return De.children[re]=new Ie(V.segments.slice(J.pathIndex),V.children),Ss(De,0,ye)}return J.match&&0===ye.length?new Ie(V.segments,{}):J.match&&!V.hasChildren()?$s(V,F,M):J.match?Ss(V,0,ye):$s(V,F,M)}function Ss(V,F,M){if(0===M.length)return new Ie(V.segments,{});{const J=function Uu(V){return rs(V[0])?V[0].outlets:{[re]:V}}(M),ye={};return tt(J,(De,Ne)=>{"string"==typeof De&&(De=[De]),null!==De&&(ye[Ne]=ma(V.children[Ne],F,De))}),tt(V.children,(De,Ne)=>{void 0===J[Ne]&&(ye[Ne]=De)}),new Ie(V.segments,ye)}}function $s(V,F,M){const J=V.segments.slice(0,F);let ye=0;for(;ye<M.length;){const De=M[ye];if(rs(De)){const pn=Ho(De.outlets);return new Ie(J,pn)}if(0===ye&&Oa(M[0])){J.push(new ze(V.segments[F].path,ga(M[0]))),ye++;continue}const Ne=rs(De)?De.outlets[re]:`${De}`,at=ye<M.length-1?M[ye+1]:null;Ne&&at&&Oa(at)?(J.push(new ze(Ne,ga(at))),ye+=2):(J.push(new ze(Ne,{})),ye++)}return new Ie(J,{})}function Ho(V){const F={};return tt(V,(M,J)=>{"string"==typeof M&&(M=[M]),null!==M&&(F[J]=$s(new Ie([],{}),0,M))}),F}function ga(V){const F={};return tt(V,(M,J)=>F[J]=`${M}`),F}function Cs(V,F,M){return V==M.path&&Ki(F,M.parameters)}class is{constructor(F,M,J,ye){this.routeReuseStrategy=F,this.futureState=M,this.currState=J,this.forwardEvent=ye}activate(F){const M=this.futureState._root,J=this.currState?this.currState._root:null;this.deactivateChildRoutes(M,J,F),fs(this.futureState.root),this.activateChildRoutes(M,J,F)}deactivateChildRoutes(F,M,J){const ye=Pi(M);F.children.forEach(De=>{const Ne=De.value.outlet;this.deactivateRoutes(De,ye[Ne],J),delete ye[Ne]}),tt(ye,(De,Ne)=>{this.deactivateRouteAndItsChildren(De,J)})}deactivateRoutes(F,M,J){const ye=F.value,De=M?M.value:null;if(ye===De)if(ye.component){const Ne=J.getContext(ye.outlet);Ne&&this.deactivateChildRoutes(F,M,Ne.children)}else this.deactivateChildRoutes(F,M,J);else De&&this.deactivateRouteAndItsChildren(M,J)}deactivateRouteAndItsChildren(F,M){F.value.component&&this.routeReuseStrategy.shouldDetach(F.value.snapshot)?this.detachAndStoreRouteSubtree(F,M):this.deactivateRouteAndOutlet(F,M)}detachAndStoreRouteSubtree(F,M){const J=M.getContext(F.value.outlet),ye=J&&F.value.component?J.children:M,De=Pi(F);for(const Ne of Object.keys(De))this.deactivateRouteAndItsChildren(De[Ne],ye);if(J&&J.outlet){const Ne=J.outlet.detach(),at=J.children.onOutletDeactivated();this.routeReuseStrategy.store(F.value.snapshot,{componentRef:Ne,route:F,contexts:at})}}deactivateRouteAndOutlet(F,M){const J=M.getContext(F.value.outlet),ye=J&&F.value.component?J.children:M,De=Pi(F);for(const Ne of Object.keys(De))this.deactivateRouteAndItsChildren(De[Ne],ye);J&&J.outlet&&(J.outlet.deactivate(),J.children.onOutletDeactivated(),J.attachRef=null,J.resolver=null,J.route=null)}activateChildRoutes(F,M,J){const ye=Pi(M);F.children.forEach(De=>{this.activateRoutes(De,ye[De.value.outlet],J),this.forwardEvent(new ve(De.value.snapshot))}),F.children.length&&this.forwardEvent(new Wn(F.value.snapshot))}activateRoutes(F,M,J){const ye=F.value,De=M?M.value:null;if(fs(ye),ye===De)if(ye.component){const Ne=J.getOrCreateContext(ye.outlet);this.activateChildRoutes(F,M,Ne.children)}else this.activateChildRoutes(F,M,J);else if(ye.component){const Ne=J.getOrCreateContext(ye.outlet);if(this.routeReuseStrategy.shouldAttach(ye.snapshot)){const at=this.routeReuseStrategy.retrieve(ye.snapshot);this.routeReuseStrategy.store(ye.snapshot,null),Ne.children.onOutletReAttached(at.contexts),Ne.attachRef=at.componentRef,Ne.route=at.route.value,Ne.outlet&&Ne.outlet.attach(at.componentRef,at.route.value),fs(at.route.value),this.activateChildRoutes(F,null,Ne.children)}else{const at=function po(V){for(let F=V.parent;F;F=F.parent){const M=F.routeConfig;if(M&&M._loadedConfig)return M._loadedConfig;if(M&&M.component)return null}return null}(ye.snapshot),pn=at?at.module.componentFactoryResolver:null;Ne.attachRef=null,Ne.route=ye,Ne.resolver=pn,Ne.outlet&&Ne.outlet.activateWith(ye,pn),this.activateChildRoutes(F,null,Ne.children)}}else this.activateChildRoutes(F,null,J)}}class Ni{constructor(F,M){this.routes=F,this.module=M}}function Uo(V){return"function"==typeof V}function na(V){return V instanceof Je}const qs=Symbol("INITIAL_VALUE");function so(){return(0,ft.w)(V=>function St(...V){const F=(0,fe.yG)(V),M=(0,fe.jO)(V),{args:J,keys:ye}=(0,xe.D)(V);if(0===J.length)return(0,Le.D)([],F);const De=new nt.y(function pt(V,F,M=Re.y){return J=>{bt(F,()=>{const{length:ye}=V,De=new Array(ye);let Ne=ye,at=ye;for(let pn=0;pn<ye;pn++)bt(F,()=>{const wn=(0,Le.D)(V[pn],F);let Fn=!1;wn.subscribe(new ae.Q(J,Pr=>{De[pn]=Pr,Fn||(Fn=!0,at--),at||J.next(M(De.slice()))},()=>{--Ne||J.complete()}))},J)},J)}}(J,F,ye?Ne=>(0,se.n)(ye,Ne):Re.y));return M?De.pipe((0,Ue.Z)(M)):De}(V.map(F=>F.pipe((0,Zt.q)(1),(0,nn.O)(qs)))).pipe((0,qt.R)((F,M)=>{let J=!1;return M.reduce((ye,De,Ne)=>ye!==qs?ye:(De===qs&&(J=!0),J||!1!==De&&Ne!==M.length-1&&!na(De)?ye:De),F)},qs),(0,Y.h)(F=>F!==qs),(0,_t.U)(F=>na(F)?F:!0===F),(0,Zt.q)(1)))}class ss{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Su,this.attachRef=null}}class Su{constructor(){this.contexts=new Map}onChildOutletCreated(F,M){const J=this.getOrCreateContext(F);J.outlet=M,this.contexts.set(F,J)}onChildOutletDestroyed(F){const M=this.getContext(F);M&&(M.outlet=null,M.attachRef=null)}onOutletDeactivated(){const F=this.contexts;return this.contexts=new Map,F}onOutletReAttached(F){this.contexts=F}getOrCreateContext(F){let M=this.getContext(F);return M||(M=new ss,this.contexts.set(F,M)),M}getContext(F){return this.contexts.get(F)||null}}let wo=(()=>{class V{constructor(M,J,ye,De,Ne){this.parentContexts=M,this.location=J,this.resolver=ye,this.changeDetector=Ne,this.activated=null,this._activatedRoute=null,this.activateEvents=new w.vpe,this.deactivateEvents=new w.vpe,this.attachEvents=new w.vpe,this.detachEvents=new w.vpe,this.name=De||re,M.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const M=this.parentContexts.getContext(this.name);M&&M.route&&(M.attachRef?this.attach(M.attachRef,M.route):this.activateWith(M.route,M.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const M=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(M.instance),M}attach(M,J){this.activated=M,this._activatedRoute=J,this.location.insert(M.hostView),this.attachEvents.emit(M.instance)}deactivate(){if(this.activated){const M=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(M)}}activateWith(M,J){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=M;const Ne=(J=J||this.resolver).resolveComponentFactory(M._futureSnapshot.routeConfig.component),at=this.parentContexts.getOrCreateContext(this.name).children,pn=new Ds(M,at,this.location.injector);this.activated=this.location.createComponent(Ne,this.location.length,pn),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return V.\u0275fac=function(M){return new(M||V)(w.Y36(Su),w.Y36(w.s_b),w.Y36(w._Vd),w.$8M("name"),w.Y36(w.sBO))},V.\u0275dir=w.lG2({type:V,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),V})();class Ds{constructor(F,M,J){this.route=F,this.childContexts=M,this.parent=J}get(F,M){return F===Br?this.route:F===Su?this.childContexts:this.parent.get(F,M)}}let qa=(()=>{class V{}return V.\u0275fac=function(M){return new(M||V)},V.\u0275cmp=w.Xpm({type:V,selectors:[["ng-component"]],decls:1,vars:0,template:function(M,J){1&M&&w._UZ(0,"router-outlet")},directives:[wo],encapsulation:2}),V})();function eo(V,F=""){for(let M=0;M<V.length;M++){const J=V[M];Cu(J,ps(F,J))}}function Cu(V,F){V.children&&eo(V.children,F)}function ps(V,F){return F?V||F.path?V&&!F.path?`${V}/`:!V&&F.path?F.path:`${V}/${F.path}`:"":V}function Jo(V){const F=V.children&&V.children.map(Jo),M=F?Object.assign(Object.assign({},V),{children:F}):Object.assign({},V);return!M.component&&(F||M.loadChildren)&&M.outlet&&M.outlet!==re&&(M.component=qa),M}function qr(V){return V.outlet||re}function oe(V,F){const M=V.filter(J=>qr(J)===F);return M.push(...V.filter(J=>qr(J)!==F)),M}const qe={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function ne(V,F,M){var J;if(""===F.path)return"full"===F.pathMatch&&(V.hasChildren()||M.length>0)?Object.assign({},qe):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const De=(F.matcher||Tr)(M,V,F);if(!De)return Object.assign({},qe);const Ne={};tt(De.posParams,(pn,wn)=>{Ne[wn]=pn.path});const at=De.consumed.length>0?Object.assign(Object.assign({},Ne),De.consumed[De.consumed.length-1].parameters):Ne;return{matched:!0,consumedSegments:De.consumed,lastChild:De.consumed.length,parameters:at,positionalParamSegments:null!==(J=De.posParams)&&void 0!==J?J:{}}}function et(V,F,M,J,ye="corrected"){if(M.length>0&&function On(V,F,M){return M.some(J=>Hr(V,F,J)&&qr(J)!==re)}(V,M,J)){const Ne=new Ie(F,function vn(V,F,M,J){const ye={};ye[re]=J,J._sourceSegment=V,J._segmentIndexShift=F.length;for(const De of M)if(""===De.path&&qr(De)!==re){const Ne=new Ie([],{});Ne._sourceSegment=V,Ne._segmentIndexShift=F.length,ye[qr(De)]=Ne}return ye}(V,F,J,new Ie(M,V.children)));return Ne._sourceSegment=V,Ne._segmentIndexShift=F.length,{segmentGroup:Ne,slicedSegments:[]}}if(0===M.length&&function er(V,F,M){return M.some(J=>Hr(V,F,J))}(V,M,J)){const Ne=new Ie(V.segments,function Ot(V,F,M,J,ye,De){const Ne={};for(const at of J)if(Hr(V,M,at)&&!ye[qr(at)]){const pn=new Ie([],{});pn._sourceSegment=V,pn._segmentIndexShift="legacy"===De?V.segments.length:F.length,Ne[qr(at)]=pn}return Object.assign(Object.assign({},ye),Ne)}(V,F,M,J,V.children,ye));return Ne._sourceSegment=V,Ne._segmentIndexShift=F.length,{segmentGroup:Ne,slicedSegments:M}}const De=new Ie(V.segments,V.children);return De._sourceSegment=V,De._segmentIndexShift=F.length,{segmentGroup:De,slicedSegments:M}}function Hr(V,F,M){return(!(V.hasChildren()||F.length>0)||"full"!==M.pathMatch)&&""===M.path}function li(V,F,M,J){return!!(qr(V)===J||J!==re&&Hr(F,M,V))&&("**"===V.path||ne(F,V,M).matched)}function ni(V,F,M){return 0===F.length&&!V.children[M]}class Qr{constructor(F){this.segmentGroup=F||null}}class mo{constructor(F){this.urlTree=F}}function Vi(V){return new nt.y(F=>F.error(new Qr(V)))}function Di(V){return new nt.y(F=>F.error(new mo(V)))}function ms(V){return new nt.y(F=>F.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${V}'`)))}class ra{constructor(F,M,J,ye,De){this.configLoader=M,this.urlSerializer=J,this.urlTree=ye,this.config=De,this.allowRedirects=!0,this.ngModule=F.get(w.h0i)}apply(){const F=et(this.urlTree.root,[],[],this.config).segmentGroup,M=new Ie(F.segments,F.children);return this.expandSegmentGroup(this.ngModule,this.config,M,re).pipe((0,_t.U)(De=>this.createUrlTree(Ns(De),this.urlTree.queryParams,this.urlTree.fragment))).pipe(U(De=>{if(De instanceof mo)return this.allowRedirects=!1,this.match(De.urlTree);throw De instanceof Qr?this.noMatchError(De):De}))}match(F){return this.expandSegmentGroup(this.ngModule,this.config,F.root,re).pipe((0,_t.U)(ye=>this.createUrlTree(Ns(ye),F.queryParams,F.fragment))).pipe(U(ye=>{throw ye instanceof Qr?this.noMatchError(ye):ye}))}noMatchError(F){return new Error(`Cannot match any routes. URL Segment: '${F.segmentGroup}'`)}createUrlTree(F,M,J){const ye=F.segments.length>0?new Ie([],{[re]:F}):F;return new Je(ye,M,J)}expandSegmentGroup(F,M,J,ye){return 0===J.segments.length&&J.hasChildren()?this.expandChildren(F,M,J).pipe((0,_t.U)(De=>new Ie([],De))):this.expandSegment(F,J,M,J.segments,ye,!0)}expandChildren(F,M,J){const ye=[];for(const De of Object.keys(J.children))"primary"===De?ye.unshift(De):ye.push(De);return(0,Le.D)(ye).pipe((0,An.b)(De=>{const Ne=J.children[De],at=oe(M,De);return this.expandSegmentGroup(F,at,Ne,De).pipe((0,_t.U)(pn=>({segment:pn,outlet:De})))}),(0,qt.R)((De,Ne)=>(De[Ne.outlet]=Ne.segment,De),{}),function We(V,F){const M=arguments.length>=2;return J=>J.pipe(V?(0,Y.h)((ye,De)=>V(ye,De,J)):Re.y,ee(1),M?(0,_e.d)(F):(0,Pe.T)(()=>new Ae.K))}())}expandSegment(F,M,J,ye,De,Ne){return(0,Le.D)(J).pipe((0,An.b)(at=>this.expandSegmentAgainstRoute(F,M,J,at,ye,De,Ne).pipe(U(wn=>{if(wn instanceof Qr)return(0,je.of)(null);throw wn}))),(0,kn.P)(at=>!!at),U((at,pn)=>{if(at instanceof Ae.K||"EmptyError"===at.name){if(ni(M,ye,De))return(0,je.of)(new Ie([],{}));throw new Qr(M)}throw at}))}expandSegmentAgainstRoute(F,M,J,ye,De,Ne,at){return li(ye,M,De,Ne)?void 0===ye.redirectTo?this.matchSegmentAgainstRoute(F,M,ye,De,Ne):at&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(F,M,J,ye,De,Ne):Vi(M):Vi(M)}expandSegmentAgainstRouteUsingRedirect(F,M,J,ye,De,Ne){return"**"===ye.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(F,J,ye,Ne):this.expandRegularSegmentAgainstRouteUsingRedirect(F,M,J,ye,De,Ne)}expandWildCardWithParamsAgainstRouteUsingRedirect(F,M,J,ye){const De=this.applyRedirectCommands([],J.redirectTo,{});return J.redirectTo.startsWith("/")?Di(De):this.lineralizeSegments(J,De).pipe((0,jn.z)(Ne=>{const at=new Ie(Ne,{});return this.expandSegment(F,at,M,Ne,ye,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(F,M,J,ye,De,Ne){const{matched:at,consumedSegments:pn,lastChild:wn,positionalParamSegments:Fn}=ne(M,ye,De);if(!at)return Vi(M);const Pr=this.applyRedirectCommands(pn,ye.redirectTo,Fn);return ye.redirectTo.startsWith("/")?Di(Pr):this.lineralizeSegments(ye,Pr).pipe((0,jn.z)(si=>this.expandSegment(F,M,J,si.concat(De.slice(wn)),Ne,!1)))}matchSegmentAgainstRoute(F,M,J,ye,De){if("**"===J.path)return J.loadChildren?(J._loadedConfig?(0,je.of)(J._loadedConfig):this.configLoader.load(F.injector,J)).pipe((0,_t.U)(si=>(J._loadedConfig=si,new Ie(ye,{})))):(0,je.of)(new Ie(ye,{}));const{matched:Ne,consumedSegments:at,lastChild:pn}=ne(M,J,ye);if(!Ne)return Vi(M);const wn=ye.slice(pn);return this.getChildConfig(F,J,ye).pipe((0,jn.z)(Pr=>{const si=Pr.module,xi=Pr.routes,{segmentGroup:Ro,slicedSegments:Co}=et(M,at,wn,xi),xa=new Ie(Ro.segments,Ro.children);if(0===Co.length&&xa.hasChildren())return this.expandChildren(si,xi,xa).pipe((0,_t.U)(Ks=>new Ie(at,Ks)));if(0===xi.length&&0===Co.length)return(0,je.of)(new Ie(at,{}));const Ea=qr(J)===De;return this.expandSegment(si,xa,xi,Co,Ea?re:De,!0).pipe((0,_t.U)(Xi=>new Ie(at.concat(Xi.segments),Xi.children)))}))}getChildConfig(F,M,J){return M.children?(0,je.of)(new Ni(M.children,F)):M.loadChildren?void 0!==M._loadedConfig?(0,je.of)(M._loadedConfig):this.runCanLoadGuards(F.injector,M,J).pipe((0,jn.z)(ye=>ye?this.configLoader.load(F.injector,M).pipe((0,_t.U)(De=>(M._loadedConfig=De,De))):function go(V){return new nt.y(F=>F.error(Mn(`Cannot load children because the guard of the route "path: '${V.path}'" returned false`)))}(M))):(0,je.of)(new Ni([],F))}runCanLoadGuards(F,M,J){const ye=M.canLoad;if(!ye||0===ye.length)return(0,je.of)(!0);const De=ye.map(Ne=>{const at=F.get(Ne);let pn;if(function uu(V){return V&&Uo(V.canLoad)}(at))pn=at.canLoad(M,J);else{if(!Uo(at))throw new Error("Invalid CanLoad guard");pn=at(M,J)}return Ft(pn)});return(0,je.of)(De).pipe(so(),(0,gr.b)(Ne=>{if(!na(Ne))return;const at=Mn(`Redirecting to "${this.urlSerializer.serialize(Ne)}"`);throw at.url=Ne,at}),(0,_t.U)(Ne=>!0===Ne))}lineralizeSegments(F,M){let J=[],ye=M.root;for(;;){if(J=J.concat(ye.segments),0===ye.numberOfChildren)return(0,je.of)(J);if(ye.numberOfChildren>1||!ye.children[re])return ms(F.redirectTo);ye=ye.children[re]}}applyRedirectCommands(F,M,J){return this.applyRedirectCreatreUrlTree(M,this.urlSerializer.parse(M),F,J)}applyRedirectCreatreUrlTree(F,M,J,ye){const De=this.createSegmentGroup(F,M.root,J,ye);return new Je(De,this.createQueryParams(M.queryParams,this.urlTree.queryParams),M.fragment)}createQueryParams(F,M){const J={};return tt(F,(ye,De)=>{if("string"==typeof ye&&ye.startsWith(":")){const at=ye.substring(1);J[De]=M[at]}else J[De]=ye}),J}createSegmentGroup(F,M,J,ye){const De=this.createSegments(F,M.segments,J,ye);let Ne={};return tt(M.children,(at,pn)=>{Ne[pn]=this.createSegmentGroup(F,at,J,ye)}),new Ie(De,Ne)}createSegments(F,M,J,ye){return M.map(De=>De.path.startsWith(":")?this.findPosParam(F,De,ye):this.findOrReturn(De,J))}findPosParam(F,M,J){const ye=J[M.path.substring(1)];if(!ye)throw new Error(`Cannot redirect to '${F}'. Cannot find '${M.path}'.`);return ye}findOrReturn(F,M){let J=0;for(const ye of M){if(ye.path===F.path)return M.splice(J),ye;J++}return F}}function Ns(V){const F={};for(const J of Object.keys(V.children)){const De=Ns(V.children[J]);(De.segments.length>0||De.hasChildren())&&(F[J]=De)}return function La(V){if(1===V.numberOfChildren&&V.children[re]){const F=V.children[re];return new Ie(V.segments.concat(F.segments),F.children)}return V}(new Ie(V.segments,F))}class Na{constructor(F){this.path=F,this.route=this.path[this.path.length-1]}}class Xo{constructor(F,M){this.component=F,this.route=M}}function vl(V,F,M){const J=V._root;return xo(J,F?F._root:null,M,[J.value])}function Cr(V,F,M){const J=function Fa(V){if(!V)return null;for(let F=V.parent;F;F=F.parent){const M=F.routeConfig;if(M&&M._loadedConfig)return M._loadedConfig}return null}(F);return(J?J.module.injector:M).get(V)}function xo(V,F,M,J,ye={canDeactivateChecks:[],canActivateChecks:[]}){const De=Pi(F);return V.children.forEach(Ne=>{(function Ws(V,F,M,J,ye={canDeactivateChecks:[],canActivateChecks:[]}){const De=V.value,Ne=F?F.value:null,at=M?M.getContext(V.value.outlet):null;if(Ne&&De.routeConfig===Ne.routeConfig){const pn=function Wa(V,F,M){if("function"==typeof M)return M(V,F);switch(M){case"pathParamsChange":return!mt(V.url,F.url);case"pathParamsOrQueryParamsChange":return!mt(V.url,F.url)||!Ki(V.queryParams,F.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Io(V,F)||!Ki(V.queryParams,F.queryParams);default:return!Io(V,F)}}(Ne,De,De.routeConfig.runGuardsAndResolvers);pn?ye.canActivateChecks.push(new Na(J)):(De.data=Ne.data,De._resolvedData=Ne._resolvedData),xo(V,F,De.component?at?at.children:null:M,J,ye),pn&&at&&at.outlet&&at.outlet.isActivated&&ye.canDeactivateChecks.push(new Xo(at.outlet.component,Ne))}else Ne&&as(F,at,ye),ye.canActivateChecks.push(new Na(J)),xo(V,null,De.component?at?at.children:null:M,J,ye)})(Ne,De[Ne.value.outlet],M,J.concat([Ne.value]),ye),delete De[Ne.value.outlet]}),tt(De,(Ne,at)=>as(Ne,M.getContext(at),ye)),ye}function as(V,F,M){const J=Pi(V),ye=V.value;tt(J,(De,Ne)=>{as(De,ye.component?F?F.children.getContext(Ne):null:F,M)}),M.canDeactivateChecks.push(new Xo(ye.component&&F&&F.outlet&&F.outlet.isActivated?F.outlet.component:null,ye))}class Za{}function Eo(V){return new nt.y(F=>F.error(V))}class Au{constructor(F,M,J,ye,De,Ne){this.rootComponentType=F,this.config=M,this.urlTree=J,this.url=ye,this.paramsInheritanceStrategy=De,this.relativeLinkResolution=Ne}recognize(){const F=et(this.urlTree.root,[],[],this.config.filter(Ne=>void 0===Ne.redirectTo),this.relativeLinkResolution).segmentGroup,M=this.processSegmentGroup(this.config,F,re);if(null===M)return null;const J=new fo([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},re,this.rootComponentType,null,this.urlTree.root,-1,{}),ye=new Bo(J,M),De=new Ji(this.url,ye);return this.inheritParamsAndData(De._root),De}inheritParamsAndData(F){const M=F.value,J=ds(M,this.paramsInheritanceStrategy);M.params=Object.freeze(J.params),M.data=Object.freeze(J.data),F.children.forEach(ye=>this.inheritParamsAndData(ye))}processSegmentGroup(F,M,J){return 0===M.segments.length&&M.hasChildren()?this.processChildren(F,M):this.processSegment(F,M,M.segments,J)}processChildren(F,M){const J=[];for(const De of Object.keys(M.children)){const Ne=M.children[De],at=oe(F,De),pn=this.processSegmentGroup(at,Ne,De);if(null===pn)return null;J.push(...pn)}const ye=_a(J);return function Fo(V){V.sort((F,M)=>F.value.outlet===re?-1:M.value.outlet===re?1:F.value.outlet.localeCompare(M.value.outlet))}(ye),ye}processSegment(F,M,J,ye){for(const De of F){const Ne=this.processSegmentAgainstRoute(De,M,J,ye);if(null!==Ne)return Ne}return ni(M,J,ye)?[]:null}processSegmentAgainstRoute(F,M,J,ye){if(F.redirectTo||!li(F,M,J,ye))return null;let De,Ne=[],at=[];if("**"===F.path){const xi=J.length>0?Te(J).parameters:{};De=new fo(J,xi,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Mu(F),qr(F),F.component,F,va(M),$u(M)+J.length,Ms(F))}else{const xi=ne(M,F,J);if(!xi.matched)return null;Ne=xi.consumedSegments,at=J.slice(xi.lastChild),De=new fo(Ne,xi.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Mu(F),qr(F),F.component,F,va(M),$u(M)+Ne.length,Ms(F))}const pn=function ia(V){return V.children?V.children:V.loadChildren?V._loadedConfig.routes:[]}(F),{segmentGroup:wn,slicedSegments:Fn}=et(M,Ne,at,pn.filter(xi=>void 0===xi.redirectTo),this.relativeLinkResolution);if(0===Fn.length&&wn.hasChildren()){const xi=this.processChildren(pn,wn);return null===xi?null:[new Bo(De,xi)]}if(0===pn.length&&0===Fn.length)return[new Bo(De,[])];const Pr=qr(F)===ye,si=this.processSegment(pn,wn,Fn,Pr?re:ye);return null===si?null:[new Bo(De,si)]}}function Hu(V){const F=V.value.routeConfig;return F&&""===F.path&&void 0===F.redirectTo}function _a(V){const F=[],M=new Set;for(const J of V){if(!Hu(J)){F.push(J);continue}const ye=F.find(De=>J.value.routeConfig===De.value.routeConfig);void 0!==ye?(ye.children.push(...J.children),M.add(ye)):F.push(J)}for(const J of M){const ye=_a(J.children);F.push(new Bo(J.value,ye))}return F.filter(J=>!M.has(J))}function va(V){let F=V;for(;F._sourceSegment;)F=F._sourceSegment;return F}function $u(V){let F=V,M=F._segmentIndexShift?F._segmentIndexShift:0;for(;F._sourceSegment;)F=F._sourceSegment,M+=F._segmentIndexShift?F._segmentIndexShift:0;return M-1}function Mu(V){return V.data||{}}function Ms(V){return V.resolve||{}}function fl(V){return[...Object.keys(V),...Object.getOwnPropertySymbols(V)]}function oa(V){return(0,ft.w)(F=>{const M=V(F);return M?(0,Le.D)(M).pipe((0,_t.U)(()=>F)):(0,je.of)(F)})}class Ai extends class To{shouldDetach(F){return!1}store(F,M){}shouldAttach(F){return!1}retrieve(F){return null}shouldReuseRoute(F,M){return F.routeConfig===M.routeConfig}}{}const ao=new w.OlP("ROUTES");class Ka{constructor(F,M,J,ye){this.injector=F,this.compiler=M,this.onLoadStartListener=J,this.onLoadEndListener=ye}load(F,M){if(M._loader$)return M._loader$;this.onLoadStartListener&&this.onLoadStartListener(M);const ye=this.loadModuleFactory(M.loadChildren).pipe((0,_t.U)(De=>{this.onLoadEndListener&&this.onLoadEndListener(M);const Ne=De.create(F);return new Ni(Ht(Ne.injector.get(ao,void 0,w.XFs.Self|w.XFs.Optional)).map(Jo),Ne)}),U(De=>{throw M._loader$=void 0,De}));return M._loader$=new he(ye,()=>new ue.x).pipe(ut()),M._loader$}loadModuleFactory(F){return Ft(F()).pipe((0,jn.z)(M=>M instanceof w.YKP?(0,je.of)(M):(0,Le.D)(this.compiler.compileModuleAsync(M))))}}class P{shouldProcessUrl(F){return!0}extract(F){return F}merge(F,M){return F}}function B(V){throw V}function $(V,F,M){return F.parse("/")}function de(V,F){return(0,je.of)(null)}const Ge={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Ze={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Mt=(()=>{class V{constructor(M,J,ye,De,Ne,at,pn){this.rootComponentType=M,this.urlSerializer=J,this.rootContexts=ye,this.location=De,this.config=pn,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ue.x,this.errorHandler=B,this.malformedUriErrorHandler=$,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:de,afterPreactivation:de},this.urlHandlingStrategy=new P,this.routeReuseStrategy=new Ai,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=Ne.get(w.h0i),this.console=Ne.get(w.c2e);const Pr=Ne.get(w.R0b);this.isNgZoneEnabled=Pr instanceof w.R0b&&w.R0b.isInAngularZone(),this.resetConfig(pn),this.currentUrlTree=function vt(){return new Je(new Ie([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Ka(Ne,at,si=>this.triggerEvent(new ln(si)),si=>this.triggerEvent(new En(si))),this.routerState=xs(this.currentUrlTree,this.rootComponentType),this.transitions=new g({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var M;return null===(M=this.location.getState())||void 0===M?void 0:M.\u0275routerPageId}setupNavigations(M){const J=this.events;return M.pipe((0,Y.h)(ye=>0!==ye.id),(0,_t.U)(ye=>Object.assign(Object.assign({},ye),{extractedUrl:this.urlHandlingStrategy.extract(ye.rawUrl)})),(0,ft.w)(ye=>{let De=!1,Ne=!1;return(0,je.of)(ye).pipe((0,gr.b)(at=>{this.currentNavigation={id:at.id,initialUrl:at.currentRawUrl,extractedUrl:at.extractedUrl,trigger:at.source,extras:at.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,ft.w)(at=>{const pn=this.browserUrlTree.toString(),wn=!this.navigated||at.extractedUrl.toString()!==pn||pn!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||wn)&&this.urlHandlingStrategy.shouldProcessUrl(at.rawUrl))return _n(at.source)&&(this.browserUrlTree=at.extractedUrl),(0,je.of)(at).pipe((0,ft.w)(Pr=>{const si=this.transitions.getValue();return J.next(new di(Pr.id,this.serializeUrl(Pr.extractedUrl),Pr.source,Pr.restoredState)),si!==this.transitions.getValue()?ge.E:Promise.resolve(Pr)}),function Fs(V,F,M,J){return(0,ft.w)(ye=>function Rr(V,F,M,J,ye){return new ra(V,F,M,J,ye).apply()}(V,F,M,ye.extractedUrl,J).pipe((0,_t.U)(De=>Object.assign(Object.assign({},ye),{urlAfterRedirects:De}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,gr.b)(Pr=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Pr.urlAfterRedirects})}),function ba(V,F,M,J,ye){return(0,jn.z)(De=>function Us(V,F,M,J,ye="emptyOnly",De="legacy"){try{const Ne=new Au(V,F,M,J,ye,De).recognize();return null===Ne?Eo(new Za):(0,je.of)(Ne)}catch(Ne){return Eo(Ne)}}(V,F,De.urlAfterRedirects,M(De.urlAfterRedirects),J,ye).pipe((0,_t.U)(Ne=>Object.assign(Object.assign({},De),{targetSnapshot:Ne}))))}(this.rootComponentType,this.config,Pr=>this.serializeUrl(Pr),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,gr.b)(Pr=>{if("eager"===this.urlUpdateStrategy){if(!Pr.extras.skipLocationChange){const xi=this.urlHandlingStrategy.merge(Pr.urlAfterRedirects,Pr.rawUrl);this.setBrowserUrl(xi,Pr)}this.browserUrlTree=Pr.urlAfterRedirects}const si=new fi(Pr.id,this.serializeUrl(Pr.extractedUrl),this.serializeUrl(Pr.urlAfterRedirects),Pr.targetSnapshot);J.next(si)}));if(wn&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:si,extractedUrl:xi,source:Ro,restoredState:Co,extras:xa}=at,Ea=new di(si,this.serializeUrl(xi),Ro,Co);J.next(Ea);const Wr=xs(xi,this.rootComponentType).snapshot;return(0,je.of)(Object.assign(Object.assign({},at),{targetSnapshot:Wr,urlAfterRedirects:xi,extras:Object.assign(Object.assign({},xa),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=at.rawUrl,at.resolve(null),ge.E}),oa(at=>{const{targetSnapshot:pn,id:wn,extractedUrl:Fn,rawUrl:Pr,extras:{skipLocationChange:si,replaceUrl:xi}}=at;return this.hooks.beforePreactivation(pn,{navigationId:wn,appliedUrlTree:Fn,rawUrlTree:Pr,skipLocationChange:!!si,replaceUrl:!!xi})}),(0,gr.b)(at=>{const pn=new bi(at.id,this.serializeUrl(at.extractedUrl),this.serializeUrl(at.urlAfterRedirects),at.targetSnapshot);this.triggerEvent(pn)}),(0,_t.U)(at=>Object.assign(Object.assign({},at),{guards:vl(at.targetSnapshot,at.currentSnapshot,this.rootContexts)})),function zu(V,F){return(0,jn.z)(M=>{const{targetSnapshot:J,currentSnapshot:ye,guards:{canActivateChecks:De,canDeactivateChecks:Ne}}=M;return 0===Ne.length&&0===De.length?(0,je.of)(Object.assign(Object.assign({},M),{guardsResult:!0})):function Vu(V,F,M,J){return(0,Le.D)(V).pipe((0,jn.z)(ye=>function Bs(V,F,M,J,ye){const De=F&&F.routeConfig?F.routeConfig.canDeactivate:null;if(!De||0===De.length)return(0,je.of)(!0);const Ne=De.map(at=>{const pn=Cr(at,F,ye);let wn;if(function os(V){return V&&Uo(V.canDeactivate)}(pn))wn=Ft(pn.canDeactivate(V,F,M,J));else{if(!Uo(pn))throw new Error("Invalid CanDeactivate guard");wn=Ft(pn(V,F,M,J))}return wn.pipe((0,kn.P)())});return(0,je.of)(Ne).pipe(so())}(ye.component,ye.route,M,F,J)),(0,kn.P)(ye=>!0!==ye,!0))}(Ne,J,ye,V).pipe((0,jn.z)(at=>at&&function el(V){return"boolean"==typeof V}(at)?function Du(V,F,M,J){return(0,Le.D)(F).pipe((0,An.b)(ye=>(0,j.z)(function ya(V,F){return null!==V&&F&&F(new bn(V)),(0,je.of)(!0)}(ye.route.parent,J),function ju(V,F){return null!==V&&F&&F(new jt(V)),(0,je.of)(!0)}(ye.route,J),function yo(V,F,M){const J=F[F.length-1],De=F.slice(0,F.length-1).reverse().map(Ne=>function Nn(V){const F=V.routeConfig?V.routeConfig.canActivateChild:null;return F&&0!==F.length?{node:V,guards:F}:null}(Ne)).filter(Ne=>null!==Ne).map(Ne=>(0,W.P)(()=>{const at=Ne.guards.map(pn=>{const wn=Cr(pn,Ne.node,M);let Fn;if(function Gs(V){return V&&Uo(V.canActivateChild)}(wn))Fn=Ft(wn.canActivateChild(J,V));else{if(!Uo(wn))throw new Error("Invalid CanActivateChild guard");Fn=Ft(wn(J,V))}return Fn.pipe((0,kn.P)())});return(0,je.of)(at).pipe(so())}));return(0,je.of)(De).pipe(so())}(V,ye.path,M),function As(V,F,M){const J=F.routeConfig?F.routeConfig.canActivate:null;if(!J||0===J.length)return(0,je.of)(!0);const ye=J.map(De=>(0,W.P)(()=>{const Ne=Cr(De,F,M);let at;if(function Ga(V){return V&&Uo(V.canActivate)}(Ne))at=Ft(Ne.canActivate(F,V));else{if(!Uo(Ne))throw new Error("Invalid CanActivate guard");at=Ft(Ne(F,V))}return at.pipe((0,kn.P)())}));return(0,je.of)(ye).pipe(so())}(V,ye.route,M))),(0,kn.P)(ye=>!0!==ye,!0))}(J,De,V,F):(0,je.of)(at)),(0,_t.U)(at=>Object.assign(Object.assign({},M),{guardsResult:at})))})}(this.ngModule.injector,at=>this.triggerEvent(at)),(0,gr.b)(at=>{if(na(at.guardsResult)){const wn=Mn(`Redirecting to "${this.serializeUrl(at.guardsResult)}"`);throw wn.url=at.guardsResult,wn}const pn=new pi(at.id,this.serializeUrl(at.extractedUrl),this.serializeUrl(at.urlAfterRedirects),at.targetSnapshot,!!at.guardsResult);this.triggerEvent(pn)}),(0,Y.h)(at=>!!at.guardsResult||(this.restoreHistory(at),this.cancelNavigationTransition(at,""),!1)),oa(at=>{if(at.guards.canActivateChecks.length)return(0,je.of)(at).pipe((0,gr.b)(pn=>{const wn=new oi(pn.id,this.serializeUrl(pn.extractedUrl),this.serializeUrl(pn.urlAfterRedirects),pn.targetSnapshot);this.triggerEvent(wn)}),(0,ft.w)(pn=>{let wn=!1;return(0,je.of)(pn).pipe(function nl(V,F){return(0,jn.z)(M=>{const{targetSnapshot:J,guards:{canActivateChecks:ye}}=M;if(!ye.length)return(0,je.of)(M);let De=0;return(0,Le.D)(ye).pipe((0,An.b)(Ne=>function us(V,F,M,J){return function rl(V,F,M,J){const ye=fl(V);if(0===ye.length)return(0,je.of)({});const De={};return(0,Le.D)(ye).pipe((0,jn.z)(Ne=>function lu(V,F,M,J){const ye=Cr(V,F,J);return Ft(ye.resolve?ye.resolve(F,M):ye(F,M))}(V[Ne],F,M,J).pipe((0,gr.b)(at=>{De[Ne]=at}))),ee(1),(0,jn.z)(()=>fl(De).length===ye.length?(0,je.of)(De):ge.E))}(V._resolve,V,F,J).pipe((0,_t.U)(De=>(V._resolvedData=De,V.data=Object.assign(Object.assign({},V.data),ds(V,M).resolve),null)))}(Ne.route,J,V,F)),(0,gr.b)(()=>De++),ee(1),(0,jn.z)(Ne=>De===ye.length?(0,je.of)(M):ge.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,gr.b)({next:()=>wn=!0,complete:()=>{wn||(this.restoreHistory(pn),this.cancelNavigationTransition(pn,"At least one route resolver didn't emit any value."))}}))}),(0,gr.b)(pn=>{const wn=new Xt(pn.id,this.serializeUrl(pn.extractedUrl),this.serializeUrl(pn.urlAfterRedirects),pn.targetSnapshot);this.triggerEvent(wn)}))}),oa(at=>{const{targetSnapshot:pn,id:wn,extractedUrl:Fn,rawUrl:Pr,extras:{skipLocationChange:si,replaceUrl:xi}}=at;return this.hooks.afterPreactivation(pn,{navigationId:wn,appliedUrlTree:Fn,rawUrlTree:Pr,skipLocationChange:!!si,replaceUrl:!!xi})}),(0,_t.U)(at=>{const pn=function jo(V,F,M){const J=Mo(V,F._root,M?M._root:void 0);return new Si(J,F)}(this.routeReuseStrategy,at.targetSnapshot,at.currentRouterState);return Object.assign(Object.assign({},at),{targetRouterState:pn})}),(0,gr.b)(at=>{this.currentUrlTree=at.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(at.urlAfterRedirects,at.rawUrl),this.routerState=at.targetRouterState,"deferred"===this.urlUpdateStrategy&&(at.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,at),this.browserUrlTree=at.urlAfterRedirects)}),((V,F,M)=>(0,_t.U)(J=>(new is(F,J.targetRouterState,J.currentRouterState,M).activate(V),J)))(this.rootContexts,this.routeReuseStrategy,at=>this.triggerEvent(at)),(0,gr.b)({next(){De=!0},complete(){De=!0}}),function rt(V){return(0,ct.e)((F,M)=>{try{F.subscribe(M)}finally{M.add(V)}})}(()=>{var at;De||Ne||this.cancelNavigationTransition(ye,`Navigation ID ${ye.id} is not equal to the current navigation id ${this.navigationId}`),(null===(at=this.currentNavigation)||void 0===at?void 0:at.id)===ye.id&&(this.currentNavigation=null)}),U(at=>{if(Ne=!0,function Jn(V){return V&&V[sn]}(at)){const pn=na(at.url);pn||(this.navigated=!0,this.restoreHistory(ye,!0));const wn=new qi(ye.id,this.serializeUrl(ye.extractedUrl),at.message);J.next(wn),pn?setTimeout(()=>{const Fn=this.urlHandlingStrategy.merge(at.url,this.rawUrlTree),Pr={skipLocationChange:ye.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||_n(ye.source)};this.scheduleNavigation(Fn,"imperative",null,Pr,{resolve:ye.resolve,reject:ye.reject,promise:ye.promise})},0):ye.resolve(!1)}else{this.restoreHistory(ye,!0);const pn=new ii(ye.id,this.serializeUrl(ye.extractedUrl),at);J.next(pn);try{ye.resolve(this.errorHandler(at))}catch(wn){ye.reject(wn)}}return ge.E}))}))}resetRootComponentType(M){this.rootComponentType=M,this.routerState.root.component=this.rootComponentType}setTransition(M){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),M))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(M=>{const J="popstate"===M.type?"popstate":"hashchange";"popstate"===J&&setTimeout(()=>{var ye;const De={replaceUrl:!0},Ne=(null===(ye=M.state)||void 0===ye?void 0:ye.navigationId)?M.state:null;if(Ne){const pn=Object.assign({},Ne);delete pn.navigationId,delete pn.\u0275routerPageId,0!==Object.keys(pn).length&&(De.state=pn)}const at=this.parseUrl(M.url);this.scheduleNavigation(at,J,Ne,De)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(M){this.events.next(M)}resetConfig(M){eo(M),this.config=M.map(Jo),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(M,J={}){const{relativeTo:ye,queryParams:De,fragment:Ne,queryParamsHandling:at,preserveFragment:pn}=J,wn=ye||this.routerState.root,Fn=pn?this.currentUrlTree.fragment:Ne;let Pr=null;switch(at){case"merge":Pr=Object.assign(Object.assign({},this.currentUrlTree.queryParams),De);break;case"preserve":Pr=this.currentUrlTree.queryParams;break;default:Pr=De||null}return null!==Pr&&(Pr=this.removeEmptyProps(Pr)),function su(V,F,M,J,ye){if(0===M.length)return Yo(F.root,F.root,F,J,ye);const De=function fa(V){if("string"==typeof V[0]&&1===V.length&&"/"===V[0])return new au(!0,0,V);let F=0,M=!1;const J=V.reduce((ye,De,Ne)=>{if("object"==typeof De&&null!=De){if(De.outlets){const at={};return tt(De.outlets,(pn,wn)=>{at[wn]="string"==typeof pn?pn.split("/"):pn}),[...ye,{outlets:at}]}if(De.segmentPath)return[...ye,De.segmentPath]}return"string"!=typeof De?[...ye,De]:0===Ne?(De.split("/").forEach((at,pn)=>{0==pn&&"."===at||(0==pn&&""===at?M=!0:".."===at?F++:""!=at&&ye.push(at))}),ye):[...ye,De]},[]);return new au(M,F,J)}(M);if(De.toRoot())return Yo(F.root,new Ie([],{}),F,J,ye);const Ne=function pa(V,F,M){if(V.isAbsolute)return new ta(F.root,!0,0);if(-1===M.snapshot._lastPathIndex){const De=M.snapshot._urlSegment;return new ta(De,De===F.root,0)}const J=Oa(V.commands[0])?0:1;return function Tu(V,F,M){let J=V,ye=F,De=M;for(;De>ye;){if(De-=ye,J=J.parent,!J)throw new Error("Invalid number of '../'");ye=J.segments.length}return new ta(J,!1,ye-De)}(M.snapshot._urlSegment,M.snapshot._lastPathIndex+J,V.numberOfDoubleDots)}(De,F,V),at=Ne.processChildren?Ss(Ne.segmentGroup,Ne.index,De.commands):ma(Ne.segmentGroup,Ne.index,De.commands);return Yo(Ne.segmentGroup,at,F,J,ye)}(wn,this.currentUrlTree,M,Pr,null!=Fn?Fn:null)}navigateByUrl(M,J={skipLocationChange:!1}){const ye=na(M)?M:this.parseUrl(M),De=this.urlHandlingStrategy.merge(ye,this.rawUrlTree);return this.scheduleNavigation(De,"imperative",null,J)}navigate(M,J={skipLocationChange:!1}){return function $t(V){for(let F=0;F<V.length;F++){const M=V[F];if(null==M)throw new Error(`The requested path contains ${M} segment at index ${F}`)}}(M),this.navigateByUrl(this.createUrlTree(M,J),J)}serializeUrl(M){return this.urlSerializer.serialize(M)}parseUrl(M){let J;try{J=this.urlSerializer.parse(M)}catch(ye){J=this.malformedUriErrorHandler(ye,this.urlSerializer,M)}return J}isActive(M,J){let ye;if(ye=!0===J?Object.assign({},Ge):!1===J?Object.assign({},Ze):J,na(M))return ce(this.currentUrlTree,M,ye);const De=this.parseUrl(M);return ce(this.currentUrlTree,De,ye)}removeEmptyProps(M){return Object.keys(M).reduce((J,ye)=>{const De=M[ye];return null!=De&&(J[ye]=De),J},{})}processNavigations(){this.navigations.subscribe(M=>{this.navigated=!0,this.lastSuccessfulId=M.id,this.currentPageId=M.targetPageId,this.events.next(new vr(M.id,this.serializeUrl(M.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,M.resolve(!0)},M=>{this.console.warn(`Unhandled Navigation Error: ${M}`)})}scheduleNavigation(M,J,ye,De,Ne){var at,pn,wn;if(this.disposed)return Promise.resolve(!1);const Fn=this.transitions.value,Pr=_n(J)&&Fn&&!_n(Fn.source),si=Fn.rawUrl.toString()===M.toString(),xi=Fn.id===(null===(at=this.currentNavigation)||void 0===at?void 0:at.id);if(Pr&&si&&xi)return Promise.resolve(!0);let Co,xa,Ea;Ne?(Co=Ne.resolve,xa=Ne.reject,Ea=Ne.promise):Ea=new Promise((Ks,Jr)=>{Co=Ks,xa=Jr});const Wr=++this.navigationId;let Xi;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(ye=this.location.getState()),Xi=ye&&ye.\u0275routerPageId?ye.\u0275routerPageId:De.replaceUrl||De.skipLocationChange?null!==(pn=this.browserPageId)&&void 0!==pn?pn:0:(null!==(wn=this.browserPageId)&&void 0!==wn?wn:0)+1):Xi=0,this.setTransition({id:Wr,targetPageId:Xi,source:J,restoredState:ye,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:M,extras:De,resolve:Co,reject:xa,promise:Ea,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ea.catch(Ks=>Promise.reject(Ks))}setBrowserUrl(M,J){const ye=this.urlSerializer.serialize(M),De=Object.assign(Object.assign({},J.extras.state),this.generateNgRouterState(J.id,J.targetPageId));this.location.isCurrentPathEqualTo(ye)||J.extras.replaceUrl?this.location.replaceState(ye,"",De):this.location.go(ye,"",De)}restoreHistory(M,J=!1){var ye,De;if("computed"===this.canceledNavigationResolution){const Ne=this.currentPageId-M.targetPageId;"popstate"!==M.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(ye=this.currentNavigation)||void 0===ye?void 0:ye.finalUrl)||0===Ne?this.currentUrlTree===(null===(De=this.currentNavigation)||void 0===De?void 0:De.finalUrl)&&0===Ne&&(this.resetState(M),this.browserUrlTree=M.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(Ne)}else"replace"===this.canceledNavigationResolution&&(J&&this.resetState(M),this.resetUrlToCurrentUrlTree())}resetState(M){this.routerState=M.currentRouterState,this.currentUrlTree=M.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,M.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(M,J){const ye=new qi(M.id,this.serializeUrl(M.extractedUrl),J);this.triggerEvent(ye),M.resolve(!1)}generateNgRouterState(M,J){return"computed"===this.canceledNavigationResolution?{navigationId:M,\u0275routerPageId:J}:{navigationId:M}}}return V.\u0275fac=function(M){w.$Z()},V.\u0275prov=w.Yz7({token:V,factory:V.\u0275fac}),V})();function _n(V){return"imperative"!==V}let or=(()=>{class V{constructor(M,J,ye){this.router=M,this.route=J,this.locationStrategy=ye,this.commands=null,this.href=null,this.onChanges=new ue.x,this.subscription=M.events.subscribe(De=>{De instanceof vr&&this.updateTargetUrlAndHref()})}set routerLink(M){this.commands=null!=M?Array.isArray(M)?M:[M]:null}ngOnChanges(M){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(M,J,ye,De,Ne){if(0!==M||J||ye||De||Ne||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const at={skipLocationChange:Gn(this.skipLocationChange),replaceUrl:Gn(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,at),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Gn(this.preserveFragment)})}}return V.\u0275fac=function(M){return new(M||V)(w.Y36(Mt),w.Y36(Br),w.Y36(Er.S$))},V.\u0275dir=w.lG2({type:V,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(M,J){1&M&&w.NdJ("click",function(De){return J.onClick(De.button,De.ctrlKey,De.shiftKey,De.altKey,De.metaKey)}),2&M&&w.uIk("target",J.target)("href",J.href,w.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[w.TTD]}),V})();function Gn(V){return""===V||!!V}class Yr{}class Po{preload(F,M){return(0,je.of)(null)}}let gs=(()=>{class V{constructor(M,J,ye,De){this.router=M,this.injector=ye,this.preloadingStrategy=De,this.loader=new Ka(ye,J,pn=>M.triggerEvent(new ln(pn)),pn=>M.triggerEvent(new En(pn)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Y.h)(M=>M instanceof vr),(0,An.b)(()=>this.preload())).subscribe(()=>{})}preload(){const M=this.injector.get(w.h0i);return this.processRoutes(M,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(M,J){const ye=[];for(const De of J)if(De.loadChildren&&!De.canLoad&&De._loadedConfig){const Ne=De._loadedConfig;ye.push(this.processRoutes(Ne.module,Ne.routes))}else De.loadChildren&&!De.canLoad?ye.push(this.preloadConfig(M,De)):De.children&&ye.push(this.processRoutes(M,De.children));return(0,Le.D)(ye).pipe((0,lr.J)(),(0,_t.U)(De=>{}))}preloadConfig(M,J){return this.preloadingStrategy.preload(J,()=>(J._loadedConfig?(0,je.of)(J._loadedConfig):this.loader.load(M.injector,J)).pipe((0,jn.z)(De=>(J._loadedConfig=De,this.processRoutes(De.module,De.routes)))))}}return V.\u0275fac=function(M){return new(M||V)(w.LFG(Mt),w.LFG(w.Sil),w.LFG(w.zs3),w.LFG(Yr))},V.\u0275prov=w.Yz7({token:V,factory:V.\u0275fac}),V})(),Ya=(()=>{class V{constructor(M,J,ye={}){this.router=M,this.viewportScroller=J,this.options=ye,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},ye.scrollPositionRestoration=ye.scrollPositionRestoration||"disabled",ye.anchorScrolling=ye.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(M=>{M instanceof di?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=M.navigationTrigger,this.restoredId=M.restoredState?M.restoredState.navigationId:0):M instanceof vr&&(this.lastId=M.id,this.scheduleScrollEvent(M,this.router.parseUrl(M.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(M=>{M instanceof me&&(M.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(M.position):M.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(M.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(M,J){this.router.triggerEvent(new me(M,"popstate"===this.lastSource?this.store[this.restoredId]:null,J))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return V.\u0275fac=function(M){w.$Z()},V.\u0275prov=w.Yz7({token:V,factory:V.\u0275fac}),V})();const wi=new w.OlP("ROUTER_CONFIGURATION"),Ba=new w.OlP("ROUTER_FORROOT_GUARD"),rr=[Er.Ye,{provide:en,useClass:Dn},{provide:Mt,useFactory:function qu(V,F,M,J,ye,De,Ne={},at,pn){const wn=new Mt(null,V,F,M,J,ye,Ht(De));return at&&(wn.urlHandlingStrategy=at),pn&&(wn.routeReuseStrategy=pn),function Qo(V,F){V.errorHandler&&(F.errorHandler=V.errorHandler),V.malformedUriErrorHandler&&(F.malformedUriErrorHandler=V.malformedUriErrorHandler),V.onSameUrlNavigation&&(F.onSameUrlNavigation=V.onSameUrlNavigation),V.paramsInheritanceStrategy&&(F.paramsInheritanceStrategy=V.paramsInheritanceStrategy),V.relativeLinkResolution&&(F.relativeLinkResolution=V.relativeLinkResolution),V.urlUpdateStrategy&&(F.urlUpdateStrategy=V.urlUpdateStrategy),V.canceledNavigationResolution&&(F.canceledNavigationResolution=V.canceledNavigationResolution)}(Ne,wn),Ne.enableTracing&&wn.events.subscribe(Fn=>{var Pr,si;null===(Pr=console.group)||void 0===Pr||Pr.call(console,`Router Event: ${Fn.constructor.name}`),console.log(Fn.toString()),console.log(Fn),null===(si=console.groupEnd)||void 0===si||si.call(console)}),wn},deps:[en,Su,Er.Ye,w.zs3,w.Sil,ao,wi,[class sa{},new w.FiY],[class kl{},new w.FiY]]},Su,{provide:Br,useFactory:function So(V){return V.routerState.root},deps:[Mt]},gs,Po,class tr{preload(F,M){return M().pipe(U(()=>(0,je.of)(null)))}},{provide:wi,useValue:{enableTracing:!1}}];function Gu(){return new w.PXZ("Router",Mt)}let cu=(()=>{class V{constructor(M,J){}static forRoot(M,J){return{ngModule:V,providers:[rr,Zs(M),{provide:Ba,useFactory:zs,deps:[[Mt,new w.FiY,new w.tp0]]},{provide:wi,useValue:J||{}},{provide:Er.S$,useFactory:Ri,deps:[Er.lw,[new w.tBr(Er.mr),new w.FiY],wi]},{provide:Ya,useFactory:Ol,deps:[Mt,Er.EM,wi]},{provide:Yr,useExisting:J&&J.preloadingStrategy?J.preloadingStrategy:Po},{provide:w.PXZ,multi:!0,useFactory:Gu},[hu,{provide:w.ip1,multi:!0,useFactory:aa,deps:[hu]},{provide:il,useFactory:bl,deps:[hu]},{provide:w.tb,multi:!0,useExisting:il}]]}}static forChild(M){return{ngModule:V,providers:[Zs(M)]}}}return V.\u0275fac=function(M){return new(M||V)(w.LFG(Ba,8),w.LFG(Mt,8))},V.\u0275mod=w.oAB({type:V}),V.\u0275inj=w.cJS({}),V})();function Ol(V,F,M){return M.scrollOffset&&F.setOffset(M.scrollOffset),new Ya(V,F,M)}function Ri(V,F,M={}){return M.useHash?new Er.Do(V,F):new Er.b0(V,F)}function zs(V){return"guarded"}function Zs(V){return[{provide:w.deG,multi:!0,useValue:V},{provide:ao,multi:!0,useValue:V}]}let hu=(()=>{class V{constructor(M){this.injector=M,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new ue.x}appInitializer(){return this.injector.get(Er.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let J=null;const ye=new Promise(at=>J=at),De=this.injector.get(Mt),Ne=this.injector.get(wi);return"disabled"===Ne.initialNavigation?(De.setUpLocationChangeListener(),J(!0)):"enabled"===Ne.initialNavigation||"enabledBlocking"===Ne.initialNavigation?(De.hooks.afterPreactivation=()=>this.initNavigation?(0,je.of)(null):(this.initNavigation=!0,J(!0),this.resultOfPreactivationDone),De.initialNavigation()):J(!0),ye})}bootstrapListener(M){const J=this.injector.get(wi),ye=this.injector.get(gs),De=this.injector.get(Ya),Ne=this.injector.get(Mt),at=this.injector.get(w.z2F);M===at.components[0]&&(("enabledNonBlocking"===J.initialNavigation||void 0===J.initialNavigation)&&Ne.initialNavigation(),ye.setUpPreloading(),De.init(),Ne.resetRootComponentType(at.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return V.\u0275fac=function(M){return new(M||V)(w.LFG(w.zs3))},V.\u0275prov=w.Yz7({token:V,factory:V.\u0275fac}),V})();function aa(V){return V.appInitializer.bind(V)}function bl(V){return V.bootstrapListener.bind(V)}const il=new w.OlP("Router Initializer")},3942:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Z:()=>bt});var w=H(2090),ue=H(4859),g=H(9681),nt=H(1877);class xe{constructor(ct,ut){this._delegate=ct,this.firebase=ut,(0,g._addComponent)(ct,new ue.wA("app-compat",()=>this,"PUBLIC")),this.container=ct.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ct){this._delegate.automaticDataCollectionEnabled=ct}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ct=>{this._delegate.checkDestroyed(),ct()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,g.deleteApp)(this._delegate)))}_getService(ct,ut=g._DEFAULT_ENTRY_NAME){var he;this._delegate.checkDestroyed();const je=this._delegate.container.getProvider(ct);return!je.isInitialized()&&"EXPLICIT"===(null===(he=je.getComponent())||void 0===he?void 0:he.instantiationMode)&&je.initialize(),je.getImmediate({identifier:ut})}_removeServiceInstance(ct,ut=g._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ct).clearInstance(ut)}_addComponent(ct){(0,g._addComponent)(this._delegate,ct)}_addOrOverwriteComponent(ct){(0,g._addOrOverwriteComponent)(this._delegate,ct)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Re=new w.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),se=function fe(){const Ct=function Ue(Ct){const ct={},ut={__esModule:!0,initializeApp:function Ae(q,U={}){const Y=g.initializeApp(q,U);if((0,w.r3)(ct,Y.name))return ct[Y.name];const ee=new Ct(Y,ut);return ct[Y.name]=ee,ee},app:je,registerVersion:g.registerVersion,setLogLevel:g.setLogLevel,onLog:g.onLog,apps:null,SDK_VERSION:g.SDK_VERSION,INTERNAL:{registerComponent:function W(q){const U=q.name,Y=U.replace("-compat","");if(g._registerComponent(q)&&"PUBLIC"===q.type){const ee=(Pe=je())=>{if("function"!=typeof Pe[Y])throw Re.create("invalid-app-argument",{appName:U});return Pe[Y]()};void 0!==q.serviceProps&&(0,w.ZB)(ee,q.serviceProps),ut[Y]=ee,Ct.prototype[Y]=function(...Pe){return this._getService.bind(this,U).apply(this,q.multipleInstances?Pe:[])}}return"PUBLIC"===q.type?ut[Y]:null},removeApp:function he(q){delete ct[q]},useAsService:function ge(q,U){return"serverAuth"===U?null:U},modularAPIs:g}};function je(q){if(!(0,w.r3)(ct,q=q||g._DEFAULT_ENTRY_NAME))throw Re.create("no-app",{appName:q});return ct[q]}return ut.default=ut,Object.defineProperty(ut,"apps",{get:function j(){return Object.keys(ct).map(q=>ct[q])}}),je.App=Ct,ut}(xe);return Ct.INTERNAL=Object.assign(Object.assign({},Ct.INTERNAL),{createFirebaseNamespace:fe,extendNamespace:function ct(ut){(0,w.ZB)(Ct,ut)},createSubscribe:w.ne,ErrorFactory:w.LL,deepExtend:w.ZB}),Ct}(),ae=new nt.Yd("@firebase/app-compat");if((0,w.jU)()&&void 0!==self.firebase){ae.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ct=self.firebase.SDK_VERSION;Ct&&Ct.indexOf("LITE")>=0&&ae.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const bt=se;!function pt(Ct){(0,g.registerVersion)("@firebase/app-compat","0.1.15",Ct)}()},9681:(Sn,Nt,H)=>{"use strict";H.r(Nt),H.d(Nt,{FirebaseError:()=>nt.ZR,SDK_VERSION:()=>ii,_DEFAULT_ENTRY_NAME:()=>Zt,_addComponent:()=>kn,_addOrOverwriteComponent:()=>jn,_apps:()=>qt,_clearComponents:()=>Sr,_components:()=>An,_getProvider:()=>lr,_registerComponent:()=>gr,_removeServiceInstance:()=>Er,deleteApp:()=>oi,getApp:()=>bi,getApps:()=>pi,initializeApp:()=>fi,onLog:()=>En,registerVersion:()=>ln,setLogLevel:()=>bn});var w=H(5861),ue=H(4859),g=H(1877),nt=H(2090);class xe{constructor(ve){this.container=ve}getPlatformInfoString(){return this.container.getProviders().map(me=>{if(function Le(jt){const ve=jt.getComponent();return"VERSION"===(null==ve?void 0:ve.type)}(me)){const re=me.getImmediate();return`${re.library}/${re.version}`}return null}).filter(me=>me).join(" ")}}const Re="@firebase/app",fe=new g.Yd("@firebase/app"),Zt="[DEFAULT]",nn={[Re]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},qt=new Map,An=new Map;function kn(jt,ve){try{jt.container.addComponent(ve)}catch(me){fe.debug(`Component ${ve.name} failed to register with FirebaseApp ${jt.name}`,me)}}function jn(jt,ve){jt.container.addOrOverwriteComponent(ve)}function gr(jt){const ve=jt.name;if(An.has(ve))return fe.debug(`There were multiple attempts to register component ${ve}.`),!1;An.set(ve,jt);for(const me of qt.values())kn(me,jt);return!0}function lr(jt,ve){return jt.container.getProvider(ve)}function Er(jt,ve,me=Zt){lr(jt,ve).clearInstance(me)}function Sr(){An.clear()}const vr=new nt.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class qi{constructor(ve,me,re){this._isDeleted=!1,this._options=Object.assign({},ve),this._config=Object.assign({},me),this._name=me.name,this._automaticDataCollectionEnabled=me.automaticDataCollectionEnabled,this._container=re,this.container.addComponent(new ue.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ve){this.checkDestroyed(),this._automaticDataCollectionEnabled=ve}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(ve){this._isDeleted=ve}checkDestroyed(){if(this.isDeleted)throw vr.create("app-deleted",{appName:this._name})}}const ii="9.6.4";function fi(jt,ve={}){"object"!=typeof ve&&(ve={name:ve});const me=Object.assign({name:Zt,automaticDataCollectionEnabled:!1},ve),re=me.name;if("string"!=typeof re||!re)throw vr.create("bad-app-name",{appName:String(re)});const ht=qt.get(re);if(ht){if((0,nt.vZ)(jt,ht.options)&&(0,nt.vZ)(me,ht.config))return ht;throw vr.create("duplicate-app",{appName:re})}const zt=new ue.H0(re);for(const Mn of An.values())zt.addComponent(Mn);const sn=new qi(jt,me,zt);return qt.set(re,sn),sn}function bi(jt=Zt){const ve=qt.get(jt);if(!ve)throw vr.create("no-app",{appName:jt});return ve}function pi(){return Array.from(qt.values())}function oi(jt){return Xt.apply(this,arguments)}function Xt(){return(Xt=(0,w.Z)(function*(jt){const ve=jt.name;qt.has(ve)&&(qt.delete(ve),yield Promise.all(jt.container.getProviders().map(me=>me.delete())),jt.isDeleted=!0)})).apply(this,arguments)}function ln(jt,ve,me){var re;let ht=null!==(re=nn[jt])&&void 0!==re?re:jt;me&&(ht+=`-${me}`);const zt=ht.match(/\s|\//),sn=ve.match(/\s|\//);if(zt||sn){const Mn=[`Unable to register library "${ht}" with version "${ve}":`];return zt&&Mn.push(`library name "${ht}" contains illegal characters (whitespace or "/")`),zt&&sn&&Mn.push("and"),sn&&Mn.push(`version name "${ve}" contains illegal characters (whitespace or "/")`),void fe.warn(Mn.join(" "))}gr(new ue.wA(`${ht}-version`,()=>({library:ht,version:ve}),"VERSION"))}function En(jt,ve){if(null!==jt&&"function"!=typeof jt)throw vr.create("invalid-log-argument");(0,g.Am)(jt,ve)}function bn(jt){(0,g.Ub)(jt)}!function Wn(jt){gr(new ue.wA("platform-logger",ve=>new xe(ve),"PRIVATE")),ln(Re,"0.7.14",jt),ln(Re,"0.7.14","esm2017"),ln("fire-js","")}("")},4859:(Sn,Nt,H)=>{"use strict";H.d(Nt,{wA:()=>g,H0:()=>Ue});var w=H(5861),ue=H(2090);class g{constructor(se,ae,$e){this.name=se,this.instanceFactory=ae,this.type=$e,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(se){return this.instantiationMode=se,this}setMultipleInstances(se){return this.multipleInstances=se,this}setServiceProps(se){return this.serviceProps=se,this}setInstanceCreatedCallback(se){return this.onInstanceCreated=se,this}}const nt="[DEFAULT]";class xe{constructor(se,ae){this.name=se,this.container=ae,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(se){const ae=this.normalizeInstanceIdentifier(se);if(!this.instancesDeferred.has(ae)){const $e=new ue.BH;if(this.instancesDeferred.set(ae,$e),this.isInitialized(ae)||this.shouldAutoInitialize())try{const St=this.getOrInitializeService({instanceIdentifier:ae});St&&$e.resolve(St)}catch(St){}}return this.instancesDeferred.get(ae).promise}getImmediate(se){var ae;const $e=this.normalizeInstanceIdentifier(null==se?void 0:se.identifier),St=null!==(ae=null==se?void 0:se.optional)&&void 0!==ae&&ae;if(!this.isInitialized($e)&&!this.shouldAutoInitialize()){if(St)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:$e})}catch(pt){if(St)return null;throw pt}}getComponent(){return this.component}setComponent(se){if(se.name!==this.name)throw Error(`Mismatching Component ${se.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=se,this.shouldAutoInitialize()){if(function Re(fe){return"EAGER"===fe.instantiationMode}(se))try{this.getOrInitializeService({instanceIdentifier:nt})}catch(ae){}for(const[ae,$e]of this.instancesDeferred.entries()){const St=this.normalizeInstanceIdentifier(ae);try{const pt=this.getOrInitializeService({instanceIdentifier:St});$e.resolve(pt)}catch(pt){}}}}clearInstance(se=nt){this.instancesDeferred.delete(se),this.instancesOptions.delete(se),this.instances.delete(se)}delete(){var se=this;return(0,w.Z)(function*(){const ae=Array.from(se.instances.values());yield Promise.all([...ae.filter($e=>"INTERNAL"in $e).map($e=>$e.INTERNAL.delete()),...ae.filter($e=>"_delete"in $e).map($e=>$e._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(se=nt){return this.instances.has(se)}getOptions(se=nt){return this.instancesOptions.get(se)||{}}initialize(se={}){const{options:ae={}}=se,$e=this.normalizeInstanceIdentifier(se.instanceIdentifier);if(this.isInitialized($e))throw Error(`${this.name}(${$e}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const St=this.getOrInitializeService({instanceIdentifier:$e,options:ae});for(const[pt,bt]of this.instancesDeferred.entries())$e===this.normalizeInstanceIdentifier(pt)&&bt.resolve(St);return St}onInit(se,ae){var $e;const St=this.normalizeInstanceIdentifier(ae),pt=null!==($e=this.onInitCallbacks.get(St))&&void 0!==$e?$e:new Set;pt.add(se),this.onInitCallbacks.set(St,pt);const bt=this.instances.get(St);return bt&&se(bt,St),()=>{pt.delete(se)}}invokeOnInitCallbacks(se,ae){const $e=this.onInitCallbacks.get(ae);if($e)for(const St of $e)try{St(se,ae)}catch(pt){}}getOrInitializeService({instanceIdentifier:se,options:ae={}}){let $e=this.instances.get(se);if(!$e&&this.component&&($e=this.component.instanceFactory(this.container,{instanceIdentifier:(fe=se,fe===nt?void 0:fe),options:ae}),this.instances.set(se,$e),this.instancesOptions.set(se,ae),this.invokeOnInitCallbacks($e,se),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,se,$e)}catch(St){}var fe;return $e||null}normalizeInstanceIdentifier(se=nt){return this.component?this.component.multipleInstances?se:nt:se}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ue{constructor(se){this.name=se,this.providers=new Map}addComponent(se){const ae=this.getProvider(se.name);if(ae.isComponentSet())throw new Error(`Component ${se.name} has already been registered with ${this.name}`);ae.setComponent(se)}addOrOverwriteComponent(se){this.getProvider(se.name).isComponentSet()&&this.providers.delete(se.name),this.addComponent(se)}getProvider(se){if(this.providers.has(se))return this.providers.get(se);const ae=new xe(se,this);return this.providers.set(se,ae),ae}getProviders(){return Array.from(this.providers.values())}}},1877:(Sn,Nt,H)=>{"use strict";H.d(Nt,{in:()=>ue,Yd:()=>Re,Ub:()=>Ue,Am:()=>fe});const w=[];var ue=(()=>{return(se=ue||(ue={}))[se.DEBUG=0]="DEBUG",se[se.VERBOSE=1]="VERBOSE",se[se.INFO=2]="INFO",se[se.WARN=3]="WARN",se[se.ERROR=4]="ERROR",se[se.SILENT=5]="SILENT",ue;var se})();const g={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},nt=ue.INFO,xe={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},Le=(se,ae,...$e)=>{if(ae<se.logLevel)return;const St=(new Date).toISOString(),pt=xe[ae];if(!pt)throw new Error(`Attempted to log a message with an invalid logType (value: ${ae})`);console[pt](`[${St}]  ${se.name}:`,...$e)};class Re{constructor(ae){this.name=ae,this._logLevel=nt,this._logHandler=Le,this._userLogHandler=null,w.push(this)}get logLevel(){return this._logLevel}set logLevel(ae){if(!(ae in ue))throw new TypeError(`Invalid value "${ae}" assigned to \`logLevel\``);this._logLevel=ae}setLogLevel(ae){this._logLevel="string"==typeof ae?g[ae]:ae}get logHandler(){return this._logHandler}set logHandler(ae){if("function"!=typeof ae)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=ae}get userLogHandler(){return this._userLogHandler}set userLogHandler(ae){this._userLogHandler=ae}debug(...ae){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...ae),this._logHandler(this,ue.DEBUG,...ae)}log(...ae){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...ae),this._logHandler(this,ue.VERBOSE,...ae)}info(...ae){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...ae),this._logHandler(this,ue.INFO,...ae)}warn(...ae){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...ae),this._logHandler(this,ue.WARN,...ae)}error(...ae){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...ae),this._logHandler(this,ue.ERROR,...ae)}}function Ue(se){w.forEach(ae=>{ae.setLogLevel(se)})}function fe(se,ae){for(const $e of w){let St=null;ae&&ae.level&&(St=g[ae.level]),$e.userLogHandler=null===se?null:(pt,bt,...Ct)=>{const ct=Ct.map(ut=>{if(null==ut)return null;if("string"==typeof ut)return ut;if("number"==typeof ut||"boolean"==typeof ut)return ut.toString();if(ut instanceof Error)return ut.message;try{return JSON.stringify(ut)}catch(he){return null}}).filter(ut=>ut).join(" ");bt>=(null!=St?St:pt.logLevel)&&se({level:ue[bt].toLowerCase(),message:ct,args:Ct,type:pt.name})}}}},5886:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Z:()=>g});var w=H(1638);function ue(nt){var xe=[1/0,1/0,-1/0,-1/0];return(0,w.pZ)(nt,function(Le){xe[0]>Le[0]&&(xe[0]=Le[0]),xe[1]>Le[1]&&(xe[1]=Le[1]),xe[2]<Le[0]&&(xe[2]=Le[0]),xe[3]<Le[1]&&(xe[3]=Le[1])}),xe}ue.default=ue;const g=ue},1858:(Sn,Nt,H)=>{"use strict";H.d(Nt,{ZP:()=>Re});var w=H(5886),ue=H(7646),g=H(9400);function xe(ut,he,je,Ae){var j=je[0],W=je[1],ge=ut[0],q=ut[1],U=he[0],Y=he[1],_e=U-ge,We=Y-q;return 0==(je[0]-ge)*We-(je[1]-q)*_e&&(Ae?"start"===Ae?Math.abs(_e)>=Math.abs(We)?_e>0?ge<j&&j<=U:U<=j&&j<ge:We>0?q<W&&W<=Y:Y<=W&&W<q:"end"===Ae?Math.abs(_e)>=Math.abs(We)?_e>0?ge<=j&&j<U:U<j&&j<=ge:We>0?q<=W&&W<Y:Y<W&&W<=q:"both"===Ae&&(Math.abs(_e)>=Math.abs(We)?_e>0?ge<j&&j<U:U<j&&j<ge:We>0?q<W&&W<Y:Y<W&&W<q):Math.abs(_e)>=Math.abs(We)?_e>0?ge<=j&&j<=U:U<=j&&j<=ge:We>0?q<=W&&W<=Y:Y<=W&&W<=q)}const Le=function nt(ut,he,je){void 0===je&&(je={});for(var Ae=(0,g.c9)(ut),j=(0,g.r7)(he),W=0;W<j.length-1;W++){var ge=!1;if(je.ignoreEndVertices&&(0===W&&(ge="start"),W===j.length-2&&(ge="end"),0===W&&W+1===j.length-1&&(ge="both")),xe(j[W],j[W+1],Ae,ge))return!0}return!1};function Re(ut,he){var je=(0,g.wA)(ut),Ae=(0,g.wA)(he),j=je.type,W=Ae.type,ge=je.coordinates,q=Ae.coordinates;switch(j){case"Point":if("Point"===W)return Ct(ge,q);throw new Error("feature2 "+W+" geometry not supported");case"MultiPoint":switch(W){case"Point":return function Ue(ut,he){var je,Ae=!1;for(je=0;je<ut.coordinates.length;je++)if(Ct(ut.coordinates[je],he.coordinates)){Ae=!0;break}return Ae}(je,Ae);case"MultiPoint":return function fe(ut,he){for(var je=0,Ae=he.coordinates;je<Ae.length;je++){for(var j=Ae[je],W=!1,ge=0,q=ut.coordinates;ge<q.length;ge++)if(Ct(j,q[ge])){W=!0;break}if(!W)return!1}return!0}(je,Ae);default:throw new Error("feature2 "+W+" geometry not supported")}case"LineString":switch(W){case"Point":return Le(Ae,je,{ignoreEndVertices:!0});case"LineString":return function $e(ut,he){for(var je=!1,Ae=0,j=he.coordinates;Ae<j.length;Ae++){var W=j[Ae];if(Le({type:"Point",coordinates:W},ut,{ignoreEndVertices:!0})&&(je=!0),!Le({type:"Point",coordinates:W},ut,{ignoreEndVertices:!1}))return!1}return je}(je,Ae);case"MultiPoint":return function se(ut,he){for(var je=!1,Ae=0,j=he.coordinates;Ae<j.length;Ae++){var W=j[Ae];if(Le(W,ut,{ignoreEndVertices:!0})&&(je=!0),!Le(W,ut))return!1}return!!je}(je,Ae);default:throw new Error("feature2 "+W+" geometry not supported")}case"Polygon":switch(W){case"Point":return(0,ue.Z)(Ae,je,{ignoreBoundary:!0});case"LineString":return function St(ut,he){var je=!1,Ae=0;if(!bt((0,w.Z)(ut),(0,w.Z)(he)))return!1;for(;Ae<he.coordinates.length-1;Ae++){var ge=ct(he.coordinates[Ae],he.coordinates[Ae+1]);if((0,ue.Z)({type:"Point",coordinates:ge},ut,{ignoreBoundary:!0})){je=!0;break}}return je}(je,Ae);case"Polygon":return function pt(ut,he){if("Feature"===ut.type&&null===ut.geometry||"Feature"===he.type&&null===he.geometry)return!1;if(!bt((0,w.Z)(ut),(0,w.Z)(he)))return!1;for(var W=0,ge=(0,g.wA)(he).coordinates;W<ge.length;W++)for(var U=0,Y=ge[W];U<Y.length;U++)if(!(0,ue.Z)(Y[U],ut))return!1;return!0}(je,Ae);case"MultiPoint":return function ae(ut,he){for(var je=0,Ae=he.coordinates;je<Ae.length;je++)if(!(0,ue.Z)(Ae[je],ut,{ignoreBoundary:!0}))return!1;return!0}(je,Ae);default:throw new Error("feature2 "+W+" geometry not supported")}default:throw new Error("feature1 "+j+" geometry not supported")}}function bt(ut,he){return!(ut[0]>he[0]||ut[2]<he[2]||ut[1]>he[1]||ut[3]<he[3])}function Ct(ut,he){return ut[0]===he[0]&&ut[1]===he[1]}function ct(ut,he){return[(ut[0]+he[0])/2,(ut[1]+he[1])/2]}},7646:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Z:()=>ue});var w=H(9400);function ue(xe,Le,Re){if(void 0===Re&&(Re={}),!xe)throw new Error("point is required");if(!Le)throw new Error("polygon is required");var Ue=(0,w.c9)(xe),fe=(0,w.wA)(Le),se=fe.type,ae=Le.bbox,$e=fe.coordinates;if(ae&&!1===function nt(xe,Le){return Le[0]<=xe[0]&&Le[1]<=xe[1]&&Le[2]>=xe[0]&&Le[3]>=xe[1]}(Ue,ae))return!1;"Polygon"===se&&($e=[$e]);for(var St=!1,pt=0;pt<$e.length&&!St;pt++)if(g(Ue,$e[pt][0],Re.ignoreBoundary)){for(var bt=!1,Ct=1;Ct<$e[pt].length&&!bt;)g(Ue,$e[pt][Ct],!Re.ignoreBoundary)&&(bt=!0),Ct++;bt||(St=!0)}return St}function g(xe,Le,Re){var Ue=!1;Le[0][0]===Le[Le.length-1][0]&&Le[0][1]===Le[Le.length-1][1]&&(Le=Le.slice(0,Le.length-1));for(var fe=0,se=Le.length-1;fe<Le.length;se=fe++){var ae=Le[fe][0],$e=Le[fe][1],St=Le[se][0],pt=Le[se][1];if(xe[1]*(ae-St)+$e*(St-xe[0])+pt*(xe[0]-ae)==0&&(ae-xe[0])*(St-xe[0])<=0&&($e-xe[1])*(pt-xe[1])<=0)return!Re;$e>xe[1]!=pt>xe[1]&&xe[0]<(St-ae)*(xe[1]-$e)/(pt-$e)+ae&&(Ue=!Ue)}return Ue}},2986:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Z:()=>nt});var w=H(9400),ue=H(2615);const nt=function g(xe,Le,Re){void 0===Re&&(Re={});var Ue=(0,w.c9)(xe),fe=(0,w.c9)(Le),se=(0,ue.Ht)(fe[1]-Ue[1]),ae=(0,ue.Ht)(fe[0]-Ue[0]),$e=(0,ue.Ht)(Ue[1]),St=(0,ue.Ht)(fe[1]),pt=Math.pow(Math.sin(se/2),2)+Math.pow(Math.sin(ae/2),2)*Math.cos($e)*Math.cos(St);return(0,ue.DL)(2*Math.atan2(Math.sqrt(pt),Math.sqrt(1-pt)),Re.units)}},2615:(Sn,Nt,H)=>{"use strict";H.d(Nt,{zL:()=>xe,xm:()=>Re,uf:()=>St,DL:()=>he,Ht:()=>ge});var w=6371008.8,ue={centimeters:100*w,centimetres:100*w,degrees:w/111325,feet:3.28084*w,inches:39.37*w,kilometers:w/1e3,kilometres:w/1e3,meters:w,metres:w,miles:w/1609.344,millimeters:1e3*w,millimetres:1e3*w,nauticalmiles:w/1852,radians:1,yards:w/1.0936};function xe(We,rt,_t){void 0===_t&&(_t={});var ft={type:"Feature"};return(0===_t.id||_t.id)&&(ft.id=_t.id),_t.bbox&&(ft.bbox=_t.bbox),ft.properties=rt||{},ft.geometry=We,ft}function Re(We,rt,_t){if(void 0===_t&&(_t={}),!We)throw new Error("coordinates is required");if(!Array.isArray(We))throw new Error("coordinates must be an Array");if(We.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Y(We[0])||!Y(We[1]))throw new Error("coordinates must contain numbers");return xe({type:"Point",coordinates:We},rt,_t)}function St(We,rt){void 0===rt&&(rt={});var _t={type:"FeatureCollection"};return rt.id&&(_t.id=rt.id),rt.bbox&&(_t.bbox=rt.bbox),_t.features=We,_t}function he(We,rt){void 0===rt&&(rt="kilometers");var _t=ue[rt];if(!_t)throw new Error(rt+" units is invalid");return We*_t}function ge(We){return We%360*Math.PI/180}function Y(We){return!isNaN(We)&&null!==We&&!Array.isArray(We)}},9400:(Sn,Nt,H)=>{"use strict";function ue(se){if(!se)throw new Error("coord is required");if(!Array.isArray(se)){if("Feature"===se.type&&null!==se.geometry&&"Point"===se.geometry.type)return se.geometry.coordinates;if("Point"===se.type)return se.coordinates}if(Array.isArray(se)&&se.length>=2&&!Array.isArray(se[0])&&!Array.isArray(se[1]))return se;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function g(se){if(Array.isArray(se))return se;if("Feature"===se.type){if(null!==se.geometry)return se.geometry.coordinates}else if(se.coordinates)return se.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Ue(se){return"Feature"===se.type?se.geometry:se}H.d(Nt,{c9:()=>ue,r7:()=>g,wA:()=>Ue}),H(2615)},1638:(Sn,Nt,H)=>{"use strict";function ue(he,je,Ae){if(null!==he)for(var j,W,ge,q,U,Y,ee,We,Pe=0,_e=0,rt=he.type,_t="FeatureCollection"===rt,ft="Feature"===rt,Zt=_t?he.features.length:1,nn=0;nn<Zt;nn++){U=(We=!!(ee=_t?he.features[nn].geometry:ft?he.geometry:he)&&"GeometryCollection"===ee.type)?ee.geometries.length:1;for(var qt=0;qt<U;qt++){var An=0,kn=0;if(null!==(q=We?ee.geometries[qt]:ee)){Y=q.coordinates;var jn=q.type;switch(Pe=!Ae||"Polygon"!==jn&&"MultiPolygon"!==jn?0:1,jn){case null:break;case"Point":if(!1===je(Y,_e,nn,An,kn))return!1;_e++,An++;break;case"LineString":case"MultiPoint":for(j=0;j<Y.length;j++){if(!1===je(Y[j],_e,nn,An,kn))return!1;_e++,"MultiPoint"===jn&&An++}"LineString"===jn&&An++;break;case"Polygon":case"MultiLineString":for(j=0;j<Y.length;j++){for(W=0;W<Y[j].length-Pe;W++){if(!1===je(Y[j][W],_e,nn,An,kn))return!1;_e++}"MultiLineString"===jn&&An++,"Polygon"===jn&&kn++}"Polygon"===jn&&An++;break;case"MultiPolygon":for(j=0;j<Y.length;j++){for(kn=0,W=0;W<Y[j].length;W++){for(ge=0;ge<Y[j][W].length-Pe;ge++){if(!1===je(Y[j][W][ge],_e,nn,An,kn))return!1;_e++}kn++}An++}break;case"GeometryCollection":for(j=0;j<q.geometries.length;j++)if(!1===ue(q.geometries[j],je,Ae))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Le(he,je){if("Feature"===he.type)je(he,0);else if("FeatureCollection"===he.type)for(var Ae=0;Ae<he.features.length&&!1!==je(he.features[Ae],Ae);Ae++);}H.d(Nt,{pZ:()=>ue,By:()=>Le}),H(2615)},4289:(Sn,Nt,H)=>{"use strict";H.d(Nt,{Z:()=>j});var w=H(1638),ue=H(2615);const nt=function g(W){var ge=[];return"FeatureCollection"===W.type?(0,w.By)(W,function(q){(0,w.pZ)(q,function(U){ge.push((0,ue.xm)(U,q.properties))})}):(0,w.pZ)(W,function(q){ge.push((0,ue.xm)(q,W.properties))}),(0,ue.uf)(ge)};var xe=H(5886);function fe(W){var ge={type:"Feature"};return Object.keys(W).forEach(function(q){switch(q){case"type":case"properties":case"geometry":return;default:ge[q]=W[q]}}),ge.properties=se(W.properties),ge.geometry=$e(W.geometry),ge}function se(W){var ge={};return W&&Object.keys(W).forEach(function(q){var U=W[q];ge[q]="object"==typeof U?null===U?null:Array.isArray(U)?U.map(function(Y){return Y}):se(U):U}),ge}function $e(W){var ge={type:W.type};return W.bbox&&(ge.bbox=W.bbox),"GeometryCollection"===W.type?(ge.geometries=W.geometries.map(function(q){return $e(q)}),ge):(ge.coordinates=St(W.coordinates),ge)}function St(W){var ge=W;return"object"!=typeof ge[0]?ge.slice():ge.map(function(q){return St(q)})}var bt=H(2986);const ct=function Ct(W,ge){if(!W)throw new Error("targetPoint is required");if(!ge)throw new Error("points is required");var q,U=1/0,Y=0;return(0,w.By)(ge,function(ee,Pe){var _e=(0,bt.Z)(W,ee);_e<U&&(Y=Pe,U=_e)}),(q=function Ue(W){if(!W)throw new Error("geojson is required");switch(W.type){case"Feature":return fe(W);case"FeatureCollection":return function ae(W){var ge={type:"FeatureCollection"};return Object.keys(W).forEach(function(q){switch(q){case"type":case"features":return;default:ge[q]=W[q]}}),ge.features=W.features.map(function(q){return fe(q)}),ge}(W);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return $e(W);default:throw new Error("unknown GeoJSON type")}}(ge.features[Y])).properties.featureIndex=Y,q.properties.distanceToPoint=U,q};var ut=H(7646);function Ae(W,ge,q,U,Y,ee){return Math.sqrt((Y-q)*(Y-q)+(ee-U)*(ee-U))===Math.sqrt((W-q)*(W-q)+(ge-U)*(ge-U))+Math.sqrt((Y-W)*(Y-W)+(ee-ge)*(ee-ge))}const j=function he(W){for(var ge=function je(W){return"FeatureCollection"!==W.type?(0,ue.uf)("Feature"!==W.type?[(0,ue.zL)(W)]:[W]):W}(W),q=function Le(W,ge){void 0===ge&&(ge={});var q=(0,xe.Z)(W);return(0,ue.xm)([(q[0]+q[2])/2,(q[1]+q[3])/2],ge.properties,ge)}(ge),U=!1,Y=0;!U&&Y<ge.features.length;){var Zt,ee=ge.features[Y].geometry,nn=!1;if("Point"===ee.type)q.geometry.coordinates[0]===ee.coordinates[0]&&q.geometry.coordinates[1]===ee.coordinates[1]&&(U=!0);else if("MultiPoint"===ee.type){var qt=!1;for(Zt=0;!qt&&Zt<ee.coordinates.length;)q.geometry.coordinates[0]===ee.coordinates[Zt][0]&&q.geometry.coordinates[1]===ee.coordinates[Zt][1]&&(U=!0,qt=!0),Zt++}else if("LineString"===ee.type)for(Zt=0;!nn&&Zt<ee.coordinates.length-1;)Ae(q.geometry.coordinates[0],q.geometry.coordinates[1],ee.coordinates[Zt][0],ee.coordinates[Zt][1],ee.coordinates[Zt+1][0],ee.coordinates[Zt+1][1])&&(nn=!0,U=!0),Zt++;else if("MultiLineString"===ee.type)for(var An=0;An<ee.coordinates.length;){nn=!1,Zt=0;for(var kn=ee.coordinates[An];!nn&&Zt<kn.length-1;)Ae(q.geometry.coordinates[0],q.geometry.coordinates[1],kn[Zt][0],kn[Zt][1],kn[Zt+1][0],kn[Zt+1][1])&&(nn=!0,U=!0),Zt++;An++}else("Polygon"===ee.type||"MultiPolygon"===ee.type)&&(0,ut.Z)(q,ee)&&(U=!0);Y++}if(U)return q;var jn=(0,ue.uf)([]);for(Y=0;Y<ge.features.length;Y++)jn.features=jn.features.concat(nt(ge.features[Y]).features);return(0,ue.xm)(ct(q,jn).geometry.coordinates)}},5861:(Sn,Nt,H)=>{"use strict";function w(g,nt,xe,Le,Re,Ue,fe){try{var se=g[Ue](fe),ae=se.value}catch($e){return void xe($e)}se.done?nt(ae):Promise.resolve(ae).then(Le,Re)}function ue(g){return function(){var nt=this,xe=arguments;return new Promise(function(Le,Re){var Ue=g.apply(nt,xe);function fe(ae){w(Ue,Le,Re,fe,se,"next",ae)}function se(ae){w(Ue,Le,Re,fe,se,"throw",ae)}fe(void 0)})}}H.d(Nt,{Z:()=>ue})}}]);